---
ms.openlocfilehash: 8b804d23247b95381f3ff83bc12c32215a420fb6
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/01/2020
ms.locfileid: "85614957"
---
### <a name="wpf-appdomain-shutdown-handling-may-now-call-dispatcherinvoke-in-cleanup-of-weak-events"></a><span data-ttu-id="560bc-101">La gestione degli arresti di AppDomain WPF potrebbe ora chiamare Dispatcher. Invoke nella pulizia degli eventi vulnerabili</span><span class="sxs-lookup"><span data-stu-id="560bc-101">WPF AppDomain Shutdown Handling May Now Call Dispatcher.Invoke in Cleanup of Weak Events</span></span>

#### <a name="details"></a><span data-ttu-id="560bc-102">Dettagli</span><span class="sxs-lookup"><span data-stu-id="560bc-102">Details</span></span>

<span data-ttu-id="560bc-103">In .NET Framework 4.7.1 e versioni precedenti, WPF crea potenzialmente un oggetto <xref:System.Windows.Threading.Dispatcher?displayProperty=nameWithType> nel thread del finalizzatore .NET durante l'arresto di AppDomain.</span><span class="sxs-lookup"><span data-stu-id="560bc-103">In .NET Framework 4.7.1 and earlier versions, WPF potentially creates a <xref:System.Windows.Threading.Dispatcher?displayProperty=nameWithType> on the .NET finalizer thread during AppDomain shutdown.</span></span>  <span data-ttu-id="560bc-104">Questo problema è stato risolto in .NET Framework 4.7.2 e nelle versioni successive, rendendo la pulitura degli eventi vulnerabili in grado di riconoscere i thread.</span><span class="sxs-lookup"><span data-stu-id="560bc-104">This was fixed in .NET Framework 4.7.2 and later versions by making the cleanup of weak events thread-aware.</span></span>  <span data-ttu-id="560bc-105">Per questo motivo, WPF può chiamare <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> per completare il processo di pulizia. In alcune applicazioni, questa modifica nell'intervallo di tempo del finalizzatore può causare eccezioni durante il dominio AppDomain o l'arresto del processo.</span><span class="sxs-lookup"><span data-stu-id="560bc-105">Due to this, WPF may call <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> to complete the cleanup process.In certain applications, this change in finalizer timing can potentially cause exceptions during AppDomain or process shutdown.</span></span>  <span data-ttu-id="560bc-106">Questo problema si verifica in genere nelle applicazioni che non arrestano correttamente i dispatcher in esecuzione nei thread di lavoro prima dell'arresto del processo o dell'AppDomain.</span><span class="sxs-lookup"><span data-stu-id="560bc-106">This is generally seen in applications that do not correctly shut down dispatchers running on worker threads prior to process or AppDomain shutdown.</span></span>  <span data-ttu-id="560bc-107">Tali applicazioni devono prestare attenzione a gestire correttamente la durata dei dispatcher.</span><span class="sxs-lookup"><span data-stu-id="560bc-107">Such applications should take care to properly manage the lifetime of dispatchers.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="560bc-108">Suggerimento</span><span class="sxs-lookup"><span data-stu-id="560bc-108">Suggestion</span></span>

<span data-ttu-id="560bc-109">In .NET Framework 4.7.2 e versioni successive, gli sviluppatori possono disabilitare questa correzione per ridurre (ma non eliminare) i problemi di temporizzazione che possono verificarsi a causa della modifica della pulizia. Per disabilitare la modifica nella pulizia, usare il flag AppContext seguente.</span><span class="sxs-lookup"><span data-stu-id="560bc-109">In .NET Framework 4.7.2 and later versions, developers can disable this fix in order to help alleviate (but not eliminate) timing issues that may occur due to the cleanup change.To disable the change in cleanup, use the following AppContext flag.</span></span><pre><code class="lang-xml">&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.MS.Internal.DoNotInvokeInWeakEventTableShutdownListener=true&quot;/&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>

| <span data-ttu-id="560bc-110">Nome</span><span class="sxs-lookup"><span data-stu-id="560bc-110">Name</span></span>    | <span data-ttu-id="560bc-111">Valore</span><span class="sxs-lookup"><span data-stu-id="560bc-111">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="560bc-112">Scope</span><span class="sxs-lookup"><span data-stu-id="560bc-112">Scope</span></span>   | <span data-ttu-id="560bc-113">Microsoft Edge</span><span class="sxs-lookup"><span data-stu-id="560bc-113">Edge</span></span>        |
| <span data-ttu-id="560bc-114">Version</span><span class="sxs-lookup"><span data-stu-id="560bc-114">Version</span></span> | <span data-ttu-id="560bc-115">4.7.2</span><span class="sxs-lookup"><span data-stu-id="560bc-115">4.7.2</span></span>       |
| <span data-ttu-id="560bc-116">Type</span><span class="sxs-lookup"><span data-stu-id="560bc-116">Type</span></span>    | <span data-ttu-id="560bc-117">Ridestinazione</span><span class="sxs-lookup"><span data-stu-id="560bc-117">Retargeting</span></span> |
