---
title: Delegati
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: 1f161248fa04f8fab0e5335413e69ca565732f71
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/04/2020
ms.locfileid: "84410683"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="9bd40-102">Delegati (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="9bd40-102">Delegates (Visual Basic)</span></span>

<span data-ttu-id="9bd40-103">I delegati sono oggetti che fanno riferimento ai metodi.</span><span class="sxs-lookup"><span data-stu-id="9bd40-103">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="9bd40-104">Vengono a volte descritti come *puntatori a funzione indipendenti dai tipi* poiché sono simili ai puntatori a funzione usati in altri linguaggi di programmazione.</span><span class="sxs-lookup"><span data-stu-id="9bd40-104">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="9bd40-105">Tuttavia, a differenza dei puntatori a funzione, i delegati Visual Basic sono un tipo di riferimento basato sulla classe <xref:System.Delegate?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="9bd40-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="9bd40-106">I delegati possono fare riferimento sia a metodi condivisi, ovvero metodi che è possibile chiamare senza una specifica istanza di una classe, sia a metodi di istanza.</span><span class="sxs-lookup"><span data-stu-id="9bd40-106">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>

## <a name="delegates-and-events"></a><span data-ttu-id="9bd40-107">Delegati ed eventi</span><span class="sxs-lookup"><span data-stu-id="9bd40-107">Delegates and Events</span></span>

<span data-ttu-id="9bd40-108">I delegati sono utili nelle situazioni in cui è necessario un intermediario tra una routine chiamante e la routine chiamata.</span><span class="sxs-lookup"><span data-stu-id="9bd40-108">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="9bd40-109">Ad esempio, può essere necessario che un oggetto generatore di eventi sia in grado di chiamare gestori di eventi differenti in circostanze diverse.</span><span class="sxs-lookup"><span data-stu-id="9bd40-109">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="9bd40-110">Purtroppo, l'oggetto che genera gli eventi non può sapere in anticipo quale gestore eventi gestirà uno specifico evento.</span><span class="sxs-lookup"><span data-stu-id="9bd40-110">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="9bd40-111">Visual Basic consente di associare dinamicamente i gestori eventi agli eventi creando un delegato quando si usa l' `AddHandler` istruzione.</span><span class="sxs-lookup"><span data-stu-id="9bd40-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="9bd40-112">In fase di esecuzione, il delegato inoltrerà le chiamate al gestore eventi appropriato.</span><span class="sxs-lookup"><span data-stu-id="9bd40-112">At run time, the delegate forwards calls to the appropriate event handler.</span></span>

<span data-ttu-id="9bd40-113">Sebbene sia possibile creare delegati personalizzati, nella maggior parte dei casi Visual Basic crea il delegato e si occupa dei dettagli.</span><span class="sxs-lookup"><span data-stu-id="9bd40-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="9bd40-114">Un'istruzione `Event`, ad esempio, consente di definire implicitamente una classe delegata denominata `<EventName>EventHandler` come classe nidificata della classe contenente l'istruzione `Event` e con la stessa firma dell'evento.</span><span class="sxs-lookup"><span data-stu-id="9bd40-114">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="9bd40-115">L'istruzione `AddressOf` crea in modo implicito un'istanza di un delegato che fa riferimento a una routine specifica.</span><span class="sxs-lookup"><span data-stu-id="9bd40-115">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="9bd40-116">Le due righe di codice seguenti sono equivalenti.</span><span class="sxs-lookup"><span data-stu-id="9bd40-116">The following two lines of code are equivalent.</span></span> <span data-ttu-id="9bd40-117">Nella prima riga è possibile osservare la creazione esplicita di un'istanza di `EventHandler`, con un riferimento al metodo `Button1_Click` inviato come argomento.</span><span class="sxs-lookup"><span data-stu-id="9bd40-117">In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="9bd40-118">La seconda riga rappresenta un modo più pratico di eseguire la stessa operazione.</span><span class="sxs-lookup"><span data-stu-id="9bd40-118">The second line is a more convenient way to do the same thing.</span></span>

[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]

<span data-ttu-id="9bd40-119">È possibile usare la sintassi abbreviata per creare delegati ogni volta che il compilatore è in grado di determinare il tipo del delegato in base al contesto.</span><span class="sxs-lookup"><span data-stu-id="9bd40-119">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>

## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="9bd40-120">Dichiarazione di eventi che usano un tipo delegato esistente</span><span class="sxs-lookup"><span data-stu-id="9bd40-120">Declaring Events that Use an Existing Delegate Type</span></span>

<span data-ttu-id="9bd40-121">In alcune situazioni, è consigliabile dichiarare un evento che usa un tipo delegato esistente come delegato sottostante.</span><span class="sxs-lookup"><span data-stu-id="9bd40-121">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="9bd40-122">La sintassi seguente illustra come eseguire tale operazione:</span><span class="sxs-lookup"><span data-stu-id="9bd40-122">The following syntax demonstrates how:</span></span>

[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]

<span data-ttu-id="9bd40-123">Questa operazione si rivela utile quando si vogliono inviare più eventi allo stesso gestore.</span><span class="sxs-lookup"><span data-stu-id="9bd40-123">This is useful when you want to route multiple events to the same handler.</span></span>

## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="9bd40-124">Variabili e parametri dei delegati</span><span class="sxs-lookup"><span data-stu-id="9bd40-124">Delegate Variables and Parameters</span></span>

<span data-ttu-id="9bd40-125">È possibile usare i delegati per altre attività non relative a eventi, ad esempio il modello di threading Free, oppure con routine che richiedono la chiamata di diverse versioni delle funzioni in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="9bd40-125">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>

<span data-ttu-id="9bd40-126">Si supponga, ad esempio, di avere un'applicazione di annunci pubblicitari che include una casella di riepilogo contenente nomi di automobili.</span><span class="sxs-lookup"><span data-stu-id="9bd40-126">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="9bd40-127">Gli annunci sono ordinati per titolo, in genere corrispondente al modello dell'auto.</span><span class="sxs-lookup"><span data-stu-id="9bd40-127">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="9bd40-128">Se per alcune auto il modello è preceduto dall'anno di produzione, può verificarsi un problema.</span><span class="sxs-lookup"><span data-stu-id="9bd40-128">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="9bd40-129">Il problema consiste nel fatto che la funzionalità di ordinamento integrata della casella di riepilogo esegue l'ordinamento solo in base ai codici dei caratteri, elencando prima tutti gli annunci che iniziano con una data e quindi tutti quelli che iniziano con il modello.</span><span class="sxs-lookup"><span data-stu-id="9bd40-129">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>

<span data-ttu-id="9bd40-130">Per risolvere il problema, è possibile creare una routine di ordinamento in una classe che usa l'ordinamento alfabetico standard per la maggior parte delle caselle di riepilogo, ma che è in grado di passare, in fase di esecuzione, alla routine di ordinamento personalizzata per gli annunci relativi alle automobili.</span><span class="sxs-lookup"><span data-stu-id="9bd40-130">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="9bd40-131">A questo scopo, è necessario passare la routine di ordinamento personalizzata alla classe di ordinamento in fase di esecuzione usando i delegati.</span><span class="sxs-lookup"><span data-stu-id="9bd40-131">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>

## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="9bd40-132">Espressioni AddressOf e Lambda</span><span class="sxs-lookup"><span data-stu-id="9bd40-132">AddressOf and Lambda Expressions</span></span>

<span data-ttu-id="9bd40-133">Ogni classe delegata definisce un costruttore a cui viene passata la specifica di un metodo dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9bd40-133">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="9bd40-134">Un argomento di un costruttore di delegati deve essere un riferimento a un metodo o a un'espressione lambda.</span><span class="sxs-lookup"><span data-stu-id="9bd40-134">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>

<span data-ttu-id="9bd40-135">Per specificare un riferimento a un metodo, usare la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="9bd40-135">To specify a reference to a method, use the following syntax:</span></span>

<span data-ttu-id="9bd40-136">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="9bd40-136">`AddressOf` [`expression`.]`methodName`</span></span>

<span data-ttu-id="9bd40-137">Il tipo in fase di compilazione dell'elemento `expression` deve essere il nome di una classe o un'interfaccia contenente un metodo con il nome specificato la cui firma corrisponde a quella della classe delegata.</span><span class="sxs-lookup"><span data-stu-id="9bd40-137">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="9bd40-138">Il metodo `methodName` può essere o un metodo condiviso o un metodo di istanza.</span><span class="sxs-lookup"><span data-stu-id="9bd40-138">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="9bd40-139">`methodName` non è un elemento facoltativo, anche se si crea un delegato per il metodo predefinito della classe.</span><span class="sxs-lookup"><span data-stu-id="9bd40-139">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>

<span data-ttu-id="9bd40-140">Per specificare un'espressione lambda, usare la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="9bd40-140">To specify a lambda expression, use the following syntax:</span></span>

<span data-ttu-id="9bd40-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="9bd40-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>

<span data-ttu-id="9bd40-142">Nell'esempio seguente sono illustrate sia l'espressione `AddressOf` che l'espressione lambda usate per specificare il riferimento per un delegato.</span><span class="sxs-lookup"><span data-stu-id="9bd40-142">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>

[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]

<span data-ttu-id="9bd40-143">La firma della funzione deve corrispondere a quella del tipo delegato.</span><span class="sxs-lookup"><span data-stu-id="9bd40-143">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="9bd40-144">Per ulteriori informazioni sulle espressioni lambda, vedere [espressioni lambda](../procedures/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="9bd40-144">For more information about lambda expressions, see [Lambda Expressions](../procedures/lambda-expressions.md).</span></span> <span data-ttu-id="9bd40-145">Per altri esempi di espressioni lambda e assegnazioni di `AddressOf` a delegati, vedere [Conversione di tipo relaxed del delegato](relaxed-delegate-conversion.md).</span><span class="sxs-lookup"><span data-stu-id="9bd40-145">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](relaxed-delegate-conversion.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="9bd40-146">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="9bd40-146">Related Topics</span></span>

|<span data-ttu-id="9bd40-147">Titolo</span><span class="sxs-lookup"><span data-stu-id="9bd40-147">Title</span></span>|<span data-ttu-id="9bd40-148">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9bd40-148">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="9bd40-149">Procedura: richiamare un metodo delegato</span><span class="sxs-lookup"><span data-stu-id="9bd40-149">How to: Invoke a Delegate Method</span></span>](how-to-invoke-a-delegate-method.md)|<span data-ttu-id="9bd40-150">Viene offerto un esempio che mostra come associare un metodo a un delegato e quindi richiamare tale metodo tramite il delegato.</span><span class="sxs-lookup"><span data-stu-id="9bd40-150">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|
|[<span data-ttu-id="9bd40-151">Procedura: passare una routine a un'altra routine in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="9bd40-151">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="9bd40-152">Viene illustrato come usare i delegati per passare una routine a un'altra routine.</span><span class="sxs-lookup"><span data-stu-id="9bd40-152">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|
|[<span data-ttu-id="9bd40-153">Conversione di tipo relaxed del delegato</span><span class="sxs-lookup"><span data-stu-id="9bd40-153">Relaxed Delegate Conversion</span></span>](relaxed-delegate-conversion.md)|<span data-ttu-id="9bd40-154">Viene descritto come assegnare subroutine e funzioni a delegati o gestori anche quando le relative firme non sono identiche.</span><span class="sxs-lookup"><span data-stu-id="9bd40-154">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|
|[<span data-ttu-id="9bd40-155">Events</span><span class="sxs-lookup"><span data-stu-id="9bd40-155">Events</span></span>](../events/index.md)|<span data-ttu-id="9bd40-156">Viene offerta una panoramica degli eventi in Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="9bd40-156">Provides an overview of events in Visual Basic.</span></span>|
