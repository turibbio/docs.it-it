---
title: Modello a oggetti delle espressioni regolari
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- searching with regular expressions, backreferences
- Regex class
- Match class
- pattern-matching with regular expressions, backreferences
- .NET Framework regular expressions, classes
- CaptureCollection class
- Group class
- characters [.NET Framework], backreferences
- substrings
- .NET Framework regular expressions, backreferences
- searching with regular expressions, classes
- backreferences
- Capture class
- repeating groups of characters
- MatchCollection class
- parsing text with regular expressions, backreferences
- regular expressions [.NET Framework]
- characters [.NET Framework], regular expressions
- classes [.NET Framework], regular expression
- regular expressions [.NET Framework], classes
- characters [.NET Framework], metacharacters
- metacharacters, regular expression classes
- metacharacters, backreferences
- parsing text with regular expressions, classes
- regular expressions [.NET Framework], backreferences
- strings [.NET Framework], regular expressions
- pattern-matching with regular expressions, classes
- GroupCollection class
ms.assetid: 49a21470-64ca-4b5a-a889-8e24e3c0af7e
ms.openlocfilehash: ad7957fd555c1de8fe47c092d3eb399a803fb1fb
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/02/2020
ms.locfileid: "84290902"
---
# <a name="the-regular-expression-object-model"></a><span data-ttu-id="81d0f-102">Modello a oggetti delle espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="81d0f-102">The Regular Expression Object Model</span></span>
<a name="introduction"></a> <span data-ttu-id="81d0f-103">In questo argomento viene illustrato il modello a oggetti usato con le espressioni regolari di .NET.</span><span class="sxs-lookup"><span data-stu-id="81d0f-103">This topic describes the object model used in working with .NET regular expressions.</span></span> <span data-ttu-id="81d0f-104">Contiene le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="81d0f-104">It contains the following sections:</span></span>  
  
- [<span data-ttu-id="81d0f-105">Motore delle espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="81d0f-105">The Regular Expression Engine</span></span>](#Engine)  
  
- [<span data-ttu-id="81d0f-106">Oggetti MatchCollection e match</span><span class="sxs-lookup"><span data-stu-id="81d0f-106">The MatchCollection and Match Objects</span></span>](#Match_and_MCollection)  
  
- [<span data-ttu-id="81d0f-107">Raccolta di gruppi</span><span class="sxs-lookup"><span data-stu-id="81d0f-107">The Group Collection</span></span>](#GroupCollection)  
  
- [<span data-ttu-id="81d0f-108">Gruppo acquisito</span><span class="sxs-lookup"><span data-stu-id="81d0f-108">The Captured Group</span></span>](#the_captured_group)  
  
- [<span data-ttu-id="81d0f-109">Raccolta di acquisizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-109">The Capture Collection</span></span>](#CaptureCollection)  
  
- [<span data-ttu-id="81d0f-110">Acquisizione singola</span><span class="sxs-lookup"><span data-stu-id="81d0f-110">The Individual Capture</span></span>](#the_individual_capture)  
  
<a name="Engine"></a>
## <a name="the-regular-expression-engine"></a><span data-ttu-id="81d0f-111">Motore delle espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="81d0f-111">The Regular Expression Engine</span></span>  
 <span data-ttu-id="81d0f-112">Il motore delle espressioni regolari di .NET è rappresentato dalla classe <xref:System.Text.RegularExpressions.Regex>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-112">The regular expression engine in .NET is represented by the <xref:System.Text.RegularExpressions.Regex> class.</span></span> <span data-ttu-id="81d0f-113">Il motore delle espressioni regolari è responsabile dell'analisi e della compilazione di un'espressione regolare e dell'esecuzione di operazioni che associano il criterio di espressione regolare a una stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-113">The regular expression engine is responsible for parsing and compiling a regular expression, and for performing operations that match the regular expression pattern with an input string.</span></span> <span data-ttu-id="81d0f-114">Il motore è il componente centrale del modello a oggetti delle espressioni regolari di .NET.</span><span class="sxs-lookup"><span data-stu-id="81d0f-114">The engine is the central component in the .NET regular expression object model.</span></span>  
  
 <span data-ttu-id="81d0f-115">È possibile usare il motore delle espressioni regolari in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="81d0f-115">You can use the regular expression engine in either of two ways:</span></span>  
  
- <span data-ttu-id="81d0f-116">Tramite la chiamata di metodi statici della classe <xref:System.Text.RegularExpressions.Regex>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-116">By calling the static methods of the <xref:System.Text.RegularExpressions.Regex> class.</span></span> <span data-ttu-id="81d0f-117">I parametri del metodo includono la stringa di input e il criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-117">The method parameters include the input string and the regular expression pattern.</span></span> <span data-ttu-id="81d0f-118">Il motore delle espressioni regolari memorizza nella cache le espressioni regolari usate nelle chiamate del metodo statico. Le chiamate ripetute a metodi di espressione regolare che usano la stessa espressione regolare offrono quindi prestazioni relativamente buone.</span><span class="sxs-lookup"><span data-stu-id="81d0f-118">The regular expression engine caches regular expressions that are used in static method calls, so repeated calls to static regular expression methods that use the same regular expression offer relatively good performance.</span></span>  
  
- <span data-ttu-id="81d0f-119">Tramite la creazione di istanze di un oggetto <xref:System.Text.RegularExpressions.Regex>, mediante il passaggio di un'espressione regolare al costruttore di classe.</span><span class="sxs-lookup"><span data-stu-id="81d0f-119">By instantiating a <xref:System.Text.RegularExpressions.Regex> object, by passing a regular expression to the class constructor.</span></span> <span data-ttu-id="81d0f-120">In questo caso l'oggetto <xref:System.Text.RegularExpressions.Regex> è non modificabile (sola lettura) e rappresenta un motore delle espressioni regolari strettamente associato a una singola espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-120">In this case, the <xref:System.Text.RegularExpressions.Regex> object is immutable (read-only) and represents a regular expression engine that is tightly coupled with a single regular expression.</span></span> <span data-ttu-id="81d0f-121">Poiché le espressioni regolari usate dalle istanze di <xref:System.Text.RegularExpressions.Regex> non sono memorizzate nella cache, è consigliabile non creare più volte istanze di un oggetto <xref:System.Text.RegularExpressions.Regex> con la stessa espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-121">Because regular expressions used by <xref:System.Text.RegularExpressions.Regex> instances are not cached, you should not instantiate a <xref:System.Text.RegularExpressions.Regex> object multiple times with the same regular expression.</span></span>  
  
 <span data-ttu-id="81d0f-122">È possibile chiamare i metodi della classe <xref:System.Text.RegularExpressions.Regex> per eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="81d0f-122">You can call the methods of the <xref:System.Text.RegularExpressions.Regex> class to perform the following operations:</span></span>  
  
- <span data-ttu-id="81d0f-123">Determinare se una stringa corrisponde a un criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-123">Determine whether a string matches a regular expression pattern.</span></span>  
  
- <span data-ttu-id="81d0f-124">Estrarre una singola corrispondenza o la prima corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-124">Extract a single match or the first match.</span></span>  
  
- <span data-ttu-id="81d0f-125">Estrarre tutte le corrispondenze.</span><span class="sxs-lookup"><span data-stu-id="81d0f-125">Extract all matches.</span></span>  
  
- <span data-ttu-id="81d0f-126">Sostituire una sottostringa con corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-126">Replace a matched substring.</span></span>  
  
- <span data-ttu-id="81d0f-127">Suddividere una singola stringa in una matrice di stringhe.</span><span class="sxs-lookup"><span data-stu-id="81d0f-127">Split a single string into an array of strings.</span></span>  
  
 <span data-ttu-id="81d0f-128">Queste operazioni sono descritte nelle sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="81d0f-128">These operations are described in the following sections.</span></span>  
  
### <a name="matching-a-regular-expression-pattern"></a><span data-ttu-id="81d0f-129">Corrispondenza con un criterio di espressione regolare</span><span class="sxs-lookup"><span data-stu-id="81d0f-129">Matching a Regular Expression Pattern</span></span>  
 <span data-ttu-id="81d0f-130">Il metodo <xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType> restituisce `true` se la stringa corrisponde al modello. In caso contrario, `false`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-130">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A?displayProperty=nameWithType> method returns `true` if the string matches the pattern, or `false` if it does not.</span></span> <span data-ttu-id="81d0f-131">Il metodo <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> è usato spesso per convalidare l'input di stringa.</span><span class="sxs-lookup"><span data-stu-id="81d0f-131">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is often used to validate string input.</span></span> <span data-ttu-id="81d0f-132">Ad esempio, il codice seguente assicura che una stringa corrisponda a un numero di previdenza sociale negli Stati Uniti.</span><span class="sxs-lookup"><span data-stu-id="81d0f-132">For example, the following code ensures that a string matches a valid social security number in the United States.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/validate1.cs#1)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/validate1.vb#1)]  
  
 <span data-ttu-id="81d0f-133">Il criterio di ricerca di espressioni regolari `^\d{3}-\d{2}-\d{4}$` è interpretato nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-133">The regular expression pattern `^\d{3}-\d{2}-\d{4}$` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-134">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-134">Pattern</span></span>|<span data-ttu-id="81d0f-135">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-135">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="81d0f-136">Trova la corrispondenza con l'inizio della stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-136">Match the beginning of the input string.</span></span>|  
|`\d{3}`|<span data-ttu-id="81d0f-137">Trova la corrispondenza con tre cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-137">Match three decimal digits.</span></span>|  
|`-`|<span data-ttu-id="81d0f-138">Trova la corrispondenza con un segno meno.</span><span class="sxs-lookup"><span data-stu-id="81d0f-138">Match a hyphen.</span></span>|  
|`\d{2}`|<span data-ttu-id="81d0f-139">Trova la corrispondenza con due cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-139">Match two decimal digits.</span></span>|  
|`-`|<span data-ttu-id="81d0f-140">Trova la corrispondenza con un segno meno.</span><span class="sxs-lookup"><span data-stu-id="81d0f-140">Match a hyphen.</span></span>|  
|`\d{4}`|<span data-ttu-id="81d0f-141">Trova la corrispondenza con quattro cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-141">Match four decimal digits.</span></span>|  
|`$`|<span data-ttu-id="81d0f-142">Trova la corrispondenza con la fine della stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-142">Match the end of the input string.</span></span>|  
  
### <a name="extracting-a-single-match-or-the-first-match"></a><span data-ttu-id="81d0f-143">Estrazione di una singola corrispondenza o della prima corrispondenza</span><span class="sxs-lookup"><span data-stu-id="81d0f-143">Extracting a Single Match or the First Match</span></span>  
 <span data-ttu-id="81d0f-144">Il metodo <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> restituisce un oggetto <xref:System.Text.RegularExpressions.Match> che include informazioni sulla prima sottostringa corrispondente a un criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-144">The <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.Match> object that contains information about the first substring that matches a regular expression pattern.</span></span> <span data-ttu-id="81d0f-145">Se la proprietà `Match.Success` restituisce `true`, indicando che è stata rilevata una corrispondenza, sarà possibile ottenere informazioni sulle corrispondenze successive chiamando il metodo <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-145">If the `Match.Success` property returns `true`, indicating that a match was found, you can retrieve information about subsequent matches by calling the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="81d0f-146">Le chiamate ai metodi possono continuare finché la proprietà `Match.Success` non restituisce `false`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-146">These method calls can continue until the `Match.Success` property returns `false`.</span></span> <span data-ttu-id="81d0f-147">Ad esempio, il codice seguente usa il metodo <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> per trovare la prima occorrenza di una parola duplicata in una stringa.</span><span class="sxs-lookup"><span data-stu-id="81d0f-147">For example, the following code uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> method to find the first occurrence of a duplicated word in a string.</span></span> <span data-ttu-id="81d0f-148">Chiama quindi i metodi <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> per trovare eventuali occorrenze aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="81d0f-148">It then calls the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method to find any additional occurrences.</span></span> <span data-ttu-id="81d0f-149">L'esempio esamina la proprietà `Match.Success` dopo ogni chiamata al metodo, per determinare se la corrispondenza corrente è riuscita e se deve essere seguita da una chiamata al metodo <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-149">The example examines the `Match.Success` property after each method call to determine whether the current match was successful and whether a call to the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method should follow.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match1.cs#2)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match1.vb#2)]  
  
 <span data-ttu-id="81d0f-150">Il criterio di ricerca di espressioni regolari `\b(\w+)\W+(\1)\b` è interpretato nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-150">The regular expression pattern `\b(\w+)\W+(\1)\b` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-151">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-151">Pattern</span></span>|<span data-ttu-id="81d0f-152">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-152">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="81d0f-153">Inizia la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-153">Begin the match on a word boundary.</span></span>|  
|`(\w+)`|<span data-ttu-id="81d0f-154">Trova la corrispondenza di uno o più caratteri alfanumerici.</span><span class="sxs-lookup"><span data-stu-id="81d0f-154">Match one or more word characters.</span></span> <span data-ttu-id="81d0f-155">Equivale al primo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-155">This is the first capturing group.</span></span>|  
|`\W+`|<span data-ttu-id="81d0f-156">Trova la corrispondenza di uno o più caratteri non alfanumerici.</span><span class="sxs-lookup"><span data-stu-id="81d0f-156">Match one or more non-word characters.</span></span>|  
|`(\1)`|<span data-ttu-id="81d0f-157">Trova la corrispondenza con la prima stringa acquisita.</span><span class="sxs-lookup"><span data-stu-id="81d0f-157">Match the first captured string.</span></span> <span data-ttu-id="81d0f-158">Equivale al secondo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-158">This is the second capturing group.</span></span>|  
|`\b`|<span data-ttu-id="81d0f-159">Termina la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-159">End the match on a word boundary.</span></span>|  
  
### <a name="extracting-all-matches"></a><span data-ttu-id="81d0f-160">Estrazione di tutte le corrispondenze</span><span class="sxs-lookup"><span data-stu-id="81d0f-160">Extracting All Matches</span></span>  
 <span data-ttu-id="81d0f-161">Il metodo <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> restituisce un oggetto <xref:System.Text.RegularExpressions.MatchCollection> che include informazioni su tutte le corrispondenze rilevate dal motore delle espressioni regolari nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-161">The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains information about all matches that the regular expression engine found in the input string.</span></span> <span data-ttu-id="81d0f-162">Ad esempio, è possibile riscrivere l'esempio precedente in modo da chiamare il metodo <xref:System.Text.RegularExpressions.Regex.Matches%2A> invece dei metodi <xref:System.Text.RegularExpressions.Regex.Match%2A> e <xref:System.Text.RegularExpressions.Match.NextMatch%2A>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-162">For example, the previous example could be rewritten to call the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method instead of the <xref:System.Text.RegularExpressions.Regex.Match%2A> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A> methods.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/matches1.cs#3)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/matches1.vb#3)]  
  
### <a name="replacing-a-matched-substring"></a><span data-ttu-id="81d0f-163">Sostituzione di una sottostringa con corrispondenza</span><span class="sxs-lookup"><span data-stu-id="81d0f-163">Replacing a Matched Substring</span></span>  
 <span data-ttu-id="81d0f-164">Il metodo <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> sostituisce ogni sottostringa corrispondente al criterio di espressione regolare con una stringa specificata o con un criterio di espressione regolare e restituisce l'intera stringa di input con le sostituzioni.</span><span class="sxs-lookup"><span data-stu-id="81d0f-164">The <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method replaces each substring that matches the regular expression pattern with a specified string or regular expression pattern, and returns the entire input string with replacements.</span></span> <span data-ttu-id="81d0f-165">Ad esempio, il codice riportato di seguito aggiunge il simbolo di valuta degli Stati Uniti prima di un numero decimale in una stringa.</span><span class="sxs-lookup"><span data-stu-id="81d0f-165">For example, the following code adds a U.S. currency symbol before a decimal number in a string.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/replace1.cs#4)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/replace1.vb#4)]  
  
 <span data-ttu-id="81d0f-166">Il criterio di ricerca di espressioni regolari `\b\d+\.\d{2}\b` è interpretato nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-166">The regular expression pattern `\b\d+\.\d{2}\b` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-167">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-167">Pattern</span></span>|<span data-ttu-id="81d0f-168">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-168">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="81d0f-169">Inizia la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-169">Begin the match at a word boundary.</span></span>|  
|`\d+`|<span data-ttu-id="81d0f-170">Trova la corrispondenza con una o più cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-170">Match one or more decimal digits.</span></span>|  
|`\.`|<span data-ttu-id="81d0f-171">Trova la corrispondenza con un punto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-171">Match a period.</span></span>|  
|`\d{2}`|<span data-ttu-id="81d0f-172">Trova la corrispondenza con due cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-172">Match two decimal digits.</span></span>|  
|`\b`|<span data-ttu-id="81d0f-173">Termina la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-173">End the match at a word boundary.</span></span>|  
  
 <span data-ttu-id="81d0f-174">Il modello di sostituzione `$$$&` è interpretato nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-174">The replacement pattern `$$$&` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-175">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-175">Pattern</span></span>|<span data-ttu-id="81d0f-176">Stringa di sostituzione</span><span class="sxs-lookup"><span data-stu-id="81d0f-176">Replacement string</span></span>|  
|-------------|------------------------|  
|`$$`|<span data-ttu-id="81d0f-177">Simbolo del dollaro ($).</span><span class="sxs-lookup"><span data-stu-id="81d0f-177">The dollar sign ($) character.</span></span>|  
|`$&`|<span data-ttu-id="81d0f-178">Intera stringa corrispondente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-178">The entire matched substring.</span></span>|  
  
### <a name="splitting-a-single-string-into-an-array-of-strings"></a><span data-ttu-id="81d0f-179">Suddivisione di una singola stringa in una matrice di stringhe</span><span class="sxs-lookup"><span data-stu-id="81d0f-179">Splitting a Single String into an Array of Strings</span></span>  
 <span data-ttu-id="81d0f-180">Il metodo <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> suddivide la stringa di input nelle posizioni definite da una corrispondenza di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-180">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> method splits the input string at the positions defined by a regular expression match.</span></span> <span data-ttu-id="81d0f-181">Ad esempio, il codice seguente inserisce gli elementi di un elenco numerato in una matrice di stringhe.</span><span class="sxs-lookup"><span data-stu-id="81d0f-181">For example, the following code places the items in a numbered list into a string array.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/split1.cs#5)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/split1.vb#5)]  
  
 <span data-ttu-id="81d0f-182">Il criterio di ricerca di espressioni regolari `\b\d{1,2}\.\s` è interpretato nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-182">The regular expression pattern `\b\d{1,2}\.\s` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-183">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-183">Pattern</span></span>|<span data-ttu-id="81d0f-184">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-184">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="81d0f-185">Inizia la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-185">Begin the match at a word boundary.</span></span>|  
|`\d{1,2}`|<span data-ttu-id="81d0f-186">Trova la corrispondenza con una o due cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-186">Match one or two decimal digits.</span></span>|  
|`\.`|<span data-ttu-id="81d0f-187">Trova la corrispondenza con un punto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-187">Match a period.</span></span>|  
|`\s`|<span data-ttu-id="81d0f-188">Trova la corrispondenza con uno spazio vuoto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-188">Match a white-space character.</span></span>|  
  
<a name="Match_and_MCollection"></a>
## <a name="the-matchcollection-and-match-objects"></a><span data-ttu-id="81d0f-189">Oggetti MatchCollection e Match</span><span class="sxs-lookup"><span data-stu-id="81d0f-189">The MatchCollection and Match Objects</span></span>  
 <span data-ttu-id="81d0f-190">I metodi Regex restituiscono due oggetti che fanno parte del modello a oggetti delle espressioni regolari: l'oggetto <xref:System.Text.RegularExpressions.MatchCollection> e l'oggetto <xref:System.Text.RegularExpressions.Match>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-190">Regex methods return two objects that are part of the regular expression object model: the <xref:System.Text.RegularExpressions.MatchCollection> object, and the <xref:System.Text.RegularExpressions.Match> object.</span></span>  
  
<a name="the_match_collection"></a>
### <a name="the-match-collection"></a><span data-ttu-id="81d0f-191">Raccolta Match</span><span class="sxs-lookup"><span data-stu-id="81d0f-191">The Match Collection</span></span>  
 <span data-ttu-id="81d0f-192">Il metodo <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> restituisce un oggetto <xref:System.Text.RegularExpressions.MatchCollection> contenente gli oggetti <xref:System.Text.RegularExpressions.Match> che rappresentano tutte le corrispondenze rilevate dal motore delle espressioni regolari, in base all'ordine in cui si trovano nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-192">The <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method returns a <xref:System.Text.RegularExpressions.MatchCollection> object that contains <xref:System.Text.RegularExpressions.Match> objects that represent all the matches that the regular expression engine found, in the order in which they occur in the input string.</span></span> <span data-ttu-id="81d0f-193">Se non sono rilevate corrispondenze, il metodo restituisce un oggetto <xref:System.Text.RegularExpressions.MatchCollection> senza membri.</span><span class="sxs-lookup"><span data-stu-id="81d0f-193">If there are no matches, the method returns a <xref:System.Text.RegularExpressions.MatchCollection> object with no members.</span></span> <span data-ttu-id="81d0f-194">La proprietà <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> permette di accedere a singoli membri della raccolta in base all'indice, da zero al valore della proprietà <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> meno uno.</span><span class="sxs-lookup"><span data-stu-id="81d0f-194">The <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property lets you access individual members of the collection by index, from zero to one less than the value of the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="81d0f-195"><xref:System.Text.RegularExpressions.MatchCollection.Item%2A> è l'indicizzatore della raccolta (in C#) e la proprietà predefinita (in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="81d0f-195"><xref:System.Text.RegularExpressions.MatchCollection.Item%2A> is the collection's indexer (in C#) and default property (in Visual Basic).</span></span>  
  
 <span data-ttu-id="81d0f-196">Per impostazione predefinita, la chiamata al metodo <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> usa la valutazione lenta per il popolamento dell'oggetto <xref:System.Text.RegularExpressions.MatchCollection>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-196">By default, the call to the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method uses lazy evaluation to populate the <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="81d0f-197">L'accesso alle proprietà che necessitano di una raccolta completamente popolata, ad esempio le proprietà <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> e <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType>, potrebbe comportare gravi conseguenze per le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="81d0f-197">Access to properties that require a fully populated collection, such as the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> properties, may involve a performance penalty.</span></span> <span data-ttu-id="81d0f-198">È quindi consigliabile accedere alla raccolta usando l'oggetto <xref:System.Collections.IEnumerator> restituito dal metodo <xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-198">As a result, we recommend that you access the collection by using the <xref:System.Collections.IEnumerator> object that is returned by the <xref:System.Text.RegularExpressions.MatchCollection.GetEnumerator%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="81d0f-199">I singoli linguaggi forniscono i costrutti, ad esempio `For Each` in Visual Basic e `foreach` in C#, che eseguono il wrapping dell'interfaccia <xref:System.Collections.IEnumerator> della raccolta.</span><span class="sxs-lookup"><span data-stu-id="81d0f-199">Individual languages provide constructs, such as `For Each` in Visual Basic and `foreach` in C#, that wrap the collection's <xref:System.Collections.IEnumerator> interface.</span></span>  
  
 <span data-ttu-id="81d0f-200">L'esempio seguente usa il metodo <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> per popolare un oggetto <xref:System.Text.RegularExpressions.MatchCollection> con tutte le corrispondenze rilevate in una stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-200">The following example uses the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method to populate a <xref:System.Text.RegularExpressions.MatchCollection> object with all the matches found in an input string.</span></span> <span data-ttu-id="81d0f-201">L'esempio enumera la raccolta, copia le corrispondenze a una matrice di stringhe e registra le posizioni dei caratteri in una matrice di valori di tipo Integer.</span><span class="sxs-lookup"><span data-stu-id="81d0f-201">The example enumerates the collection, copies the matches to a string array, and records the character positions in an integer array.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/matchcollection1.cs#6)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/matchcollection1.vb#6)]  
  
<a name="the_match"></a>
### <a name="the-match"></a><span data-ttu-id="81d0f-202">Oggetto Match</span><span class="sxs-lookup"><span data-stu-id="81d0f-202">The Match</span></span>  
 <span data-ttu-id="81d0f-203">La classe <xref:System.Text.RegularExpressions.Match> rappresenta il risultato della corrispondenza di una singola espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-203">The <xref:System.Text.RegularExpressions.Match> class represents the result of a single regular expression match.</span></span> <span data-ttu-id="81d0f-204">È possibile accedere agli oggetti <xref:System.Text.RegularExpressions.Match> in due modi:</span><span class="sxs-lookup"><span data-stu-id="81d0f-204">You can access <xref:System.Text.RegularExpressions.Match> objects in two ways:</span></span>  
  
- <span data-ttu-id="81d0f-205">Tramite il recupero dall'oggetto <xref:System.Text.RegularExpressions.MatchCollection> restituito dal metodo <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-205">By retrieving them from the <xref:System.Text.RegularExpressions.MatchCollection> object that is returned by the <xref:System.Text.RegularExpressions.Regex.Matches%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="81d0f-206">Per recuperare i singoli oggetti <xref:System.Text.RegularExpressions.Match>, eseguire l'iterazione della raccolta usando il costrutto `foreach` (in C#) o .`For Each`...`Next`.(in Visual Basic) oppure usare la proprietà <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> per recuperare un oggetto <xref:System.Text.RegularExpressions.Match> specifico in base all'indice o al nome.</span><span class="sxs-lookup"><span data-stu-id="81d0f-206">To retrieve individual <xref:System.Text.RegularExpressions.Match> objects, iterate the collection by using a `foreach` (in C#) or `For Each`...`Next` (in Visual Basic) construct, or use the <xref:System.Text.RegularExpressions.MatchCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific <xref:System.Text.RegularExpressions.Match> object either by index or by name.</span></span> <span data-ttu-id="81d0f-207">È anche possibile recuperare singoli oggetti <xref:System.Text.RegularExpressions.Match> dalla raccolta eseguendo l'iterazione della raccolta in base all'indice, da zero al numero di oggetti della raccolta meno uno.</span><span class="sxs-lookup"><span data-stu-id="81d0f-207">You can also retrieve individual <xref:System.Text.RegularExpressions.Match> objects from the collection by iterating the collection by index, from zero to one less that the number of objects in the collection.</span></span> <span data-ttu-id="81d0f-208">Questo metodo, tuttavia, non permette di avvalersi della valutazione lenta, poiché accede alla proprietà <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-208">However, this method does not take advantage of lazy evaluation, because it accesses the <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> property.</span></span>  
  
     <span data-ttu-id="81d0f-209">L'esempio seguente recupera singoli oggetti <xref:System.Text.RegularExpressions.Match> da un oggetto <xref:System.Text.RegularExpressions.MatchCollection> eseguendo l'iterazione della raccolta tramite il costrutto `foreach` o `For Each`...`Next`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-209">The following example retrieves individual <xref:System.Text.RegularExpressions.Match> objects from a <xref:System.Text.RegularExpressions.MatchCollection> object by iterating the collection using the `foreach` or `For Each`...`Next` construct.</span></span> <span data-ttu-id="81d0f-210">L'espressione regolare corrisponde semplicemente alla stringa "abc" nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-210">The regular expression simply matches the string "abc" in the input string.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match2.cs#7)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match2.vb#7)]  
  
- <span data-ttu-id="81d0f-211">Tramite la chiamata al metodo <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType>, che restituisce un oggetto <xref:System.Text.RegularExpressions.Match> che rappresenta la prima corrispondenza in una stringa o in una parte di una stringa.</span><span class="sxs-lookup"><span data-stu-id="81d0f-211">By calling the <xref:System.Text.RegularExpressions.Regex.Match%2A?displayProperty=nameWithType> method, which returns a <xref:System.Text.RegularExpressions.Match> object that represents the first match in a string or a portion of a string.</span></span> <span data-ttu-id="81d0f-212">È possibile stabilire se la corrispondenza è stata rilevata tramite il recupero del valore della proprietà `Match.Success`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-212">You can determine whether the match has been found by retrieving the value of the `Match.Success` property.</span></span> <span data-ttu-id="81d0f-213">Per recuperare gli oggetti <xref:System.Text.RegularExpressions.Match> che rappresentano corrispondenze successive, chiamare ripetutamente il metodo <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>, fino a quando la proprietà `Success` dell'oggetto <xref:System.Text.RegularExpressions.Match> restituito non sarà `false`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-213">To retrieve <xref:System.Text.RegularExpressions.Match> objects that represent subsequent matches, call the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method repeatedly, until the `Success` property of the returned <xref:System.Text.RegularExpressions.Match> object is `false`.</span></span>  
  
     <span data-ttu-id="81d0f-214">L'esempio seguente usa i metodi <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> e <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> per la corrispondenza con la stringa "abc" nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-214">The following example uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> methods to match the string "abc" in the input string.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/match3.cs#8)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/match3.vb#8)]  
  
 <span data-ttu-id="81d0f-215">Due proprietà della classe <xref:System.Text.RegularExpressions.Match> restituiscono oggetti della raccolta:</span><span class="sxs-lookup"><span data-stu-id="81d0f-215">Two properties of the <xref:System.Text.RegularExpressions.Match> class return collection objects:</span></span>  
  
- <span data-ttu-id="81d0f-216">La proprietà <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> restituisce un oggetto <xref:System.Text.RegularExpressions.GroupCollection> che include informazioni sulle sottostringhe che corrispondono a gruppi di acquisizione nel criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-216">The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains information about the substrings that match capturing groups in the regular expression pattern.</span></span>  
  
- <span data-ttu-id="81d0f-217">La proprietà `Match.Captures` restituisce un oggetto <xref:System.Text.RegularExpressions.CaptureCollection> di uso limitato.</span><span class="sxs-lookup"><span data-stu-id="81d0f-217">The `Match.Captures` property returns a <xref:System.Text.RegularExpressions.CaptureCollection> object that is of limited use.</span></span> <span data-ttu-id="81d0f-218">La raccolta non è popolata per un oggetto <xref:System.Text.RegularExpressions.Match> la cui proprietà `Success` è `false`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-218">The collection is not populated for a <xref:System.Text.RegularExpressions.Match> object whose `Success` property is `false`.</span></span> <span data-ttu-id="81d0f-219">In caso contrario, contiene un singolo oggetto <xref:System.Text.RegularExpressions.Capture> che include le stesse informazioni dell'oggetto <xref:System.Text.RegularExpressions.Match>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-219">Otherwise, it contains a single <xref:System.Text.RegularExpressions.Capture> object that has the same information as the <xref:System.Text.RegularExpressions.Match> object.</span></span>  
  
 <span data-ttu-id="81d0f-220">Per altre informazioni su questi oggetti, vedere le sezioni [Raccolta Group](#GroupCollection) e [Raccolta Capture](#CaptureCollection) più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="81d0f-220">For more information about these objects, see [The Group Collection](#GroupCollection) and [The Capture Collection](#CaptureCollection) sections later in this topic.</span></span>  
  
 <span data-ttu-id="81d0f-221">Due proprietà aggiuntive della classe <xref:System.Text.RegularExpressions.Match> forniscono informazioni sulla corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-221">Two additional properties of the <xref:System.Text.RegularExpressions.Match> class provide information about the match.</span></span> <span data-ttu-id="81d0f-222">La proprietà `Match.Value` restituisce la sottostringa nella stringa di input corrispondente al criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-222">The `Match.Value` property returns the substring in the input string that matches the regular expression pattern.</span></span> <span data-ttu-id="81d0f-223">La proprietà `Match.Index` restituisce la posizione di inizio a base zero della stringa con corrispondenza nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-223">The `Match.Index` property returns the zero-based starting position of the matched string in the input string.</span></span>  
  
 <span data-ttu-id="81d0f-224">La classe <xref:System.Text.RegularExpressions.Match> include anche due metodi di corrispondenza del modello:</span><span class="sxs-lookup"><span data-stu-id="81d0f-224">The <xref:System.Text.RegularExpressions.Match> class also has two pattern-matching methods:</span></span>  
  
- <span data-ttu-id="81d0f-225">Il metodo <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> trova la corrispondenza dopo la corrispondenza rappresentata dall'oggetto corrente <xref:System.Text.RegularExpressions.Match> e restituisce un oggetto <xref:System.Text.RegularExpressions.Match> che rappresenta quella corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-225">The <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method finds the match after the match represented by the current <xref:System.Text.RegularExpressions.Match> object, and returns a <xref:System.Text.RegularExpressions.Match> object that represents that match.</span></span>  
  
- <span data-ttu-id="81d0f-226">Il metodo <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> esegue un'operazione di sostituzione specificata nella stringa con corrispondenza e restituisce il risultato.</span><span class="sxs-lookup"><span data-stu-id="81d0f-226">The <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method performs a specified replacement operation on the matched string and returns the result.</span></span>  
  
 <span data-ttu-id="81d0f-227">L'esempio seguente usa il metodo <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> per aggiungere un simbolo $ e uno spazio davanti a qualsiasi numero che include due cifre frazionarie.</span><span class="sxs-lookup"><span data-stu-id="81d0f-227">The following example uses the <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method to prepend a $ symbol and a space before every number that includes two fractional digits.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/result1.cs#9)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/result1.vb#9)]  
  
 <span data-ttu-id="81d0f-228">Il criterio di ricerca di espressioni regolari `\b\d+(,\d{3})*\.\d{2}\b` è definito nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-228">The regular expression pattern `\b\d+(,\d{3})*\.\d{2}\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-229">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-229">Pattern</span></span>|<span data-ttu-id="81d0f-230">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-230">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="81d0f-231">Inizia la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-231">Begin the match at a word boundary.</span></span>|  
|`\d+`|<span data-ttu-id="81d0f-232">Trova la corrispondenza con una o più cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-232">Match one or more decimal digits.</span></span>|  
|`(,\d{3})*`|<span data-ttu-id="81d0f-233">Trova la corrispondenza con zero o più occorrenze di una virgola seguita da tre cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-233">Match zero or more occurrences of a comma followed by three decimal digits.</span></span>|  
|`\.`|<span data-ttu-id="81d0f-234">Trova la corrispondenza con il carattere del separatore decimale.</span><span class="sxs-lookup"><span data-stu-id="81d0f-234">Match the decimal point character.</span></span>|  
|`\d{2}`|<span data-ttu-id="81d0f-235">Trova la corrispondenza con due cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-235">Match two decimal digits.</span></span>|  
|`\b`|<span data-ttu-id="81d0f-236">Termina la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-236">End the match at a word boundary.</span></span>|  
  
 <span data-ttu-id="81d0f-237">Il modello di sostituzione `$$ $&` indica che la stringa con corrispondenza deve essere sostituita da un simbolo del dollaro ($) (modello `$$`), uno spazio e il valore della corrispondenza (modello `$&`).</span><span class="sxs-lookup"><span data-stu-id="81d0f-237">The replacement pattern `$$ $&` indicates that the matched substring should be replaced by a dollar sign ($) symbol (the `$$` pattern), a space, and the value of the match (the `$&` pattern).</span></span>  
  
 [<span data-ttu-id="81d0f-238">Torna all'inizio</span><span class="sxs-lookup"><span data-stu-id="81d0f-238">Back to top</span></span>](#introduction)  
  
<a name="GroupCollection"></a>
## <a name="the-group-collection"></a><span data-ttu-id="81d0f-239">Raccolta Group</span><span class="sxs-lookup"><span data-stu-id="81d0f-239">The Group Collection</span></span>  
 <span data-ttu-id="81d0f-240">La proprietà <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> restituisce un oggetto <xref:System.Text.RegularExpressions.GroupCollection> che include gli oggetti <xref:System.Text.RegularExpressions.Group> che rappresentano i gruppi acquisiti in una singola corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-240">The <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property returns a <xref:System.Text.RegularExpressions.GroupCollection> object that contains <xref:System.Text.RegularExpressions.Group> objects that represent captured groups in a single match.</span></span> <span data-ttu-id="81d0f-241">Il primo oggetto <xref:System.Text.RegularExpressions.Group> della raccolta (in corrispondenza dell'indice 0) rappresenta l'intera corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-241">The first <xref:System.Text.RegularExpressions.Group> object in the collection (at index 0) represents the entire match.</span></span> <span data-ttu-id="81d0f-242">Ogni oggetto successivo rappresenta i risultati di un singolo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-242">Each object that follows represents the results of a single capturing group.</span></span>  
  
 <span data-ttu-id="81d0f-243">È possibile recuperare singoli oggetti <xref:System.Text.RegularExpressions.Group> nella raccolta usando la proprietà <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-243">You can retrieve individual <xref:System.Text.RegularExpressions.Group> objects in the collection by using the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="81d0f-244">I gruppi senza nome possono essere recuperati in base alla relativa posizione ordinale nella raccolta e i gruppi con nome possono essere recuperati in base al nome o alla posizione ordinale.</span><span class="sxs-lookup"><span data-stu-id="81d0f-244">You can retrieve unnamed groups by their ordinal position in the collection, and retrieve named groups either by name or by ordinal position.</span></span> <span data-ttu-id="81d0f-245">Le acquisizioni senza nome compaiono per prime nella raccolta e sono indicizzate da sinistra a destra nell'ordine di visualizzazione nel criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-245">Unnamed captures appear first in the collection, and are indexed from left to right in the order in which they appear in the regular expression pattern.</span></span> <span data-ttu-id="81d0f-246">Le acquisizioni con nome sono indicizzate dopo le acquisizioni senza nome, da sinistra a destra nell'ordine di visualizzazione nel criterio di espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-246">Named captures are indexed after unnamed captures, from left to right in the order in which they appear in the regular expression pattern.</span></span> <span data-ttu-id="81d0f-247">Per determinare i gruppi numerati disponibili nella raccolta restituita per un metodo specifico di corrispondenza con l'espressione regolare, è possibile chiamare il metodo <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType> dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-247">To determine what numbered groups are available in the collection returned for a particular regular expression matching method, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="81d0f-248">Per determinare i gruppi con nome disponibili nella raccolta, è possibile chiamare il metodo <xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType> dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-248">To determine what named groups are available in the collection, you can call the instance <xref:System.Text.RegularExpressions.Regex.GetGroupNames%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="81d0f-249">Entrambi i metodi sono particolarmente utili in routine di uso generale, che analizzano le corrispondenze rilevate da un'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-249">Both methods are particularly useful in general-purpose routines that analyze the matches found by any regular expression.</span></span>  
  
 <span data-ttu-id="81d0f-250">La proprietà <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> è l'indicizzatore della raccolta in C# e la proprietà predefinita dell'oggetto della raccolta in Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="81d0f-250">The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property is the indexer of the collection in C# and the collection object's default property in Visual Basic.</span></span> <span data-ttu-id="81d0f-251">È quindi possibile accedere ai singoli oggetti <xref:System.Text.RegularExpressions.Group> in base all'indice oppure in base al nome, nel caso dei gruppi con nome, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="81d0f-251">This means that individual <xref:System.Text.RegularExpressions.Group> objects can be accessed by index (or by name, in the case of named groups) as follows:</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#13](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/groupsyntax1.cs#13)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/groupsyntax1.vb#13)]  
  
 <span data-ttu-id="81d0f-252">L'esempio seguente definisce un'espressione regolare che usa costrutti di raggruppamento per acquisire il mese, il giorno e l'anno di una data.</span><span class="sxs-lookup"><span data-stu-id="81d0f-252">The following example defines a regular expression that uses grouping constructs to capture the month, day, and year of a date.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/groupcollection1.cs#10)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/groupcollection1.vb#10)]  
  
 <span data-ttu-id="81d0f-253">Il criterio di ricerca di espressioni regolari `\b(\w+)\s(\d{1,2}),\s(\d{4})\b` è definito nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-253">The regular expression pattern `\b(\w+)\s(\d{1,2}),\s(\d{4})\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-254">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-254">Pattern</span></span>|<span data-ttu-id="81d0f-255">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-255">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="81d0f-256">Inizia la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-256">Begin the match at a word boundary.</span></span>|  
|`(\w+)`|<span data-ttu-id="81d0f-257">Trova la corrispondenza di uno o più caratteri alfanumerici.</span><span class="sxs-lookup"><span data-stu-id="81d0f-257">Match one or more word characters.</span></span> <span data-ttu-id="81d0f-258">Equivale al primo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-258">This is the first capturing group.</span></span>|  
|`\s`|<span data-ttu-id="81d0f-259">Trova la corrispondenza con uno spazio vuoto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-259">Match a white-space character.</span></span>|  
|`(\d{1,2})`|<span data-ttu-id="81d0f-260">Trova la corrispondenza con una o due cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-260">Match one or two decimal digits.</span></span> <span data-ttu-id="81d0f-261">Equivale al secondo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-261">This is the second capturing group.</span></span>|  
|`,`|<span data-ttu-id="81d0f-262">Trova la corrispondenza con una virgola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-262">Match a comma.</span></span>|  
|`\s`|<span data-ttu-id="81d0f-263">Trova la corrispondenza con uno spazio vuoto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-263">Match a white-space character.</span></span>|  
|`(\d{4})`|<span data-ttu-id="81d0f-264">Trova la corrispondenza con quattro cifre decimali.</span><span class="sxs-lookup"><span data-stu-id="81d0f-264">Match four decimal digits.</span></span> <span data-ttu-id="81d0f-265">Equivale al terzo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-265">This is the third capturing group.</span></span>|  
|`\b`|<span data-ttu-id="81d0f-266">Termina la corrispondenza sul confine di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-266">End the match on a word boundary.</span></span>|  
  
 [<span data-ttu-id="81d0f-267">Torna all'inizio</span><span class="sxs-lookup"><span data-stu-id="81d0f-267">Back to top</span></span>](#introduction)  
  
<a name="the_captured_group"></a>
## <a name="the-captured-group"></a><span data-ttu-id="81d0f-268">Gruppo Captured</span><span class="sxs-lookup"><span data-stu-id="81d0f-268">The Captured Group</span></span>  
 <span data-ttu-id="81d0f-269">La classe <xref:System.Text.RegularExpressions.Group> rappresenta il risultato di un singolo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-269">The <xref:System.Text.RegularExpressions.Group> class represents the result from a single capturing group.</span></span> <span data-ttu-id="81d0f-270">Gli oggetti di gruppo che rappresentano i gruppi di acquisizione definiti in un'espressione regolare sono restituiti dalla proprietà <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> dell'oggetto <xref:System.Text.RegularExpressions.GroupCollection> restituito dalla proprietà <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-270">Group objects that represent the capturing groups defined in a regular expression are returned by the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property of the <xref:System.Text.RegularExpressions.GroupCollection> object returned by the <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="81d0f-271">La proprietà <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> è l'indicizzatore (in C#) e la proprietà predefinita (in Visual Basic) della classe <xref:System.Text.RegularExpressions.Group>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-271">The <xref:System.Text.RegularExpressions.GroupCollection.Item%2A> property is the indexer (in C#) and the default property (in Visual Basic) of the <xref:System.Text.RegularExpressions.Group> class.</span></span> <span data-ttu-id="81d0f-272">È anche possibile recuperare i singoli membri eseguendo l'iterazione della raccolta mediante il costrutto `foreach` o `For Each`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-272">You can also retrieve individual members by iterating the collection using the `foreach` or `For Each` construct.</span></span> <span data-ttu-id="81d0f-273">Per un esempio, vedere la sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-273">For an example, see the previous section.</span></span>  
  
 <span data-ttu-id="81d0f-274">L'esempio seguente usa i costrutti di raggruppamento annidati per acquisire le sottostringhe nei gruppi.</span><span class="sxs-lookup"><span data-stu-id="81d0f-274">The following example uses nested grouping constructs to capture substrings into groups.</span></span> <span data-ttu-id="81d0f-275">Il criterio di espressione regolare `(a(b))c` corrisponde alla stringa "abc".</span><span class="sxs-lookup"><span data-stu-id="81d0f-275">The regular expression pattern `(a(b))c` matches the string "abc".</span></span> <span data-ttu-id="81d0f-276">Assegna la sottostringa "ab" al primo gruppo di acquisizione e la sottostringa "b" al secondo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-276">It assigns the substring "ab" to the first capturing group, and the substring "b" to the second capturing group.</span></span>  
  
 [!code-csharp[RegularExpressions.Classes#6](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#6)]
 [!code-vb[RegularExpressions.Classes#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#6)]  
  
 <span data-ttu-id="81d0f-277">L'esempio seguente usa costrutti di raggruppamento con nome per acquisire sottostringhe da una stringa che include dati nel formato "DATANAME:VALUE" e viene suddivisa in corrispondenza dei due punti (:) dall'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="81d0f-277">The following example uses named grouping constructs to capture substrings from a string that contains data in the format "DATANAME:VALUE", which the regular expression splits at the colon (:).</span></span>  
  
 [!code-csharp[RegularExpressions.Classes#8](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#8)]
 [!code-vb[RegularExpressions.Classes#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#8)]  
  
 <span data-ttu-id="81d0f-278">Il criterio di ricerca di espressioni regolari `^(?<name>\w+):(?<value>\w+)` è definito nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-278">The regular expression pattern `^(?<name>\w+):(?<value>\w+)` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-279">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-279">Pattern</span></span>|<span data-ttu-id="81d0f-280">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-280">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="81d0f-281">Inizia la corrispondenza all'inizio della stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-281">Begin the match at the beginning of the input string.</span></span>|  
|`(?<name>\w+)`|<span data-ttu-id="81d0f-282">Trova la corrispondenza di uno o più caratteri alfanumerici.</span><span class="sxs-lookup"><span data-stu-id="81d0f-282">Match one or more word characters.</span></span> <span data-ttu-id="81d0f-283">Il nome di questo gruppo di acquisizione è `name`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-283">The name of this capturing group is `name`.</span></span>|  
|`:`|<span data-ttu-id="81d0f-284">Trova la corrispondenza con i due punti.</span><span class="sxs-lookup"><span data-stu-id="81d0f-284">Match a colon.</span></span>|  
|`(?<value>\w+)`|<span data-ttu-id="81d0f-285">Trova la corrispondenza di uno o più caratteri alfanumerici.</span><span class="sxs-lookup"><span data-stu-id="81d0f-285">Match one or more word characters.</span></span> <span data-ttu-id="81d0f-286">Il nome di questo gruppo di acquisizione è `value`.</span><span class="sxs-lookup"><span data-stu-id="81d0f-286">The name of this capturing group is `value`.</span></span>|  
  
 <span data-ttu-id="81d0f-287">Le proprietà della classe <xref:System.Text.RegularExpressions.Group> forniscono informazioni sul gruppo acquisito. La proprietà `Group.Value` include la sottostringa acquisita, la proprietà`Group.Index` indica la posizione iniziale del gruppo acquisito nel testo di input, la proprietà `Group.Length` include la lunghezza del testo acquisito e la proprietà `Group.Success` indica se una sottostringa corrisponde al modello definito dal gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-287">The properties of the <xref:System.Text.RegularExpressions.Group> class provide information about the captured group: The `Group.Value` property contains the captured substring, the `Group.Index` property indicates the starting position of the captured group in the input text, the `Group.Length` property contains the length of the captured text, and the `Group.Success` property indicates whether a substring matched the pattern defined by the capturing group.</span></span>  
  
 <span data-ttu-id="81d0f-288">L'applicazione di quantificatori a un gruppo (per altre informazioni, vedere [Quantificatori](quantifiers-in-regular-expressions.md)) modifica la relazione di un'acquisizione per ogni gruppo di acquisizione in due modi:</span><span class="sxs-lookup"><span data-stu-id="81d0f-288">Applying quantifiers to a group (for more information, see [Quantifiers](quantifiers-in-regular-expressions.md)) modifies the relationship of one capture per capturing group in two ways:</span></span>  
  
- <span data-ttu-id="81d0f-289">Se il quantificatore `*` o `*?` (che specifica zero o più corrispondenze) è applicato a un gruppo, è possibile che per un gruppo di acquisizione non siano rilevate corrispondenze nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-289">If the `*` or `*?` quantifier (which specifies zero or more matches) is applied to a group, a capturing group may not have a match in the input string.</span></span> <span data-ttu-id="81d0f-290">Se non è presente testo acquisito, le proprietà dell'oggetto <xref:System.Text.RegularExpressions.Group> sono impostate come mostrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-290">When there is no captured text, the properties of the <xref:System.Text.RegularExpressions.Group> object are set as shown in the following table.</span></span>  
  
    |<span data-ttu-id="81d0f-291">Proprietà del gruppo</span><span class="sxs-lookup"><span data-stu-id="81d0f-291">Group property</span></span>|<span data-ttu-id="81d0f-292">valore</span><span class="sxs-lookup"><span data-stu-id="81d0f-292">Value</span></span>|  
    |--------------------|-----------|  
    |`Success`|`false`|  
    |`Value`|<xref:System.String.Empty?displayProperty=nameWithType>|  
    |`Length`|<span data-ttu-id="81d0f-293">0</span><span class="sxs-lookup"><span data-stu-id="81d0f-293">0</span></span>|  
  
     <span data-ttu-id="81d0f-294">Di seguito ne viene illustrato un esempio.</span><span class="sxs-lookup"><span data-stu-id="81d0f-294">The following example provides an illustration.</span></span> <span data-ttu-id="81d0f-295">Nel criterio di espressione regolare `aaa(bbb)*ccc` per il primo gruppo di acquisizione (sottostringa "bbb") possono essere rilevate zero o più corrispondenze.</span><span class="sxs-lookup"><span data-stu-id="81d0f-295">In the regular expression pattern `aaa(bbb)*ccc`, the first capturing group (the substring "bbb") can be matched zero or more times.</span></span> <span data-ttu-id="81d0f-296">Poiché la stringa di input "aaaccc" corrisponde al modello, per il gruppo di acquisizione non sono rilevate corrispondenze.</span><span class="sxs-lookup"><span data-stu-id="81d0f-296">Because the input string "aaaccc" matches the pattern, the capturing group does not have a match.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/nocapture1.cs#11)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/nocapture1.vb#11)]  
  
- <span data-ttu-id="81d0f-297">I quantificatori possono corrispondere a più occorrenze di un modello definito da un gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-297">Quantifiers can match multiple occurrences of a pattern that is defined by a capturing group.</span></span> <span data-ttu-id="81d0f-298">In questo caso, le proprietà `Value` e `Length` di un oggetto <xref:System.Text.RegularExpressions.Group> contengono informazioni sull'ultima sottostringa acquisita.</span><span class="sxs-lookup"><span data-stu-id="81d0f-298">In this case, the `Value` and `Length` properties of a <xref:System.Text.RegularExpressions.Group> object contain information only about the last captured substring.</span></span> <span data-ttu-id="81d0f-299">Ad esempio, l'espressione regolare seguente corrisponde a una singola frase che termina con un punto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-299">For example, the following regular expression matches a single sentence that ends in a period.</span></span> <span data-ttu-id="81d0f-300">Usa due costrutti di raggruppamento: il primo acquisisce singole parole insieme a un carattere di spaziatura e il secondo acquisisce le singole parole.</span><span class="sxs-lookup"><span data-stu-id="81d0f-300">It uses two grouping constructs: The first captures individual words along with a white-space character; the second captures individual words.</span></span> <span data-ttu-id="81d0f-301">Come illustrato dall'output dell'esempio, anche se l'espressione regolare riesce ad acquisire un'intera frase, il secondo gruppo di acquisizione acquisisce solo l'ultima parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-301">As the output from the example shows, although the regular expression succeeds in capturing an entire sentence, the second capturing group captures only the last word.</span></span>  
  
     [!code-csharp[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/lastcapture1.cs#12)]
     [!code-vb[Conceptual.RegularExpressions.ObjectModel#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/lastcapture1.vb#12)]  
  
 [<span data-ttu-id="81d0f-302">Torna all'inizio</span><span class="sxs-lookup"><span data-stu-id="81d0f-302">Back to top</span></span>](#introduction)  
  
<a name="CaptureCollection"></a>
## <a name="the-capture-collection"></a><span data-ttu-id="81d0f-303">Raccolta Capture</span><span class="sxs-lookup"><span data-stu-id="81d0f-303">The Capture Collection</span></span>  
 <span data-ttu-id="81d0f-304">L'oggetto <xref:System.Text.RegularExpressions.Group> include informazioni solo sull'ultima acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-304">The <xref:System.Text.RegularExpressions.Group> object contains information only about the last capture.</span></span> <span data-ttu-id="81d0f-305">L'intero set di acquisizioni eseguite da un gruppo di acquisizione è tuttavia ancora disponibile tramite l'oggetto <xref:System.Text.RegularExpressions.CaptureCollection> restituito dalla proprietà <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-305">However, the entire set of captures made by a capturing group is still available from the <xref:System.Text.RegularExpressions.CaptureCollection> object that is returned by the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="81d0f-306">Ogni membro della raccolta è un oggetto <xref:System.Text.RegularExpressions.Capture> che rappresenta un'acquisizione eseguita da quel gruppo di acquisizione, in base all'ordine di acquisizione e quindi in base all'ordine in cui sono state rilevate corrispondenze per le stringhe acquisite da sinistra a destra nella stringa di input.</span><span class="sxs-lookup"><span data-stu-id="81d0f-306">Each member of the collection is a <xref:System.Text.RegularExpressions.Capture> object that represents a capture made by that capturing group, in the order in which they were captured (and, therefore, in the order in which the captured strings were matched from left to right in the input string).</span></span> <span data-ttu-id="81d0f-307">È possibile recuperare singoli oggetti <xref:System.Text.RegularExpressions.Capture> dalla raccolta in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="81d0f-307">You can retrieve individual <xref:System.Text.RegularExpressions.Capture> objects from the collection in either of two ways:</span></span>  
  
- <span data-ttu-id="81d0f-308">Eseguendo un'iterazione nella raccolta tramite un costrutto, ad esempio `foreach` (in C#) o `For Each` (in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="81d0f-308">By iterating through the collection using a construct such as `foreach` (in C#) or `For Each` (in Visual Basic).</span></span>  
  
- <span data-ttu-id="81d0f-309">Usando la proprietà <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType> per recuperare un oggetto specifico in base all'indice.</span><span class="sxs-lookup"><span data-stu-id="81d0f-309">By using the <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A?displayProperty=nameWithType> property to retrieve a specific object by index.</span></span> <span data-ttu-id="81d0f-310">La proprietà <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A> è la proprietà predefinita (in Visual Basic) o l'indicizzatore (in C#) dell'oggetto <xref:System.Text.RegularExpressions.CaptureCollection>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-310">The <xref:System.Text.RegularExpressions.CaptureCollection.Item%2A> property is the <xref:System.Text.RegularExpressions.CaptureCollection> object's default property (in Visual Basic) or indexer (in C#).</span></span>  
  
 <span data-ttu-id="81d0f-311">Se a un gruppo di acquisizione non è applicato alcun quantificatore, l'oggetto <xref:System.Text.RegularExpressions.CaptureCollection> conterrà un singolo oggetto <xref:System.Text.RegularExpressions.Capture> di scarso interesse, poiché fornisce informazioni sulla stessa corrispondenza indicata dall'oggetto <xref:System.Text.RegularExpressions.Group>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-311">If a quantifier is not applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains a single <xref:System.Text.RegularExpressions.Capture> object that is of little interest, because it provides information about the same match as its <xref:System.Text.RegularExpressions.Group> object.</span></span> <span data-ttu-id="81d0f-312">Se a un gruppo di acquisizione è applicato un quantificatore, l'oggetto <xref:System.Text.RegularExpressions.CaptureCollection> conterrà tutte le acquisizioni eseguite dal gruppo di acquisizione e l'ultimo membro della raccolta rappresenterà la stessa acquisizione indicata dall'oggetto <xref:System.Text.RegularExpressions.Group>.</span><span class="sxs-lookup"><span data-stu-id="81d0f-312">If a quantifier is applied to a capturing group, the <xref:System.Text.RegularExpressions.CaptureCollection> object contains all captures made by the capturing group, and the last member of the collection represents the same capture as the <xref:System.Text.RegularExpressions.Group> object.</span></span>  
  
 <span data-ttu-id="81d0f-313">Ad esempio, se si usa il criterio di espressione regolare `((a(b))c)+`, in cui il quantificatore + specifica una o più corrispondenze, per acquisire corrispondenze dalla stringa "abcabcabc", l'oggetto <xref:System.Text.RegularExpressions.CaptureCollection> per ogni oggetto <xref:System.Text.RegularExpressions.Group> includerà tre membri.</span><span class="sxs-lookup"><span data-stu-id="81d0f-313">For example, if you use the regular expression pattern `((a(b))c)+` (where the + quantifier specifies one or more matches) to capture matches from the string "abcabcabc", the <xref:System.Text.RegularExpressions.CaptureCollection> object for each <xref:System.Text.RegularExpressions.Group> object contains three members.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capturecollection1.cs#14)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capturecollection1.vb#14)]  
  
 <span data-ttu-id="81d0f-314">L'esempio seguente usa l'espressione regolare `(Abc)+` per trovare una o più esecuzioni consecutive della stringa "Abc" nella stringa "XYZAbcAbcAbcXYZAbcAb".</span><span class="sxs-lookup"><span data-stu-id="81d0f-314">The following example uses the regular expression `(Abc)+` to find one or more consecutive runs of the string "Abc" in the string "XYZAbcAbcAbcXYZAbcAb".</span></span> <span data-ttu-id="81d0f-315">L'esempio illustra l'uso della proprietà <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> per restituire più gruppi di sottostringhe acquisite.</span><span class="sxs-lookup"><span data-stu-id="81d0f-315">The example illustrates the use of the <xref:System.Text.RegularExpressions.Group.Captures%2A?displayProperty=nameWithType> property to return multiple groups of captured substrings.</span></span>  
  
 [!code-csharp[RegularExpressions.Classes#5](../../../samples/snippets/csharp/VS_Snippets_CLR/RegularExpressions.Classes/cs/Example.cs#5)]
 [!code-vb[RegularExpressions.Classes#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/RegularExpressions.Classes/vb/Example.vb#5)]  
  
 [<span data-ttu-id="81d0f-316">Torna all'inizio</span><span class="sxs-lookup"><span data-stu-id="81d0f-316">Back to top</span></span>](#introduction)  
  
<a name="the_individual_capture"></a>
## <a name="the-individual-capture"></a><span data-ttu-id="81d0f-317">Singola acquisizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-317">The Individual Capture</span></span>  
 <span data-ttu-id="81d0f-318">La classe <xref:System.Text.RegularExpressions.Capture> include i risultati di una singola acquisizione di sottoespressione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-318">The <xref:System.Text.RegularExpressions.Capture> class contains the results from a single subexpression capture.</span></span> <span data-ttu-id="81d0f-319">La proprietà <xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType> include il testo con corrispondenza e la proprietà <xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType> indica la posizione a base zero nella stringa di input in cui inizia la sottostringa con corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-319">The <xref:System.Text.RegularExpressions.Capture.Value%2A?displayProperty=nameWithType> property contains the matched text, and the <xref:System.Text.RegularExpressions.Capture.Index%2A?displayProperty=nameWithType> property indicates the zero-based position in the input string at which the matched substring begins.</span></span>  
  
 <span data-ttu-id="81d0f-320">L'esempio seguente analizza una stringa di input per ottenere la temperatura di città selezionate.</span><span class="sxs-lookup"><span data-stu-id="81d0f-320">The following example parses an input string for the temperature of selected cities.</span></span> <span data-ttu-id="81d0f-321">Una città e la relativa temperatura sono separate da una virgola (",") e un punto e virgola (";") separa i dati di ogni città.</span><span class="sxs-lookup"><span data-stu-id="81d0f-321">A comma (",") is used to separate a city and its temperature, and a semicolon (";") is used to separate each city's data.</span></span> <span data-ttu-id="81d0f-322">L'intera stringa di input rappresenta una singola corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="81d0f-322">The entire input string represents a single match.</span></span> <span data-ttu-id="81d0f-323">Nel criterio di espressione regolare `((\w+(\s\w+)*),(\d+);)+`, usato per analizzare la stringa, il nome della città è assegnato al secondo gruppo di acquisizione e la temperatura al quarto.</span><span class="sxs-lookup"><span data-stu-id="81d0f-323">In the regular expression pattern `((\w+(\s\w+)*),(\d+);)+`, which is used to parse the string, the city name is assigned to the second capturing group, and the temperature is assigned to the fourth capturing group.</span></span>  
  
 [!code-csharp[Conceptual.RegularExpressions.ObjectModel#16](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/cs/capture1.cs#16)]
 [!code-vb[Conceptual.RegularExpressions.ObjectModel#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regularexpressions.objectmodel/vb/capture1.vb#16)]  
  
 <span data-ttu-id="81d0f-324">L'espressione regolare è definita nel modo illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="81d0f-324">The regular expression is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="81d0f-325">Modello</span><span class="sxs-lookup"><span data-stu-id="81d0f-325">Pattern</span></span>|<span data-ttu-id="81d0f-326">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81d0f-326">Description</span></span>|  
|-------------|-----------------|  
|`\w+`|<span data-ttu-id="81d0f-327">Trova la corrispondenza di uno o più caratteri alfanumerici.</span><span class="sxs-lookup"><span data-stu-id="81d0f-327">Match one or more word characters.</span></span>|  
|`(\s\w+)*`|<span data-ttu-id="81d0f-328">Trova la corrispondenza con zero o più occorrenze di un carattere di spaziatura seguito da uno o più caratteri di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-328">Match zero or more occurrences of a white-space character followed by one or more word characters.</span></span> <span data-ttu-id="81d0f-329">Questo modello corrisponde a nomi di città composti da più parole.</span><span class="sxs-lookup"><span data-stu-id="81d0f-329">This pattern matches multi-word city names.</span></span> <span data-ttu-id="81d0f-330">Equivale al terzo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-330">This is the third capturing group.</span></span>|  
|`(\w+(\s\w+)*)`|<span data-ttu-id="81d0f-331">Trova la corrispondenza con uno o più caratteri di parola seguiti da zero o più caratteri di spaziatura e uno o più caratteri di parola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-331">Match one or more word characters followed by zero or more occurrences of a white-space character and one or more word characters.</span></span> <span data-ttu-id="81d0f-332">Equivale al secondo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-332">This is the second capturing group.</span></span>|  
|`,`|<span data-ttu-id="81d0f-333">Trova la corrispondenza con una virgola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-333">Match a comma.</span></span>|  
|`(\d+)`|<span data-ttu-id="81d0f-334">Trova la corrispondenza con una o più cifre.</span><span class="sxs-lookup"><span data-stu-id="81d0f-334">Match one or more digits.</span></span> <span data-ttu-id="81d0f-335">Questo è il quarto gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-335">This is the fourth capturing group.</span></span>|  
|`;`|<span data-ttu-id="81d0f-336">Trova la corrispondenza con un punto e virgola.</span><span class="sxs-lookup"><span data-stu-id="81d0f-336">Match a semicolon.</span></span>|  
|`((\w+(\s\w+)*),(\d+);)+`|<span data-ttu-id="81d0f-337">Trova la corrispondenza con modello di una parola seguita da parole aggiuntive seguite da una virgola, una o più cifre e un punto e virgola, una o più volte.</span><span class="sxs-lookup"><span data-stu-id="81d0f-337">Match the pattern of a word followed by any additional words followed by a comma, one or more digits, and a semicolon, one or more times.</span></span> <span data-ttu-id="81d0f-338">Equivale al primo gruppo di acquisizione.</span><span class="sxs-lookup"><span data-stu-id="81d0f-338">This is the first capturing group.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="81d0f-339">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="81d0f-339">See also</span></span>

- <xref:System.Text.RegularExpressions>
- [<span data-ttu-id="81d0f-340">Espressioni regolari .NET</span><span class="sxs-lookup"><span data-stu-id="81d0f-340">.NET Regular Expressions</span></span>](regular-expressions.md)
- [<span data-ttu-id="81d0f-341">Linguaggio di espressioni regolari - Riferimento rapido</span><span class="sxs-lookup"><span data-stu-id="81d0f-341">Regular Expression Language - Quick Reference</span></span>](regular-expression-language-quick-reference.md)
