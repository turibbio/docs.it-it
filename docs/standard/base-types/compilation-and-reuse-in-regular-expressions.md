---
title: Compilazione e riutilizzo nelle espressioni regolari
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- parsing text with regular expressions, compilation
- searching with regular expressions, compilation
- .NET Framework regular expressions, engines
- .NET Framework regular expressions, compilation
- regular expressions, compilation
- compilation, regular expressions
- pattern-matching with regular expressions, compilation
- regular expressions, engines
ms.assetid: 182ec76d-5a01-4d73-996c-0b0d14fcea18
ms.openlocfilehash: 54f14a4f31bef00dd222686cc523935b2d9dd5fa
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/02/2020
ms.locfileid: "84279038"
---
# <a name="compilation-and-reuse-in-regular-expressions"></a><span data-ttu-id="38aef-102">Compilazione e riutilizzo nelle espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="38aef-102">Compilation and Reuse in Regular Expressions</span></span>
<span data-ttu-id="38aef-103">Se si comprendono le modalità con cui le espressioni regolari vengono compilate dal motore e vengono memorizzate nella cache, è possibile ottimizzare le prestazioni delle applicazioni che fanno ampio uso di espressioni regolari.</span><span class="sxs-lookup"><span data-stu-id="38aef-103">You can optimize the performance of applications that make extensive use of regular expressions by understanding how the regular expression engine compiles expressions and by understanding how regular expressions are cached.</span></span> <span data-ttu-id="38aef-104">In questo argomento vengono descritte sia la compilazione che la memorizzazione nella cache.</span><span class="sxs-lookup"><span data-stu-id="38aef-104">This topic discusses both compilation and caching.</span></span>  
  
## <a name="compiled-regular-expressions"></a><span data-ttu-id="38aef-105">Espressioni regolari compilate</span><span class="sxs-lookup"><span data-stu-id="38aef-105">Compiled Regular Expressions</span></span>  
 <span data-ttu-id="38aef-106">Per impostazione predefinita, il motore delle espressioni regolari compila un'espressione regolare in una sequenza di istruzioni interne. Si tratta di codici di alto livello che sono diversi da Microsoft intermediate language, o MSIL.</span><span class="sxs-lookup"><span data-stu-id="38aef-106">By default, the regular expression engine compiles a regular expression to a sequence of internal instructions (these are high-level codes that are different from Microsoft intermediate language, or MSIL).</span></span> <span data-ttu-id="38aef-107">Quando il motore esegue un'espressione regolare, interpreta i codici interni.</span><span class="sxs-lookup"><span data-stu-id="38aef-107">When the engine executes a regular expression, it interprets the internal codes.</span></span>  
  
 <span data-ttu-id="38aef-108">Se un oggetto <xref:System.Text.RegularExpressions.Regex> viene costruito con l'opzione <xref:System.Text.RegularExpressions.RegexOptions.Compiled?displayProperty=nameWithType>, compila l'espressione regolare in codice MSIL esplicito invece che in istruzioni interne di espressione regolare di alto livello.</span><span class="sxs-lookup"><span data-stu-id="38aef-108">If a <xref:System.Text.RegularExpressions.Regex> object is constructed with the <xref:System.Text.RegularExpressions.RegexOptions.Compiled?displayProperty=nameWithType> option, it compiles the regular expression to explicit MSIL code instead of high-level regular expression internal instructions.</span></span> <span data-ttu-id="38aef-109">In questo modo il compilatore JIT di.NET può convertire l'espressione in codice macchina nativo per ottimizzare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="38aef-109">This allows .NET's just-in-time (JIT) compiler to convert the expression to native machine code for higher performance.</span></span>  <span data-ttu-id="38aef-110">Il costo della costruzione dell' <xref:System.Text.RegularExpressions.Regex> oggetto può essere superiore, ma il costo di esecuzione delle corrispondenze è probabilmente molto più piccolo.</span><span class="sxs-lookup"><span data-stu-id="38aef-110">The cost of constructing the <xref:System.Text.RegularExpressions.Regex> object may be higher, but the cost of performing matches with it is likely to be much smaller.</span></span>

 <span data-ttu-id="38aef-111">Un'alternativa consiste nell'usare espressioni regolari precompilate.</span><span class="sxs-lookup"><span data-stu-id="38aef-111">An alternative is to use precompiled regular expressions.</span></span> <span data-ttu-id="38aef-112">È possibile compilare tutte le espressioni in una DLL riutilizzabile usando il metodo <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A>.</span><span class="sxs-lookup"><span data-stu-id="38aef-112">You can compile all of your expressions into a reusable DLL by using the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A> method.</span></span> <span data-ttu-id="38aef-113">In questo modo si evita la necessità di eseguire la compilazione in fase di esecuzione, pur continuando a trarre vantaggio dalla velocità delle espressioni regolari compilate.</span><span class="sxs-lookup"><span data-stu-id="38aef-113">This avoids the need to compile at run time while still benefiting from the speed of compiled regular expressions.</span></span>  
  
## <a name="the-regular-expressions-cache"></a><span data-ttu-id="38aef-114">La cache delle espressioni regolari</span><span class="sxs-lookup"><span data-stu-id="38aef-114">The Regular Expressions Cache</span></span>  
 <span data-ttu-id="38aef-115">Per migliorare le prestazioni, il motore delle espressioni regolari gestisce una cache a livello di applicazione delle espressioni regolari compilate.</span><span class="sxs-lookup"><span data-stu-id="38aef-115">To improve performance, the regular expression engine maintains an application-wide cache of compiled regular expressions.</span></span> <span data-ttu-id="38aef-116">La cache memorizza i modelli di espressione regolare che vengono usati solo nelle chiamate di metodo statico.</span><span class="sxs-lookup"><span data-stu-id="38aef-116">The cache stores regular expression patterns that are used only in static method calls.</span></span> <span data-ttu-id="38aef-117">I modelli di espressione regolare forniti ai metodi di istanza non vengono memorizzati nella cache. In questo modo si evita la necessità di analizzare nuovamente un'espressione nel codice byte di alto livello ogni volta che viene utilizzata.</span><span class="sxs-lookup"><span data-stu-id="38aef-117">(Regular expression patterns supplied to instance methods are not cached.) This avoids the need to reparse an expression into high-level byte code each time it is used.</span></span>  
  
 <span data-ttu-id="38aef-118">Il numero massimo di espressioni regolari memorizzate nella cache è determinato dal valore della proprietà <xref:System.Text.RegularExpressions.Regex.CacheSize%2A?displayProperty=nameWithType>`static` (`Shared` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="38aef-118">The maximum number of cached regular expressions is determined by the value of the `static` (`Shared` in Visual Basic) <xref:System.Text.RegularExpressions.Regex.CacheSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="38aef-119">Per impostazione predefinita, il motore delle espressioni regolari memorizza nella cache fino a 15 espressioni regolari compilate.</span><span class="sxs-lookup"><span data-stu-id="38aef-119">By default, the regular expression engine caches up to 15 compiled regular expressions.</span></span> <span data-ttu-id="38aef-120">Se il numero di espressioni regolari compilate supera la dimensione della cache, l'espressione regolare usata meno di recente viene eliminata e viene memorizzata nella cache la nuova espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="38aef-120">If the number of compiled regular expressions exceeds the cache size, the least recently used regular expression is discarded and the new regular expression is cached.</span></span>  
  
 <span data-ttu-id="38aef-121">L'applicazione può riutilizzare le espressioni regolari in uno dei due modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="38aef-121">Your application can reuse regular expressions in one of the following two ways:</span></span>  
  
- <span data-ttu-id="38aef-122">Usando un metodo statico dell'oggetto <xref:System.Text.RegularExpressions.Regex> per definire l'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="38aef-122">By using a static method of the <xref:System.Text.RegularExpressions.Regex> object to define the regular expression.</span></span> <span data-ttu-id="38aef-123">Se si usa un modello di espressione regolare che è già stato definito da un'altra chiamata di metodo statico, il motore delle espressioni regolari tenterà di recuperarlo dalla cache.</span><span class="sxs-lookup"><span data-stu-id="38aef-123">If you're using a regular expression pattern that has already been defined by another static method call, the regular expression engine will try to retrieve it from the cache.</span></span> <span data-ttu-id="38aef-124">Se non è disponibile nella cache, il motore compila l'espressione regolare e la aggiunge alla cache.</span><span class="sxs-lookup"><span data-stu-id="38aef-124">If it's not available in the cache, the engine will compile the regular expression and add it to the cache.</span></span>
  
- <span data-ttu-id="38aef-125">Usando ripetutamente un oggetto <xref:System.Text.RegularExpressions.Regex> esistente finché il modello di espressione regolare relativo è necessario.</span><span class="sxs-lookup"><span data-stu-id="38aef-125">By reusing an existing <xref:System.Text.RegularExpressions.Regex> object as long as its regular expression pattern is needed.</span></span>  
  
 <span data-ttu-id="38aef-126">A causa del sovraccarico di creazione di istanze di oggetti e di compilazione di espressioni regolari, la creazione e l'eliminazione rapide di numerosi oggetti <xref:System.Text.RegularExpressions.Regex> è un processo molto costoso.</span><span class="sxs-lookup"><span data-stu-id="38aef-126">Because of the overhead of object instantiation and regular expression compilation, creating and rapidly destroying numerous <xref:System.Text.RegularExpressions.Regex> objects is a very expensive process.</span></span> <span data-ttu-id="38aef-127">Per le applicazioni che usano un numero elevato di espressioni regolari, è possibile ottimizzare le prestazioni con chiamate a metodi statici `Regex` e aumentando eventualmente la dimensione della cache delle espressioni regolari.</span><span class="sxs-lookup"><span data-stu-id="38aef-127">For applications that use a large number of different regular expressions, you can optimize performance by using calls to static `Regex` methods and possibly by increasing the size of the regular expression cache.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="38aef-128">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="38aef-128">See also</span></span>

- [<span data-ttu-id="38aef-129">Espressioni regolari .NET</span><span class="sxs-lookup"><span data-stu-id="38aef-129">.NET Regular Expressions</span></span>](regular-expressions.md)
