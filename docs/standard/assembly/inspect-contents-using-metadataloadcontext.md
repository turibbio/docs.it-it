---
title: "Procedura: controllare il contenuto dell'assembly tramite MetadataLoadContextHow to: Inspect assembly contents using MetadataLoadContext"
description: Informazioni su come usare MetadataLoadContext, un'API che consente di caricare assembly .NET a scopo di ispezione.
author: MSDN-WhiteKnight
ms.date: 03/10/2020
ms.technology: dotnet-standard
ms.openlocfilehash: a782b2db4fb62cfaedaa6768e2131bda6bec864c
ms.sourcegitcommit: b75a45f0cfe012b71b45dd9bf723adf32369d40c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/24/2020
ms.locfileid: "80229301"
---
# <a name="how-to-inspect-assembly-contents-using-metadataloadcontext"></a><span data-ttu-id="2a179-103">Procedura: controllare il contenuto dell'assembly tramite MetadataLoadContextHow to: Inspect assembly contents using MetadataLoadContext</span><span class="sxs-lookup"><span data-stu-id="2a179-103">How to: Inspect assembly contents using MetadataLoadContext</span></span>

<span data-ttu-id="2a179-104">L'API di reflection in .NET per impostazione predefinita consente agli sviluppatori di esaminare il contenuto degli assembly caricati nel contesto di esecuzione principale.</span><span class="sxs-lookup"><span data-stu-id="2a179-104">The reflection API in .NET by default enables developers to inspect the contents of assemblies loaded into the main execution context.</span></span> <span data-ttu-id="2a179-105">Tuttavia, a volte non è possibile caricare un assembly nel contesto di esecuzione, ad esempio perché è stato compilato per un'altra piattaforma o architettura del processore o è un assembly di [riferimento.](reference-assemblies.md)</span><span class="sxs-lookup"><span data-stu-id="2a179-105">However, sometimes it isn't possible to load an assembly into the execution context, for example, because it was compiled for another platform or processor architecture, or it's a [reference assembly](reference-assemblies.md).</span></span> <span data-ttu-id="2a179-106">L'API <xref:System.Reflection.MetadataLoadContext?displayProperty=fullName> consente di caricare e controllare tali assembly.</span><span class="sxs-lookup"><span data-stu-id="2a179-106">The <xref:System.Reflection.MetadataLoadContext?displayProperty=fullName> API allows you to load and inspect such assemblies.</span></span> <span data-ttu-id="2a179-107">Gli assembly <xref:System.Reflection.MetadataLoadContext> caricati in vengono trattati solo come metadati, ovvero è possibile esaminare i tipi nell'assembly, ma non è possibile eseguire il codice in esso contenuto.</span><span class="sxs-lookup"><span data-stu-id="2a179-107">Assemblies loaded into the <xref:System.Reflection.MetadataLoadContext> are treated only as metadata, that is, you can examine types in the assembly, but you can't execute any code contained in it.</span></span> <span data-ttu-id="2a179-108">A differenza del contesto di esecuzione principale, l'oggetto <xref:System.Reflection.MetadataLoadContext> non carica automaticamente le dipendenze dalla directory corrente; utilizza invece la logica di <xref:System.Reflection.MetadataAssemblyResolver> associazione personalizzata fornita dal passato a esso.</span><span class="sxs-lookup"><span data-stu-id="2a179-108">Unlike the main execution context, the <xref:System.Reflection.MetadataLoadContext> doesn't automatically load dependencies from the current directory; instead it uses the custom binding logic provided by the <xref:System.Reflection.MetadataAssemblyResolver> passed to it.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="2a179-109">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="2a179-109">Prerequisites</span></span>

<span data-ttu-id="2a179-110">Per <xref:System.Reflection.MetadataLoadContext>utilizzare , installare il pacchetto [System.Reflection.MetadataLoadContext](https://www.nuget.org/packages/System.Reflection.MetadataLoadContext) NuGet.</span><span class="sxs-lookup"><span data-stu-id="2a179-110">To use <xref:System.Reflection.MetadataLoadContext>, install the [System.Reflection.MetadataLoadContext](https://www.nuget.org/packages/System.Reflection.MetadataLoadContext) NuGet package.</span></span> <span data-ttu-id="2a179-111">È supportato in qualsiasi framework di destinazione conforme a .NET Standard 2.0, ad esempio .NET Core 2.0 o .NET Framework 4.6.1.</span><span class="sxs-lookup"><span data-stu-id="2a179-111">It is supported on any .NET Standard 2.0-compliant target framework, for example, .NET Core 2.0 or .NET Framework 4.6.1.</span></span>

## <a name="create-metadataassemblyresolver-for-metadataloadcontext"></a><span data-ttu-id="2a179-112">Creare MetadataAssemblyResolver per MetadataLoadContextCreate MetadataAssemblyResolver for MetadataLoadContext</span><span class="sxs-lookup"><span data-stu-id="2a179-112">Create MetadataAssemblyResolver for MetadataLoadContext</span></span>

<span data-ttu-id="2a179-113">La <xref:System.Reflection.MetadataLoadContext> creazione di è <xref:System.Reflection.MetadataAssemblyResolver>necessario fornire l'istanza del file .</span><span class="sxs-lookup"><span data-stu-id="2a179-113">Creating the <xref:System.Reflection.MetadataLoadContext> requires providing the instance of the <xref:System.Reflection.MetadataAssemblyResolver>.</span></span> <span data-ttu-id="2a179-114">Il modo più semplice per <xref:System.Reflection.PathAssemblyResolver>fornirne uno consiste nell'utilizzare l'oggetto , che risolve gli assembly dalla raccolta specificata di stringhe del percorso di assembly.</span><span class="sxs-lookup"><span data-stu-id="2a179-114">The simplest way to provide one is to use the <xref:System.Reflection.PathAssemblyResolver>, which resolves assemblies from the given collection of assembly path strings.</span></span> <span data-ttu-id="2a179-115">Questa raccolta, oltre agli assembly che si desidera esaminare direttamente, deve includere anche tutte le dipendenze necessarie.</span><span class="sxs-lookup"><span data-stu-id="2a179-115">This collection, besides assemblies you want to inspect directly, should also include all needed dependencies.</span></span> <span data-ttu-id="2a179-116">Ad esempio, per leggere l'attributo personalizzato che si trova in un assembly esterno, è necessario includere tale assembly o verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="2a179-116">For example, to read the custom attribute located in an external assembly, you should include that assembly or an exception will be thrown.</span></span> <span data-ttu-id="2a179-117">Nella maggior parte dei casi, è necessario includere almeno l'assembly *di base,* ovvero l'assembly contenente i tipi di sistema incorporati, ad <xref:System.Object?displayProperty=nameWithType>esempio .</span><span class="sxs-lookup"><span data-stu-id="2a179-117">In most cases, you should include at least the *core assembly*, that is, the assembly containing built-in system types, such as <xref:System.Object?displayProperty=nameWithType>.</span></span> <span data-ttu-id="2a179-118">Il codice seguente viene <xref:System.Reflection.PathAssemblyResolver> illustrato come creare l'utilizzando la raccolta costituita dall'assembly controllato e l'assembly principale del runtime corrente:</span><span class="sxs-lookup"><span data-stu-id="2a179-118">The following code shows how to create the <xref:System.Reflection.PathAssemblyResolver> using the collection consisting of the inspected assembly and the current runtime's core assembly:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#CoreAssembly)]

<span data-ttu-id="2a179-119">Se è necessario accedere a tutti i tipi BCL, è possibile includere tutti gli assembly di runtime nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="2a179-119">If you need access to all BCL types, you can include all runtime assemblies in the collection.</span></span> <span data-ttu-id="2a179-120">Nel codice seguente viene <xref:System.Reflection.PathAssemblyResolver> illustrato come creare l'oggetto utilizzando la raccolta costituita dall'assembly controllato e da tutti gli assembly del runtime corrente:</span><span class="sxs-lookup"><span data-stu-id="2a179-120">The following code shows how to create the <xref:System.Reflection.PathAssemblyResolver> using the collection consisting of the inspected assembly and all assemblies of the current runtime:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#RuntimeAssemblies)]

## <a name="create-metadataloadcontext"></a><span data-ttu-id="2a179-121">Creare MetadataLoadContextCreate MetadataLoadContext</span><span class="sxs-lookup"><span data-stu-id="2a179-121">Create MetadataLoadContext</span></span>

<span data-ttu-id="2a179-122">Per creare <xref:System.Reflection.MetadataLoadContext>l'oggetto <xref:System.Reflection.MetadataLoadContext.%23ctor%28System.Reflection.MetadataAssemblyResolver%2CSystem.String%29>, richiamare <xref:System.Reflection.MetadataAssemblyResolver> il relativo costruttore , passando il parametro creato in precedenza come primo parametro e il nome dell'assembly di base come secondo parametro.</span><span class="sxs-lookup"><span data-stu-id="2a179-122">To create the <xref:System.Reflection.MetadataLoadContext>, invoke its constructor <xref:System.Reflection.MetadataLoadContext.%23ctor%28System.Reflection.MetadataAssemblyResolver%2CSystem.String%29>, passing the previously created <xref:System.Reflection.MetadataAssemblyResolver> as the first parameter and the core assembly name as the second parameter.</span></span> <span data-ttu-id="2a179-123">È possibile omettere il nome dell'assembly principale, nel qual caso il costruttore tenterà di utilizzare i nomi predefiniti: "mscorlib", "System.Runtime" o "netstandard".</span><span class="sxs-lookup"><span data-stu-id="2a179-123">You can omit the core assembly name, in which case the constructor will attempt to use default names: "mscorlib", "System.Runtime", or "netstandard".</span></span>

<span data-ttu-id="2a179-124">Dopo aver creato il contesto, è possibile caricare <xref:System.Reflection.MetadataLoadContext.LoadFromAssemblyPath%2A>gli assembly in esso utilizzando metodi quali .</span><span class="sxs-lookup"><span data-stu-id="2a179-124">After you've created the context, you can load assemblies into it using methods such as <xref:System.Reflection.MetadataLoadContext.LoadFromAssemblyPath%2A>.</span></span> <span data-ttu-id="2a179-125">È possibile usare tutte le API di reflection negli assembly caricati, ad eccezione di quelli che implicano l'esecuzione del codice.</span><span class="sxs-lookup"><span data-stu-id="2a179-125">You can use all reflection APIs on loaded assemblies except ones that involve code execution.</span></span> <span data-ttu-id="2a179-126">Il <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A> metodo prevede l'esecuzione di costruttori, pertanto utilizzare il <xref:System.Reflection.MemberInfo.GetCustomAttributesData%2A> metodo <xref:System.Reflection.MetadataLoadContext>quando è necessario esaminare gli attributi personalizzati nell'oggetto .</span><span class="sxs-lookup"><span data-stu-id="2a179-126">The <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A> method does involve the execution of constructors, so use the <xref:System.Reflection.MemberInfo.GetCustomAttributesData%2A> method instead when you need to examine custom attributes in the <xref:System.Reflection.MetadataLoadContext>.</span></span>

<span data-ttu-id="2a179-127">Nell'esempio di <xref:System.Reflection.MetadataLoadContext>codice riportato di seguito viene creato , l'assembly viene caricato in esso e gli attributi dell'assembly vengono restituiti nella console:</span><span class="sxs-lookup"><span data-stu-id="2a179-127">The following code sample creates <xref:System.Reflection.MetadataLoadContext>, loads the assembly into it, and outputs assembly attributes into the console:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#CreateContext)]

## <a name="example"></a><span data-ttu-id="2a179-128">Esempio</span><span class="sxs-lookup"><span data-stu-id="2a179-128">Example</span></span>

<span data-ttu-id="2a179-129">Per un esempio di codice completo, consultate [Esaminare il contenuto dell'assembly tramite MetadataLoadContext](https://docs.microsoft.com/samples/dotnet/samples/inspect-assembly-contents-using-metadataloadcontext/).</span><span class="sxs-lookup"><span data-stu-id="2a179-129">For a complete code example, see [Inspect assembly contents using MetadataLoadContext](https://docs.microsoft.com/samples/dotnet/samples/inspect-assembly-contents-using-metadataloadcontext/).</span></span>
