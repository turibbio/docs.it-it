---
title: Recupero di informazioni memorizzate negli attributi
description: Informazioni su come recuperare le informazioni archiviate negli attributi, ad esempio per un'istanza di attributo, molte istanze per lo stesso ambito, & molte istanze per ambiti diversi.
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- retrieving attributes
- multiple attribute instances
- attributes [.NET Framework], retrieving
ms.assetid: 37dfe4e3-7da0-48b6-a3d9-398981524e1c
ms.openlocfilehash: cf147a0ae6833039247c4c0878996973cc3db545
ms.sourcegitcommit: 7137e12f54c4e83a94ae43ec320f8cf59c1772ea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/10/2020
ms.locfileid: "84661861"
---
# <a name="retrieving-information-stored-in-attributes"></a><span data-ttu-id="11e0a-103">Recupero di informazioni memorizzate negli attributi</span><span class="sxs-lookup"><span data-stu-id="11e0a-103">Retrieving Information Stored in Attributes</span></span>
<span data-ttu-id="11e0a-104">Il recupero di un attributo personalizzato è un processo semplice.</span><span class="sxs-lookup"><span data-stu-id="11e0a-104">Retrieving a custom attribute is a simple process.</span></span> <span data-ttu-id="11e0a-105">Dichiarare prima di tutto un'istanza dell'attributo da recuperare.</span><span class="sxs-lookup"><span data-stu-id="11e0a-105">First, declare an instance of the attribute you want to retrieve.</span></span> <span data-ttu-id="11e0a-106">Usare quindi il metodo <xref:System.Attribute.GetCustomAttribute%2A?displayProperty=nameWithType> per inizializzare il nuovo attributo per il valore dell'attributo da recuperare.</span><span class="sxs-lookup"><span data-stu-id="11e0a-106">Then, use the <xref:System.Attribute.GetCustomAttribute%2A?displayProperty=nameWithType> method to initialize the new attribute to the value of the attribute you want to retrieve.</span></span> <span data-ttu-id="11e0a-107">Dopo avere inizializzato il nuovo attributo, è sufficiente usarne le proprietà per ottenere i valori.</span><span class="sxs-lookup"><span data-stu-id="11e0a-107">Once the new attribute is initialized, you simply use its properties to get the values.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="11e0a-108">Questo argomento descrive come recuperare gli attributi personalizzati per il codice caricato nel contesto di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="11e0a-108">This topic describes how to retrieve attributes for code loaded into the execution context.</span></span> <span data-ttu-id="11e0a-109">Per recuperare gli attributi per il codice caricato nel contesto di sola reflection, è necessario usare la classe <xref:System.Reflection.CustomAttributeData>, come illustrato in [Procedura: Caricare assembly nel contesto Reflection-Only](../../framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).</span><span class="sxs-lookup"><span data-stu-id="11e0a-109">To retrieve attributes for code loaded into the reflection-only context, you must use the <xref:System.Reflection.CustomAttributeData> class, as shown in [How to: Load Assemblies into the Reflection-Only Context](../../framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).</span></span>  
  
 <span data-ttu-id="11e0a-110">Questa sezione descrive i modi seguenti per recuperare gli attributi:</span><span class="sxs-lookup"><span data-stu-id="11e0a-110">This section describes the following ways to retrieve attributes:</span></span>  
  
- [<span data-ttu-id="11e0a-111">Recupero di una singola istanza di un attributo</span><span class="sxs-lookup"><span data-stu-id="11e0a-111">Retrieving a single instance of an attribute</span></span>](#cpconretrievingsingleinstanceofattribute)  
  
- [<span data-ttu-id="11e0a-112">Recupero di più istanze di un attributo applicate allo stesso ambito</span><span class="sxs-lookup"><span data-stu-id="11e0a-112">Retrieving multiple instances of an attribute applied to the same scope</span></span>](#cpconretrievingmultipleinstancesofattributeappliedtosamescope)  
  
- [<span data-ttu-id="11e0a-113">Recupero di più istanze di un attributo applicate a ambiti diversi</span><span class="sxs-lookup"><span data-stu-id="11e0a-113">Retrieving multiple instances of an attribute applied to different scopes</span></span>](#cpconretrievingmultipleinstancesofattributeappliedtodifferentscopes)  
  
<a name="cpconretrievingsingleinstanceofattribute"></a>
## <a name="retrieving-a-single-instance-of-an-attribute"></a><span data-ttu-id="11e0a-114">Recupero di una singola istanza di un attributo</span><span class="sxs-lookup"><span data-stu-id="11e0a-114">Retrieving a Single Instance of an Attribute</span></span>  
 <span data-ttu-id="11e0a-115">Nell'esempio seguente `DeveloperAttribute` (descritto nella sezione precedente) viene applicato alla classe `MainApp` a livello di classe.</span><span class="sxs-lookup"><span data-stu-id="11e0a-115">In the following example, the `DeveloperAttribute` (described in the previous section) is applied to the `MainApp` class on the class level.</span></span> <span data-ttu-id="11e0a-116">Il `GetAttribute` metodo usa **GetCustomAttribute** per recuperare i valori archiviati in `DeveloperAttribute` a livello di classe prima di visualizzarli nella console.</span><span class="sxs-lookup"><span data-stu-id="11e0a-116">The `GetAttribute` method uses **GetCustomAttribute** to retrieve the values stored in `DeveloperAttribute` on the class level before displaying them to the console.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#18](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source3.cpp#18)]
 [!code-csharp[Conceptual.Attributes.Usage#18](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source3.cs#18)]
 [!code-vb[Conceptual.Attributes.Usage#18](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source3.vb#18)]  
  
 <span data-ttu-id="11e0a-117">Questo programma visualizza il testo seguente quando viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="11e0a-117">This program displays the following text when executed.</span></span>  
  
```console  
The Name Attribute is: Joan Smith.  
The Level Attribute is: 42.  
The Reviewed Attribute is: True.  
```  
  
 <span data-ttu-id="11e0a-118">Se l'attributo non viene trovato, il metodo **GetCustomAttribute** inizializza `MyAttribute` per un valore null.</span><span class="sxs-lookup"><span data-stu-id="11e0a-118">If the attribute is not found, the **GetCustomAttribute** method initializes `MyAttribute` to a null value.</span></span> <span data-ttu-id="11e0a-119">Questo esempio cerca tale istanza in `MyAttribute` e informa l'utente se non vengono trovati attributi.</span><span class="sxs-lookup"><span data-stu-id="11e0a-119">This example checks `MyAttribute` for such an instance and notifies the user if no attribute is found.</span></span> <span data-ttu-id="11e0a-120">Se `DeveloperAttribute` non viene trovato nell'ambito della classe, viene visualizzato il messaggio seguente nella console.</span><span class="sxs-lookup"><span data-stu-id="11e0a-120">If the `DeveloperAttribute` is not found in the class scope, the following message displays to the console.</span></span>  
  
```console  
The attribute was not found.
```  
  
 <span data-ttu-id="11e0a-121">Questo esempio presuppone che la definizione dell'attributo sia nello spazio dei nomi corrente.</span><span class="sxs-lookup"><span data-stu-id="11e0a-121">This example assumes that the attribute definition is in the current namespace.</span></span> <span data-ttu-id="11e0a-122">Ricordare di importare lo spazio dei nomi in cui si trova la definizione dell'attributo se non è inclusa nello spazio dei nomi corrente.</span><span class="sxs-lookup"><span data-stu-id="11e0a-122">Remember to import the namespace in which the attribute definition resides if it is not in the current namespace.</span></span>  
  
<a name="cpconretrievingmultipleinstancesofattributeappliedtosamescope"></a>
## <a name="retrieving-multiple-instances-of-an-attribute-applied-to-the-same-scope"></a><span data-ttu-id="11e0a-123">Recupero di più istanze di un attributo applicate allo stesso ambito</span><span class="sxs-lookup"><span data-stu-id="11e0a-123">Retrieving Multiple Instances of an Attribute Applied to the Same Scope</span></span>  
 <span data-ttu-id="11e0a-124">Nell'esempio precedente la classe da analizzare e l'attributo specifico da trovare vengono passati a <xref:System.Attribute.GetCustomAttribute%2A>.</span><span class="sxs-lookup"><span data-stu-id="11e0a-124">In the previous example, the class to inspect and the specific attribute to find are passed to <xref:System.Attribute.GetCustomAttribute%2A>.</span></span> <span data-ttu-id="11e0a-125">Tale codice funziona correttamente solo se un'istanza di un attributo viene applicata a livello di classe.</span><span class="sxs-lookup"><span data-stu-id="11e0a-125">That code works well if only one instance of an attribute is applied on the class level.</span></span> <span data-ttu-id="11e0a-126">Se tuttavia più istanze di un attributo vengono applicate allo stesso livello di classe, il metodo **GetCustomAttribute** non recupera tutte le informazioni.</span><span class="sxs-lookup"><span data-stu-id="11e0a-126">However, if multiple instances of an attribute are applied on the same class level, the **GetCustomAttribute** method does not retrieve all the information.</span></span> <span data-ttu-id="11e0a-127">Nei casi in cui più istanze dello stesso attributo vengono applicate allo stesso ambito, è possibile usare <xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType> per inserire tutte le istanze di un attributo in una matrice.</span><span class="sxs-lookup"><span data-stu-id="11e0a-127">In cases where multiple instances of the same attribute are applied to the same scope, you can use <xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType> to place all instances of an attribute into an array.</span></span> <span data-ttu-id="11e0a-128">Se ad esempio due istanze di `DeveloperAttribute` vengono applicate a livello di classe della stessa classe, il metodo `GetAttribute` può essere modificato per visualizzare le informazioni trovate in entrambi gli attributi.</span><span class="sxs-lookup"><span data-stu-id="11e0a-128">For example, if two instances of `DeveloperAttribute` are applied on the class level of the same class, the `GetAttribute` method can be modified to display the information found in both attributes.</span></span> <span data-ttu-id="11e0a-129">Si ricordi che, per applicare più attributi allo stesso livello, l'attributo deve essere definito con la proprietà **AllowMultiple** impostata su **true** in <xref:System.AttributeUsageAttribute>.</span><span class="sxs-lookup"><span data-stu-id="11e0a-129">Remember, to apply multiple attributes on the same level, the attribute must be defined with the **AllowMultiple** property set to **true** in the <xref:System.AttributeUsageAttribute>.</span></span>  
  
 <span data-ttu-id="11e0a-130">L'esempio di codice seguente illustra come usare il metodo **GetCustomAttributes** per creare una matrice che fa riferimento a tutte le istanze di `DeveloperAttribute` in una determinata classe.</span><span class="sxs-lookup"><span data-stu-id="11e0a-130">The following code example shows how to use the **GetCustomAttributes** method to create an array that references all instances of `DeveloperAttribute` in any given class.</span></span> <span data-ttu-id="11e0a-131">I valori di tutti gli attributi vengono quindi visualizzati nella console.</span><span class="sxs-lookup"><span data-stu-id="11e0a-131">The values of all attributes are then displayed to the console.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#19](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source3.cpp#19)]
 [!code-csharp[Conceptual.Attributes.Usage#19](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source3.cs#19)]
 [!code-vb[Conceptual.Attributes.Usage#19](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source3.vb#19)]  
  
 <span data-ttu-id="11e0a-132">Se non vengono trovati attributi, questo codice avvisa l'utente.</span><span class="sxs-lookup"><span data-stu-id="11e0a-132">If no attributes are found, this code alerts the user.</span></span> <span data-ttu-id="11e0a-133">In caso contrario, vengono visualizzate le informazioni contenute in entrambe le istanze di `DeveloperAttribute`.</span><span class="sxs-lookup"><span data-stu-id="11e0a-133">Otherwise, the information contained in both instances of `DeveloperAttribute` is displayed.</span></span>  
  
<a name="cpconretrievingmultipleinstancesofattributeappliedtodifferentscopes"></a>
## <a name="retrieving-multiple-instances-of-an-attribute-applied-to-different-scopes"></a><span data-ttu-id="11e0a-134">Recupero di più istanze di un attributo applicate ad ambiti diversi</span><span class="sxs-lookup"><span data-stu-id="11e0a-134">Retrieving Multiple Instances of an Attribute Applied to Different Scopes</span></span>  
 <span data-ttu-id="11e0a-135">I metodi <xref:System.Attribute.GetCustomAttributes%2A> e <xref:System.Attribute.GetCustomAttribute%2A> non eseguono la ricerca in un'intera classe e non restituiscono tutte le istanze di un attributo in tale classe.</span><span class="sxs-lookup"><span data-stu-id="11e0a-135">The <xref:System.Attribute.GetCustomAttributes%2A> and <xref:System.Attribute.GetCustomAttribute%2A> methods do not search an entire class and return all instances of an attribute in that class.</span></span> <span data-ttu-id="11e0a-136">Cercano invece solo un metodo o membro specificato per volta.</span><span class="sxs-lookup"><span data-stu-id="11e0a-136">Rather, they search only one specified method or member at a time.</span></span> <span data-ttu-id="11e0a-137">Se si ha una classe con lo stesso attributo applicato a ogni membro e si vogliono recuperare i valori in tutti gli attributi applicati a tali membri, è necessario fornire ogni metodo o membro singolarmente a **GetCustomAttributes** e \*\* GetCustomAttribute\*\*.</span><span class="sxs-lookup"><span data-stu-id="11e0a-137">If you have a class with the same attribute applied to every member and you want to retrieve the values in all the attributes applied to those members, you must supply every method or member individually to **GetCustomAttributes** and **GetCustomAttribute**.</span></span>  
  
 <span data-ttu-id="11e0a-138">L'esempio di codice seguente accetta una classe come parametro e cerca `DeveloperAttribute` (definito in precedenza) a livello di classe e in ogni singolo metodo di tale classe.</span><span class="sxs-lookup"><span data-stu-id="11e0a-138">The following code example takes a class as a parameter and searches for the `DeveloperAttribute` (defined previously) on the class level and on every individual method of that class.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#20](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source3.cpp#20)]
 [!code-csharp[Conceptual.Attributes.Usage#20](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source3.cs#20)]
 [!code-vb[Conceptual.Attributes.Usage#20](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source3.vb#20)]  
  
 <span data-ttu-id="11e0a-139">Se non vengono trovate istanze di `DeveloperAttribute` al livello di metodo o a livello di classe, il metodo `GetAttribute` notifica all'utente che non sono stati trovati attributi e visualizza il nome del metodo o della classe che non contiene l'attributo.</span><span class="sxs-lookup"><span data-stu-id="11e0a-139">If no instances of the `DeveloperAttribute` are found on the method level or class level, the `GetAttribute` method notifies the user that no attributes were found and displays the name of the method or class that does not contain the attribute.</span></span> <span data-ttu-id="11e0a-140">Se viene trovato un attributo, i campi `Name`, `Level` e `Reviewed` vengono visualizzati nella console.</span><span class="sxs-lookup"><span data-stu-id="11e0a-140">If an attribute is found, the `Name`, `Level`, and `Reviewed` fields are displayed to the console.</span></span>  
  
 <span data-ttu-id="11e0a-141">È possibile usare i membri della classe <xref:System.Type> per ottenere i singoli metodi e membri nella classe passata.</span><span class="sxs-lookup"><span data-stu-id="11e0a-141">You can use the members of the <xref:System.Type> class to get the individual methods and members in the passed class.</span></span> <span data-ttu-id="11e0a-142">Questo esempio esegue prima di tutto una query dell'oggetto **Type** per ottenere informazioni sugli attributi per il livello di classe.</span><span class="sxs-lookup"><span data-stu-id="11e0a-142">This example first queries the **Type** object to get attribute information for the class level.</span></span> <span data-ttu-id="11e0a-143">Usa quindi <xref:System.Type.GetMethods%2A?displayProperty=nameWithType> per inserire le istanze di tutti i metodi in una matrice di oggetti <xref:System.Reflection.MemberInfo?displayProperty=nameWithType> per recuperare informazioni sugli attributi per il livello di metodo.</span><span class="sxs-lookup"><span data-stu-id="11e0a-143">Next, it uses <xref:System.Type.GetMethods%2A?displayProperty=nameWithType> to place instances of all methods into an array of <xref:System.Reflection.MemberInfo?displayProperty=nameWithType> objects to retrieve attribute information for the method level.</span></span> <span data-ttu-id="11e0a-144">È anche possibile usare il metodo <xref:System.Type.GetProperties%2A?displayProperty=nameWithType> per verificare la presenza di attributi a livello di proprietà o <xref:System.Type.GetConstructors%2A?displayProperty=nameWithType> per verificare la presenza di attributi a livello di costruttore.</span><span class="sxs-lookup"><span data-stu-id="11e0a-144">You can also use the <xref:System.Type.GetProperties%2A?displayProperty=nameWithType> method to check for attributes on the property level or <xref:System.Type.GetConstructors%2A?displayProperty=nameWithType> to check for attributes on the constructor level.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="11e0a-145">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="11e0a-145">See also</span></span>

- <xref:System.Type?displayProperty=nameWithType>
- <xref:System.Attribute.GetCustomAttribute%2A?displayProperty=nameWithType>
- <xref:System.Attribute.GetCustomAttributes%2A?displayProperty=nameWithType>
- [<span data-ttu-id="11e0a-146">Attributes (Attributi)</span><span class="sxs-lookup"><span data-stu-id="11e0a-146">Attributes</span></span>](index.md)
