---
title: 'Procedura: Aggiungere funzionalità di delimitazione e blocco a una raccolta'
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- thread-safe collections, custom blocking collections
ms.assetid: 4c2492de-3876-4873-b5a1-000bb404d770
ms.openlocfilehash: 57a01726e897f4ddbf8df5ede53609c198012d80
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287874"
---
# <a name="how-to-add-bounding-and-blocking-functionality-to-a-collection"></a><span data-ttu-id="6a53e-102">Procedura: Aggiungere funzionalità di delimitazione e blocco a una raccolta</span><span class="sxs-lookup"><span data-stu-id="6a53e-102">How to: Add Bounding and Blocking Functionality to a Collection</span></span>
<span data-ttu-id="6a53e-103">Questo esempio illustra come aggiungere la funzionalità di delimitazione e blocco a una classe di raccolta personalizzata implementando l'interfaccia <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> nella classe e successivamente usando un'istanza della classe come meccanismo di archiviazione interno per un oggetto <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6a53e-103">This example shows how to add bounding and blocking functionality to a custom collection class by implementing the <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> interface in the class, and then using a class instance as the internal storage mechanism for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="6a53e-104">Per altre informazioni su delimitazione e blocco, vedere [Panoramica di BlockingCollection](blockingcollection-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6a53e-104">For more information about bounding and blocking, see [BlockingCollection Overview](blockingcollection-overview.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="6a53e-105">Esempio</span><span class="sxs-lookup"><span data-stu-id="6a53e-105">Example</span></span>  
 <span data-ttu-id="6a53e-106">La classe di raccolta personalizzata è una coda di priorità di base in cui i livelli di priorità sono rappresentati come matrice di oggetti <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6a53e-106">The custom collection class is a basic priority queue in which the priority levels are represented as an array of <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType> objects.</span></span> <span data-ttu-id="6a53e-107">Nessun ordinamento aggiuntivo viene eseguito all'interno di ogni coda.</span><span class="sxs-lookup"><span data-stu-id="6a53e-107">No additional ordering is performed within each queue.</span></span>  
  
 <span data-ttu-id="6a53e-108">Nel codice client vengono avviate tre attività.</span><span class="sxs-lookup"><span data-stu-id="6a53e-108">In the client code, three tasks are started.</span></span> <span data-ttu-id="6a53e-109">La prima attività esegue il polling per le sequenze di tasti che abilitano l'annullamento in qualsiasi momento durante l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="6a53e-109">The first task just polls for keyboard strokes to enable cancellation at any point during execution.</span></span> <span data-ttu-id="6a53e-110">La seconda attività è il thread producer. Aggiunge nuovi elementi alla raccolta di blocco e assegna a ogni elemento una priorità basata su un valore casuale.</span><span class="sxs-lookup"><span data-stu-id="6a53e-110">The second task is the producer thread; it adds new items to the blocking collection and gives each item a priority based on a random value.</span></span> <span data-ttu-id="6a53e-111">La terza attività rimuove gli elementi dalla raccolta appena diventano disponibili.</span><span class="sxs-lookup"><span data-stu-id="6a53e-111">The third task removes items from the collection as they become available.</span></span>  
  
 <span data-ttu-id="6a53e-112">È possibile modificare il comportamento dell'applicazione rendendo uno dei thread più veloce rispetto all'altro.</span><span class="sxs-lookup"><span data-stu-id="6a53e-112">You can adjust the behavior of the application by making one of the threads run faster than the other.</span></span> <span data-ttu-id="6a53e-113">Se il producer viene eseguito più velocemente, si noterà la funzionalità di delimitazione perché la raccolta di blocco impedisce l'aggiunta di elementi se contiene già il numero di elementi specificato nel costruttore.</span><span class="sxs-lookup"><span data-stu-id="6a53e-113">If the producer runs faster, you will notice the bounding functionality as the blocking collection prevents items from being added if it already contains the number of items that is specified in the constructor.</span></span> <span data-ttu-id="6a53e-114">Se il consumer viene eseguito più velocemente, si noterà la funzionalità di blocco perché il consumer aspetta che un nuovo elemento venga aggiunto.</span><span class="sxs-lookup"><span data-stu-id="6a53e-114">If the consumer runs faster, you will notice the blocking functionality as the consumer waits for a new item to be added.</span></span>  
  
 [!code-csharp[CDS_BlockingCollection#06](../../../../samples/snippets/csharp/VS_Snippets_Misc/cds_blockingcollection/cs/prodcon.cs#06)]  
  
 <span data-ttu-id="6a53e-115">Per impostazione predefinita, l'archiviazione per un oggetto <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> è <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6a53e-115">By default, the storage for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> is <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6a53e-116">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6a53e-116">See also</span></span>

- [<span data-ttu-id="6a53e-117">Raccolte thread-safe</span><span class="sxs-lookup"><span data-stu-id="6a53e-117">Thread-Safe Collections</span></span>](index.md)
