---
title: Selezione di una classe Collection
ms.date: 03/18/2019
ms.technology: dotnet-standard
helpviewer_keywords:
- last-in-first-out collections
- first-in-first-out collections
- collections [.NET Framework], selecting collection class
- indexed collections
- Collections classes
- grouping data in collections, selecting collection class
ms.assetid: ba049f9a-ce87-4cc4-b319-3f75c8ddac8a
ms.openlocfilehash: 621d64183c1cacc14c2d432e4eef43f4d3ba5474
ms.sourcegitcommit: 961ec21c22d2f1d55c9cc8a7edf2ade1d1fd92e3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/02/2020
ms.locfileid: "80588318"
---
# <a name="selecting-a-collection-class"></a><span data-ttu-id="a2518-102">Selezione di una classe Collection</span><span class="sxs-lookup"><span data-stu-id="a2518-102">Selecting a Collection Class</span></span>

<span data-ttu-id="a2518-103">Assicurarsi di scegliere con attenzione la classe Collection,</span><span class="sxs-lookup"><span data-stu-id="a2518-103">Be sure to choose your collection class carefully.</span></span> <span data-ttu-id="a2518-104">poiché l'uso del tipo errato può limitare l'uso della raccolta.</span><span class="sxs-lookup"><span data-stu-id="a2518-104">Using the wrong type can restrict your use of the collection.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="a2518-105">Evitare l'uso dei tipi nello spazio dei nomi <xref:System.Collections>.</span><span class="sxs-lookup"><span data-stu-id="a2518-105">Avoid using the types in the <xref:System.Collections> namespace.</span></span> <span data-ttu-id="a2518-106">È consigliabile usare le versioni generiche e simultanee delle raccolte per via di una maggiore indipendenza dai tipi e di altri miglioramenti.</span><span class="sxs-lookup"><span data-stu-id="a2518-106">The generic and concurrent versions of the collections are recommended because of their greater type safety and other improvements.</span></span>  

 <span data-ttu-id="a2518-107">Prendere in considerazione le domande seguenti:</span><span class="sxs-lookup"><span data-stu-id="a2518-107">Consider the following questions:</span></span>  
  
- <span data-ttu-id="a2518-108">È necessario un elenco sequenziale quando l'elemento viene in genere eliminato dopo che il valore è stato recuperato?</span><span class="sxs-lookup"><span data-stu-id="a2518-108">Do you need a sequential list where the element is typically discarded after its value is retrieved?</span></span>  
  
  - <span data-ttu-id="a2518-109">Se la risposta è affermativa ed è necessario un comportamento FIFO (First In First Out), considerare l'uso della classe <xref:System.Collections.Queue> o della classe generica <xref:System.Collections.Generic.Queue%601>.</span><span class="sxs-lookup"><span data-stu-id="a2518-109">If yes, consider using the <xref:System.Collections.Queue> class or the <xref:System.Collections.Generic.Queue%601> generic class if you need first-in, first-out (FIFO) behavior.</span></span> <span data-ttu-id="a2518-110">Se è necessario un comportamento LIFO (Last In First Out), considerare l'uso della classe <xref:System.Collections.Stack> o della classe generica <xref:System.Collections.Generic.Stack%601>.</span><span class="sxs-lookup"><span data-stu-id="a2518-110">Consider using the <xref:System.Collections.Stack> class or the <xref:System.Collections.Generic.Stack%601> generic class if you need last-in, first-out (LIFO) behavior.</span></span> <span data-ttu-id="a2518-111">Per un accesso sicuro da più thread, usare le versioni simultanee <xref:System.Collections.Concurrent.ConcurrentQueue%601> e <xref:System.Collections.Concurrent.ConcurrentStack%601>.</span><span class="sxs-lookup"><span data-stu-id="a2518-111">For safe access from multiple threads, use the concurrent versions, <xref:System.Collections.Concurrent.ConcurrentQueue%601> and <xref:System.Collections.Concurrent.ConcurrentStack%601>.</span></span>  
  
  - <span data-ttu-id="a2518-112">Se la risposta è negativa, è opportuno usare le altre raccolte.</span><span class="sxs-lookup"><span data-stu-id="a2518-112">If not, consider using the other collections.</span></span>  
  
- <span data-ttu-id="a2518-113">È necessario accedere agli elementi in un determinato ordine, ad esempio FIFO, LIFO o casuale?</span><span class="sxs-lookup"><span data-stu-id="a2518-113">Do you need to access the elements in a certain order, such as FIFO, LIFO, or random?</span></span>  
  
  - <span data-ttu-id="a2518-114">La classe <xref:System.Collections.Queue> e la classe generica <xref:System.Collections.Generic.Queue%601> o <xref:System.Collections.Concurrent.ConcurrentQueue%601> consentono l'accesso FIFO.</span><span class="sxs-lookup"><span data-stu-id="a2518-114">The <xref:System.Collections.Queue> class and the <xref:System.Collections.Generic.Queue%601> or <xref:System.Collections.Concurrent.ConcurrentQueue%601> generic class offer FIFO access.</span></span> <span data-ttu-id="a2518-115">Per altre informazioni, vedere [When to Use a Thread-Safe Collection](../../../docs/standard/collections/thread-safe/when-to-use-a-thread-safe-collection.md) (Quando usare una raccolta thread-safe).</span><span class="sxs-lookup"><span data-stu-id="a2518-115">For more information, see [When to Use a Thread-Safe Collection](../../../docs/standard/collections/thread-safe/when-to-use-a-thread-safe-collection.md).</span></span>  
  
  - <span data-ttu-id="a2518-116">La classe <xref:System.Collections.Stack> e la classe generica <xref:System.Collections.Generic.Stack%601> o <xref:System.Collections.Concurrent.ConcurrentStack%601> consentono l'accesso LIFO.</span><span class="sxs-lookup"><span data-stu-id="a2518-116">The <xref:System.Collections.Stack> class and the <xref:System.Collections.Generic.Stack%601> or <xref:System.Collections.Concurrent.ConcurrentStack%601> generic class offer LIFO access.</span></span> <span data-ttu-id="a2518-117">Per altre informazioni, vedere [When to Use a Thread-Safe Collection](../../../docs/standard/collections/thread-safe/when-to-use-a-thread-safe-collection.md) (Quando usare una raccolta thread-safe).</span><span class="sxs-lookup"><span data-stu-id="a2518-117">For more information, see [When to Use a Thread-Safe Collection](../../../docs/standard/collections/thread-safe/when-to-use-a-thread-safe-collection.md).</span></span>  
  
  - <span data-ttu-id="a2518-118">La classe generica <xref:System.Collections.Generic.LinkedList%601> consente l'accesso sequenziale dall'inizio alla fine o viceversa.</span><span class="sxs-lookup"><span data-stu-id="a2518-118">The <xref:System.Collections.Generic.LinkedList%601> generic class allows sequential access either from the head to the tail, or from the tail to the head.</span></span>  
  
- <span data-ttu-id="a2518-119">È necessario accedere a ciascun elemento tramite l'indice?</span><span class="sxs-lookup"><span data-stu-id="a2518-119">Do you need to access each element by index?</span></span>  
  
  - <span data-ttu-id="a2518-120">Le classi <xref:System.Collections.ArrayList> e <xref:System.Collections.Specialized.StringCollection> e la classe generica <xref:System.Collections.Generic.List%601> consentono l'accesso ai relativi elementi tramite l'indice in base zero dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="a2518-120">The <xref:System.Collections.ArrayList> and <xref:System.Collections.Specialized.StringCollection> classes and the <xref:System.Collections.Generic.List%601> generic class offer access to their elements by the zero-based index of the element.</span></span>  
  
  - <span data-ttu-id="a2518-121">Le classi <xref:System.Collections.Hashtable>, <xref:System.Collections.SortedList>, <xref:System.Collections.Specialized.ListDictionary> e <xref:System.Collections.Specialized.StringDictionary> e le classi generiche <xref:System.Collections.Generic.Dictionary%602> e <xref:System.Collections.Generic.SortedDictionary%602> consentono l'accesso ai relativi elementi tramite la chiave dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="a2518-121">The <xref:System.Collections.Hashtable>, <xref:System.Collections.SortedList>, <xref:System.Collections.Specialized.ListDictionary>, and <xref:System.Collections.Specialized.StringDictionary> classes, and the <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Generic.SortedDictionary%602> generic classes offer access to their elements by the key of the element.</span></span>  
  
  - <span data-ttu-id="a2518-122">Le classi <xref:System.Collections.Specialized.NameObjectCollectionBase> e <xref:System.Collections.Specialized.NameValueCollection> e le classi generiche <xref:System.Collections.ObjectModel.KeyedCollection%602> e <xref:System.Collections.Generic.SortedList%602> consentono l'accesso ai relativi elementi tramite l'indice in base zero o la chiave dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="a2518-122">The <xref:System.Collections.Specialized.NameObjectCollectionBase> and <xref:System.Collections.Specialized.NameValueCollection> classes, and the <xref:System.Collections.ObjectModel.KeyedCollection%602> and <xref:System.Collections.Generic.SortedList%602> generic classes offer access to their elements by either the zero-based index or the key of the element.</span></span>  
  
- <span data-ttu-id="a2518-123">Ogni elemento contiene un valore, una combinazione di una chiave e un valore o una combinazione di una chiave e più valori?</span><span class="sxs-lookup"><span data-stu-id="a2518-123">Will each element contain one value, a combination of one key and one value, or a combination of one key and multiple values?</span></span>  
  
  - <span data-ttu-id="a2518-124">Un valore: usare una qualsiasi raccolta basata sull'interfaccia <xref:System.Collections.IList> o sull'interfaccia generica <xref:System.Collections.Generic.IList%601>.</span><span class="sxs-lookup"><span data-stu-id="a2518-124">One value: Use any of the collections based on the <xref:System.Collections.IList> interface or the <xref:System.Collections.Generic.IList%601> generic interface.</span></span>  
  
  - <span data-ttu-id="a2518-125">Una chiave e un valore: usare una qualsiasi raccolta basata sull'interfaccia <xref:System.Collections.IDictionary> o sull'interfaccia generica <xref:System.Collections.Generic.IDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="a2518-125">One key and one value: Use any of the collections based on the <xref:System.Collections.IDictionary> interface or the <xref:System.Collections.Generic.IDictionary%602> generic interface.</span></span>  
  
  - <span data-ttu-id="a2518-126">Un valore con chiave incorporata: usare la classe generica <xref:System.Collections.ObjectModel.KeyedCollection%602>.</span><span class="sxs-lookup"><span data-stu-id="a2518-126">One value with embedded key: Use the <xref:System.Collections.ObjectModel.KeyedCollection%602> generic class.</span></span>  
  
  - <span data-ttu-id="a2518-127">Una chiave e più valori: usare la classe <xref:System.Collections.Specialized.NameValueCollection>.</span><span class="sxs-lookup"><span data-stu-id="a2518-127">One key and multiple values: Use the <xref:System.Collections.Specialized.NameValueCollection> class.</span></span>  
  
- <span data-ttu-id="a2518-128">È necessario ordinare gli elementi in modo diverso da come sono stati immessi?</span><span class="sxs-lookup"><span data-stu-id="a2518-128">Do you need to sort the elements differently from how they were entered?</span></span>  
  
  - <span data-ttu-id="a2518-129">Gli elementi della classe <xref:System.Collections.Hashtable> vengono ordinati in base ai rispettivi codici hash.</span><span class="sxs-lookup"><span data-stu-id="a2518-129">The <xref:System.Collections.Hashtable> class sorts its elements by their hash codes.</span></span>  
  
  - <span data-ttu-id="a2518-130">La classe <xref:System.Collections.SortedList> e le classi generiche <xref:System.Collections.Generic.SortedList%602> e <xref:System.Collections.Generic.SortedDictionary%602> ordinano i relativi elementi in base alla chiave.</span><span class="sxs-lookup"><span data-stu-id="a2518-130">The <xref:System.Collections.SortedList> class, and the <xref:System.Collections.Generic.SortedList%602> and <xref:System.Collections.Generic.SortedDictionary%602> generic classes sort their elements by the key.</span></span> <span data-ttu-id="a2518-131">L'ordinamento è basato sull'implementazione dell'interfaccia <xref:System.Collections.IComparer> per la classe <xref:System.Collections.SortedList> e sull'implementazione dell'interfaccia generica <xref:System.Collections.Generic.IComparer%601> per le classi generiche <xref:System.Collections.Generic.SortedList%602> e <xref:System.Collections.Generic.SortedDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="a2518-131">The sort order is based on the implementation of the <xref:System.Collections.IComparer> interface for the <xref:System.Collections.SortedList> class and on the implementation of the <xref:System.Collections.Generic.IComparer%601> generic interface for the <xref:System.Collections.Generic.SortedList%602> and <xref:System.Collections.Generic.SortedDictionary%602> generic classes.</span></span> <span data-ttu-id="a2518-132">Dei due tipi generici, <xref:System.Collections.Generic.SortedDictionary%602> offre prestazioni migliori di <xref:System.Collections.Generic.SortedList%602>, mentre <xref:System.Collections.Generic.SortedList%602> utilizza meno memoria.</span><span class="sxs-lookup"><span data-stu-id="a2518-132">Of the two generic types, <xref:System.Collections.Generic.SortedDictionary%602> offers better performance than <xref:System.Collections.Generic.SortedList%602>, while <xref:System.Collections.Generic.SortedList%602> consumes less memory.</span></span>  
  
  - <span data-ttu-id="a2518-133"><xref:System.Collections.ArrayList> fornisce un metodo <xref:System.Collections.ArrayList.Sort%2A> che accetta come parametro un'implementazione di <xref:System.Collections.IComparer>.</span><span class="sxs-lookup"><span data-stu-id="a2518-133"><xref:System.Collections.ArrayList> provides a <xref:System.Collections.ArrayList.Sort%2A> method that takes an <xref:System.Collections.IComparer> implementation as a parameter.</span></span> <span data-ttu-id="a2518-134">La relativa controparte generica, ossia la classe <xref:System.Collections.Generic.List%601>, fornisce un metodo <xref:System.Collections.Generic.List%601.Sort%2A> che accetta come parametro un'implementazione dell'interfaccia generica <xref:System.Collections.Generic.IComparer%601>.</span><span class="sxs-lookup"><span data-stu-id="a2518-134">Its generic counterpart, the <xref:System.Collections.Generic.List%601> generic class, provides a <xref:System.Collections.Generic.List%601.Sort%2A> method that takes an implementation of the <xref:System.Collections.Generic.IComparer%601> generic interface as a parameter.</span></span>  
  
- <span data-ttu-id="a2518-135">Sono necessarie le ricerche veloci e il recupero di informazioni?</span><span class="sxs-lookup"><span data-stu-id="a2518-135">Do you need fast searches and retrieval of information?</span></span>  
  
  - <span data-ttu-id="a2518-136"><xref:System.Collections.Specialized.ListDictionary> è più veloce di <xref:System.Collections.Hashtable> per le raccolte che non superano le 10 voci.</span><span class="sxs-lookup"><span data-stu-id="a2518-136"><xref:System.Collections.Specialized.ListDictionary> is faster than <xref:System.Collections.Hashtable> for small collections (10 items or fewer).</span></span> <span data-ttu-id="a2518-137">La classe generica <xref:System.Collections.Generic.Dictionary%602> consente ricerche più veloci rispetto alla classe generica <xref:System.Collections.Generic.SortedDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="a2518-137">The <xref:System.Collections.Generic.Dictionary%602> generic class provides faster lookup than the <xref:System.Collections.Generic.SortedDictionary%602> generic class.</span></span> <span data-ttu-id="a2518-138">L'implementazione multithreading è <xref:System.Collections.Concurrent.ConcurrentDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="a2518-138">The multi-threaded implementation is <xref:System.Collections.Concurrent.ConcurrentDictionary%602>.</span></span> <span data-ttu-id="a2518-139"><xref:System.Collections.Concurrent.ConcurrentBag%601> fornisce un inserimento multithreading veloce per i dati non ordinati.</span><span class="sxs-lookup"><span data-stu-id="a2518-139"><xref:System.Collections.Concurrent.ConcurrentBag%601> provides fast multi-threaded insertion for unordered data.</span></span> <span data-ttu-id="a2518-140">Per altre informazioni su entrambi i tipi di multithread, vedere [Quando usare una raccolta thread-safe](../../../docs/standard/collections/thread-safe/when-to-use-a-thread-safe-collection.md).</span><span class="sxs-lookup"><span data-stu-id="a2518-140">For more information about both multi-threaded types, see [When to Use a Thread-Safe Collection](../../../docs/standard/collections/thread-safe/when-to-use-a-thread-safe-collection.md).</span></span>  
  
- <span data-ttu-id="a2518-141">Sono necessarie raccolte che accettano solo stringhe?</span><span class="sxs-lookup"><span data-stu-id="a2518-141">Do you need collections that accept only strings?</span></span>  
  
  - <span data-ttu-id="a2518-142">La classe <xref:System.Collections.Specialized.StringCollection> (basata su <xref:System.Collections.IList>) e la classe <xref:System.Collections.Specialized.StringDictionary> (basata su <xref:System.Collections.IDictionary>) sono incluse nello spazio dei nomi <xref:System.Collections.Specialized>.</span><span class="sxs-lookup"><span data-stu-id="a2518-142"><xref:System.Collections.Specialized.StringCollection> (based on <xref:System.Collections.IList>) and <xref:System.Collections.Specialized.StringDictionary> (based on <xref:System.Collections.IDictionary>) are in the <xref:System.Collections.Specialized> namespace.</span></span>  
  
  - <span data-ttu-id="a2518-143">È anche possibile usare una qualsiasi classe di raccolte generiche nello spazio dei nomi <xref:System.Collections.Generic> come raccolte di stringhe fortemente tipizzate specificando la classe <xref:System.String> per i relativi argomenti di tipo generico.</span><span class="sxs-lookup"><span data-stu-id="a2518-143">In addition, you can use any of the generic collection classes in the <xref:System.Collections.Generic> namespace as strongly typed string collections by specifying the <xref:System.String> class for their generic type arguments.</span></span> <span data-ttu-id="a2518-144">Ad esempio, è possibile dichiarare una variabile di tipo [List\<String>](xref:System.Collections.Generic.List%601) o [Dictionary<String,String>](xref:System.Collections.Generic.Dictionary%602).</span><span class="sxs-lookup"><span data-stu-id="a2518-144">For example, you can declare a variable to be of type [List\<String>](xref:System.Collections.Generic.List%601) or [Dictionary<String,String>](xref:System.Collections.Generic.Dictionary%602).</span></span>
  
## <a name="linq-to-objects-and-plinq"></a><span data-ttu-id="a2518-145">LINQ to Objects e PLINQ</span><span class="sxs-lookup"><span data-stu-id="a2518-145">LINQ to Objects and PLINQ</span></span>  
 <span data-ttu-id="a2518-146">LINQ to Objects permette agli sviluppatori di usare le query LINQ per accedere agli oggetti in memoria, a condizione che il tipo dell'oggetto implementi <xref:System.Collections.IEnumerable> o <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="a2518-146">LINQ to Objects enables developers to use LINQ queries to access in-memory objects as long as the object type implements <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601>.</span></span> <span data-ttu-id="a2518-147">Le query LINQ forniscono un modello comune per l'accesso ai dati, sono in genere più concise e leggibili dei cicli `foreach` standard e forniscono funzionalità di filtro, ordinamento e raggruppamento.</span><span class="sxs-lookup"><span data-stu-id="a2518-147">LINQ queries provide a common pattern for accessing data, are typically more concise and readable than standard `foreach` loops, and provide filtering, ordering, and grouping capabilities.</span></span> <span data-ttu-id="a2518-148">Per altre informazioni, vedere [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md) e [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md).</span><span class="sxs-lookup"><span data-stu-id="a2518-148">For more information, see [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md) and [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md).</span></span>  
  
 <span data-ttu-id="a2518-149">PLINQ fornisce un'implementazione parallela di LINQ to Objects in grado di offrire un'esecuzione più rapida delle query in molti scenari, grazie a un uso più efficiente dei computer multicore.</span><span class="sxs-lookup"><span data-stu-id="a2518-149">PLINQ provides a parallel implementation of LINQ to Objects that can offer faster query execution in many scenarios, through more efficient use of multi-core computers.</span></span> <span data-ttu-id="a2518-150">Per altre informazioni, vedere [Parallel LINQ (PLINQ)](../../../docs/standard/parallel-programming/introduction-to-plinq.md).</span><span class="sxs-lookup"><span data-stu-id="a2518-150">For more information, see [Parallel LINQ (PLINQ)](../../../docs/standard/parallel-programming/introduction-to-plinq.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a2518-151">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a2518-151">See also</span></span>

- <xref:System.Collections>
- <xref:System.Collections.Specialized>
- <xref:System.Collections.Generic>
- [<span data-ttu-id="a2518-152">Raccolte thread-safe</span><span class="sxs-lookup"><span data-stu-id="a2518-152">Thread-Safe Collections</span></span>](../../../docs/standard/collections/thread-safe/index.md)
