---
title: Raccolta comunità compensata tra workstation e server
description: Informazioni su operazioni di Garbage Collection per workstation e server in .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 6b8e5f6802e5d44669b95d43d4e897fa4a418512
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2020
ms.locfileid: "82103555"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="0f6fc-103">Operazione di Garbage Collection per workstation e server</span><span class="sxs-lookup"><span data-stu-id="0f6fc-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="0f6fc-104">Il Garbage Collector si regola da sé e può funzionare in un'ampia varietà di scenari.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="0f6fc-105">Tuttavia, è possibile [impostare il tipo di Garbage Collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) in base alle caratteristiche del carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="0f6fc-106">CLR fornisce i seguenti tipi di Garbage Collection:</span><span class="sxs-lookup"><span data-stu-id="0f6fc-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="0f6fc-107">Garbage Collection per workstation (GC), progettato per le app client.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="0f6fc-108">È la versione GC predefinita per le app autonome.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="0f6fc-109">Per le app ospitate, ad esempio quelle ospitate da ASP.NET, l'host determina la versione GC predefinita.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="0f6fc-110">Le operazioni di Garbage Collection per workstation possono essere eseguite in modalità simultanea o non simultanea.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="0f6fc-111">La procedura di Garbage Collection simultanea (o *in background)* consente ai thread gestiti di continuare le operazioni durante un'operazione di Garbage Collection.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="0f6fc-112">[L'operazione di Garbage Collection](background-gc.md) in background sostituisce la [garbage collection simultanea](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="0f6fc-113">Garbage Collection per server, per le applicazioni server che richiedono scalabilità e velocità effettiva elevata.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="0f6fc-114">In .NET Core la procedura di Garbage Collection per server può essere non simultanea o in background.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="0f6fc-115">In .NET Framework 4.5 e versioni successive, la procedura di Garbage Collection per server può essere non simultanea o in background.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="0f6fc-116">In .NET Framework 4 e versioni precedenti, la procedura di Garbage Collection per server non è simultanea.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="0f6fc-117">Nella figura seguente vengono illustrati i thread dedicati che eseguono l'operazione di Garbage Collection in un server:The following illustration shows the dedicated threads that perform the garbage collection on a server:</span><span class="sxs-lookup"><span data-stu-id="0f6fc-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Thread di Garbage Collection server](./media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="0f6fc-119">Considerazioni sulle prestazioni</span><span class="sxs-lookup"><span data-stu-id="0f6fc-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="0f6fc-120">GC workstation</span><span class="sxs-lookup"><span data-stu-id="0f6fc-120">Workstation GC</span></span>

<span data-ttu-id="0f6fc-121">Di seguito sono riportate alcune considerazioni su threading e prestazioni per l'operazione di Garbage Collection per workstation:</span><span class="sxs-lookup"><span data-stu-id="0f6fc-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="0f6fc-122">La raccolta viene eseguita nel thread dell'utente che ha attivato l'operazione di Garbage Collection e mantiene la stessa priorità.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="0f6fc-123">Poiché i thread dell'utente vengono in genere eseguiti con priorità normale, il Garbage Collector (eseguito in un thread con priorità normale) deve competere con altri thread per il tempo CPU.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="0f6fc-124">I thread che eseguono codice nativo non vengono sospesi in caso di Garbage Collection per server o workstation.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="0f6fc-125">La procedura di Garbage Collection per workstation viene sempre utilizzata in un computer che dispone di un solo processore, indipendentemente [dall'impostazione](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver)di configurazione.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver).</span></span>

### <a name="server-gc"></a><span data-ttu-id="0f6fc-126">GC server</span><span class="sxs-lookup"><span data-stu-id="0f6fc-126">Server GC</span></span>

<span data-ttu-id="0f6fc-127">Di seguito sono riportate alcune considerazioni su threading e prestazioni per l'operazione di Garbage Collection per server:</span><span class="sxs-lookup"><span data-stu-id="0f6fc-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="0f6fc-128">La raccolta viene eseguita in più thread dedicati eseguiti con livello di priorità `THREAD_PRIORITY_HIGHEST` .</span><span class="sxs-lookup"><span data-stu-id="0f6fc-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="0f6fc-129">Per ogni CPU vengono forniti un heap e un thread dedicato per l'esecuzione dell'operazione di Garbage Collection. Gli heap vengono raccolti contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="0f6fc-130">Ogni heap contiene un heap degli oggetti piccoli e un heap degli oggetti grandi; è possibile accedere a tutti gli heap tramite codice utente.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="0f6fc-131">Gli oggetti contenuti in heap diversi possono fare riferimento l'un l'altro.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="0f6fc-132">Grazie all'utilizzo congiunto di più thread di Garbage Collection, le operazioni di Garbage Collection per server saranno più veloci delle operazioni per workstation in un heap di pari dimensioni.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="0f6fc-133">I segmenti di Garbage Collection per server sono spesso di dimensioni maggiori.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="0f6fc-134">Tuttavia, questa è solo una generalizzazione: la dimensione del segmento è specifica dell'implementazione ed è soggetta a modifiche.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="0f6fc-135">Non fare supposizioni sulle dimensioni dei segmenti allocati dal Garbage Collector durante l'ottimizzazione dell'app.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="0f6fc-136">Le operazioni di Garbage Collection per server possono richiedere un utilizzo di risorse elevato.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="0f6fc-137">Si supponga, ad esempio, che siano presenti 12 processi che utilizzano il catalogo globale del server in esecuzione in un computer con quattro processori.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="0f6fc-138">Se tutti i processi si verificano per raccogliere spazzatura allo stesso tempo, avrebbero interferire con l'altro, come ci sarebbero 12 thread pianificati sullo stesso processore.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="0f6fc-139">Se i processi sono attivi, non è una buona idea che tutti utilizzino il catalogo globale del server.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="0f6fc-140">Se si eseguono centinaia di istanze di un'applicazione, prendere in considerazione l'utilizzo di Garbage Collection per workstation con l'operazione di Garbage Collection simultanea disabilitata.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="0f6fc-141">Si avranno meno cambi di contesto e un possibile miglioramento delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="0f6fc-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="0f6fc-142">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0f6fc-142">See also</span></span>

- [<span data-ttu-id="0f6fc-143">Garbage Collection in background</span><span class="sxs-lookup"><span data-stu-id="0f6fc-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="0f6fc-144">Opzioni di configurazione in fase di esecuzione per la procedura di Garbage CollectionRun-time configuration options for garbage collection</span><span class="sxs-lookup"><span data-stu-id="0f6fc-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
