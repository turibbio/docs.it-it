---
title: Convalida di un documento XML nel DOM
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
- cpp
ms.assetid: 2c61c920-d0f8-4c72-bfcc-6524570f3060
ms.openlocfilehash: 93686ddf1afff76926e77acdbf5aa58e93d6cb77
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/07/2020
ms.locfileid: "75710037"
---
# <a name="validating-an-xml-document-in-the-dom"></a><span data-ttu-id="fe7d5-102">Convalida di un documento XML nel DOM</span><span class="sxs-lookup"><span data-stu-id="fe7d5-102">Validating an XML Document in the DOM</span></span>

<span data-ttu-id="fe7d5-103">La classe <xref:System.Xml.XmlDocument> non esegue la convalida del codice XML nel DOM (Document Object Model) in base a uno schema XSD (XML Schema Definition Language) o a una DTD (Document Type Definition) per impostazione predefinita. Viene solo verificato che il codice XML sia ben formato.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-103">The<xref:System.Xml.XmlDocument> class does not validate the XML in the Document Object Model (DOM) against an XML Schema definition language (XSD) schema or document type definition (DTD) by default; the XML is only verified to be well-formed.</span></span>

<span data-ttu-id="fe7d5-104">Per eseguire la convalida del codice XML nel modello DOM, è possibile convalidare il codice XML durante il caricamento nel DOM passando una convalida dello schema <xref:System.Xml.XmlReader> al metodo <xref:System.Xml.XmlDocument.Load%2A> della classe <xref:System.Xml.XmlDocument> oppure convalidare un documento XML non convalidato in precedenza nel DOM usando il metodo <xref:System.Xml.XmlDocument.Validate%2A> della classe <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-104">To validate the XML in the DOM, you can validate the XML as it is loaded into the DOM by passing a schema-validating <xref:System.Xml.XmlReader> to the <xref:System.Xml.XmlDocument.Load%2A> method of the <xref:System.Xml.XmlDocument> class, or validate a previously unvalidated XML document in the DOM using the <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class.</span></span>

## <a name="validating-an-xml-document-as-it-is-loaded-into-the-dom"></a><span data-ttu-id="fe7d5-105">Convalida di un documento XML durante il caricamento nel DOM</span><span class="sxs-lookup"><span data-stu-id="fe7d5-105">Validating an XML Document As It Is Loaded into the DOM</span></span>

<span data-ttu-id="fe7d5-106">La classe <xref:System.Xml.XmlDocument> convalida i dati XML durante il caricamento nel DOM quando un <xref:System.Xml.XmlReader> di convalida viene passato al metodo <xref:System.Xml.XmlDocument.Load%2A> della classe <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-106">The <xref:System.Xml.XmlDocument> class validates the XML data as it is loaded into the DOM when a validating <xref:System.Xml.XmlReader> is passed to the <xref:System.Xml.XmlDocument.Load%2A> method of the <xref:System.Xml.XmlDocument> class.</span></span>

<span data-ttu-id="fe7d5-107">Una volta eseguita la convalida, vengono applicati i valori predefiniti dello schema, i valori di testo vengono convertiti in valori di tipo atomic in base alle necessità e le informazioni sui tipi vengono associate agli elementi delle informazioni convalidate.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-107">After successful validation, schema defaults are applied, text values are converted to atomic values as necessary, and type information is associated with validated information items.</span></span> <span data-ttu-id="fe7d5-108">Di conseguenza, i dati XML tipizzati sostituiscono i dati XML in precedenza non tipizzati.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-108">As a result, typed XML data replaces previously untyped XML data.</span></span>

### <a name="creating-an-xml-schema-validating-xmlreader"></a><span data-ttu-id="fe7d5-109">Creazione di un XmlReader di convalida di XML Schema</span><span class="sxs-lookup"><span data-stu-id="fe7d5-109">Creating an XML Schema-Validating XmlReader</span></span>

<span data-ttu-id="fe7d5-110">Per creare un tipo <xref:System.Xml.XmlReader> di convalida di XML Schema, attenersi alla seguente procedura.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-110">To create an XML schema-validating <xref:System.Xml.XmlReader>, follow these steps.</span></span>

1. <span data-ttu-id="fe7d5-111">Creare una nuova istanza di <xref:System.Xml.XmlReaderSettings>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-111">Construct a new <xref:System.Xml.XmlReaderSettings> instance.</span></span>

2. <span data-ttu-id="fe7d5-112">Aggiungere un XML Schema alla proprietà <xref:System.Xml.XmlReaderSettings.Schemas%2A> dell'istanza di <xref:System.Xml.XmlReaderSettings>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-112">Add an XML schema to the <xref:System.Xml.XmlReaderSettings.Schemas%2A> property of the <xref:System.Xml.XmlReaderSettings> instance.</span></span>

3. <span data-ttu-id="fe7d5-113">Specificare `Schema` come proprietà <xref:System.Xml.XmlReaderSettings.ValidationType%2A>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-113">Specify `Schema` as the <xref:System.Xml.XmlReaderSettings.ValidationType%2A>.</span></span>

4. <span data-ttu-id="fe7d5-114">È possibile eventualmente specificare la proprietà <xref:System.Xml.XmlReaderSettings.ValidationFlags%2A> e un evento <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> per gestire gli errori di convalida degli schemi e gli avvisi rilevati durante la convalida.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-114">Optionally specify <xref:System.Xml.XmlReaderSettings.ValidationFlags%2A> and a <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> to handle schema validation errors and warnings encountered during validation.</span></span>

5. <span data-ttu-id="fe7d5-115">Infine, passare l'oggetto <xref:System.Xml.XmlReaderSettings> al metodo <xref:System.Xml.XmlReader.Create%2A> della classe <xref:System.Xml.XmlReader> insieme al documento XML, creando un tipo <xref:System.Xml.XmlReader> di convalida dello schema.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-115">Finally, pass the <xref:System.Xml.XmlReaderSettings> object to the <xref:System.Xml.XmlReader.Create%2A> method of the <xref:System.Xml.XmlReader> class along with the XML document, creating a schema-validating <xref:System.Xml.XmlReader>.</span></span>

### <a name="example"></a><span data-ttu-id="fe7d5-116">Esempio</span><span class="sxs-lookup"><span data-stu-id="fe7d5-116">Example</span></span>

<span data-ttu-id="fe7d5-117">Nell'esempio di codice seguente un tipo <xref:System.Xml.XmlReader> di convalida dello schema esegue la convalida dei dati XML caricati nel DOM.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-117">In the code example that follows, a schema-validating <xref:System.Xml.XmlReader> validates the XML data loaded into the DOM.</span></span> <span data-ttu-id="fe7d5-118">Vengono apportate modifiche non valide al documento XML che viene quindi nuovamente convalidato, determinando errori di convalida dello schema.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-118">Invalid modifications are made to the XML document and the document is then revalidated, causing schema validation errors.</span></span> <span data-ttu-id="fe7d5-119">Infine, uno degli errori viene corretto e quindi una parte del documento XML viene parzialmente convalidata.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-119">Finally, one of the errors is corrected, and then part of the XML document is partially validated.</span></span>

[!code-cpp[XmlDocumentValidation.Load#1](../../../../samples/snippets/cpp/VS_Snippets_Data/XmlDocumentValidation.Load/CPP/XmlDocumentValidationExample.cpp#1)]
[!code-csharp[XmlDocumentValidation.Load#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlDocumentValidation.Load/CS/XmlDocumentValidationExample.cs#1)]
[!code-vb[XmlDocumentValidation.Load#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlDocumentValidation.Load/VB/XmlDocumentValidationExample.vb#1)]

<span data-ttu-id="fe7d5-120">Nell'esempio il file `contosoBooks.xml` viene considerato come input.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-120">The example takes the `contosoBooks.xml` file as input.</span></span>

[!code-xml[XPathXMLExamples#2](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xml#2)]

<span data-ttu-id="fe7d5-121">Nell'esempio il file `contosoBooks.xsd` viene considerato come input.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-121">The example also takes the `contosoBooks.xsd` file as input.</span></span>

[!code-xml[XPathXMLExamples#3](../../../../samples/snippets/xml/VS_Snippets_Data/XPathXMLExamples/XML/contosoBooks.xsd#3)]

<span data-ttu-id="fe7d5-122">Quando si convalidano i dati XML durante il caricamento nel DOM, è necessario prendere in considerazione quanto segue.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-122">Consider the following when validating XML data as it is loaded into the DOM.</span></span>

- <span data-ttu-id="fe7d5-123">Nell'esempio precedente, viene chiamato l'oggetto <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> ogni volta che viene rilevato un tipo non valido.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-123">In the above example, the <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> is called whenever an invalid type is encountered.</span></span> <span data-ttu-id="fe7d5-124">Se non è impostato un oggetto <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> sull'oggetto <xref:System.Xml.XmlReader> di convalida, quando viene chiamato <xref:System.Xml.Schema.XmlSchemaValidationException> viene generata un'eccezione <xref:System.Xml.XmlDocument.Load%2A> se un tipo di attributo o di elemento non corrisponde al tipo specificato nello schema di convalida.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-124">If a <xref:System.Xml.XmlReaderSettings.ValidationEventHandler> is not set on the validating <xref:System.Xml.XmlReader>,an <xref:System.Xml.Schema.XmlSchemaValidationException> is thrown when <xref:System.Xml.XmlDocument.Load%2A> is called if any attribute or element type does not match the corresponding type specified in the validating schema.</span></span>

- <span data-ttu-id="fe7d5-125">Quando un documento XML viene caricato in un oggetto <xref:System.Xml.XmlDocument> con uno schema associato che definisce valori predefiniti, l'oggetto <xref:System.Xml.XmlDocument> tratta tali valori predefiniti come se si trovassero nel documento XML.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-125">When an XML document is loaded into an <xref:System.Xml.XmlDocument> object with an associated schema that defines default values, the <xref:System.Xml.XmlDocument> treats these defaults as if they appeared in the XML document.</span></span> <span data-ttu-id="fe7d5-126">Pertanto la proprietà <xref:System.Xml.XmlReader.IsEmptyElement%2A> restituisce sempre un valore `false` per un elemento ottenuto automaticamente dallo schema.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-126">This means that the <xref:System.Xml.XmlReader.IsEmptyElement%2A> property always returns `false` for an element that was defaulted from the schema.</span></span> <span data-ttu-id="fe7d5-127">Anche se è incluso nel documento XML, è stato scritto come elemento vuoto.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-127">Even if in the XML document, it was written as an empty element.</span></span>

## <a name="validating-an-xml-document-in-the-dom"></a><span data-ttu-id="fe7d5-128">Convalida di un documento XML nel DOM</span><span class="sxs-lookup"><span data-stu-id="fe7d5-128">Validating an XML Document in the DOM</span></span>

<span data-ttu-id="fe7d5-129">Il metodo <xref:System.Xml.XmlDocument.Validate%2A> della classe <xref:System.Xml.XmlDocument> esegue la convalida dei dati XML caricati nel DOM in base agli schemi nella proprietà <xref:System.Xml.XmlDocument> dell'oggetto <xref:System.Xml.XmlDocument.Schemas%2A>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-129">The <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class validates the XML data loaded in the DOM against the schemas in the <xref:System.Xml.XmlDocument> object's <xref:System.Xml.XmlDocument.Schemas%2A> property.</span></span> <span data-ttu-id="fe7d5-130">Una volta eseguita la convalida, vengono applicati i valori predefiniti dello schema, i valori di testo vengono convertiti in valori di tipo atomic in base alle necessità e le informazioni sui tipi vengono associate agli elementi delle informazioni convalidate.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-130">After successful validation, schema defaults are applied, text values are converted to atomic values as necessary, and type information is associated with validated information items.</span></span> <span data-ttu-id="fe7d5-131">Di conseguenza, i dati XML tipizzati sostituiscono i dati XML in precedenza non tipizzati.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-131">As a result, typed XML data replaces previously untyped XML data.</span></span>

<span data-ttu-id="fe7d5-132">L'esempio seguente è simile a quello riportato sopra in "Convalida di un documento XML durante il caricamento nel DOM".</span><span class="sxs-lookup"><span data-stu-id="fe7d5-132">The example below is similar to the example in "Validating an XML Document As It Is Loaded into the DOM" above.</span></span> <span data-ttu-id="fe7d5-133">In questo esempio, il documento XML non viene convalidato durante il caricamento nel DOM, bensì dopo che è stato caricato nel DOM usando il metodo <xref:System.Xml.XmlDocument.Validate%2A> della classe <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-133">In this example, the XML document is not validated as it is loaded into the DOM, but rather is validated after it has been loaded into the DOM using the <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class.</span></span> <span data-ttu-id="fe7d5-134">Il metodo <xref:System.Xml.XmlDocument.Validate%2A> esegue la convalida del documento XML in base agli schemi XML contenuti nella proprietà <xref:System.Xml.XmlDocument.Schemas%2A> del <xref:System.Xml.XmlDocument>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-134">The <xref:System.Xml.XmlDocument.Validate%2A> method validates the XML document against the XML schemas contained in the <xref:System.Xml.XmlDocument.Schemas%2A> property of the <xref:System.Xml.XmlDocument>.</span></span> <span data-ttu-id="fe7d5-135">Vengono apportate modifiche non valide al documento XML che viene quindi riconvalidato, determinando errori di convalida dello schema.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-135">Invalid modifications are then made to the XML document, and the document is then revalidated, causing schema validation errors.</span></span> <span data-ttu-id="fe7d5-136">Infine, uno degli errori viene corretto e quindi una parte del documento XML viene parzialmente convalidata.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-136">Finally, one of the errors is corrected, and then part of the XML document is partially validated.</span></span>

[!code-csharp[XmlDocumentValidation.Validate#1](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlDocumentValidation.Validate/CS/XmlDocumentValidationExample.cs#1)]
[!code-vb[XmlDocumentValidation.Validate#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlDocumentValidation.Validate/VB/XmlDocumentValidationExample.vb#1)]

<span data-ttu-id="fe7d5-137">Nell'esempio vengono accettati come input i file `contosoBooks.xml` e `contosoBooks.xsd` a cui si fa riferimento in "Convalida di un documento XML durante il caricamento nel DOM".</span><span class="sxs-lookup"><span data-stu-id="fe7d5-137">The example takes as input the `contosoBooks.xml` and `contosoBooks.xsd` files referred to in "Validating an XML Document as it is Loaded into the DOM" above.</span></span>

## <a name="handling-validation-errors-and-warnings"></a><span data-ttu-id="fe7d5-138">Gestione degli errori di convalida e degli avvisi</span><span class="sxs-lookup"><span data-stu-id="fe7d5-138">Handling Validation Errors and Warnings</span></span>

<span data-ttu-id="fe7d5-139">Gli errori di convalida di XML Schema vengono segnalati durante la convalida dei dati XML caricati nel DOM.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-139">XML schema validation errors are reported when validating XML data loaded in the DOM.</span></span> <span data-ttu-id="fe7d5-140">Viene inviata una notifica per tutti gli errori di convalida dello schema rilevati durante la convalida dei dati XML in fase di caricamento o durante la convalida di un documento XML non convalidato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-140">You are notified about all schema validation errors found while validating the XML data as it is being loaded, or when validating a previously unvalidated XML document.</span></span>

<span data-ttu-id="fe7d5-141">Gli errori di convalida sono gestiti dal tipo <xref:System.Xml.Schema.ValidationEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-141">Validation errors are handled by the <xref:System.Xml.Schema.ValidationEventHandler>.</span></span> <span data-ttu-id="fe7d5-142">Se un tipo <xref:System.Xml.Schema.ValidationEventHandler> è stato assegnato all'istanza di <xref:System.Xml.XmlReaderSettings> o passato al metodo<xref:System.Xml.XmlDocument.Validate%2A> della classe <xref:System.Xml.XmlDocument>, il <xref:System.Xml.Schema.ValidationEventHandler> gestirà gli errori di convalida degli schemi. In caso contrario, viene generata un'eccezione <xref:System.Xml.Schema.XmlSchemaValidationException> quando viene rilevato un errore di convalida.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-142">If a <xref:System.Xml.Schema.ValidationEventHandler> was assigned to the <xref:System.Xml.XmlReaderSettings> instance, or passed to the <xref:System.Xml.XmlDocument.Validate%2A> method of the <xref:System.Xml.XmlDocument> class, the <xref:System.Xml.Schema.ValidationEventHandler> will handle schema validation errors; otherwise an <xref:System.Xml.Schema.XmlSchemaValidationException> is raised when a schema validation error is encountered.</span></span>

> [!NOTE]
> <span data-ttu-id="fe7d5-143">I dati XML vengono caricati nel DOM indipendentemente dagli errori di convalida dello schema, a meno che il tipo <xref:System.Xml.Schema.ValidationEventHandler> non generi un'eccezione che interrompe il processo.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-143">The XML data is loaded into the DOM despite schema validation errors unless your <xref:System.Xml.Schema.ValidationEventHandler> raises an exception to stop the process.</span></span>
>
> <span data-ttu-id="fe7d5-144">Non vengono segnalati avvisi di convalida dello schema, a meno che non sia stato specificato il flag <xref:System.Xml.Schema.XmlSchemaValidationFlags.ReportValidationWarnings> nell'oggetto <xref:System.Xml.XmlReaderSettings>.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-144">Schema validation warnings are not reported unless the <xref:System.Xml.Schema.XmlSchemaValidationFlags.ReportValidationWarnings> flag is specified to the <xref:System.Xml.XmlReaderSettings> object.</span></span>

 <span data-ttu-id="fe7d5-145">Per gli esempi che illustrano il tipo <xref:System.Xml.Schema.ValidationEventHandler>, vedere "Convalida di un documento XML durante il caricamento nel DOM" e "Convalida di un documento XML nel DOM" riportati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="fe7d5-145">For examples illustrating the <xref:System.Xml.Schema.ValidationEventHandler>, see "Validating an XML Document As It Is Loaded into the DOM" and "Validating an XML Document in the DOM" above.</span></span>

## <a name="see-also"></a><span data-ttu-id="fe7d5-146">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="fe7d5-146">See also</span></span>

- <xref:System.Xml.XmlDocument>
- <xref:System.Xml.XmlReader>
- <xref:System.Xml.Schema.ValidationEventHandler>
- <xref:System.Xml.XmlReaderSettings>
- [<span data-ttu-id="fe7d5-147">Elaborazione di dati XML con il modello DOM</span><span class="sxs-lookup"><span data-stu-id="fe7d5-147">Process XML Data Using the DOM Model</span></span>](../../../../docs/standard/data/xml/process-xml-data-using-the-dom-model.md)
- [<span data-ttu-id="fe7d5-148">Utilizzo di schemi XML</span><span class="sxs-lookup"><span data-stu-id="fe7d5-148">Working with XML Schemas</span></span>](../../../../docs/standard/data/xml/working-with-xml-schemas.md)
