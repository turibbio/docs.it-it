---
title: Inferenza degli schemi da documenti XML
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
- cpp
ms.assetid: f3d97d53-614d-4a04-a174-87965b7405f6
ms.openlocfilehash: 2d991a7835d22af2c780b020d6884f626908665e
ms.sourcegitcommit: de7f589de07a9979b6ac28f54c3e534a617d9425
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/05/2020
ms.locfileid: "82796171"
---
# <a name="inferring-schemas-from-xml-documents"></a><span data-ttu-id="1cfe8-102">Inferenza degli schemi da documenti XML</span><span class="sxs-lookup"><span data-stu-id="1cfe8-102">Inferring Schemas from XML Documents</span></span>
<span data-ttu-id="1cfe8-103">In questo argomento viene descritto come usare la classe <xref:System.Xml.Schema.XmlSchemaInference> per inferire uno schema XSD (XML Schema Definition Language) dalla struttura di un documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-103">This topic describes how to use the <xref:System.Xml.Schema.XmlSchemaInference> class to infer an XML Schema definition language (XSD) schema from the structure of an XML document.</span></span>  
  
## <a name="the-schema-inference-process"></a><span data-ttu-id="1cfe8-104">Processo di inferenza dello schema</span><span class="sxs-lookup"><span data-stu-id="1cfe8-104">The Schema Inference Process</span></span>  
 <span data-ttu-id="1cfe8-105">La classe <xref:System.Xml.Schema.XmlSchemaInference> dello spazio dei nomi <xref:System.Xml.Schema?displayProperty=nameWithType> è usata per generare uno o più schemi XSD (XML Schema definition language) dalla struttura di un documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-105">The <xref:System.Xml.Schema.XmlSchemaInference> class of the <xref:System.Xml.Schema?displayProperty=nameWithType> namespace is used to generate one or more XML Schema definition language (XSD) schemas from the structure of an XML document.</span></span> <span data-ttu-id="1cfe8-106">È possibile usare gli schemi generati per convalidare il documento XML originale.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-106">The generated schemas may be used to validate the original XML document.</span></span>  
  
 <span data-ttu-id="1cfe8-107">Quando un documento XML viene elaborato dalla classe <xref:System.Xml.Schema.XmlSchemaInference>, la classe <xref:System.Xml.Schema.XmlSchemaInference> ipotizza i componenti dello schema che descrivono gli elementi e gli attributi nel documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-107">As an XML document is processed by the <xref:System.Xml.Schema.XmlSchemaInference> class, the <xref:System.Xml.Schema.XmlSchemaInference> class makes assumptions about the schema components that describe the elements and attributes in the XML document.</span></span> <span data-ttu-id="1cfe8-108">La classe <xref:System.Xml.Schema.XmlSchemaInference> inferisce inoltre i componenti dello schema in modo vincolante inferendo il tipo più restrittivo per un determinato elemento o attributo.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-108">The <xref:System.Xml.Schema.XmlSchemaInference> class also infers schema components in a constrained way by inferring the most restrictive type for a particular element or attribute.</span></span> <span data-ttu-id="1cfe8-109">Una volta raccolta una quantità maggiore di informazioni sul documento XML, tali vincoli vengono sciolti inferendo tipi meno restrittivi.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-109">As more information about the XML document is gathered, these constraints are loosened by inferring less restrictive types.</span></span> <span data-ttu-id="1cfe8-110">Il tipo meno restrittivo che è possibile inferire è `xs:string`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-110">The least restrictive type that can be inferred is `xs:string`.</span></span>  
  
 <span data-ttu-id="1cfe8-111">Si consideri, ad esempio, la seguente parte di un documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-111">Take, for example, the following piece of an XML document.</span></span>  
  
```xml  
<parent attribute1="6">  
    <child>One</child>  
    <child>Two</child>  
</parent>  
<parent attribute1="A" />
```  
  
 <span data-ttu-id="1cfe8-112">Nell'esempio precedente, quando viene rilevato l'attributo `attribute1` con un valore uguale a `6` dal processo <xref:System.Xml.Schema.XmlSchemaInference>, si presuppone che sia del tipo `xs:unsignedByte`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-112">In the example above, when the `attribute1` attribute is encountered with a value of `6` by the <xref:System.Xml.Schema.XmlSchemaInference> process, it is assumed to be of type `xs:unsignedByte`.</span></span> <span data-ttu-id="1cfe8-113">Quando viene rilevato il secondo elemento `parent` dal processo <xref:System.Xml.Schema.XmlSchemaInference>, il vincolo viene allentato modificando il tipo in `xs:string`, in quanto il valore dell'attributo `attribute1` è ora uguale a `A`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-113">When the second `parent` element is encountered by the <xref:System.Xml.Schema.XmlSchemaInference> process, the constraint is loosened by modifying the type to `xs:string` because the value of the `attribute1` attribute is now `A`.</span></span> <span data-ttu-id="1cfe8-114">Analogamente, l'attributo `minOccurs` per tutti gli elementi `child` inferiti nello schema viene allentato impostandolo su `minOccurs="0"`, in quanto il secondo elemento padre non contiene elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-114">Similarly, the `minOccurs` attribute for all the `child` elements inferred in the schema are loosened to `minOccurs="0"` because the second parent element has no child elements.</span></span>  
  
## <a name="inferring-schemas-from-xml-documents"></a><span data-ttu-id="1cfe8-115">Inferenza degli schemi da documenti XML</span><span class="sxs-lookup"><span data-stu-id="1cfe8-115">Inferring Schemas from XML Documents</span></span>  
 <span data-ttu-id="1cfe8-116">La classe <xref:System.Xml.Schema.XmlSchemaInference> usa due metodi <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A> di overload per inferire uno schema da un documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-116">The <xref:System.Xml.Schema.XmlSchemaInference> class uses two overloaded <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A> methods to infer a schema from an XML document.</span></span>  
  
 <span data-ttu-id="1cfe8-117">Il primo metodo <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> viene usato per creare uno schema basato su un documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-117">The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to create a schema based on an XML document.</span></span> <span data-ttu-id="1cfe8-118">Il secondo metodo <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> viene usato per inferire uno schema che descrive più documenti XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-118">The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method is used to infer a schema that describes multiple XML documents.</span></span> <span data-ttu-id="1cfe8-119">Ad esempio, è possibile aggiungere uno alla volta più documenti XML nel metodo <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> per ottenere uno schema che descrive l'intero set di documenti XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-119">For example, you can feed multiple XML documents to the <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method one at a time to produce a schema that describes the entire set of XML documents.</span></span>  
  
 <span data-ttu-id="1cfe8-120">Il primo metodo <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> inferisce lo schema da un documento XML contenuto in un oggetto <xref:System.Xml.XmlReader> e restituisce un oggetto <xref:System.Xml.Schema.XmlSchemaSet> contenente lo schema inferito.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-120">The first <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method infers a schema from an XML document contained in an <xref:System.Xml.XmlReader> object, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema.</span></span> <span data-ttu-id="1cfe8-121">Il secondo metodo <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> cerca un oggetto <xref:System.Xml.Schema.XmlSchemaSet> per uno schema con lo stesso spazio dei nomi di destinazione del documento XML contenuto nell'oggetto <xref:System.Xml.XmlReader>, ottimizza lo schema esistente e restituisce un oggetto <xref:System.Xml.Schema.XmlSchemaSet> contenente lo schema inferito.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-121">The second <xref:System.Xml.Schema.XmlSchemaInference.InferSchema%2A?displayProperty=nameWithType> method searches an <xref:System.Xml.Schema.XmlSchemaSet> object for a schema with the same target namespace as the XML document contained in the <xref:System.Xml.XmlReader> object, refines the existing schema, and returns an <xref:System.Xml.Schema.XmlSchemaSet> object containing the inferred schema.</span></span>  
  
 <span data-ttu-id="1cfe8-122">Le modifiche apportate allo schema ottimizzato sono basate sulla nuova struttura rilevata nel documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-122">The changes made to the refined schema are based on new structure found in the XML document.</span></span> <span data-ttu-id="1cfe8-123">Ad esempio, quando si scorre un documento XML, si ipotizzano i tipi di dati rilevati e lo schema viene creato in base a tali ipotesi.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-123">For example, as an XML document is traversed, assumptions are made about the data types found, and the schema is created based on those assumptions.</span></span> <span data-ttu-id="1cfe8-124">Tuttavia, se i dati vengono rilevati in un secondo passaggio del processo di inferenza che differisce dall'ipotesi iniziale, lo schema viene ridefinito.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-124">However, if data is encountered on a second inference pass that differs from the original assumption, the schema is refined.</span></span> <span data-ttu-id="1cfe8-125">Nell'esempio seguente viene illustrato questo processo.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-125">The following example illustrates the refinement process.</span></span>  
  
 [!code-cpp[XmlSchemaInferenceExamples#4](../../../../samples/snippets/cpp/VS_Snippets_Data/XmlSchemaInferenceExamples/CPP/XmlSchemaInferenceExamples.cpp#4)]
 [!code-csharp[XmlSchemaInferenceExamples#4](../../../../samples/snippets/csharp/VS_Snippets_Data/XmlSchemaInferenceExamples/CS/XmlSchemaInferenceExamples.cs#4)]
 [!code-vb[XmlSchemaInferenceExamples#4](../../../../samples/snippets/visualbasic/VS_Snippets_Data/XmlSchemaInferenceExamples/VB/XmlSchemaInferenceExamples.vb#4)]  
  
 <span data-ttu-id="1cfe8-126">Nell'esempio il file `item1.xml` viene considerato come primo input.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-126">The example takes the following file, `item1.xml`, as its first input.</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#13](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/item1.xml#13)]  
  
 <span data-ttu-id="1cfe8-127">Il file `item2.xml` viene quindi considerato come secondo input:</span><span class="sxs-lookup"><span data-stu-id="1cfe8-127">The example then takes the `item2.xml` file as its second input:</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#14](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/item2.xml#14)]  
  
 <span data-ttu-id="1cfe8-128">Quando viene rilevato l'attributo `productID` nel primo documento XML, si presuppone che il valore `123456789` sia del tipo `xs:unsignedInt`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-128">When the `productID` attribute is encountered in the first XML document, the value of `123456789` is assumed to be an `xs:unsignedInt` type.</span></span> <span data-ttu-id="1cfe8-129">Tuttavia, quando viene letto il secondo documento XML e viene rilevato un valore uguale a `A53-246`, non è più possibile presupporre il tipo `xs:unsignedInt`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-129">However, when the second XML document is read and the value of `A53-246` is found, the `xs:unsignedInt` type can no longer be assumed.</span></span> <span data-ttu-id="1cfe8-130">Lo schema viene ridefinito e il tipo `productID` viene modificato in `xs:string`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-130">The schema is refined and the type of `productID` is changed to `xs:string`.</span></span> <span data-ttu-id="1cfe8-131">Inoltre, l'attributo `minOccurs` per l'elemento `supplierID` è impostato su `0`, in quanto il secondo documento XML non contiene alcun elemento `supplierID`.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-131">In addition, the `minOccurs` attribute for the `supplierID` element is set to `0`, because the second XML document contains no `supplierID` element.</span></span>  
  
 <span data-ttu-id="1cfe8-132">Lo schema seguente è lo schema inferito dal primo documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-132">The following is the schema inferred from the first XML document.</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#15](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/InferSchema1.xml#15)]  
  
 <span data-ttu-id="1cfe8-133">Lo schema seguente è lo schema inferito dal primo documento XML, ridefinito dal secondo documento XML.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-133">The following is the schema inferred from the first XML document, refined by the second XML document.</span></span>  
  
 [!code-xml[XmlSchemaInferenceExamples#16](../../../../samples/snippets/xml/VS_Snippets_Data/XmlSchemaInferenceExamples/XML/InferSchema2.xml#16)]  
  
## <a name="inline-schemas"></a><span data-ttu-id="1cfe8-134">Schemi inline</span><span class="sxs-lookup"><span data-stu-id="1cfe8-134">Inline Schemas</span></span>  
 <span data-ttu-id="1cfe8-135">Se viene rilevato uno schema XSD inline durante il processo <xref:System.Xml.Schema.XmlSchemaInference>, viene generata l'eccezione <xref:System.Xml.Schema.XmlSchemaInferenceException>.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-135">If an inline XML Schema definition language (XSD) schema is encountered during the <xref:System.Xml.Schema.XmlSchemaInference> process, an <xref:System.Xml.Schema.XmlSchemaInferenceException> is thrown.</span></span> <span data-ttu-id="1cfe8-136">Ad esempio, nel seguente schema inline viene generata un'eccezione <xref:System.Xml.Schema.XmlSchemaInferenceException>.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-136">For example, the following inline schema throws an <xref:System.Xml.Schema.XmlSchemaInferenceException>.</span></span>  
  
```xml  
<root xmlns:ex="http://www.contoso.com" xmlns="http://www.tempuri.org">  
    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.contoso.com">  
        <xs:element name="Contoso" type="xs:normalizedString" />  
    </xs:schema>  
    <ex:Contoso>Test</ex:Contoso>  
</root>  
```  
  
## <a name="schemas-that-cannot-be-refined"></a><span data-ttu-id="1cfe8-137">Schemi che non possono essere ridefiniti</span><span class="sxs-lookup"><span data-stu-id="1cfe8-137">Schemas that Cannot be Refined</span></span>  
 <span data-ttu-id="1cfe8-138">Esistono costrutti di schemi W3C XML che il processo XSD (XML Schema definition language) <xref:System.Xml.Schema.XmlSchemaInference> non è in grado di gestire se si tratta di ridefinire un tipo e viene quindi generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-138">There are W3C XML Schema constructs that the XML Schema definition language (XSD) schema <xref:System.Xml.Schema.XmlSchemaInference> process cannot handle if given a type to refine and cause an exception to be thrown.</span></span> <span data-ttu-id="1cfe8-139">Un esempio è un tipo particolarmente complesso il cui compositor di livello principale è diverso da una sequenza.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-139">Such as a complex type whose top-level compositor is anything other than a sequence.</span></span> <span data-ttu-id="1cfe8-140">Nel SOM (Schema Object Model), ciò corrisponde a un tipo <xref:System.Xml.Schema.XmlSchemaComplexType> la cui proprietà <xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A> non è un'istanza del tipo <xref:System.Xml.Schema.XmlSchemaSequence>.</span><span class="sxs-lookup"><span data-stu-id="1cfe8-140">In the Schema Object Model (SOM), this corresponds to an <xref:System.Xml.Schema.XmlSchemaComplexType> whose <xref:System.Xml.Schema.XmlSchemaComplexType.Particle%2A> property is not an instance of <xref:System.Xml.Schema.XmlSchemaSequence>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cfe8-141">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="1cfe8-141">See also</span></span>

- <xref:System.Xml.Schema.XmlSchemaInference>
- [<span data-ttu-id="1cfe8-142">SOM (Schema Object Model) XML</span><span class="sxs-lookup"><span data-stu-id="1cfe8-142">XML Schema Object Model (SOM)</span></span>](../../../../docs/standard/data/xml/xml-schema-object-model-som.md)
- [<span data-ttu-id="1cfe8-143">Inferenza di uno schema XML</span><span class="sxs-lookup"><span data-stu-id="1cfe8-143">Inferring an XML Schema</span></span>](../../../../docs/standard/data/xml/inferring-an-xml-schema.md)
- [<span data-ttu-id="1cfe8-144">Regole per l'inferenza dello schema per tipi di nodo e struttura</span><span class="sxs-lookup"><span data-stu-id="1cfe8-144">Rules for Inferring Schema Node Types and Structure</span></span>](../../../../docs/standard/data/xml/rules-for-inferring-schema-node-types-and-structure.md)
- [<span data-ttu-id="1cfe8-145">Regole per l'inferenza di tipi semplici</span><span class="sxs-lookup"><span data-stu-id="1cfe8-145">Rules for Inferring Simple Types</span></span>](../../../../docs/standard/data/xml/rules-for-inferring-simple-types.md)
