---
title: 'Procedura: creare fusi orari con regole di rettifica'
ms.date: 04/10/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- time zones [.NET Framework], creating
- time zones [.NET Framework], and adjustment rules
- adjustment rule [.NET Framework]
ms.assetid: c52ef192-13a9-435f-8015-3b12eae8c47c
ms.openlocfilehash: b7e938581dfde3f1566aa2506302292686c2fc5c
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/02/2020
ms.locfileid: "84278168"
---
# <a name="how-to-create-time-zones-with-adjustment-rules"></a><span data-ttu-id="6c23d-102">Procedura: creare fusi orari con regole di rettifica</span><span class="sxs-lookup"><span data-stu-id="6c23d-102">How to: Create time zones with adjustment rules</span></span>

<span data-ttu-id="6c23d-103">Le informazioni esatte sul fuso orario richieste da un'applicazione potrebbero non essere presenti in un sistema specifico per diversi motivi:</span><span class="sxs-lookup"><span data-stu-id="6c23d-103">The precise time zone information that is required by an application may not be present on a particular system for several reasons:</span></span>

- <span data-ttu-id="6c23d-104">Il fuso orario non è mai stato definito nel registro di sistema del sistema locale.</span><span class="sxs-lookup"><span data-stu-id="6c23d-104">The time zone has never been defined in the local system's registry.</span></span>

- <span data-ttu-id="6c23d-105">I dati relativi al fuso orario sono stati modificati o rimossi dal registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="6c23d-105">Data about the time zone has been modified or removed from the registry.</span></span>

- <span data-ttu-id="6c23d-106">Il fuso orario non dispone di informazioni accurate sulle regolazioni del fuso orario per un determinato periodo cronologico.</span><span class="sxs-lookup"><span data-stu-id="6c23d-106">The time zone does not have accurate information about time zone adjustments for a particular historic period.</span></span>

<span data-ttu-id="6c23d-107">In questi casi, è possibile chiamare il <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> metodo per definire il fuso orario richiesto dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6c23d-107">In these cases, you can call the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method to define the time zone required by your application.</span></span> <span data-ttu-id="6c23d-108">È possibile usare gli overload di questo metodo per creare un fuso orario con o senza regole di regolazione.</span><span class="sxs-lookup"><span data-stu-id="6c23d-108">You can use the overloads of this method to create a time zone with or without adjustment rules.</span></span> <span data-ttu-id="6c23d-109">Se il fuso orario supporta l'ora legale, è possibile definire le regolazioni con regole di rettifica fisse o mobili.</span><span class="sxs-lookup"><span data-stu-id="6c23d-109">If the time zone supports daylight saving time, you can define adjustments with either fixed or floating adjustment rules.</span></span> <span data-ttu-id="6c23d-110">Per le definizioni di questi termini, vedere la sezione "terminologia del fuso orario" nella [Panoramica del fuso orario](time-zone-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6c23d-110">(For definitions of these terms, see the "Time Zone Terminology" section in [Time zone overview](time-zone-overview.md).)</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6c23d-111">I fusi orari personalizzati creati chiamando il <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> metodo non vengono aggiunti al registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="6c23d-111">Custom time zones created by calling the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method are not added to the registry.</span></span> <span data-ttu-id="6c23d-112">Al contrario, è possibile accedervi solo tramite il riferimento all'oggetto restituito dalla <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> chiamata al metodo.</span><span class="sxs-lookup"><span data-stu-id="6c23d-112">Instead, they can be accessed only through the object reference returned by the <xref:System.TimeZoneInfo.CreateCustomTimeZone%2A> method call.</span></span>

<span data-ttu-id="6c23d-113">In questo argomento viene illustrato come creare un fuso orario con regole di rettifica.</span><span class="sxs-lookup"><span data-stu-id="6c23d-113">This topic shows how to create a time zone with adjustment rules.</span></span> <span data-ttu-id="6c23d-114">Per creare un fuso orario che non supporta le regole di regolazione dell'ora legale, vedere [procedura: creare fusi orari senza regole di regolazione](create-time-zones-without-adjustment-rules.md).</span><span class="sxs-lookup"><span data-stu-id="6c23d-114">To create a time zone that does not support daylight saving time adjustment rules, see [How to: Create Time Zones Without Adjustment Rules](create-time-zones-without-adjustment-rules.md).</span></span>

### <a name="to-create-a-time-zone-with-floating-adjustment-rules"></a><span data-ttu-id="6c23d-115">Per creare un fuso orario con regole di rettifica a virgola mobile</span><span class="sxs-lookup"><span data-stu-id="6c23d-115">To create a time zone with floating adjustment rules</span></span>

1. <span data-ttu-id="6c23d-116">Per ogni regolazione, ovvero per ogni transizione da e verso l'ora solare in un intervallo di tempo specifico, procedere come segue:</span><span class="sxs-lookup"><span data-stu-id="6c23d-116">For each adjustment (that is, for each transition away from and back to standard time over a particular time interval), do the following:</span></span>

    1. <span data-ttu-id="6c23d-117">Definire il tempo di transizione iniziale per la regolazione del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-117">Define the starting transition time for the time zone adjustment.</span></span>

       <span data-ttu-id="6c23d-118">È necessario chiamare il <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> metodo e passargli un <xref:System.DateTime> valore che definisce l'ora della transizione, un valore intero che definisce il mese della transizione, un valore intero che definisce la settimana in cui si verifica la transizione e un <xref:System.DayOfWeek> valore che definisce il giorno della settimana in cui si verifica la transizione.</span><span class="sxs-lookup"><span data-stu-id="6c23d-118">You must call the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> method and pass it a <xref:System.DateTime> value that defines the time of the transition, an integer value that defines the month of the transition, an integer value that defines the week on which the transition occurs, and a <xref:System.DayOfWeek> value that defines the day of the week on which the transition occurs.</span></span> <span data-ttu-id="6c23d-119">Questa chiamata al metodo crea un'istanza di un <xref:System.TimeZoneInfo.TransitionTime> oggetto.</span><span class="sxs-lookup"><span data-stu-id="6c23d-119">This method call instantiates a <xref:System.TimeZoneInfo.TransitionTime> object.</span></span>

    2. <span data-ttu-id="6c23d-120">Definire il tempo di transizione finale per la regolazione del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-120">Define the ending transition time for the time zone adjustment.</span></span> <span data-ttu-id="6c23d-121">Questa operazione richiede un'altra chiamata al <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> metodo.</span><span class="sxs-lookup"><span data-stu-id="6c23d-121">This requires another call to the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="6c23d-122">Questa chiamata al metodo crea un'istanza di un secondo <xref:System.TimeZoneInfo.TransitionTime> oggetto.</span><span class="sxs-lookup"><span data-stu-id="6c23d-122">This method call instantiates a second <xref:System.TimeZoneInfo.TransitionTime> object.</span></span>

    3. <span data-ttu-id="6c23d-123">Chiamare il <xref:System.TimeZoneInfo.AdjustmentRule.CreateAdjustmentRule%2A> metodo e passare le date di inizio e di fine valide della regolazione, un <xref:System.TimeSpan> oggetto che definisce la quantità di tempo nella transizione e i due <xref:System.TimeZoneInfo.TransitionTime> oggetti che definiscono quando si verificano le transizioni da e verso l'ora legale.</span><span class="sxs-lookup"><span data-stu-id="6c23d-123">Call the <xref:System.TimeZoneInfo.AdjustmentRule.CreateAdjustmentRule%2A> method and pass it the effective start and end dates of the adjustment, a <xref:System.TimeSpan> object that defines the amount of time in the transition, and the two <xref:System.TimeZoneInfo.TransitionTime> objects that define when the transitions to and from daylight saving time occur.</span></span> <span data-ttu-id="6c23d-124">Questa chiamata al metodo crea un'istanza di un <xref:System.TimeZoneInfo.AdjustmentRule> oggetto.</span><span class="sxs-lookup"><span data-stu-id="6c23d-124">This method call instantiates a <xref:System.TimeZoneInfo.AdjustmentRule> object.</span></span>

    4. <span data-ttu-id="6c23d-125">Assegnare l' <xref:System.TimeZoneInfo.AdjustmentRule> oggetto a una matrice di <xref:System.TimeZoneInfo.AdjustmentRule> oggetti.</span><span class="sxs-lookup"><span data-stu-id="6c23d-125">Assign the <xref:System.TimeZoneInfo.AdjustmentRule> object to an array of <xref:System.TimeZoneInfo.AdjustmentRule> objects.</span></span>

2. <span data-ttu-id="6c23d-126">Definire il nome visualizzato del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-126">Define the time zone's display name.</span></span> <span data-ttu-id="6c23d-127">Il nome visualizzato segue un formato abbastanza standard in cui l'offset del fuso orario rispetto all'ora UTC (Coordinated Universal Time) è racchiuso tra parentesi ed è seguito da una stringa che identifica il fuso orario, una o più città del fuso orario o uno o più paesi o aree del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-127">The display name follows a fairly standard format in which the time zone's offset from Coordinated Universal Time (UTC) is enclosed in parentheses and is followed by a string that identifies the time zone, one or more of the cities in the time zone, or one or more of the countries or regions in the time zone.</span></span>

3. <span data-ttu-id="6c23d-128">Definire il nome dell'ora solare del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-128">Define the name of the time zone's standard time.</span></span> <span data-ttu-id="6c23d-129">In genere, questa stringa viene usata anche come identificatore del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-129">Typically, this string is also used as the time zone's identifier.</span></span>

4. <span data-ttu-id="6c23d-130">Definire il nome dell'ora legale del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-130">Define the name of the time zone's daylight time.</span></span>

5. <span data-ttu-id="6c23d-131">Se si vuole usare un identificatore diverso dal nome standard del fuso orario, definire l'identificatore del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-131">If you want to use a different identifier than the time zone's standard name, define the time zone identifier.</span></span>

6. <span data-ttu-id="6c23d-132">Creare un'istanza di un <xref:System.TimeSpan> oggetto che definisce l'offset del fuso orario rispetto all'ora UTC.</span><span class="sxs-lookup"><span data-stu-id="6c23d-132">Instantiate a <xref:System.TimeSpan> object that defines the time zone's offset from UTC.</span></span> <span data-ttu-id="6c23d-133">I fusi orari con tempi successivi all'ora UTC hanno un offset positivo.</span><span class="sxs-lookup"><span data-stu-id="6c23d-133">Time zones with times that are later than UTC have a positive offset.</span></span> <span data-ttu-id="6c23d-134">I fusi orari con tempi precedenti all'ora UTC hanno un offset negativo.</span><span class="sxs-lookup"><span data-stu-id="6c23d-134">Time zones with times that are earlier than UTC have a negative offset.</span></span>

7. <span data-ttu-id="6c23d-135">Chiamare il <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> metodo per creare un'istanza del nuovo fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-135">Call the <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> method to instantiate the new time zone.</span></span>

## <a name="example"></a><span data-ttu-id="6c23d-136">Esempio</span><span class="sxs-lookup"><span data-stu-id="6c23d-136">Example</span></span>

<span data-ttu-id="6c23d-137">Nell'esempio seguente viene definito un fuso orario standard centrale per la Stati Uniti che include regole di rettifica per un'ampia gamma di intervalli di tempo da 1918 al momento corrente.</span><span class="sxs-lookup"><span data-stu-id="6c23d-137">The following example defines a Central Standard Time zone for the United States that includes adjustment rules for a variety of time intervals from 1918 to the present.</span></span>

[!code-csharp[System.TimeZone2.CreateTimeZone#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/cs/System.TimeZone2.CreateTimeZone.cs#5)]
[!code-vb[System.TimeZone2.CreateTimeZone#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/vb/System.TimeZone2.CreateTimeZone.vb#5)]

<span data-ttu-id="6c23d-138">Il fuso orario creato in questo esempio include più regole di regolazione.</span><span class="sxs-lookup"><span data-stu-id="6c23d-138">The time zone created in this example has multiple adjustment rules.</span></span> <span data-ttu-id="6c23d-139">È necessario prestare attenzione per assicurarsi che le date di inizio e di fine valide di una regola di rettifica non si sovrappongano alle date di un'altra regola di rettifica.</span><span class="sxs-lookup"><span data-stu-id="6c23d-139">Care must be taken to ensure that the effective start and end dates of any adjustment rule do not overlap with the dates of another adjustment rule.</span></span> <span data-ttu-id="6c23d-140">Se si verifica una sovrapposizione, <xref:System.InvalidTimeZoneException> viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="6c23d-140">If there is an overlap, an <xref:System.InvalidTimeZoneException> is thrown.</span></span>

<span data-ttu-id="6c23d-141">Per le regole di rettifica a virgola mobile, il valore 5 viene passato al `week` parametro del <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> metodo per indicare che la transizione si verifica nell'ultima settimana di un determinato mese.</span><span class="sxs-lookup"><span data-stu-id="6c23d-141">For floating adjustment rules, the value 5 is passed to the `week` parameter of the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> method to indicate that the transition occurs on the last week of a particular month.</span></span>

<span data-ttu-id="6c23d-142">Quando si crea la matrice di <xref:System.TimeZoneInfo.AdjustmentRule> oggetti da usare nella <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> chiamata al metodo, il codice potrebbe inizializzare la matrice in base alla dimensione richiesta dal numero di modifiche da creare per il fuso orario.</span><span class="sxs-lookup"><span data-stu-id="6c23d-142">In creating the array of <xref:System.TimeZoneInfo.AdjustmentRule> objects to use in the <xref:System.TimeZoneInfo.CreateCustomTimeZone%28System.String%2CSystem.TimeSpan%2CSystem.String%2CSystem.String%2CSystem.String%2CSystem.TimeZoneInfo.AdjustmentRule%5B%5D%29?displayProperty=nameWithType> method call, the code could initialize the array to the size required by the number of adjustments to be created for the time zone.</span></span> <span data-ttu-id="6c23d-143">Al contrario, in questo esempio di codice viene chiamato il <xref:System.Collections.Generic.List%601.Add%2A> metodo per aggiungere ogni regola di regolazione a una raccolta generica <xref:System.Collections.Generic.List%601> di <xref:System.TimeZoneInfo.AdjustmentRule> oggetti.</span><span class="sxs-lookup"><span data-stu-id="6c23d-143">Instead, this code example calls the <xref:System.Collections.Generic.List%601.Add%2A> method to add each adjustment rule to a generic <xref:System.Collections.Generic.List%601> collection of <xref:System.TimeZoneInfo.AdjustmentRule> objects.</span></span> <span data-ttu-id="6c23d-144">Il codice chiama quindi il <xref:System.Collections.Generic.List%601.CopyTo%2A> metodo per copiare i membri di questa raccolta nella matrice.</span><span class="sxs-lookup"><span data-stu-id="6c23d-144">The code then calls the <xref:System.Collections.Generic.List%601.CopyTo%2A> method to copy the members of this collection to the array.</span></span>

<span data-ttu-id="6c23d-145">Nell'esempio viene inoltre usato il <xref:System.TimeZoneInfo.TransitionTime.CreateFixedDateRule%2A> metodo per definire le regolazioni a data fissa.</span><span class="sxs-lookup"><span data-stu-id="6c23d-145">The example also uses the <xref:System.TimeZoneInfo.TransitionTime.CreateFixedDateRule%2A> method to define fixed-date adjustments.</span></span> <span data-ttu-id="6c23d-146">Questa operazione è simile alla chiamata al <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> metodo, con la differenza che richiede solo l'ora, il mese e il giorno dei parametri di transizione.</span><span class="sxs-lookup"><span data-stu-id="6c23d-146">This is similar to calling the <xref:System.TimeZoneInfo.TransitionTime.CreateFloatingDateRule%2A> method, except that it requires only the time, month, and day of the transition parameters.</span></span>

<span data-ttu-id="6c23d-147">L'esempio può essere testato usando un codice simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="6c23d-147">The example can be tested using code such as the following:</span></span>

[!code-csharp[System.TimeZone2.CreateTimeZone#7](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/cs/System.TimeZone2.CreateTimeZone.cs#7)]
[!code-vb[System.TimeZone2.CreateTimeZone#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/vb/System.TimeZone2.CreateTimeZone.vb#7)]

## <a name="compiling-the-code"></a><span data-ttu-id="6c23d-148">Compilazione del codice</span><span class="sxs-lookup"><span data-stu-id="6c23d-148">Compiling the code</span></span>

<span data-ttu-id="6c23d-149">L'esempio presenta i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="6c23d-149">This example requires:</span></span>

- <span data-ttu-id="6c23d-150">Che vengano importati gli spazi dei nomi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6c23d-150">That the following namespaces be imported:</span></span>

  [!code-csharp[System.TimeZone2.CreateTimeZone#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/cs/System.TimeZone2.CreateTimeZone.cs#6)]
  [!code-vb[System.TimeZone2.CreateTimeZone#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.CreateTimeZone/vb/System.TimeZone2.CreateTimeZone.vb#6)]

## <a name="see-also"></a><span data-ttu-id="6c23d-151">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6c23d-151">See also</span></span>

- [<span data-ttu-id="6c23d-152">Date, ore e fusi orari</span><span class="sxs-lookup"><span data-stu-id="6c23d-152">Dates, times, and time zones</span></span>](index.md)
- [<span data-ttu-id="6c23d-153">Panoramica sul fuso orario</span><span class="sxs-lookup"><span data-stu-id="6c23d-153">Time zone overview</span></span>](time-zone-overview.md)
- [<span data-ttu-id="6c23d-154">Procedura: creare fusi orari senza regole di regolazione</span><span class="sxs-lookup"><span data-stu-id="6c23d-154">How to: Create time zones without adjustment rules</span></span>](create-time-zones-without-adjustment-rules.md)
