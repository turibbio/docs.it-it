---
title: Applicazione di attributi di interoperabilità
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET Framework, exposing components to COM
- attributes [.NET Framework], design-time functionality
- conversion-tool attributes
- attributes [.NET Framework], interop-specific
- attributes [.NET Framework], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: ca104c512641774217de5e270dc50b7393fc5725
ms.sourcegitcommit: 00aa62e2f469c2272a457b04e66b4cc3c97a800b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/28/2020
ms.locfileid: "78159247"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="b6a92-102">Applicazione di attributi di interoperabilità</span><span class="sxs-lookup"><span data-stu-id="b6a92-102">Applying Interop Attributes</span></span>
<span data-ttu-id="b6a92-103">Lo spazio dei nomi <xref:System.Runtime.InteropServices> offre tre categorie di attributi specifici per l'interoperabilità: quelli applicati manualmente in fase di progettazione, quelli applicati dalle API e dagli strumenti di interoperabilità COM durante il processo di conversione e quelli applicati nell'uno o nell'altro modo.</span><span class="sxs-lookup"><span data-stu-id="b6a92-103">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="b6a92-104">Per informazioni su come applicare gli attributi nel codice gestito, vedere [Estensione di metadati mediante attributi](../../../docs/standard/attributes/index.md).</span><span class="sxs-lookup"><span data-stu-id="b6a92-104">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md).</span></span> <span data-ttu-id="b6a92-105">Come per altri attributi personalizzati, è possibile applicare gli attributi specifici per l'interoperabilità a tipi, metodi, proprietà, parametri, campi e altri membri.</span><span class="sxs-lookup"><span data-stu-id="b6a92-105">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="b6a92-106">Attributi della fase di progettazione</span><span class="sxs-lookup"><span data-stu-id="b6a92-106">Design-Time Attributes</span></span>  
 <span data-ttu-id="b6a92-107">È possibile intervenire sul risultato del processo di conversione eseguito dalle API e dagli strumenti di interoperabilità COM usando gli attributi in fase di progettazione.</span><span class="sxs-lookup"><span data-stu-id="b6a92-107">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="b6a92-108">La tabella seguente descrive gli attributi che è possibile applicare al codice sorgente gestito.</span><span class="sxs-lookup"><span data-stu-id="b6a92-108">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="b6a92-109">Questi attributi possono essere applicati, in alcuni casi, anche dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-109">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="b6a92-110">Attributo</span><span class="sxs-lookup"><span data-stu-id="b6a92-110">Attribute</span></span>|<span data-ttu-id="b6a92-111">Description</span><span class="sxs-lookup"><span data-stu-id="b6a92-111">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="b6a92-112">Specifica se il marshalling del tipo deve essere effettuato mediante il gestore di marshalling di Automazione oppure un proxy e uno stub personalizzati.</span><span class="sxs-lookup"><span data-stu-id="b6a92-112">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="b6a92-113">Controlla il tipo di interfaccia generato per una classe.</span><span class="sxs-lookup"><span data-stu-id="b6a92-113">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="b6a92-114">Identifica il CLSID della coclasse originale importata da una libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="b6a92-114">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="b6a92-115">Questo attributo viene in genere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-115">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="b6a92-116">Indica che è stata importata una definizione di interfaccia o una coclasse da una libreria dei tipi COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-116">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="b6a92-117">Il runtime usa questo flag per determinare come attivare il tipo ed effettuarne il marshalling.</span><span class="sxs-lookup"><span data-stu-id="b6a92-117">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="b6a92-118">Questo attributo impedisce la riesportazione del tipo in una libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="b6a92-118">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="b6a92-119">Questo attributo viene in genere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-119">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="b6a92-120">Indica che, quando l'assembly viene registrato per l'utilizzo da COM, deve essere chiamato un metodo per consentire l'esecuzione di codice utente durante il processo di registrazione.</span><span class="sxs-lookup"><span data-stu-id="b6a92-120">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="b6a92-121">Identifica le interfacce che sono fonti di eventi per la classe.</span><span class="sxs-lookup"><span data-stu-id="b6a92-121">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="b6a92-122">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-122">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="b6a92-123">Indica che, quando la registrazione dell'assembly da COM viene annullata, deve essere chiamato un metodo per consentire l'esecuzione di codice utente durante il processo.</span><span class="sxs-lookup"><span data-stu-id="b6a92-123">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="b6a92-124">Rende i tipi invisibili a COM quando il valore dell'attributo è **false**.</span><span class="sxs-lookup"><span data-stu-id="b6a92-124">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="b6a92-125">Questo attributo può essere applicato a un tipo singolo o a un intero assembly per controllare la visibilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-125">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="b6a92-126">Tutti i tipi gestiti e pubblici sono visibili per impostazione predefinita. Non è necessario usare questo attributo per renderli visibili.</span><span class="sxs-lookup"><span data-stu-id="b6a92-126">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="b6a92-127">Specifica l'identificatore di invio (DISPID) COM di un metodo o un campo.</span><span class="sxs-lookup"><span data-stu-id="b6a92-127">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="b6a92-128">Questo attributo contiene il DISPID per il metodo, il campo o la proprietà che descrive.</span><span class="sxs-lookup"><span data-stu-id="b6a92-128">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="b6a92-129">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-129">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="b6a92-130">Indica l'interfaccia predefinita per una classe COM implementata in .NET.</span><span class="sxs-lookup"><span data-stu-id="b6a92-130">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="b6a92-131">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-131">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="b6a92-132">Indica la posizione fisica di ogni campo all'interno di una classe quando è usato con l'attributo **StructLayoutAttribute** e **LayoutKind** è impostato su Explicit.</span><span class="sxs-lookup"><span data-stu-id="b6a92-132">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="b6a92-133">Specifica l'identificatore univoco globale (GUID) di una classe, un'interfaccia o un'intera libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="b6a92-133">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="b6a92-134">Il formato della stringa passata all'attributo deve essere un argomento di costruttore accettabile per il tipo **System.Guid**.</span><span class="sxs-lookup"><span data-stu-id="b6a92-134">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="b6a92-135">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-135">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="b6a92-136">Indica quale implementazione dell'interfaccia **IDispatch** viene usata da Common Language Runtime quando espone a COM interfacce duali e dispatch.</span><span class="sxs-lookup"><span data-stu-id="b6a92-136">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="b6a92-137">Indica che è necessario effettuare il marshalling dei dati verso il chiamante.</span><span class="sxs-lookup"><span data-stu-id="b6a92-137">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="b6a92-138">Può essere usato per i parametri.</span><span class="sxs-lookup"><span data-stu-id="b6a92-138">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="b6a92-139">Controlla in che modo un'interfaccia gestita viene esposta ai client COM (duale, derivata da IUnknown o solo IDispatch).</span><span class="sxs-lookup"><span data-stu-id="b6a92-139">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="b6a92-140">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-140">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="b6a92-141">Indica che una firma di metodo non gestito accetta un parametro LCID.</span><span class="sxs-lookup"><span data-stu-id="b6a92-141">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="b6a92-142">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-142">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="b6a92-143">Indica come deve essere effettuato il marshalling dei dati di campi o parametri tra codice gestito e codice non gestito.</span><span class="sxs-lookup"><span data-stu-id="b6a92-143">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="b6a92-144">L'attributo è sempre facoltativo perché per ogni tipo di dati è previsto un comportamento di marshalling predefinito.</span><span class="sxs-lookup"><span data-stu-id="b6a92-144">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="b6a92-145">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-145">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="b6a92-146">Indica che un parametro è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="b6a92-146">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="b6a92-147">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-147">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="b6a92-148">Indica che è necessario effettuare il marshalling dei dati di un campo o di un parametro da un oggetto chiamato al relativo chiamante.</span><span class="sxs-lookup"><span data-stu-id="b6a92-148">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="b6a92-149">Disattiva la trasformazione della firma retval o HRESULT che normalmente ha luogo durante le chiamate di interoperabilità.</span><span class="sxs-lookup"><span data-stu-id="b6a92-149">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="b6a92-150">L'attributo influisce sul marshalling e sull'esportazione delle librerie dei tipi.</span><span class="sxs-lookup"><span data-stu-id="b6a92-150">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="b6a92-151">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-151">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="b6a92-152">Specifica il ProgID di una classe .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="b6a92-152">Specifies the ProgID of a .NET Framework class.</span></span> <span data-ttu-id="b6a92-153">Può essere usato per le classi.</span><span class="sxs-lookup"><span data-stu-id="b6a92-153">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="b6a92-154">Controlla il layout fisico dei campi di una classe.</span><span class="sxs-lookup"><span data-stu-id="b6a92-154">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="b6a92-155">Questo attributo può essere applicato dagli strumenti di interoperabilità COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-155">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="b6a92-156">Attributi degli strumenti di conversione</span><span class="sxs-lookup"><span data-stu-id="b6a92-156">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="b6a92-157">La tabella seguente descrive gli attributi applicati dagli strumenti di interoperabilità COM durante il processo di conversione.</span><span class="sxs-lookup"><span data-stu-id="b6a92-157">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="b6a92-158">Questi attributi non devono essere applicati in fase di progettazione.</span><span class="sxs-lookup"><span data-stu-id="b6a92-158">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="b6a92-159">Attributo</span><span class="sxs-lookup"><span data-stu-id="b6a92-159">Attribute</span></span>|<span data-ttu-id="b6a92-160">Description</span><span class="sxs-lookup"><span data-stu-id="b6a92-160">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="b6a92-161">Indica l'alias COM per un tipo di parametro o campo.</span><span class="sxs-lookup"><span data-stu-id="b6a92-161">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="b6a92-162">Può essere usato per parametri, campi o valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="b6a92-162">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="b6a92-163">Indica che le informazioni relative a una classe o a un'interfaccia sono andate perse durante l'importazione da una libreria dei tipi a un assembly.</span><span class="sxs-lookup"><span data-stu-id="b6a92-163">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="b6a92-164">Identifica l'interfaccia di origine e la classe che implementa i metodi dell'interfaccia eventi.</span><span class="sxs-lookup"><span data-stu-id="b6a92-164">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="b6a92-165">Indica che l'assembly è stato importato in origine da una libreria dei tipi COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-165">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="b6a92-166">Questo attributo contiene la definizione della libreria dei tipi di origine.</span><span class="sxs-lookup"><span data-stu-id="b6a92-166">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="b6a92-167">Contiene i **FUNCFLAGS** importati in origine per questa funzione dalla libreria dei tipi COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-167">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="b6a92-168">Contiene i **TYPEFLAGS** importati in origine per questo tipo dalla libreria dei tipi COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-168">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="b6a92-169">Contiene i **VARFLAGS** importati in origine per questa variabile dalla libreria dei tipi COM.</span><span class="sxs-lookup"><span data-stu-id="b6a92-169">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b6a92-170">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="b6a92-170">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="b6a92-171">Esposizione di componenti .NET Framework a COM</span><span class="sxs-lookup"><span data-stu-id="b6a92-171">Exposing .NET Framework Components to COM</span></span>](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="b6a92-172">Attributi</span><span class="sxs-lookup"><span data-stu-id="b6a92-172">Attributes</span></span>](../../../docs/standard/attributes/index.md)
- [<span data-ttu-id="b6a92-173">Qualificazione di tipi .NET per l'interoperabilità</span><span class="sxs-lookup"><span data-stu-id="b6a92-173">Qualifying .NET Types for Interoperation</span></span>](../../../docs/standard/native-interop/qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="b6a92-174">Creazione di un pacchetto di un assembly .NET Framework per COM</span><span class="sxs-lookup"><span data-stu-id="b6a92-174">Packaging a .NET Framework Assembly for COM</span></span>](../../../docs/framework/interop/packaging-an-assembly-for-com.md)
