---
title: Procedure consigliate per il caricamento di assembly
description: Esplorare le procedure consigliate per il caricamento di assembly in .NET. Evitare problemi di identità del tipo che possono causare cast non validi, metodi mancanti e altre eccezioni.
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies,binding
- LoadFrom method
- default load context
- TypeLoadException class,causes
- assembly loading errors
- load contexts
- assemblies,loading
- LoadWithPartialName method
- load-from context
ms.assetid: 68d1c539-6a47-4614-ab59-4b071c9d4b4c
ms.openlocfilehash: 8ee5243258ea1b853b4690b79ec032c46d1b3777
ms.sourcegitcommit: c23d9666ec75b91741da43ee3d91c317d68c7327
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/01/2020
ms.locfileid: "85803502"
---
# <a name="best-practices-for-assembly-loading"></a><span data-ttu-id="1fd5a-104">Procedure consigliate per il caricamento di assembly</span><span class="sxs-lookup"><span data-stu-id="1fd5a-104">Best Practices for Assembly Loading</span></span>
<span data-ttu-id="1fd5a-105">Questo articolo illustra come evitare problemi di identità del tipo che possono causare eccezioni <xref:System.InvalidCastException>, <xref:System.MissingMethodException> e altri errori.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-105">This article discusses ways to avoid problems of type identity that can lead to <xref:System.InvalidCastException>, <xref:System.MissingMethodException>, and other errors.</span></span> <span data-ttu-id="1fd5a-106">Nell'articolo vengono discussi i seguenti suggerimenti:</span><span class="sxs-lookup"><span data-stu-id="1fd5a-106">The article discusses the following recommendations:</span></span>  
  
- [<span data-ttu-id="1fd5a-107">Comprendere i vantaggi e gli svantaggi dei contesti di carico</span><span class="sxs-lookup"><span data-stu-id="1fd5a-107">Understand the advantages and disadvantages of load contexts</span></span>](#load_contexts)  
  
- [<span data-ttu-id="1fd5a-108">Evitare l'associazione di nomi di assembly parziali</span><span class="sxs-lookup"><span data-stu-id="1fd5a-108">Avoid binding on partial assembly names</span></span>](#avoid_partial_names)  
  
- [<span data-ttu-id="1fd5a-109">Evitare il caricamento di un assembly in più contesti</span><span class="sxs-lookup"><span data-stu-id="1fd5a-109">Avoid loading an assembly into multiple contexts</span></span>](#avoid_loading_into_multiple_contexts)  
  
- [<span data-ttu-id="1fd5a-110">Evitare il caricamento di più versioni di un assembly nello stesso contesto</span><span class="sxs-lookup"><span data-stu-id="1fd5a-110">Avoid loading multiple versions of an assembly into the same context</span></span>](#avoid_loading_multiple_versions)  
  
- [<span data-ttu-id="1fd5a-111">Considerare il passaggio al contesto di caricamento predefinito</span><span class="sxs-lookup"><span data-stu-id="1fd5a-111">Consider switching to the default load context</span></span>](#switch_to_default)  
  
 <span data-ttu-id="1fd5a-112">Il primo suggerimento [Esaminare i vantaggi e gli svantaggi dei contesti di caricamento](#load_contexts) fornisce informazioni di base per le altre indicazioni, che dipendono dalla conoscenza dei contesti di caricamento.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-112">The first recommendation, [understand the advantages and disadvantages of load contexts](#load_contexts), provides background information for the other recommendations, because they all depend on a knowledge of load contexts.</span></span>  
  
<a name="load_contexts"></a>
## <a name="understand-the-advantages-and-disadvantages-of-load-contexts"></a><span data-ttu-id="1fd5a-113">Esaminare i vantaggi e gli svantaggi dei contesti di caricamento</span><span class="sxs-lookup"><span data-stu-id="1fd5a-113">Understand the Advantages and Disadvantages of Load Contexts</span></span>  
 <span data-ttu-id="1fd5a-114">All'interno di un dominio dell'applicazione gli assembly possono essere caricati in uno dei tre contesti disponibili o essere caricati senza contesto:</span><span class="sxs-lookup"><span data-stu-id="1fd5a-114">Within an application domain, assemblies can be loaded into one of three contexts, or they can be loaded without context:</span></span>  
  
- <span data-ttu-id="1fd5a-115">Il contesto di caricamento di default contiene gli assembly rilevati mediante l'esecuzione di probe nella Global Assembly Cache, nello store di assembly dell'host se il runtime è gestito tramite host (ad esempio in SQL Server) e in <xref:System.AppDomainSetup.ApplicationBase%2A> e <xref:System.AppDomainSetup.PrivateBinPath%2A> nel dominio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-115">The default load context contains assemblies found by probing the global assembly cache, the host assembly store if the runtime is hosted (for example, in SQL Server), and the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> of the application domain.</span></span> <span data-ttu-id="1fd5a-116">La maggior parte degli overload del metodo <xref:System.Reflection.Assembly.Load%2A> carica gli assembly in questo contesto.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-116">Most overloads of the <xref:System.Reflection.Assembly.Load%2A> method load assemblies into this context.</span></span>  
  
- <span data-ttu-id="1fd5a-117">Il contesto di origine del caricamento contiene assembly caricati da percorsi nei quali il caricatore non esegue ricerche.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-117">The load-from context contains assemblies that are loaded from locations that are not searched by the loader.</span></span> <span data-ttu-id="1fd5a-118">Ad esempio i componenti aggiuntivi potrebbero essere installati in una directory che non si trova nel percorso dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-118">For example, add-ins might be installed in a directory that is not under the application path.</span></span> <span data-ttu-id="1fd5a-119"><xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>, <xref:System.AppDomain.CreateInstanceFrom%2A?displayProperty=nameWithType> e <xref:System.AppDomain.ExecuteAssembly%2A?displayProperty=nameWithType> sono esempi di metodi che vengono caricati in base al percorso.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-119"><xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>, <xref:System.AppDomain.CreateInstanceFrom%2A?displayProperty=nameWithType>, and <xref:System.AppDomain.ExecuteAssembly%2A?displayProperty=nameWithType> are examples of methods that load by path.</span></span>  
  
- <span data-ttu-id="1fd5a-120">Il contesto Reflection-Only contiene assembly caricati con i metodi <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A> e <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-120">The reflection-only context contains assemblies loaded with the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A> and <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A> methods.</span></span> <span data-ttu-id="1fd5a-121">Il codice in questo contesto non può essere eseguito, pertanto non viene discusso in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-121">Code in this context cannot be executed, so it is not discussed here.</span></span> <span data-ttu-id="1fd5a-122">Per altre informazioni, vedere [Procedura: Caricare assembly nel contesto Reflection-Only](../reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).</span><span class="sxs-lookup"><span data-stu-id="1fd5a-122">For more information, see [How to: Load Assemblies into the Reflection-Only Context](../reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).</span></span>  
  
- <span data-ttu-id="1fd5a-123">Se un assembly dinamico temporaneo è stato generato tramite reflection emit non è presente in nessun contesto.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-123">If you generated a transient dynamic assembly by using reflection emit, the assembly is not in any context.</span></span> <span data-ttu-id="1fd5a-124">Inoltre la maggior parte degli assembly caricati con il metodo <xref:System.Reflection.Assembly.LoadFile%2A> vengono caricati senza contesto mentre gli assembly caricati da matrici di byte vengono caricati senza contesto a meno che la loro identità, dopo l'applicazione dei criteri, non stabilisca che si trovano nella Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-124">In addition, most assemblies that are loaded by using the <xref:System.Reflection.Assembly.LoadFile%2A> method are loaded without context, and assemblies that are loaded from byte arrays are loaded without context unless their identity (after policy is applied) establishes that they are in the global assembly cache.</span></span>  
  
 <span data-ttu-id="1fd5a-125">I contesti di esecuzione presentano vantaggi e svantaggi, illustrati nelle sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-125">The execution contexts have advantages and disadvantages, as discussed in the following sections.</span></span>  
  
### <a name="default-load-context"></a><span data-ttu-id="1fd5a-126">Contesto di caricamento predefinito</span><span class="sxs-lookup"><span data-stu-id="1fd5a-126">Default Load Context</span></span>  
 <span data-ttu-id="1fd5a-127">Quando gli assembly vengono caricati nel contesto di caricamento predefinito le relative dipendenze vengono caricate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-127">When assemblies are loaded into the default load context, their dependencies are loaded automatically.</span></span> <span data-ttu-id="1fd5a-128">Le dipendenze caricate nel contesto di caricamento predefinito vengono rilevate automaticamente per gli assembly che si trovano in tale contesto o nel contesto di origine del caricamento.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-128">Dependencies that are loaded into the default load context are found automatically for assemblies in the default load context or the load-from context.</span></span> <span data-ttu-id="1fd5a-129">Il caricamento tramite identità dell'assembly aumenta la stabilità delle applicazioni impedendo l'uso di versioni sconosciute degli assembly. Vedere la sezione [Evitare l'associazione di nomi di assembly parziali](#avoid_partial_names).</span><span class="sxs-lookup"><span data-stu-id="1fd5a-129">Loading by assembly identity increases the stability of applications by ensuring that unknown versions of assemblies are not used (see the [Avoid Binding on Partial Assembly Names](#avoid_partial_names) section).</span></span>  
  
 <span data-ttu-id="1fd5a-130">L'uso del contesto di caricamento predefinito presenta i seguenti svantaggi:</span><span class="sxs-lookup"><span data-stu-id="1fd5a-130">Using the default load context has the following disadvantages:</span></span>  
  
- <span data-ttu-id="1fd5a-131">Le dipendenze caricate in altri contesti non sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-131">Dependencies that are loaded into other contexts are not available.</span></span>  
  
- <span data-ttu-id="1fd5a-132">Non è possibile caricare assembly da percorsi esterni al percorso di esecuzione del probe nel contesto di caricamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-132">You cannot load assemblies from locations outside the probing path into the default load context.</span></span>  
  
### <a name="load-from-context"></a><span data-ttu-id="1fd5a-133">Contesto di origine del caricamento</span><span class="sxs-lookup"><span data-stu-id="1fd5a-133">Load-From Context</span></span>  
 <span data-ttu-id="1fd5a-134">Il contesto di origine del caricamento consente di caricare un assembly da un percorso esterno al percorso dell'applicazione e pertanto non incluso nell'esecuzione del probe.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-134">The load-from context lets you load an assembly from a path that is not under the application path, and therefore is not included in probing.</span></span> <span data-ttu-id="1fd5a-135">Consente il rilevamento e il caricamento delle dipendenze da tale percorso, perché le informazioni del percorso sono gestite dal contesto.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-135">It enables dependencies to be located and loaded from that path, because the path information is maintained by the context.</span></span> <span data-ttu-id="1fd5a-136">Inoltre gli assembly in questo contesto possono usare le dipendenze caricate nel contesto di caricamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-136">In addition, assemblies in this context can use dependencies that are loaded into the default load context.</span></span>  
  
 <span data-ttu-id="1fd5a-137">Il caricamento di assembly con il metodo <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> o uno degli altri metodi di caricamento in base al percorso presenta i seguenti svantaggi:</span><span class="sxs-lookup"><span data-stu-id="1fd5a-137">Loading assemblies by using the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method, or one of the other methods that load by path, has the following disadvantages:</span></span>  
  
- <span data-ttu-id="1fd5a-138">Se è già caricato un assembly con la stessa identità <xref:System.Reflection.Assembly.LoadFrom%2A> restituisce l'assembly caricato anche se è stato specificato un percorso diverso.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-138">If an assembly with the same identity is already loaded, <xref:System.Reflection.Assembly.LoadFrom%2A> returns the loaded assembly even if a different path was specified.</span></span>  
  
- <span data-ttu-id="1fd5a-139">Se un assembly viene caricato con <xref:System.Reflection.Assembly.LoadFrom%2A> e successivamente un assembly nel contesto di caricamento predefinito tenta di caricare lo stesso assembly in base al nome visualizzato, il tentativo di caricamento non riesce.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-139">If an assembly is loaded with <xref:System.Reflection.Assembly.LoadFrom%2A>, and later an assembly in the default load context tries to load the same assembly by display name, the load attempt fails.</span></span> <span data-ttu-id="1fd5a-140">Questa situazione può verificarsi quando un assembly è deserializzato.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-140">This can occur when an assembly is deserialized.</span></span>  
  
- <span data-ttu-id="1fd5a-141">Se un assembly viene caricato con <xref:System.Reflection.Assembly.LoadFrom%2A> e il percorso di esecuzione del probe include un assembly con la stessa identità ma situato in un percorso diverso possono verificarsi eccezioni <xref:System.InvalidCastException>, <xref:System.MissingMethodException> o altri comportamenti imprevisti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-141">If an assembly is loaded with <xref:System.Reflection.Assembly.LoadFrom%2A>, and the probing path includes an assembly with the same identity but in a different location, an <xref:System.InvalidCastException>, <xref:System.MissingMethodException>, or other unexpected behavior can occur.</span></span>  
  
- <span data-ttu-id="1fd5a-142"><xref:System.Reflection.Assembly.LoadFrom%2A> richiede <xref:System.Security.Permissions.FileIOPermissionAccess.Read?displayProperty=nameWithType> e <xref:System.Security.Permissions.FileIOPermissionAccess.PathDiscovery?displayProperty=nameWithType> o <xref:System.Net.WebPermission> per il percorso specificato.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-142"><xref:System.Reflection.Assembly.LoadFrom%2A> demands <xref:System.Security.Permissions.FileIOPermissionAccess.Read?displayProperty=nameWithType> and <xref:System.Security.Permissions.FileIOPermissionAccess.PathDiscovery?displayProperty=nameWithType>, or <xref:System.Net.WebPermission>, on the specified path.</span></span>  
  
- <span data-ttu-id="1fd5a-143">Se esiste un'immagine nativa per l'assembly tale immagine non viene usata.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-143">If a native image exists for the assembly, it is not used.</span></span>  
  
- <span data-ttu-id="1fd5a-144">L'assembly non può essere caricato come modulo indipendente dal dominio.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-144">The assembly cannot be loaded as domain-neutral.</span></span>  
  
- <span data-ttu-id="1fd5a-145">Nelle versioni 1.0 e 1.1 di .NET Framework i criteri non vengono applicati.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-145">In the .NET Framework versions 1.0 and 1.1, policy is not applied.</span></span>  
  
### <a name="no-context"></a><span data-ttu-id="1fd5a-146">Nessun contesto</span><span class="sxs-lookup"><span data-stu-id="1fd5a-146">No Context</span></span>  
 <span data-ttu-id="1fd5a-147">Il caricamento senza contesto è l'unica opzione disponibile per gli assembly temporanei generati con reflection emit.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-147">Loading without context is the only option for transient assemblies that are generated with reflection emit.</span></span> <span data-ttu-id="1fd5a-148">Il caricamento senza contesto è l'unico metodo per caricare più assembly con la stessa identità in un unico dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-148">Loading without context is the only way to load multiple assemblies that have the same identity into one application domain.</span></span> <span data-ttu-id="1fd5a-149">Inoltre evita l'esecuzione del probe.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-149">The cost of probing is avoided.</span></span>  
  
 <span data-ttu-id="1fd5a-150">Gli assembly caricati da matrici di byte vengono caricati senza contesto a meno che l'identità dell'assembly, stabilita quando vengono applicati i criteri, non corrisponda all'identità di un assembly nella Global Assembly Cache. In tal caso l'assembly viene caricato dalla Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-150">Assemblies that are loaded from byte arrays are loaded without context unless the identity of the assembly, which is established when policy is applied, matches the identity of an assembly in the global assembly cache; in that case, the assembly is loaded from the global assembly cache.</span></span>  
  
 <span data-ttu-id="1fd5a-151">Il caricamento di assembly senza contesto presenta i seguenti svantaggi:</span><span class="sxs-lookup"><span data-stu-id="1fd5a-151">Loading assemblies without context has the following disadvantages:</span></span>  
  
- <span data-ttu-id="1fd5a-152">Gli altri assembly non possono essere associati agli assembly caricati senza contesto, a meno che non si gestisca l'evento <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-152">Other assemblies cannot bind to assemblies that are loaded without context, unless you handle the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>  
  
- <span data-ttu-id="1fd5a-153">Le dipendenze non vengono caricate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-153">Dependencies are not loaded automatically.</span></span> <span data-ttu-id="1fd5a-154">È possibile precaricarle senza contesto, precaricarle nel contesto di caricamento predefinito o caricarle tramite la gestione dell'evento <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-154">You can preload them without context, preload them into the default load context, or load them by handling the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>  
  
- <span data-ttu-id="1fd5a-155">Il caricamento di più assembly con la stessa identità senza contesto può causare problemi di identità del tipo simili a quelli causati dal caricamento di assembly con la stessa identità in più contesti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-155">Loading multiple assemblies with the same identity without context can cause type identity problems similar to those caused by loading assemblies with the same identity into multiple contexts.</span></span> <span data-ttu-id="1fd5a-156">Vedere [Evitare il caricamento di un assembly in più contesti](#avoid_loading_into_multiple_contexts).</span><span class="sxs-lookup"><span data-stu-id="1fd5a-156">See [Avoid Loading an Assembly into Multiple Contexts](#avoid_loading_into_multiple_contexts).</span></span>  
  
- <span data-ttu-id="1fd5a-157">Se esiste un'immagine nativa per l'assembly tale immagine non viene usata.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-157">If a native image exists for the assembly, it is not used.</span></span>  
  
- <span data-ttu-id="1fd5a-158">L'assembly non può essere caricato come modulo indipendente dal dominio.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-158">The assembly cannot be loaded as domain-neutral.</span></span>  
  
- <span data-ttu-id="1fd5a-159">Nelle versioni 1.0 e 1.1 di .NET Framework i criteri non vengono applicati.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-159">In the .NET Framework versions 1.0 and 1.1, policy is not applied.</span></span>  
  
<a name="avoid_partial_names"></a>
## <a name="avoid-binding-on-partial-assembly-names"></a><span data-ttu-id="1fd5a-160">Evitare l'associazione di nomi di assembly parziali</span><span class="sxs-lookup"><span data-stu-id="1fd5a-160">Avoid Binding on Partial Assembly Names</span></span>  
 <span data-ttu-id="1fd5a-161">L'associazione di un nome parziale si verifica quando al caricamento di un assembly si specifica solo una parte del nome visualizzato dell'assembly (<xref:System.Reflection.Assembly.FullName%2A>).</span><span class="sxs-lookup"><span data-stu-id="1fd5a-161">Partial name binding occurs when you specify only part of the assembly display name (<xref:System.Reflection.Assembly.FullName%2A>) when you load an assembly.</span></span> <span data-ttu-id="1fd5a-162">Ad esempio è possibile chiamare il metodo <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> solo con il nome semplice dell'assembly, omettendo la versione, le impostazioni cultura e il token di chiave pubblica.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-162">For example, you might call the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method with only the simple name of the assembly, omitting the version, culture, and public key token.</span></span> <span data-ttu-id="1fd5a-163">Oppure è possibile chiamare il metodo <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> il quale prima chiama il metodo <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType>, quindi se questo non individua l'assembly esegue una ricerca nella Global Assembly Cache e carica la versione disponibile più recente dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-163">Or you might call the <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> method, which first calls the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method and, if that fails to locate the assembly, searches the global assembly cache and loads the latest available version of the assembly.</span></span>  
  
 <span data-ttu-id="1fd5a-164">L'associazione di nomi parziali può causare numerosi problemi, inclusi i seguenti:</span><span class="sxs-lookup"><span data-stu-id="1fd5a-164">Partial name binding can cause many problems, including the following:</span></span>  
  
- <span data-ttu-id="1fd5a-165">Il metodo <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> potrebbe caricare un assembly diverso con lo stesso nome semplice.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-165">The <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> method might load a different assembly with the same simple name.</span></span> <span data-ttu-id="1fd5a-166">Ad esempio è possibile che due applicazioni installino nella Global Assembly Cache due assembly completamente diversi che hanno lo stesso nome semplice `GraphicsLibrary`.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-166">For example, two applications might install two completely different assemblies that both have the simple name `GraphicsLibrary` into the global assembly cache.</span></span>  
  
- <span data-ttu-id="1fd5a-167">L'assembly realmente caricato potrebbe non essere compatibile con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-167">The assembly that is actually loaded might not be backward-compatible.</span></span> <span data-ttu-id="1fd5a-168">Ad esempio se non si specifica la versione potrebbe essere caricata una versione di molto successiva a quella che il programma doveva usare in origine.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-168">For example, not specifying the version might result in the loading of a much later version than the version your program was originally written to use.</span></span> <span data-ttu-id="1fd5a-169">Le modifiche presenti nella versione successiva potrebbero causare errori nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-169">Changes in the later version might cause errors in your application.</span></span>  
  
- <span data-ttu-id="1fd5a-170">L'assembly realmente caricato potrebbe non essere compatibile con le versioni successive.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-170">The assembly that is actually loaded might not be forward-compatible.</span></span> <span data-ttu-id="1fd5a-171">Ad esempio l'applicazione può essere stata creata e sottoposta a test con la versione più recente di un assembly, ma l'associazione parziale potrebbe caricare una versione di molto anteriore, che non dispone delle funzionalità usate dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-171">For example, you might have built and tested your application with the latest version of an assembly, but partial binding might load a much earlier version that lacks features your application uses.</span></span>  
  
- <span data-ttu-id="1fd5a-172">L'installazione di nuove applicazioni può compromettere il funzionamento delle applicazioni esistenti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-172">Installing new applications can break existing applications.</span></span> <span data-ttu-id="1fd5a-173">Il funzionamento di un'applicazione che usa il metodo <xref:System.Reflection.Assembly.LoadWithPartialName%2A> può essere compromesso dall'installazione di una versione più recente e non compatibile di un assembly condiviso.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-173">An application that uses the <xref:System.Reflection.Assembly.LoadWithPartialName%2A> method can be broken by installing a newer, incompatible version of a shared assembly.</span></span>  
  
- <span data-ttu-id="1fd5a-174">Può verificarsi il caricamento imprevisto di dipendenze.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-174">Unexpected dependency loading can occur.</span></span> <span data-ttu-id="1fd5a-175">Se si caricano due assembly che condividono una dipendenza, il caricamento con associazione parziale può far sì che un assembly usi un componente con il quale non è stato compilato né testato.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-175">It you load two assemblies that share a dependency, loading them with partial binding might result in one assembly using a component that it was not built or tested with.</span></span>  
  
 <span data-ttu-id="1fd5a-176">Per i problemi che può causare, il metodo <xref:System.Reflection.Assembly.LoadWithPartialName%2A> è stato contrassegnato come obsoleto.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-176">Because of the problems it can cause, the <xref:System.Reflection.Assembly.LoadWithPartialName%2A> method has been marked obsolete.</span></span> <span data-ttu-id="1fd5a-177">Si consiglia di usare il metodo <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> e di specificare i nomi visualizzati degli assembly completi.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-177">We recommend that you use the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method instead, and specify full assembly display names.</span></span> <span data-ttu-id="1fd5a-178">Vedere [Comprendere i vantaggi e gli svantaggi dei contesti di caricamento](#load_contexts) e [Considerare il passaggio al contesto di caricamento predefinito](#switch_to_default).</span><span class="sxs-lookup"><span data-stu-id="1fd5a-178">See [Understand the Advantages and Disadvantages of Load Contexts](#load_contexts) and [Consider Switching to the Default Load Context](#switch_to_default).</span></span>  
  
 <span data-ttu-id="1fd5a-179">Se si vuole usare il metodo <xref:System.Reflection.Assembly.LoadWithPartialName%2A> perché semplifica il caricamento degli assembly, tenere presente che l'interruzione del funzionamento dell'applicazione con un messaggio di errore che identifica l'assembly mancante è probabilmente un'esperienza utente migliore all'uso automatico di una versione sconosciuta dell'assembly, che potrebbe causare comportamenti imprevedibili e problemi di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-179">If you want to use the <xref:System.Reflection.Assembly.LoadWithPartialName%2A> method because it makes assembly loading easy, consider that having your application fail with an error message that identifies the missing assembly is likely to provide a better user experience than automatically using an unknown version of the assembly, which might cause unpredictable behavior and security holes.</span></span>  
  
<a name="avoid_loading_into_multiple_contexts"></a>
## <a name="avoid-loading-an-assembly-into-multiple-contexts"></a><span data-ttu-id="1fd5a-180">Evitare il caricamento di un assembly in più contesti</span><span class="sxs-lookup"><span data-stu-id="1fd5a-180">Avoid Loading an Assembly into Multiple Contexts</span></span>  
 <span data-ttu-id="1fd5a-181">Il caricamento di un assembly in più contesti può causare problemi di identità del tipo.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-181">Loading an assembly into multiple contexts can cause type identity problems.</span></span> <span data-ttu-id="1fd5a-182">Quando lo stesso tipo viene caricato dallo stesso assembly in due contesti diversi è come se fossero stati caricati due tipi diversi con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-182">If the same type is loaded from the same assembly into two different contexts, it is as if two different types with the same name had been loaded.</span></span> <span data-ttu-id="1fd5a-183">Se si tenta di eseguire il cast di un tipo all'altro tipo viene generata un'eccezione <xref:System.InvalidCastException> con un messaggio ambiguo indicante che non è possibile eseguire il cast del tipo `MyType` al tipo `MyType`.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-183">An <xref:System.InvalidCastException> is thrown if you try to cast one type to the other, with the confusing message that type `MyType` cannot be cast to type `MyType`.</span></span>  
  
 <span data-ttu-id="1fd5a-184">Si supponga ad esempio che l'interfaccia `ICommunicate` venga dichiarata in un assembly `Utility` al quale fa riferimento sia il programma che altri assembly caricati dal programma stesso.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-184">For example, suppose that the `ICommunicate` interface is declared in an assembly named `Utility`, which is referenced by your program and also by other assemblies that your program loads.</span></span> <span data-ttu-id="1fd5a-185">Gli altri assembly contengono tipi che implementano l'interfaccia `ICommunicate` e consentono al programma di usarli.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-185">These other assemblies contain types that implement the `ICommunicate` interface, allowing your program to use them.</span></span>  
  
 <span data-ttu-id="1fd5a-186">Si consideri ora cosa accade quando viene eseguito il programma.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-186">Now consider what happens when your program is run.</span></span> <span data-ttu-id="1fd5a-187">Gli assembly ai quali fa riferimento il programma vengono caricati nel contesto di caricamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-187">Assemblies that are referenced by your program are loaded into the default load context.</span></span> <span data-ttu-id="1fd5a-188">Se si carica un assembly di destinazione in base all'identità con il metodo <xref:System.Reflection.Assembly.Load%2A>, l'assembly e le relative dipendenze vengono caricati nel contesto di caricamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-188">If you load a target assembly by its identity, using the <xref:System.Reflection.Assembly.Load%2A> method, it will be in the default load context, and so will its dependencies.</span></span> <span data-ttu-id="1fd5a-189">Sia il programma sia l'assembly di destinazione useranno lo stesso assembly `Utility`.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-189">Both your program and the target assembly will use the same `Utility` assembly.</span></span>  
  
 <span data-ttu-id="1fd5a-190">Si supponga tuttavia di caricare l'assembly di destinazione in base al percorso del file, usando il metodo <xref:System.Reflection.Assembly.LoadFile%2A>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-190">However, suppose you load the target assembly by its file path, using the <xref:System.Reflection.Assembly.LoadFile%2A> method.</span></span> <span data-ttu-id="1fd5a-191">L'assembly viene caricato senza contesto, pertanto le relative dipendenze non vengono caricate automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-191">The assembly is loaded without any context, so its dependencies are not automatically loaded.</span></span> <span data-ttu-id="1fd5a-192">Si potrebbe disporre di un gestore per l'evento <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> per fornire la dipendenza e caricare l'assembly `Utility` senza contesto mediante il metodo <xref:System.Reflection.Assembly.LoadFile%2A>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-192">You might have a handler for the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event to supply the dependency, and it might load the `Utility` assembly with no context by using the <xref:System.Reflection.Assembly.LoadFile%2A> method.</span></span> <span data-ttu-id="1fd5a-193">Ora quando si crea un'istanza di un tipo incluso nell'assembly di destinazione e si tenta di assegnarla a una variabile di tipo `ICommunicate` viene restituita un'eccezione <xref:System.InvalidCastException> perché il runtime considera le interfacce `ICommunicate` nelle due copie dell'assembly `Utility` come tipi diversi.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-193">Now when you create an instance of a type that is contained in the target assembly and try to assign it to a variable of type `ICommunicate`, an <xref:System.InvalidCastException> is thrown because the runtime considers the `ICommunicate` interfaces in the two copies of the `Utility` assembly to be different types.</span></span>  
  
 <span data-ttu-id="1fd5a-194">Esistono molti altri scenari in cui un assembly può essere caricato in più contesti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-194">There are many other scenarios in which an assembly can be loaded into multiple contexts.</span></span> <span data-ttu-id="1fd5a-195">L'approccio migliore consiste nell'evitare conflitti riposizionando l'assembly di destinazione nel percorso dell'applicazione e usando il metodo <xref:System.Reflection.Assembly.Load%2A> con il nome visualizzato completo.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-195">The best approach is to avoid conflicts by relocating the target assembly in your application path and using the <xref:System.Reflection.Assembly.Load%2A> method with the full display name.</span></span> <span data-ttu-id="1fd5a-196">L'assembly viene così caricato nel contesto di caricamento predefinito ed entrambi gli assembly usano lo stesso assembly `Utility`.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-196">The assembly is then loaded into the default load context, and both assemblies use the same `Utility` assembly.</span></span>  
  
 <span data-ttu-id="1fd5a-197">Se l'assembly di destinazione deve rimanere al di fuori del percorso dell'applicazione è possibile usare il <xref:System.Reflection.Assembly.LoadFrom%2A> metodo per caricarlo nel contesto di origine del caricamento.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-197">If the target assembly must remain outside your application path, you can use the <xref:System.Reflection.Assembly.LoadFrom%2A> method to load it into the load-from context.</span></span> <span data-ttu-id="1fd5a-198">Se l'assembly di destinazione è stato compilato con un riferimento all'assembly `Utility` dell'applicazione userà l'assembly `Utility` caricato dall'applicazione nel contesto di caricamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-198">If the target assembly was compiled with a reference to your application's `Utility` assembly, it will use the `Utility` assembly that your application has loaded into the default load context.</span></span> <span data-ttu-id="1fd5a-199">Si noti che possono verificarsi problemi se l'assembly di destinazione presenta una dipendenza da una copia dell'assembly `Utility` situata al di fuori del percorso dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-199">Note that problems can occur if the target assembly has a dependency on a copy of the `Utility` assembly located outside your application path.</span></span> <span data-ttu-id="1fd5a-200">Se tale assembly viene caricato nel contesto di origine del caricamento prima che l'applicazione carichi l'assembly `Utility`, il caricamento dell'applicazione avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-200">If that assembly is loaded into the load-from context before your application loads the `Utility` assembly, your application's load will fail.</span></span>  
  
 <span data-ttu-id="1fd5a-201">La sezione [Considerare il passaggio al contesto di caricamento predefinito](#switch_to_default) illustra le alternative all'uso di caricamenti del percorso del file quali <xref:System.Reflection.Assembly.LoadFile%2A> e <xref:System.Reflection.Assembly.LoadFrom%2A>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-201">The [Consider Switching to the Default Load Context](#switch_to_default) section discusses alternatives to using file path loads such as <xref:System.Reflection.Assembly.LoadFile%2A> and <xref:System.Reflection.Assembly.LoadFrom%2A>.</span></span>  
  
<a name="avoid_loading_multiple_versions"></a>
## <a name="avoid-loading-multiple-versions-of-an-assembly-into-the-same-context"></a><span data-ttu-id="1fd5a-202">Evitare il caricamento di più versioni di un assembly nello stesso contesto</span><span class="sxs-lookup"><span data-stu-id="1fd5a-202">Avoid Loading Multiple Versions of an Assembly into the Same Context</span></span>  
 <span data-ttu-id="1fd5a-203">Il caricamento di più versioni di un assembly in un unico contesto di caricamento può causare problemi di identità del tipo.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-203">Loading multiple versions of an assembly into one load context can cause type identity problems.</span></span> <span data-ttu-id="1fd5a-204">Il fatto che lo stesso tipo venga caricato da due versioni dello stesso assembly equivale al caricamento di due tipi diversi con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-204">If the same type is loaded from two versions of the same assembly, it is as if two different types with the same name had been loaded.</span></span> <span data-ttu-id="1fd5a-205">Se si tenta di eseguire il cast di un tipo all'altro tipo viene generata un'eccezione <xref:System.InvalidCastException> con un messaggio ambiguo indicante che non è possibile eseguire il cast del tipo `MyType` al tipo `MyType`.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-205">An <xref:System.InvalidCastException> is thrown if you try to cast one type to the other, with the confusing message that type `MyType` cannot be cast to type `MyType`.</span></span>  
  
 <span data-ttu-id="1fd5a-206">Ad esempio il programma potrebbe caricare immediatamente una versione dell'assembly `Utility` e in seguito caricare un altro assembly che carica una versione diversa dell'assembly `Utility`.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-206">For example, your program might load one version of the `Utility` assembly directly, and later it might load another assembly that loads a different version of the `Utility` assembly.</span></span> <span data-ttu-id="1fd5a-207">Oppure un errore di codifica potrebbe far sì che due percorsi di codice diversi dell'applicazione carichino versioni diverse di un assembly.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-207">Or a coding error might cause two different code paths in your application to load different versions of an assembly.</span></span>  
  
 <span data-ttu-id="1fd5a-208">Nel contesto di caricamento predefinito questo problema può verificarsi quando si usa il metodo <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> e si specificano nomi visualizzati degli assembly completi che includono numeri di versione diversi.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-208">In the default load context, this problem can occur when you use the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method and specify complete assembly display names that include different version numbers.</span></span> <span data-ttu-id="1fd5a-209">Per gli assembly caricati senza contesto, il problema può essere causato dall'uso del metodo <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType> per caricare lo stesso assembly da percorsi diversi.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-209">For assemblies that are loaded without context, the problem can be caused by using the <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType> method to load the same assembly from different paths.</span></span> <span data-ttu-id="1fd5a-210">Il runtime considera due assembly caricati da percorsi diversi come assembly diversi, anche se le loro identità sono uguali.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-210">The runtime considers two assemblies that are loaded from different paths to be different assemblies, even if their identities are the same.</span></span>  
  
 <span data-ttu-id="1fd5a-211">Oltre ai problemi di identità del tipo, più versioni di un assembly possono causare un'eccezione <xref:System.MissingMethodException> se un tipo caricato da una determinata versione dell'assembly viene passato a codice che prevede di ricevere quel tipo da una versione diversa.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-211">In addition to type identity problems, multiple versions of an assembly can cause a <xref:System.MissingMethodException> if a type that is loaded from one version of the assembly is passed to code that expects that type from a different version.</span></span> <span data-ttu-id="1fd5a-212">Ad esempio il codice potrebbe prevedere un metodo aggiunto alla versione successiva.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-212">For example, the code might expect a method that was added to the later version.</span></span>  
  
 <span data-ttu-id="1fd5a-213">Errori più insidiosi possono verificarsi se il comportamento del tipo è cambiato da una versione all'altra.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-213">More subtle errors can occur if the behavior of the type changed between versions.</span></span> <span data-ttu-id="1fd5a-214">Ad esempio un metodo potrebbe generare un'eccezione imprevista o restituire un valore imprevisto.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-214">For example, a method might throw an unexpected exception or return an unexpected value.</span></span>  
  
 <span data-ttu-id="1fd5a-215">Esaminare attentamente il codice per garantire che sia caricata una sola versione di un assembly.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-215">Carefully review your code to ensure that only one version of an assembly is loaded.</span></span> <span data-ttu-id="1fd5a-216">È possibile usare il metodo <xref:System.AppDomain.GetAssemblies%2A?displayProperty=nameWithType> per determinare quali assembly vengono caricati in un determinato momento.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-216">You can use the <xref:System.AppDomain.GetAssemblies%2A?displayProperty=nameWithType> method to determine which assemblies are loaded at any given time.</span></span>  
  
<a name="switch_to_default"></a>
## <a name="consider-switching-to-the-default-load-context"></a><span data-ttu-id="1fd5a-217">Considerare il passaggio al contesto di caricamento predefinito</span><span class="sxs-lookup"><span data-stu-id="1fd5a-217">Consider Switching to the Default Load Context</span></span>  
 <span data-ttu-id="1fd5a-218">Esaminare i modelli di caricamento e distribuzione degli assembly dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-218">Examine your application's assembly loading and deployment patterns.</span></span> <span data-ttu-id="1fd5a-219">È possibile eliminare gli assembly caricati da matrici di byte?</span><span class="sxs-lookup"><span data-stu-id="1fd5a-219">Can you eliminate assemblies that are loaded from byte arrays?</span></span> <span data-ttu-id="1fd5a-220">È possibile spostare gli assembly nel percorso di esecuzione del probe?</span><span class="sxs-lookup"><span data-stu-id="1fd5a-220">Can you move assemblies into the probing path?</span></span> <span data-ttu-id="1fd5a-221">Se gli assembly si trovano nella Global Assembly Cache o nel percorso di esecuzione del probe del dominio applicazione (vale a dire <xref:System.AppDomainSetup.ApplicationBase%2A> e <xref:System.AppDomainSetup.PrivateBinPath%2A>) è possibile caricare l'assembly tramite l'identità.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-221">If assemblies are located in the global assembly cache or in the application domain's probing path (that is, its <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A>), you can load the assembly by its identity.</span></span>  
  
 <span data-ttu-id="1fd5a-222">Se non è possibile inserire tutti gli assembly nel percorso di esecuzione del probe, considerare alternative quali l'uso del modello del componente aggiuntivo di .NET Framework, l'inserimento degli assembly nella Global Assembly Cache o la creazione di domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-222">If it is not possible to put all your assemblies in the probing path, consider alternatives such as using the .NET Framework add-in model, placing assemblies into the global assembly cache, or creating application domains.</span></span>  
  
### <a name="consider-using-the-net-framework-add-in-model"></a><span data-ttu-id="1fd5a-223">Considerare l'uso del modello del componente aggiuntivo di .NET Framework</span><span class="sxs-lookup"><span data-stu-id="1fd5a-223">Consider Using the .NET Framework Add-In Model</span></span>  
 <span data-ttu-id="1fd5a-224">Se si usa il contesto di origine del caricamento per implementare i componenti aggiuntivi, che in genere non vengono installati nella base dell'applicazione, usare il modello del componente aggiuntivo di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-224">If you are using the load-from context to implement add-ins, which typically are not installed in the application base, use the .NET Framework add-in model.</span></span> <span data-ttu-id="1fd5a-225">Questo modello fornisce l'isolamento a livello del dominio applicazione o del processo e non richiede alcuna gestione dei domini applicazione da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-225">This model provides isolation at the application domain or process level, without requiring you to manage application domains yourself.</span></span> <span data-ttu-id="1fd5a-226">Per informazioni sul modello del componente aggiuntivo, vedere [Componenti aggiuntivi ed estensibilità](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="1fd5a-226">For information about the add-in model, see [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>  
  
### <a name="consider-using-the-global-assembly-cache"></a><span data-ttu-id="1fd5a-227">Considerare l'uso della Global Assembly Cache</span><span class="sxs-lookup"><span data-stu-id="1fd5a-227">Consider Using the Global Assembly Cache</span></span>  
 <span data-ttu-id="1fd5a-228">L'inserimento degli assembly nella Global Assembly Cache consente di sfruttare il vantaggio di un percorso dell'assembly condiviso al di fuori della base dell'applicazione, senza rinunciare ai vantaggi del contesto di caricamento predefinito né avere gli svantaggi degli altri contesti.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-228">Place assemblies in the global assembly cache to get the benefit of a shared assembly path that is outside the application base, without losing the advantages of the default load context or taking on the disadvantages of the other contexts.</span></span>  
  
### <a name="consider-using-application-domains"></a><span data-ttu-id="1fd5a-229">Considerare l'uso dei domini applicazione</span><span class="sxs-lookup"><span data-stu-id="1fd5a-229">Consider Using Application Domains</span></span>  
 <span data-ttu-id="1fd5a-230">Se risulta impossibile distribuire alcuni assembly nel percorso di esecuzione del probe dell'applicazione, considerare la possibilità di creare di un nuovo dominio applicazione per tali assembly.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-230">If you determine that some of your assemblies cannot be deployed in the application's probing path, consider creating a new application domain for those assemblies.</span></span> <span data-ttu-id="1fd5a-231">Usare un oggetto <xref:System.AppDomainSetup> per creare il nuovo dominio applicazione e la proprietà <xref:System.AppDomainSetup.ApplicationBase%2A?displayProperty=nameWithType> per specificare il percorso che contiene gli assembly da caricare.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-231">Use an <xref:System.AppDomainSetup> to create the new application domain, and use the <xref:System.AppDomainSetup.ApplicationBase%2A?displayProperty=nameWithType> property to specify the path that contains the assemblies you want to load.</span></span> <span data-ttu-id="1fd5a-232">Se è necessario eseguire il probe in più directory, è possibile impostare <xref:System.AppDomainSetup.ApplicationBase%2A> su una directory radice e usare la proprietà <xref:System.AppDomainSetup.PrivateBinPath%2A?displayProperty=nameWithType> per identificare le sottodirectory in cui eseguire il probe.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-232">If you have multiple directories to probe, you can set the <xref:System.AppDomainSetup.ApplicationBase%2A> to a root directory and use the <xref:System.AppDomainSetup.PrivateBinPath%2A?displayProperty=nameWithType> property to identify the subdirectories to probe.</span></span> <span data-ttu-id="1fd5a-233">In alternativa è possibile creare più domini applicazione e impostare la proprietà <xref:System.AppDomainSetup.ApplicationBase%2A> di ogni dominio sul percorso appropriato per gli assembly.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-233">Alternatively, you can create multiple application domains and set the <xref:System.AppDomainSetup.ApplicationBase%2A> of each application domain to the appropriate path for its assemblies.</span></span>  
  
 <span data-ttu-id="1fd5a-234">Per caricare questi assembly è possibile usare il metodo <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-234">Note that you can use the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method to load these assemblies.</span></span> <span data-ttu-id="1fd5a-235">Dal momento che ora si trovano nel percorso di esecuzione del probe, verranno caricati nel contesto di caricamento predefinito anziché nel contesto di origine del caricamento.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-235">Because they are now in the probing path, they will be loaded into the default load context instead of the load-from context.</span></span> <span data-ttu-id="1fd5a-236">Tuttavia è consigliabile passare al metodo <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> e fornire i nomi visualizzati degli assembly completi per assicurare che vengano sempre usate versioni corrette.</span><span class="sxs-lookup"><span data-stu-id="1fd5a-236">However, we recommend that you switch to the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method and supply full assembly display names to ensure that correct versions are always used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1fd5a-237">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="1fd5a-237">See also</span></span>

- <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType>
- <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>
- <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType>
- <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType>
