---
title: Eventi di automazione interfaccia utente per i client
description: Informazioni su come gli eventi di automazione interfaccia utente Microsoft vengono usati dai client di automazione interfaccia utente in .NET. Automazione interfaccia utente consente ai client di sottoscrivere gli eventi di interesse.
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, events for clients
- events, UI Automation clients
ms.assetid: b909e388-3f24-4997-b6d4-bd9c35c2dc27
ms.openlocfilehash: 84568cf228a30535ec603cdad5bddbfd5697be0a
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/17/2020
ms.locfileid: "84903740"
---
# <a name="ui-automation-events-for-clients"></a><span data-ttu-id="fbfe3-104">Eventi di automazione interfaccia utente per i client</span><span class="sxs-lookup"><span data-stu-id="fbfe3-104">UI Automation Events for Clients</span></span>
> [!NOTE]
> <span data-ttu-id="fbfe3-105">Questa documentazione è destinata agli sviluppatori di .NET Framework che vogliono usare le classi gestite di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] definite nello spazio dei nomi <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="fbfe3-106">Per informazioni aggiornate su [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], vedere [Windows Automation API: automazione interfaccia utente](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="fbfe3-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="fbfe3-107">Questo argomento descrive come gli eventi di [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] vengono usati dai client di automazione interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-107">This topic describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] events are used by UI Automation clients.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="fbfe3-108">consente ai client di sottoscrivere gli eventi di interesse.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-108">allows clients to subscribe to events of interest.</span></span> <span data-ttu-id="fbfe3-109">Questa funzionalità migliora le prestazioni eliminando la necessità di esaminare continuamente tutti gli elementi dell'[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] nel sistema per verificare se sono state apportate modifiche alle informazioni, la struttura o lo stato.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-109">This capability improves performance by eliminating the need to continually poll all the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements in the system to see if any information, structure, or state has changed.</span></span>  
  
 <span data-ttu-id="fbfe3-110">Una maggiore efficienza è ottenuta anche grazie alla possibilità di restare in ascolto di eventi solo in un ambito definito.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-110">Efficiency is also improved by the ability to listen for events only within a defined scope.</span></span> <span data-ttu-id="fbfe3-111">Un client, ad esempio, può restare in ascolto di eventi di modifica dello stato attivo per tutti gli elementi di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dell'albero o solo per un elemento e i relativi discendenti.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-111">For example, a client can listen for focus change events on all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements in the tree, or on just one element and its descendants.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="fbfe3-112">Non presupporre che tutti i possibili eventi vengano generati da un provider di [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fbfe3-112">Do not assume that all possible events are raised by a [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] provider.</span></span> <span data-ttu-id="fbfe3-113">Non tutte le modifiche alle proprietà, ad esempio, determinano la generazione di eventi da parte dei provider proxy standard per i controlli Windows Forms e Win32.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-113">For example, not all property changes cause events to be raised by the standard proxy providers for Windows Forms and Win32 controls.</span></span>  
  
 <span data-ttu-id="fbfe3-114">Per una visualizzazione più ampia degli [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] eventi, vedere [Panoramica degli eventi di automazione interfaccia utente](ui-automation-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fbfe3-114">For a broader view of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events, see [UI Automation Events Overview](ui-automation-events-overview.md).</span></span>  
  
<a name="Subscribing_to_Events"></a>
## <a name="subscribing-to-events"></a><span data-ttu-id="fbfe3-115">Sottoscrizione di eventi</span><span class="sxs-lookup"><span data-stu-id="fbfe3-115">Subscribing to Events</span></span>  
 <span data-ttu-id="fbfe3-116">Le applicazioni client sottoscrivono eventi di una particolare tipologia registrando un gestore eventi, con uno dei metodi seguenti.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-116">Client applications subscribe to events of a particular kind by registering an event handler, using one of the following methods.</span></span>  
  
|<span data-ttu-id="fbfe3-117">Metodo</span><span class="sxs-lookup"><span data-stu-id="fbfe3-117">Method</span></span>|<span data-ttu-id="fbfe3-118">Tipo evento</span><span class="sxs-lookup"><span data-stu-id="fbfe3-118">Event Type</span></span>|<span data-ttu-id="fbfe3-119">Tipo argomenti evento</span><span class="sxs-lookup"><span data-stu-id="fbfe3-119">Event Arguments Type</span></span>|<span data-ttu-id="fbfe3-120">Tipo di delegato</span><span class="sxs-lookup"><span data-stu-id="fbfe3-120">Delegate Type</span></span>|  
|------------|----------------|--------------------------|-------------------|  
|<xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A>|<span data-ttu-id="fbfe3-121">Modifica dello stato attivo</span><span class="sxs-lookup"><span data-stu-id="fbfe3-121">Focus change</span></span>|<xref:System.Windows.Automation.AutomationFocusChangedEventArgs>|<xref:System.Windows.Automation.AutomationFocusChangedEventHandler>|  
|<xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A>|<span data-ttu-id="fbfe3-122">Modifica proprietà</span><span class="sxs-lookup"><span data-stu-id="fbfe3-122">Property change</span></span>|<xref:System.Windows.Automation.AutomationPropertyChangedEventArgs>|<xref:System.Windows.Automation.AutomationPropertyChangedEventHandler>|  
|<xref:System.Windows.Automation.Automation.AddStructureChangedEventHandler%2A>|<span data-ttu-id="fbfe3-123">Modifica struttura</span><span class="sxs-lookup"><span data-stu-id="fbfe3-123">Structure change</span></span>|<xref:System.Windows.Automation.StructureChangedEventArgs>|<xref:System.Windows.Automation.StructureChangedEventHandler>|  
|<xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>|<span data-ttu-id="fbfe3-124">Tutti gli altri eventi, identificati da <xref:System.Windows.Automation.AutomationEvent></span><span class="sxs-lookup"><span data-stu-id="fbfe3-124">All other events, identified by an <xref:System.Windows.Automation.AutomationEvent></span></span>|<span data-ttu-id="fbfe3-125"><xref:System.Windows.Automation.AutomationEventArgs> o <xref:System.Windows.Automation.WindowClosedEventArgs></span><span class="sxs-lookup"><span data-stu-id="fbfe3-125"><xref:System.Windows.Automation.AutomationEventArgs> or <xref:System.Windows.Automation.WindowClosedEventArgs></span></span>|<xref:System.Windows.Automation.AutomationEventHandler>|  
  
 <span data-ttu-id="fbfe3-126">Prima di chiamare il metodo, è necessario creare un metodo delegato per gestire l'evento.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-126">Before calling the method, you must create a delegate method to handle the event.</span></span> <span data-ttu-id="fbfe3-127">Se si preferisce, è possibile gestire tipologie diverse di eventi con un solo metodo e passare questo metodo in più chiamate a uno dei metodi della tabella.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-127">If you prefer, you can handle different kinds of events in a single method, and pass this method in multiple calls to one of the methods in the table.</span></span> <span data-ttu-id="fbfe3-128">Ad esempio, è possibile configurare un singolo <xref:System.Windows.Automation.AutomationEventHandler> per gestire svariati eventi in modo diverso in base all'<xref:System.Windows.Automation.AutomationEventArgs.EventId%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-128">For example, a single <xref:System.Windows.Automation.AutomationEventHandler> can be set up to handle various events differently according to the <xref:System.Windows.Automation.AutomationEventArgs.EventId%2A>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="fbfe3-129">Per elaborare eventi di chiusura di finestra, eseguire il cast del tipo di argomento passato al gestore eventi come <xref:System.Windows.Automation.WindowClosedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-129">To process window-closed events, cast the argument type that is passed to the event handler as <xref:System.Windows.Automation.WindowClosedEventArgs>.</span></span> <span data-ttu-id="fbfe3-130">Poiché l'elemento di [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] per la finestra non è più valido, non è possibile usare il parametro `sender` per recuperare le informazioni. Usare invece <xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-130">Because the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] element for the window is no longer valid, you cannot use the `sender` parameter to retrieve information; use <xref:System.Windows.Automation.WindowClosedEventArgs.GetRuntimeId%2A> instead.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="fbfe3-131">Se l'applicazione può ricevere eventi dalla propria [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], non usare il thread dell'[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] dell'applicazione per sottoscrivere gli eventi o per annullare una sottoscrizione,</span><span class="sxs-lookup"><span data-stu-id="fbfe3-131">If your application might receive events from its own [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], do not use your application's [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] thread to subscribe to events, or to unsubscribe.</span></span> <span data-ttu-id="fbfe3-132">perché potrebbe verificarsi un comportamento imprevisto.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-132">Doing so might lead to unpredictable behavior.</span></span> <span data-ttu-id="fbfe3-133">Per altre informazioni, vedere [UI Automation Threading Issues](ui-automation-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="fbfe3-133">For more information, see [UI Automation Threading Issues](ui-automation-threading-issues.md).</span></span>  
  
 <span data-ttu-id="fbfe3-134">All'arresto o quando gli eventi di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] non interessano più l'applicazione, i client di automazione interfaccia utente devono chiamare uno dei metodi seguenti.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-134">On shutdown, or when [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events are no longer of interest to the application, UI Automation clients should call one of the following methods.</span></span>  
  
|<span data-ttu-id="fbfe3-135">Metodo</span><span class="sxs-lookup"><span data-stu-id="fbfe3-135">Method</span></span>|<span data-ttu-id="fbfe3-136">Descrizione</span><span class="sxs-lookup"><span data-stu-id="fbfe3-136">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Windows.Automation.Automation.RemoveAutomationEventHandler%2A>|<span data-ttu-id="fbfe3-137">Annulla la registrazione di un gestore eventi che era stato registrato usando <xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-137">Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationEventHandler%2A>.</span></span>|  
|<xref:System.Windows.Automation.Automation.RemoveAutomationFocusChangedEventHandler%2A>|<span data-ttu-id="fbfe3-138">Annulla la registrazione di un gestore eventi che era stato registrato usando <xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-138">Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationFocusChangedEventHandler%2A>.</span></span>|  
|<xref:System.Windows.Automation.Automation.RemoveAutomationPropertyChangedEventHandler%2A>|<span data-ttu-id="fbfe3-139">Annulla la registrazione di un gestore eventi che era stato registrato usando <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-139">Unregisters an event handler that was registered by using <xref:System.Windows.Automation.Automation.AddAutomationPropertyChangedEventHandler%2A>.</span></span>|  
|<xref:System.Windows.Automation.Automation.RemoveAllEventHandlers%2A>|<span data-ttu-id="fbfe3-140">Annulla la registrazione di tutti i gestori eventi registrati.</span><span class="sxs-lookup"><span data-stu-id="fbfe3-140">Unregisters all registered event handlers.</span></span>|  
  
 <span data-ttu-id="fbfe3-141">Per un esempio di codice, vedere [sottoscrivere eventi di automazione interfaccia utente](subscribe-to-ui-automation-events.md).</span><span class="sxs-lookup"><span data-stu-id="fbfe3-141">For example code, see [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fbfe3-142">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="fbfe3-142">See also</span></span>

- [<span data-ttu-id="fbfe3-143">Sottoscrivere gli eventi di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="fbfe3-143">Subscribe to UI Automation Events</span></span>](subscribe-to-ui-automation-events.md)
- [<span data-ttu-id="fbfe3-144">Cenni preliminari sugli eventi di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="fbfe3-144">UI Automation Events Overview</span></span>](ui-automation-events-overview.md)
- [<span data-ttu-id="fbfe3-145">Cenni preliminari sulle proprietà di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="fbfe3-145">UI Automation Properties Overview</span></span>](ui-automation-properties-overview.md)
- [<span data-ttu-id="fbfe3-146">Esempio TrackFocus</span><span class="sxs-lookup"><span data-stu-id="fbfe3-146">TrackFocus Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/FocusTracker)
