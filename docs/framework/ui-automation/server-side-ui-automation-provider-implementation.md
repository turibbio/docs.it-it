---
title: Implementazione del provider di automazione interfaccia utente lato server
description: Informazioni su come implementare un provider di automazione interfaccia utente sul lato server per un controllo personalizzato in .NET. L'implementazione per gli elementi WPF e non WPF è diversa.
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: ea1b5e668e29d854233d4dde4c0e6152d591da97
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/17/2020
ms.locfileid: "84903896"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="cbcf0-104">Implementazione del provider di automazione interfaccia utente lato server</span><span class="sxs-lookup"><span data-stu-id="cbcf0-104">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="cbcf0-105">Questa documentazione è destinata agli sviluppatori di .NET Framework che vogliono usare le classi gestite di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] definite nello spazio dei nomi <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="cbcf0-106">Per informazioni aggiornate su [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], vedere [Windows Automation API: automazione interfaccia utente](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="cbcf0-107">In questa sezione viene descritto come implementare un provider di automazione interfaccia utente sul lato server per un controllo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-107">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="cbcf0-108">L'implementazione per gli elementi Windows Presentation Foundation (WPF) e gli elementi non WPF (ad esempio quelli progettati per Windows Forms) è fondamentalmente diversa.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-108">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for Windows Forms) is fundamentally different.</span></span> <span data-ttu-id="cbcf0-109">Gli elementi WPF forniscono supporto per [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tramite una classe derivata da <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="cbcf0-109">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="cbcf0-110">Gli elementi non WPF forniscono supporto tramite implementazioni di interfacce del provider.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-110">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="cbcf0-111">Considerazioni relative alla sicurezza</span><span class="sxs-lookup"><span data-stu-id="cbcf0-111">Security Considerations</span></span>

<span data-ttu-id="cbcf0-112">I provider devono essere scritti in modo che possano operare in un ambiente parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-112">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="cbcf0-113">Dato che UIAutomationClient.dll non è configurato per l'esecuzione con attendibilità parziale, il codice del provider non dovrebbe fare riferimento a tale assembly.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-113">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="cbcf0-114">In caso contrario, il codice potrebbe essere eseguito in un ambiente con attendibilità completa, ma poi generare errori in un ambiente parzialmente attendibile.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-114">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="cbcf0-115">In particolare, non usare campi delle classi in UIAutomationClient.dll come quelle in <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-115">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="cbcf0-116">Usare invece i campi equivalenti dalle classi in UIAutomationTypes.dll, come <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-116">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="cbcf0-117">Implementazione di provider da elementi di Windows Presentation Foundation</span><span class="sxs-lookup"><span data-stu-id="cbcf0-117">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="cbcf0-118">Per altre informazioni su questo argomento, vedere [Automazione interfaccia utente di un controllo personalizzato WPF](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-118">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="cbcf0-119">Implementazione di provider da elementi non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-119">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="cbcf0-120">I controlli personalizzati che non fanno parte del framework WPF, ma che sono scritti in codice gestito (spesso si tratta di controlli Windows Forms), offrono il supporto per [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tramite l'implementazione di interfacce.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-120">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are Windows Forms controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="cbcf0-121">Ogni elemento deve implementare almeno una delle interfacce elencate nella prima tabella nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-121">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="cbcf0-122">Inoltre, se l'elemento supporta uno o più pattern di controllo, deve implementare l'interfaccia appropriata per ognuno di essi.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-122">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="cbcf0-123">Il progetto del provider [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] deve fare riferimento agli assembly seguenti:</span><span class="sxs-lookup"><span data-stu-id="cbcf0-123">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="cbcf0-124">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="cbcf0-124">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="cbcf0-125">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="cbcf0-125">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="cbcf0-126">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="cbcf0-126">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="cbcf0-127">Interfacce del provider</span><span class="sxs-lookup"><span data-stu-id="cbcf0-127">Provider Interfaces</span></span>

<span data-ttu-id="cbcf0-128">Ogni provider [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] deve implementare una delle interfacce seguenti.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-128">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="cbcf0-129">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="cbcf0-129">Interface</span></span>|<span data-ttu-id="cbcf0-130">Descrizione</span><span class="sxs-lookup"><span data-stu-id="cbcf0-130">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="cbcf0-131">Fornisce funzionalità per un controllo semplice ospitato in una finestra, incluso il supporto per pattern di controllo e proprietà.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-131">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="cbcf0-132">Eredita dall'oggetto <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="cbcf0-133">Aggiunge la funzionalità per un elemento in un controllo complesso, inclusi lo spostamento all'interno del frammento, l'impostazione dello stato attivo e la restituzione del rettangolo delimitatore dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-133">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="cbcf0-134">Eredita dall'oggetto <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-134">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="cbcf0-135">Aggiunge la funzionalità per l'elemento radice in un controllo complesso, inclusi l'individuazione di un elemento figlio in corrispondenza delle coordinate specificate e l'impostazione dello stato attivo per l'intero controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-135">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="cbcf0-136">Le interfacce seguenti offrono ulteriori funzionalità, ma la loro implementazione non è richiesta.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-136">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="cbcf0-137">Interfaccia</span><span class="sxs-lookup"><span data-stu-id="cbcf0-137">Interface</span></span>|<span data-ttu-id="cbcf0-138">Descrizione</span><span class="sxs-lookup"><span data-stu-id="cbcf0-138">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="cbcf0-139">Consente al provider di tenere traccia delle richieste per eventi.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-139">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="cbcf0-140">Abilita il riposizionamento degli elementi basati su finestra all'interno dell'albero di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] di un frammento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-140">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="cbcf0-141">Tutte le altre interfacce nello spazio dei nomi <xref:System.Windows.Automation.Provider> sono destinate al supporto dei pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-141">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="cbcf0-142">Requisiti per i provider non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-142">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="cbcf0-143">Per comunicare con [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], il tuo controllo deve implementare le aree di funzionalità principali seguenti:</span><span class="sxs-lookup"><span data-stu-id="cbcf0-143">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="cbcf0-144">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="cbcf0-144">Functionality</span></span>|<span data-ttu-id="cbcf0-145">Implementazione</span><span class="sxs-lookup"><span data-stu-id="cbcf0-145">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="cbcf0-146">Esporre il provider a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="cbcf0-146">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="cbcf0-147">In risposta a un messaggio WM_GETOBJECT inviato alla finestra del controllo, restituire l'oggetto che implementa <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (o un'interfaccia derivata).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-147">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="cbcf0-148">Per i frammenti, deve trattarsi del provider per la radice del frammento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-148">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="cbcf0-149">Fornire i valori delle proprietà</span><span class="sxs-lookup"><span data-stu-id="cbcf0-149">Provide property values</span></span>|<span data-ttu-id="cbcf0-150">Implementare <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> per fornire i valori o eseguirne l'override.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-150">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="cbcf0-151">Consentire al client di interagire con il controllo</span><span class="sxs-lookup"><span data-stu-id="cbcf0-151">Enable the client to interact with the control</span></span>|<span data-ttu-id="cbcf0-152">Implementare le interfacce che supportano pattern di controllo, ad esempio <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-152">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="cbcf0-153">Restituire questi provider di pattern nell'implementazione di <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-153">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="cbcf0-154">Generare eventi</span><span class="sxs-lookup"><span data-stu-id="cbcf0-154">Raise events</span></span>|<span data-ttu-id="cbcf0-155">Chiamare uno dei metodi statici di <xref:System.Windows.Automation.Provider.AutomationInteropProvider> per generare un evento di cui un client può rimanere in ascolto.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-155">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="cbcf0-156">Abilitare la navigazione e lo spostamento dello stato attivo all'interno di un frammento</span><span class="sxs-lookup"><span data-stu-id="cbcf0-156">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="cbcf0-157">Implementare <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> per ogni elemento all'interno del frammento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-157">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="cbcf0-158">(Non necessario per gli elementi che non fanno parte di un frammento).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-158">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="cbcf0-159">Abilitare lo spostamento dello stato attivo e il posizionamento dell'elemento figlio in un frammento</span><span class="sxs-lookup"><span data-stu-id="cbcf0-159">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="cbcf0-160">Implementare <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-160">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="cbcf0-161">(Non necessario per gli elementi che non sono radici di frammenti).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-161">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="cbcf0-162">Valori delle proprietà nei provider non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-162">Property Values in Non-WPF Providers</span></span>

<span data-ttu-id="cbcf0-163">I provider[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] per i controlli personalizzati devono supportare determinate proprietà che possono essere usate dai sistemi di automazione ed anche dalle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-163">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="cbcf0-164">Per gli elementi ospitati nelle finestre (HWND), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] può recuperare alcune proprietà dal provider di finestra predefinito, ma deve ottenerne altre dal provider personalizzato.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-164">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="cbcf0-165">I provider per i controlli basati su HWND in genere non richiedono di specificare le proprietà seguenti (identificate da valori di campo):</span><span class="sxs-lookup"><span data-stu-id="cbcf0-165">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="cbcf0-166">Il valore <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> di un elemento semplice o di una radice di frammento ospitato in una finestra viene ottenuto dalla finestra. Tuttavia, gli elementi del frammento sotto la radice (ad esempio voci di elenco in una casella di riepilogo) devono fornire i propri identificatori.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="cbcf0-167">Per altre informazioni, vedere <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-167">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="cbcf0-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>Deve essere restituito per i provider ospitati in un controllo Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="cbcf0-169">In questo caso, il provider di finestra predefinito potrebbe non essere in grado di recuperare il valore corretto.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-169">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="cbcf0-170">Il valore <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> viene in genere fornito dal provider host.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-170">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="cbcf0-171">Ad esempio, se un controllo personalizzato è derivato da <xref:System.Windows.Forms.Control>, il nome è derivato dalla proprietà `Text` del controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-171">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="cbcf0-172">Per il codice di esempio, vedere [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-172">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="cbcf0-173">Eventi nei provider non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-173">Events in Non-WPF Providers</span></span>

<span data-ttu-id="cbcf0-174">I provider[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] devono generare eventi per notificare alle applicazioni client le modifiche allo stato dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-174">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="cbcf0-175">Per generare gli eventi vengono usati i metodi seguenti.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-175">The following methods are used to raise events.</span></span>

|<span data-ttu-id="cbcf0-176">Metodo</span><span class="sxs-lookup"><span data-stu-id="cbcf0-176">Method</span></span>|<span data-ttu-id="cbcf0-177">Descrizione</span><span class="sxs-lookup"><span data-stu-id="cbcf0-177">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="cbcf0-178">Genera vari eventi, inclusi gli eventi attivati dai pattern di controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-178">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="cbcf0-179">Genera un evento in seguito alla modifica di una proprietà [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbcf0-179">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="cbcf0-180">Genera un evento in seguito alla modifica della struttura dell'albero [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , ad esempio per la rimozione o l'aggiunta di un elemento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-180">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="cbcf0-181">Lo scopo di un evento è notificare al client qualcosa che si verifica nell' [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], indipendentemente dal fatto che l'attività sia attivata dal sistema [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] stesso.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-181">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="cbcf0-182">Ad esempio, l'evento identificato da <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> dovrebbe essere generato ogni volta che viene richiamato il controllo, sia tramite input diretto dell'utente o dall'applicazione client che chiama <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-182">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="cbcf0-183">Per ottimizzare le prestazioni, un provider può generare eventi in modo selettivo o non generarne affatto se nessuna applicazione client è registrata per riceverli.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-183">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="cbcf0-184">Per l'ottimizzazione vengono usati i metodi seguenti.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-184">The following methods are used for optimization.</span></span>

|<span data-ttu-id="cbcf0-185">Metodo</span><span class="sxs-lookup"><span data-stu-id="cbcf0-185">Method</span></span>|<span data-ttu-id="cbcf0-186">Descrizione</span><span class="sxs-lookup"><span data-stu-id="cbcf0-186">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="cbcf0-187">Questa proprietà statica specifica se tutte le applicazioni client hanno sottoscritto eventi [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cbcf0-187">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="cbcf0-188">L'implementazione del provider di questa interfaccia in una radice di frammento consente di ricevere notifica quando i client registrano e annullano la registrazione di gestori eventi per gli eventi nel frammento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-188">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="cbcf0-189">Navigazione per i provider non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-189">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="cbcf0-190">I provider per controlli semplici, ad esempio un pulsante personalizzato contenuto in una finestra (HWND) non devono supportare la navigazione all'interno dell'albero [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cbcf0-190">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="cbcf0-191">La navigazione verso e dall'elemento viene gestita dal provider predefinito per la finestra host specificato nell'implementazione di <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-191">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="cbcf0-192">Quando si implementa un provider per un controllo personalizzato complesso, tuttavia, è necessario supportare la navigazione tra il nodo radice del frammento e i relativi discendenti, nonché tra nodi di pari livello.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-192">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="cbcf0-193">Gli elementi di un frammento diversi dalla radice devono restituire un riferimento a `null` da <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, perché non sono ospitati direttamente in una finestra e nessun provider predefinito può supportare lo spostamento verso e da tali elementi.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-193">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="cbcf0-194">La struttura del frammento è determinata dall'implementazione di <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-194">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="cbcf0-195">Per ogni possibile direzione da ogni frammento, questo metodo restituisce l'oggetto provider per l'elemento in quella direzione.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-195">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="cbcf0-196">Se non è presente alcun elemento nella direzione specificata, il metodo restituisce un riferimento a `null` .</span><span class="sxs-lookup"><span data-stu-id="cbcf0-196">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="cbcf0-197">La radice del frammento supporta la navigazione solo verso gli elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-197">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="cbcf0-198">Ad esempio, una casella di riepilogo restituisce il primo elemento nell'elenco quando la direzione è <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>e l'ultimo elemento quando la direzione è <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-198">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="cbcf0-199">La radice del frammento non supporta la navigazione verso un elemento padre o elementi di pari livello. Questa operazione viene gestita dal provider della finestra host.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-199">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="cbcf0-200">Gli elementi di un frammento non radice devono supportare la navigazione verso l'elemento padre e verso eventuali elementi di pari livello e figli.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-200">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="cbcf0-201">Associazione con un nuovo elemento padre per i provider non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-201">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="cbcf0-202">Le finestre popup sono in effetti finestre di primo livello, quindi per impostazione predefinita vengono visualizzate nell'albero [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] come figli del desktop.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-202">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="cbcf0-203">In molti casi, tuttavia, le finestre popup sono logicamente elementi figlio di un altro controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-203">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="cbcf0-204">Ad esempio, l'elenco a discesa di una casella combinata è logicamente un elemento figlio della casella combinata.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-204">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="cbcf0-205">Analogamente, una finestra popup di menu è logicamente un elemento figlio del menu.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-205">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="cbcf0-206">fornisce il supporto per l'associazione delle finestre popup con un nuovo elemento padre, in modo che vengano visualizzate come elementi figlio del controllo associato.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-206">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="cbcf0-207">Per associare una finestra popup con un nuovo elemento padre:</span><span class="sxs-lookup"><span data-stu-id="cbcf0-207">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="cbcf0-208">Creare un provider per la finestra popup.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-208">Create a provider for the pop-up window.</span></span> <span data-ttu-id="cbcf0-209">È necessario che la classe della finestra popup sia nota in anticipo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-209">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="cbcf0-210">Implementare tutte le proprietà e i pattern come di consueto per tale popup, come se fosse un controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-210">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="cbcf0-211">Implementare la proprietà <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> in modo che restituisca il valore ottenuto da <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, dove il parametro è l'handle della finestra popup.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-211">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="cbcf0-212">Implementare <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> per la finestra popup e il relativo elemento padre in modo che la navigazione venga gestita correttamente dall'elemento padre logico agli elementi figlio logici e tra gli elementi figlio di pari livello.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-212">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="cbcf0-213">Quando [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] rileva la finestra popup, riconosce che la navigazione è diversa rispetto all'impostazione predefinita e ignora la finestra popup quando viene rilevata come un figlio del desktop.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-213">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="cbcf0-214">Al contrario, il nodo sarà raggiungibile solo tramite il frammento.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-214">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="cbcf0-215">L'associazione con un nuovo elemento padre non è appropriata nei casi in cui un controllo può ospitare una finestra di qualsiasi classe.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-215">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="cbcf0-216">Ad esempio, un controllo Rebar può contenere qualsiasi tipo di HWND nelle proprie bande.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-216">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="cbcf0-217">Per gestire questi casi, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supporta un tipo alternativo di rilocazione HWND, come descritto nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-217">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="cbcf0-218">Riposizionamento per i provider non WPF</span><span class="sxs-lookup"><span data-stu-id="cbcf0-218">Non-WPF Provider Repositioning</span></span>

<span data-ttu-id="cbcf0-219">I frammenti di[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] possono contenere due o più elementi contenuti ognuno in una finestra (HWND).</span><span class="sxs-lookup"><span data-stu-id="cbcf0-219">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="cbcf0-220">Dato che ogni elemento HWND ha il proprio provider predefinito che considera HWND un elemento figlio di un HWND che lo contiene, l'albero di [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] visualizzerà, per impostazione predefinita, gli HWND nel frammento come elementi figlio della finestra padre.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-220">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="cbcf0-221">Nella maggior parte dei casi questo comportamento è utile, ma talvolta può generare confusione perché non corrisponde alla struttura logica della [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cbcf0-221">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="cbcf0-222">Un esempio valido è un controllo Rebar.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-222">A good example of this is a rebar control.</span></span> <span data-ttu-id="cbcf0-223">Un controllo Rebar contiene bande, ognuna delle quali può contenere a sua volta un controllo basato su HWND come una barra degli strumenti, una casella di modifica o una casella combinata.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-223">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="cbcf0-224">Il provider di finestra predefinito per l'HWND del controllo Rebar vede gli elementi HWND delle bande come elementi figlio e il provider del controllo Rebar considera le bande come elementi figlio.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-224">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="cbcf0-225">Poiché il provider HWND e il provider del controllo Rebar operano in tandem e combinano i rispettivi elementi figlio, sia le bande che i controlli basati su HWND vengono visualizzati come elementi figlio del controllo Rebar.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-225">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="cbcf0-226">Dal punto di vista logico, tuttavia, solo le bande devono apparire come elementi figlio del controllo Rebar e ogni provider di banda dovrebbe essere abbinato al provider HWND predefinito per il controllo che contiene.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-226">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="cbcf0-227">A tale scopo, il provider di radice del frammento per il controllo Rebar espone un set di elementi figlio che rappresentano le bande.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-227">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="cbcf0-228">A ogni banda corrisponde un unico provider che può esporre proprietà e pattern.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-228">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="cbcf0-229">Nella sua implementazione di <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, il provider di bande restituisce il provider di finestra predefinito per il controllo HWND, ottenuto chiamando <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>e passando l'handle della finestra del controllo.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-229">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="cbcf0-230">Infine, il provider di radice del frammento per il controllo Rebar implementa l'interfaccia <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> e nella sua implementazione di <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> restituisce il provider di bande appropriato per il controllo contenuto nell'HWND specificato.</span><span class="sxs-lookup"><span data-stu-id="cbcf0-230">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="cbcf0-231">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="cbcf0-231">See also</span></span>

- [<span data-ttu-id="cbcf0-232">Cenni preliminari sui provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="cbcf0-232">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="cbcf0-233">Esporre un provider di automazione interfaccia utente lato server</span><span class="sxs-lookup"><span data-stu-id="cbcf0-233">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="cbcf0-234">Restituire proprietà da un provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="cbcf0-234">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="cbcf0-235">Generare eventi da un provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="cbcf0-235">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="cbcf0-236">Consentire la navigazione in un provider di frammenti di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="cbcf0-236">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="cbcf0-237">Supportare pattern di controllo in un provider di automazione interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="cbcf0-237">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
