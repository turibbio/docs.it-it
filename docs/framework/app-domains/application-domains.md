---
title: Domini applicazione
description: Informazioni sui domini applicazione, che forniscono un limite di isolamento tra le applicazioni per la sicurezza, l'affidabilità, il controllo delle versioni & lo scaricamento degli assembly in .NET.
ms.date: 03/30/2017
helpviewer_keywords:
- process boundaries for isolation
- application isolation
- application domains, about
- common language runtime, application domains
- application domains
- runtime, application domains
- isolation between applications
- code, verification process
- verification testing code
ms.assetid: 113a8bbf-6875-4a72-a49d-ca2d92e19cc8
ms.openlocfilehash: d6accd11e33c0556fdd7596b2790f4787dce7ae1
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/17/2020
ms.locfileid: "84903480"
---
# <a name="application-domains"></a><span data-ttu-id="2f600-103">Domini applicazione</span><span class="sxs-lookup"><span data-stu-id="2f600-103">Application domains</span></span>

<span data-ttu-id="2f600-104">I sistemi operativi e gli ambienti runtime forniscono solitamente una forma di isolamento tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2f600-104">Operating systems and runtime environments typically provide some form of isolation between applications.</span></span> <span data-ttu-id="2f600-105">Windows, ad esempio, usa i processi per isolare le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2f600-105">For example, Windows uses processes to isolate applications.</span></span> <span data-ttu-id="2f600-106">L'isolamento è necessario per garantire che il codice in esecuzione in un'applicazione non interferisca con altre applicazioni non correlate.</span><span class="sxs-lookup"><span data-stu-id="2f600-106">This isolation is necessary to ensure that code running in one application cannot adversely affect other, unrelated applications.</span></span>  
  
 <span data-ttu-id="2f600-107">I domini applicazione forniscono un limite di isolamento per sicurezza, affidabilità e controllo delle versioni, nonché per lo scaricamento degli assembly.</span><span class="sxs-lookup"><span data-stu-id="2f600-107">Application domains provide an isolation boundary for security, reliability, and versioning, and for unloading assemblies.</span></span> <span data-ttu-id="2f600-108">I domini applicazione vengono solitamente creati dagli host di runtime, che sono responsabili dell'avvio di Common Language Runtime prima dell'esecuzione di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-108">Application domains are typically created by runtime hosts, which are responsible for bootstrapping the common language runtime before an application is run.</span></span>  
  
## <a name="the-benefits-of-isolating-applications"></a><span data-ttu-id="2f600-109">Vantaggi dell'isolamento delle applicazioni</span><span class="sxs-lookup"><span data-stu-id="2f600-109">The benefits of isolating applications</span></span>

 <span data-ttu-id="2f600-110">L'isolamento delle diverse applicazioni in esecuzione sullo stesso computer è sempre stato basato sui limiti dei processi.</span><span class="sxs-lookup"><span data-stu-id="2f600-110">Historically, process boundaries have been used to isolate applications running on the same computer.</span></span> <span data-ttu-id="2f600-111">Ciascuna applicazione viene caricata in un processo separato che consente di isolarla dalle altre applicazioni in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2f600-111">Each application is loaded into a separate process, which isolates the application from other applications running on the same computer.</span></span>  
  
 <span data-ttu-id="2f600-112">Le applicazioni risultano isolate perché gli indirizzi di memoria sono relativi ai processi. Un puntatore di memoria passato da un processo a un altro non può essere usato in modo significativo nel processo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-112">The applications are isolated because memory addresses are process-relative; a memory pointer passed from one process to another cannot be used in any meaningful way in the target process.</span></span> <span data-ttu-id="2f600-113">Inoltre, non è possibile effettuare chiamate dirette tra due processi.</span><span class="sxs-lookup"><span data-stu-id="2f600-113">In addition, you cannot make direct calls between two processes.</span></span> <span data-ttu-id="2f600-114">È invece necessario usare un proxy, che fornisce un livello di riferimento indiretto.</span><span class="sxs-lookup"><span data-stu-id="2f600-114">Instead, you must use proxies, which provide a level of indirection.</span></span>  
  
 <span data-ttu-id="2f600-115">Il codice gestito deve essere sottoposto a verifica prima che sia possibile eseguirlo, a meno che non esista un'apposita autorizzazione dell'amministratore.</span><span class="sxs-lookup"><span data-stu-id="2f600-115">Managed code must be passed through a verification process before it can be run (unless the administrator has granted permission to skip the verification).</span></span> <span data-ttu-id="2f600-116">Il processo di verifica determina se il codice può tentare di accedere a indirizzi di memoria non validi o eseguire operazioni che potrebbero compromettere il corretto funzionamento del processo in cui è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2f600-116">The verification process determines whether the code can attempt to access invalid memory addresses or perform some other action that could cause the process in which it is running to fail to operate properly.</span></span> <span data-ttu-id="2f600-117">Il codice che supera la verifica viene definito come indipendente dai tipi.</span><span class="sxs-lookup"><span data-stu-id="2f600-117">Code that passes the verification test is said to be type-safe.</span></span> <span data-ttu-id="2f600-118">La possibilità di verificare che il codice sia indipendente dai tipi consente a Common Language Runtime di fornire un livello di isolamento corrispondente ai limiti del processo, con un'incidenza sulle prestazioni di gran lunga inferiore.</span><span class="sxs-lookup"><span data-stu-id="2f600-118">The ability to verify code as type-safe enables the common language runtime to provide as great a level of isolation as the process boundary, at a much lower performance cost.</span></span>  
  
 <span data-ttu-id="2f600-119">I domini applicazione forniscono un'unità di elaborazione più protetta e versatile che può essere usata da Common Language Runtime per fornire isolamento tra le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2f600-119">Application domains provide a more secure and versatile unit of processing that the common language runtime can use to provide isolation between applications.</span></span> <span data-ttu-id="2f600-120">In ogni processo è possibile eseguire più domini applicazione con lo stesso livello di isolamento che si ottiene usando processi separati, ma senza l'overhead derivante dalle chiamate tra processi o dal passaggio tra processi.</span><span class="sxs-lookup"><span data-stu-id="2f600-120">You can run several application domains in a single process with the same level of isolation that would exist in separate processes, but without incurring the additional overhead of making cross-process calls or switching between processes.</span></span> <span data-ttu-id="2f600-121">La possibilità di eseguire più applicazioni all'interno di un singolo processo incrementa considerevolmente la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="2f600-121">The ability to run multiple applications within a single process dramatically increases server scalability.</span></span>  
  
 <span data-ttu-id="2f600-122">L'isolamento delle applicazioni è importante anche per la sicurezza delle applicazioni stesse.</span><span class="sxs-lookup"><span data-stu-id="2f600-122">Isolating applications is also important for application security.</span></span> <span data-ttu-id="2f600-123">È possibile, ad esempio, eseguire controlli da diverse applicazioni Web in esecuzione in un singolo processo browser, in modo che i controlli non possano accedere alle risorse e ai dati reciproci.</span><span class="sxs-lookup"><span data-stu-id="2f600-123">For example, you can run controls from several Web applications in a single browser process in such a way that the controls cannot access each other's data and resources.</span></span>  
  
 <span data-ttu-id="2f600-124">L'isolamento fornito dai domini applicazione offre i seguenti vantaggi:</span><span class="sxs-lookup"><span data-stu-id="2f600-124">The isolation provided by application domains has the following benefits:</span></span>  
  
- <span data-ttu-id="2f600-125">Gli errori di un'applicazione non possono influire sulle altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2f600-125">Faults in one application cannot affect other applications.</span></span> <span data-ttu-id="2f600-126">Poiché il codice indipendente dai tipi non può provocare errori di memoria, l'utilizzo dei domini applicazione assicura che il codice in esecuzione in un dominio non possa influire sulle altre applicazioni nel processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-126">Because type-safe code cannot cause memory faults, using application domains ensures that code running in one domain cannot affect other applications in the process.</span></span>  
  
- <span data-ttu-id="2f600-127">È possibile arrestare singole applicazioni senza arrestare l'intero processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-127">Individual applications can be stopped without stopping the entire process.</span></span> <span data-ttu-id="2f600-128">L'utilizzo dei domini applicazione consente di scaricare il codice in esecuzione in una specifica applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-128">Using application domains enables you to unload the code running in a single application.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="2f600-129">Non è possibile scaricare singoli assembly o tipi.</span><span class="sxs-lookup"><span data-stu-id="2f600-129">You cannot unload individual assemblies or types.</span></span> <span data-ttu-id="2f600-130">È possibile scaricare solo un dominio completo.</span><span class="sxs-lookup"><span data-stu-id="2f600-130">Only a complete domain can be unloaded.</span></span>  
  
- <span data-ttu-id="2f600-131">Il codice in esecuzione in un'applicazione non può accedere direttamente al codice o alle risorse di un'altra applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-131">Code running in one application cannot directly access code or resources from another application.</span></span> <span data-ttu-id="2f600-132">Common Language Runtime assicura tale isolamento impedendo le chiamate dirette tra gli oggetti appartenenti a domini applicazione diversi.</span><span class="sxs-lookup"><span data-stu-id="2f600-132">The common language runtime enforces this isolation by preventing direct calls between objects in different application domains.</span></span> <span data-ttu-id="2f600-133">Il passaggio di un oggetto da un dominio all'altro avviene tramite copia o usando un proxy.</span><span class="sxs-lookup"><span data-stu-id="2f600-133">Objects that pass between domains are either copied or accessed by proxy.</span></span> <span data-ttu-id="2f600-134">Se l'oggetto viene copiato, la chiamata all'oggetto è locale.</span><span class="sxs-lookup"><span data-stu-id="2f600-134">If the object is copied, the call to the object is local.</span></span> <span data-ttu-id="2f600-135">In altre parole, sia l'oggetto a cui viene fatto riferimento che il chiamante si trovano nello stesso dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-135">That is, both the caller and the object being referenced are in the same application domain.</span></span> <span data-ttu-id="2f600-136">Se si accede all'oggetto tramite un proxy, la chiamata all'oggetto è remota.</span><span class="sxs-lookup"><span data-stu-id="2f600-136">If the object is accessed through a proxy, the call to the object is remote.</span></span> <span data-ttu-id="2f600-137">In questo caso, l'oggetto a cui viene fatto riferimento e il chiamante si trovano in domini applicazione diversi.</span><span class="sxs-lookup"><span data-stu-id="2f600-137">In this case, the caller and the object being referenced are in different application domains.</span></span> <span data-ttu-id="2f600-138">Le chiamate tra domini usano la stessa infrastruttura di chiamata remota delle chiamate tra due processi o tra due computer.</span><span class="sxs-lookup"><span data-stu-id="2f600-138">Cross-domain calls use the same remote call infrastructure as calls between two processes or between two machines.</span></span> <span data-ttu-id="2f600-139">I metadati relativi all'oggetto a cui viene fatto riferimento devono essere pertanto disponibili per entrambi i domini applicazione, affinché il compilatore JIT possa compilare la chiamata in modo corretto.</span><span class="sxs-lookup"><span data-stu-id="2f600-139">As such, the metadata for the object being referenced must be available to both application domains to allow the method call to be JIT-compiled properly.</span></span> <span data-ttu-id="2f600-140">Se il dominio chiamante non ha accesso ai metadati per l'oggetto chiamato, la compilazione può avere esito negativo, con un'eccezione di tipo <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="2f600-140">If the calling domain does not have access to the metadata for the object being called, the compilation might fail with an exception of type <xref:System.IO.FileNotFoundException>.</span></span> <span data-ttu-id="2f600-141">Per altre informazioni, vedere [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="2f600-141">For more information, see [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span></span> <span data-ttu-id="2f600-142">Il meccanismo che stabilisce in che modo è possibile accedere a un oggetto da un dominio diverso è determinato dall'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2f600-142">The mechanism for determining how objects can be accessed across domains is determined by the object.</span></span> <span data-ttu-id="2f600-143">Per altre informazioni, vedere <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2f600-143">For more information, see <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="2f600-144">L'ambito del comportamento del codice viene stabilito dall'applicazione in cui questo è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2f600-144">The behavior of code is scoped by the application in which it runs.</span></span> <span data-ttu-id="2f600-145">In altri termini, il dominio applicazione fornisce impostazioni di configurazione quali i criteri di controllo delle versioni dell'applicazione, la posizione degli assembly remoti a cui questa accede e le informazioni sul percorso degli assembly che vengono caricati nel dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-145">In other words, the application domain provides configuration settings such as application version policies, the location of any remote assemblies it accesses, and information about where to locate assemblies that are loaded into the domain.</span></span>  
  
- <span data-ttu-id="2f600-146">Le autorizzazioni concesse al codice possono essere controllate dal dominio applicazione in cui il codice è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2f600-146">Permissions granted to code can be controlled by the application domain in which the code is running.</span></span>  
  
## <a name="application-domains-and-assemblies"></a><span data-ttu-id="2f600-147">Domini applicazione e assembly</span><span class="sxs-lookup"><span data-stu-id="2f600-147">Application domains and assemblies</span></span>

 <span data-ttu-id="2f600-148">Questa sezione descrive la relazione tra assembly e domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-148">This section describes the relationship between application domains and assemblies.</span></span> <span data-ttu-id="2f600-149">Per eseguire il codice contenuto in un assembly, è necessario innanzitutto caricare l'assembly in un dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-149">You must load an assembly into an application domain before you can execute the code it contains.</span></span> <span data-ttu-id="2f600-150">L'esecuzione di un'applicazione tipica implica il caricamento di diversi assembly in un dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-150">Running a typical application causes several assemblies to be loaded into an application domain.</span></span>  
  
 <span data-ttu-id="2f600-151">Il modo in cui viene caricato un assembly determina se il codice con compilazione JIT può essere condiviso da più domini applicazione nel processo e se l'assembly può essere scaricato dal processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-151">The way an assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process, and whether the assembly can be unloaded from the process.</span></span>  
  
- <span data-ttu-id="2f600-152">Se un assembly viene caricato come indipendente dal dominio, tutti i domini applicazione che condividono lo stesso insieme di autorizzazioni di sicurezza possono condividere lo stesso codice con compilazione JIT, il che comporta una riduzione della quantità di memoria richiesta dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-152">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code, which reduces the memory required by the application.</span></span> <span data-ttu-id="2f600-153">L'assembly tuttavia non può mai essere scaricato dal processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-153">However, the assembly can never be unloaded from the process.</span></span>  
  
- <span data-ttu-id="2f600-154">Se non viene caricato come indipendente dal dominio, un assembly deve essere sottoposto a compilazione JIT in ogni dominio applicazione in cui viene caricato.</span><span class="sxs-lookup"><span data-stu-id="2f600-154">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded.</span></span> <span data-ttu-id="2f600-155">È tuttavia possibile scaricare l'assembly dal processo scaricando tutti i domini applicazione nei quali è caricato.</span><span class="sxs-lookup"><span data-stu-id="2f600-155">However, the assembly can be unloaded from the process by unloading all the application domains in which it is loaded.</span></span>  
  
 <span data-ttu-id="2f600-156">L'host di runtime determina se caricare gli assembly come indipendenti dal dominio nel momento in cui carica il runtime in un processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-156">The runtime host determines whether to load assemblies as domain-neutral when it loads the runtime into a process.</span></span> <span data-ttu-id="2f600-157">Per le applicazioni gestite, applicare l'attributo <xref:System.LoaderOptimizationAttribute> al metodo del punto di ingresso del processo e specificare un valore dall'enumerazione <xref:System.LoaderOptimization> associata.</span><span class="sxs-lookup"><span data-stu-id="2f600-157">For managed applications, apply the <xref:System.LoaderOptimizationAttribute> attribute to the entry-point method for the process, and specify a value from the associated <xref:System.LoaderOptimization> enumeration.</span></span> <span data-ttu-id="2f600-158">Per applicazioni non gestite che ospitano Common Language Runtime, specificare il flag appropriato quando si chiama il metodo [CorBindToRuntimeEx](../unmanaged-api/hosting/corbindtoruntimeex-function.md).</span><span class="sxs-lookup"><span data-stu-id="2f600-158">For unmanaged applications that host the common language runtime, specify the appropriate flag when you call the [CorBindToRuntimeEx Function](../unmanaged-api/hosting/corbindtoruntimeex-function.md) method.</span></span>  
  
 <span data-ttu-id="2f600-159">Il caricamento di assembly indipendenti dal dominio può avvenire in tre modi:</span><span class="sxs-lookup"><span data-stu-id="2f600-159">There are three options for loading domain-neutral assemblies:</span></span>  
  
- <span data-ttu-id="2f600-160">Con l'impostazione <xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> non viene caricato alcun assembly come indipendente dal dominio, ad eccezione di Mscorlib, che viene sempre caricato come indipendente dal dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-160"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="2f600-161">Questa impostazione viene denominata a dominio singolo perché viene usata in genere quando sull'host è in esecuzione una sola applicazione nel processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-161">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>

- <span data-ttu-id="2f600-162">Con l'impostazione <xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> tutti gli assembly vengono caricati come indipendenti dal dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-162"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> loads all assemblies as domain-neutral.</span></span> <span data-ttu-id="2f600-163">Usare questa impostazione quando nel processo esistono più domini applicazione che eseguono tutti lo stesso codice.</span><span class="sxs-lookup"><span data-stu-id="2f600-163">Use this setting when there are multiple application domains in the process, all of which run the same code.</span></span>

- <span data-ttu-id="2f600-164">Con l'impostazione <xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> vengono caricati come indipendenti dal dominio gli assembly con nome sicuro, purché siano stati installati insieme alle relative dipendenze nella Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="2f600-164"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> loads strong-named assemblies as domain-neutral, if they and all their dependencies have been installed in the global assembly cache.</span></span> <span data-ttu-id="2f600-165">Gli altri assembly vengono caricati e sottoposti a compilazione JIT separatamente per ogni dominio applicazione in cui sono stati caricati e possono pertanto essere scaricati dal processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-165">Other assemblies are loaded and JIT-compiled separately for each application domain in which they are loaded, and thus can be unloaded from the process.</span></span> <span data-ttu-id="2f600-166">Usare questa impostazione se si eseguono più applicazioni nello stesso processo o se si dispone di una combinazione di assembly condivisi da molti domini applicazione e di assembly che devono essere scaricati dal processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-166">Use this setting when running more than one application in the same process, or if you have a mixture of assemblies that are shared by many application domains and assemblies that need to be unloaded from the process.</span></span>
  
 <span data-ttu-id="2f600-167">Il codice con compilazione JIT non può essere condiviso per gli assembly caricati nel contesto di origine del caricamento usando il metodo <xref:System.Reflection.Assembly.LoadFrom%2A> della classe <xref:System.Reflection.Assembly> né può essere caricato da immagini usando overload del metodo <xref:System.Reflection.Assembly.Load%2A> che specificano matrici di byte.</span><span class="sxs-lookup"><span data-stu-id="2f600-167">JIT-compiled code cannot be shared for assemblies loaded into the load-from context, using the <xref:System.Reflection.Assembly.LoadFrom%2A> method of the <xref:System.Reflection.Assembly> class, or loaded from images using overloads of the <xref:System.Reflection.Assembly.Load%2A> method that specify byte arrays.</span></span>  
  
 <span data-ttu-id="2f600-168">Gli assembly compilati nel codice nativo usando il [generatore di immagini native (Ngen.exe)](../tools/ngen-exe-native-image-generator.md) possono essere condivisi tra domini dell'applicazione se sono stati caricati come indipendenti dal dominio la prima volta che sono stati caricati in un processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-168">Assemblies that have been compiled to native code by using the [Ngen.exe (Native Image Generator)](../tools/ngen-exe-native-image-generator.md) can be shared between application domains, if they are loaded domain-neutral the first time they are loaded into a process.</span></span>  
  
 <span data-ttu-id="2f600-169">Il codice con compilazione JIT per l'assembly contenente il punto di ingresso dell'applicazione è condiviso solo se possono essere condivise tutte le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="2f600-169">JIT-compiled code for the assembly that contains the application entry point is shared only if all its dependencies can be shared.</span></span>  
  
 <span data-ttu-id="2f600-170">Un assembly indipendente dal dominio può essere sottoposto a compilazione JIT più di una volta.</span><span class="sxs-lookup"><span data-stu-id="2f600-170">A domain-neutral assembly can be JIT-compiled more than once.</span></span> <span data-ttu-id="2f600-171">Se ad esempio gli insiemi di autorizzazioni di sicurezza di due domini applicazione sono diversi, non possono condividere lo stesso codice con compilazione JIT.</span><span class="sxs-lookup"><span data-stu-id="2f600-171">For example, when the security grant sets of two application domains are different, they cannot share the same JIT-compiled code.</span></span> <span data-ttu-id="2f600-172">Ciascuna copia dell'assembly con compilazione JIT tuttavia può essere condivisa con altri domini applicazione con lo stesso insieme di autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="2f600-172">However, each copy of the JIT-compiled assembly can be shared with other application domains that have the same grant set.</span></span>  
  
 <span data-ttu-id="2f600-173">Quando si decide se caricare o meno gli assembly come indipendenti dal dominio, è necessario trovare un compromesso tra la riduzione dell'utilizzo di memoria e altri fattori relativi alle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="2f600-173">When you decide whether to load assemblies as domain-neutral, you must make a tradeoff between reducing memory use and other performance factors.</span></span>  
  
- <span data-ttu-id="2f600-174">L'accesso a dati e metodi statici è più lento per gli assembly indipendenti dal dominio a causa della necessità di isolare gli assembly.</span><span class="sxs-lookup"><span data-stu-id="2f600-174">Access to static data and methods is slower for domain-neutral assemblies because of the need to isolate assemblies.</span></span> <span data-ttu-id="2f600-175">Ciascun dominio applicazione che accede all'assembly deve disporre di una copia separata dei dati statici, per evitare che i riferimenti agli oggetti contenuti nei campi statici superino i limiti del dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-175">Each application domain that accesses the assembly must have a separate copy of the static data, to prevent references to objects in static fields from crossing domain boundaries.</span></span> <span data-ttu-id="2f600-176">Il runtime contiene la logica aggiuntiva necessaria per indirizzare un chiamante alla copia appropriata del metodo o dei dati statici.</span><span class="sxs-lookup"><span data-stu-id="2f600-176">As a result, the runtime contains additional logic to direct a caller to the appropriate copy of the static data or method.</span></span> <span data-ttu-id="2f600-177">Tale logica aggiuntiva rallenta la chiamata.</span><span class="sxs-lookup"><span data-stu-id="2f600-177">This extra logic slows down the call.</span></span>  
  
- <span data-ttu-id="2f600-178">Tutte le dipendenze di un assembly devono essere individuate e caricate quando l'assembly viene caricato come indipendente dal dominio, poiché una dipendenza che non può essere caricata come indipendente dal dominio impedisce il caricamento dell'assembly come indipendente dal dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-178">All the dependencies of an assembly must be located and loaded when the assembly is loaded domain-neutral, because a dependency that cannot be loaded domain-neutral prevents the assembly from being loaded domain-neutral.</span></span>  
  
## <a name="application-domains-and-threads"></a><span data-ttu-id="2f600-179">Domini applicazione e thread</span><span class="sxs-lookup"><span data-stu-id="2f600-179">Application domains and threads</span></span>

 <span data-ttu-id="2f600-180">Il dominio di un'applicazione costituisce un limite di isolamento per sicurezza, controllo delle versioni, affidabilità e scaricamento di codice gestito.</span><span class="sxs-lookup"><span data-stu-id="2f600-180">An application domain forms an isolation boundary for security, versioning, reliability, and unloading of managed code.</span></span> <span data-ttu-id="2f600-181">Un thread è il costrutto del sistema operativo usato da Common Language Runtime per eseguire il codice.</span><span class="sxs-lookup"><span data-stu-id="2f600-181">A thread is the operating system construct used by the common language runtime to execute code.</span></span> <span data-ttu-id="2f600-182">In fase di esecuzione, tutto il codice gestito viene caricato in un dominio applicazione ed eseguito da uno o più thread gestiti.</span><span class="sxs-lookup"><span data-stu-id="2f600-182">At run time, all managed code is loaded into an application domain and is run by one or more managed threads.</span></span>  
  
 <span data-ttu-id="2f600-183">Non esiste una relazione uno a uno tra domini applicazione e thread.</span><span class="sxs-lookup"><span data-stu-id="2f600-183">There is not a one-to-one correlation between application domains and threads.</span></span> <span data-ttu-id="2f600-184">È possibile eseguire diversi thread nello stesso dominio applicazione contemporaneamente e un particolare thread non è confinato a un singolo dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-184">Several threads can execute in a single application domain at any given time, and a particular thread is not confined to a single application domain.</span></span> <span data-ttu-id="2f600-185">I thread possono quindi estendersi oltre i limiti dei domini applicazione. Non viene creato un nuovo thread per ogni dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-185">That is, threads are free to cross application domain boundaries; a new thread is not created for each application domain.</span></span>  
  
 <span data-ttu-id="2f600-186">In qualsiasi momento, ogni thread viene eseguito in un dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-186">At any given time, every thread executes in an application domain.</span></span> <span data-ttu-id="2f600-187">In qualsiasi dominio applicazione potrebbero essere in esecuzione zero, uno o più thread.</span><span class="sxs-lookup"><span data-stu-id="2f600-187">Zero, one, or multiple threads might be executing in any given application domain.</span></span> <span data-ttu-id="2f600-188">Il runtime tiene traccia dei thread in esecuzione nei diversi domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-188">The runtime keeps track of which threads are running in which application domains.</span></span> <span data-ttu-id="2f600-189">In qualsiasi momento è possibile individuare il dominio in cui un thread viene eseguito chiamando il metodo <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2f600-189">You can locate the domain in which a thread is executing at any time by calling the <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType> method.</span></span>

### <a name="application-domains-and-cultures"></a><span data-ttu-id="2f600-190">Domini applicazione e impostazioni cultura</span><span class="sxs-lookup"><span data-stu-id="2f600-190">Application domains and cultures</span></span>

 <span data-ttu-id="2f600-191">Le impostazioni cultura, rappresentate da un oggetto <xref:System.Globalization.CultureInfo>, sono associate ai thread.</span><span class="sxs-lookup"><span data-stu-id="2f600-191">Culture, which is represented by a <xref:System.Globalization.CultureInfo> object, is associated with threads.</span></span> <span data-ttu-id="2f600-192">È possibile ottenere le impostazioni cultura associate al thread attualmente in esecuzione tramite la proprietà <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> e ottenere o impostare le impostazioni cultura associate al thread attualmente in esecuzione tramite la proprietà <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2f600-192">You can get the culture that is associated with the currently executing thread by using the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property, and you can get or set the culture that is associated with the currently executing thread by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="2f600-193">Se le impostazioni cultura associate a un thread sono state impostate in modo esplicito tramite la proprietà <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType>, continueranno a essere associate al thread in questione quando da quest'ultimo vengono superati i limiti del dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-193">If the culture that is associated with a thread has been explicitly set by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property, it continues to be associated with that thread when the thread crosses application domain boundaries.</span></span> <span data-ttu-id="2f600-194">In caso contrario, le impostazioni cultura associate al thread in un determinato momento sono determinate dal valore della proprietà <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> nel dominio applicazione in cui il thread è in esecuzione:</span><span class="sxs-lookup"><span data-stu-id="2f600-194">Otherwise, the culture that is associated with the thread at any given time is determined by the value of the <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> property in the application domain in which the thread is executing:</span></span>  
  
- <span data-ttu-id="2f600-195">Se il valore della proprietà non è `null`, le impostazioni cultura che vengono restituite dalla proprietà sono associate al thread e pertanto restituite dalle proprietà <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> e <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2f600-195">If the value of the property is not `null`, the culture that is returned by the property is associated with the thread (and therefore returned by the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> and <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> properties).</span></span>  
  
- <span data-ttu-id="2f600-196">Se il valore della proprietà è `null`, le impostazioni cultura correnti del sistema vengono associate al thread.</span><span class="sxs-lookup"><span data-stu-id="2f600-196">If the value of the property is `null`, the current system culture is associated with the thread.</span></span>  
  
## <a name="programming-with-application-domains"></a><span data-ttu-id="2f600-197">Programmazione con i domini applicazione</span><span class="sxs-lookup"><span data-stu-id="2f600-197">Programming with application domains</span></span>

 <span data-ttu-id="2f600-198">I domini applicazione vengono solitamente creati e modificati direttamente a livello di codice dagli host di runtime.</span><span class="sxs-lookup"><span data-stu-id="2f600-198">Application domains are usually created and manipulated programmatically by runtime hosts.</span></span> <span data-ttu-id="2f600-199">Tuttavia, anche un programma applicativo può richiedere talvolta l'utilizzo di domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-199">However, sometimes an application program might also want to work with application domains.</span></span> <span data-ttu-id="2f600-200">Un programma applicativo, ad esempio, potrebbe caricare il componente di un'applicazione in un dominio per poter scaricare il dominio e il componente senza dover interrompere l'intera applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-200">For example, an application program could load an application component into a domain to be able to unload the domain (and the component) without having to stop the entire application.</span></span>  
  
 <span data-ttu-id="2f600-201">La <xref:System.AppDomain> è l'interfaccia che consente di accedere ai domini applicazione a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="2f600-201">The <xref:System.AppDomain> is the programmatic interface to application domains.</span></span> <span data-ttu-id="2f600-202">e include metodi per creare e scaricare domini, per creare istanze di tipi nei domini e per effettuare la registrazione per varie notifiche, come ad esempio quelle per scaricare i domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-202">This class includes methods to create and unload domains, to create instances of types in domains, and to register for various notifications such as application domain unloading.</span></span> <span data-ttu-id="2f600-203">La tabella riportata di seguito elenca i metodi di <xref:System.AppDomain> comunemente usati.</span><span class="sxs-lookup"><span data-stu-id="2f600-203">The following table lists commonly used <xref:System.AppDomain> methods.</span></span>  
  
|<span data-ttu-id="2f600-204">Metodo AppDomain</span><span class="sxs-lookup"><span data-stu-id="2f600-204">AppDomain Method</span></span>|<span data-ttu-id="2f600-205">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2f600-205">Description</span></span>|  
|----------------------|-----------------|  
|<xref:System.AppDomain.CreateDomain%2A>|<span data-ttu-id="2f600-206">Crea un nuovo dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-206">Creates a new application domain.</span></span> <span data-ttu-id="2f600-207">Si consiglia di usare un overload di questo metodo che specifica un oggetto <xref:System.AppDomainSetup>.</span><span class="sxs-lookup"><span data-stu-id="2f600-207">It is recommended that you use an overload of this method that specifies an <xref:System.AppDomainSetup> object.</span></span> <span data-ttu-id="2f600-208">Si tratta del sistema preferito per impostare le proprietà di un nuovo dominio, quali la base o la directory radice dell'applicazione, il percorso del file di configurazione del dominio e il percorso di ricerca usato da Common Language Runtime per caricare gli assembly nel dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-208">This is the preferred way to set the properties of a new domain, such as the application base, or root directory for the application; the location of the configuration file for the domain; and the search path that the common language runtime is to use to load assemblies into the domain.</span></span>|  
|<span data-ttu-id="2f600-209"><xref:System.AppDomain.ExecuteAssembly%2A> e <xref:System.AppDomain.ExecuteAssemblyByName%2A></span><span class="sxs-lookup"><span data-stu-id="2f600-209"><xref:System.AppDomain.ExecuteAssembly%2A> and <xref:System.AppDomain.ExecuteAssemblyByName%2A></span></span>|<span data-ttu-id="2f600-210">Esegue un assembly nel dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-210">Executes an assembly in the application domain.</span></span> <span data-ttu-id="2f600-211">Si tratta di un metodo di istanza, pertanto è possibile utilizzarlo per eseguire codice in un altro dominio applicazione per il quale si dispone di un riferimento.</span><span class="sxs-lookup"><span data-stu-id="2f600-211">This is an instance method, so it can be used to execute code in another application domain to which you have a reference.</span></span>|  
|<xref:System.AppDomain.CreateInstanceAndUnwrap%2A>|<span data-ttu-id="2f600-212">Crea un'istanza del tipo specificato nel dominio applicazione e restituisce un proxy.</span><span class="sxs-lookup"><span data-stu-id="2f600-212">Creates an instance of a specified type in the application domain, and returns a proxy.</span></span> <span data-ttu-id="2f600-213">Usando questo metodo è possibile evitare di caricare l'assembly che contiene il tipo creato nell'assembly chiamante.</span><span class="sxs-lookup"><span data-stu-id="2f600-213">Use this method to avoid loading the assembly containing the created type into the calling assembly.</span></span>|  
|<xref:System.AppDomain.Unload%2A>|<span data-ttu-id="2f600-214">Esegue un arresto ponderato del dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-214">Performs a graceful shutdown of the domain.</span></span> <span data-ttu-id="2f600-215">Il dominio applicazione non viene scaricato fino a quando tutti i thread del dominio non sono stati interrotti o non sono più presenti nel dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-215">The application domain is not unloaded until all threads running in the domain have either stopped or are no longer in the domain.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="2f600-216">Poiché Common Language Runtime non supporta la serializzazione di metodi globali, non è possibile usare i delegati per eseguire metodi globali in altri domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-216">The common language runtime does not support serialization of global methods, so delegates cannot be used to execute global methods in other application domains.</span></span>  
  
 <span data-ttu-id="2f600-217">Anche le interfacce non gestite descritte nelle specifiche delle interfacce di hosting di Common Language Runtime forniscono l'accesso ai domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-217">The unmanaged interfaces described in the common language runtime Hosting Interfaces Specification also provide access to application domains.</span></span> <span data-ttu-id="2f600-218">Gli host di runtime possono usare tali interfacce dal codice non gestito per creare i domini applicazione e accedervi nell'ambito di un processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-218">Runtime hosts can use interfaces from unmanaged code to create and gain access to the application domains within a process.</span></span>  
  
## <a name="the-complus_loaderoptimization-environment-variable"></a><span data-ttu-id="2f600-219">Variabile di ambiente COMPLUS_LoaderOptimization</span><span class="sxs-lookup"><span data-stu-id="2f600-219">The COMPLUS_LoaderOptimization environment variable</span></span>

 <span data-ttu-id="2f600-220">Variabile di ambiente tramite cui vengono impostati i criteri predefiniti di ottimizzazione del caricatore di un'applicazione eseguibile.</span><span class="sxs-lookup"><span data-stu-id="2f600-220">An environment variable that sets the default loader optimization policy of an executable application.</span></span>  
  
### <a name="syntax"></a><span data-ttu-id="2f600-221">Sintassi</span><span class="sxs-lookup"><span data-stu-id="2f600-221">Syntax</span></span>  
  
```env  
COMPLUS_LoaderOptimization = 1  
```  
  
### <a name="remarks"></a><span data-ttu-id="2f600-222">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="2f600-222">Remarks</span></span>

 <span data-ttu-id="2f600-223">Tramite un'applicazione tipica vengono caricati diversi assembly in un dominio applicazione prima che il codice in essi contenuto possa essere eseguito.</span><span class="sxs-lookup"><span data-stu-id="2f600-223">A typical application loads several assemblies into an application domain before the code they contain can be executed.</span></span>  
  
 <span data-ttu-id="2f600-224">Il modo in cui viene caricato l'assembly determina se il codice con compilazione JIT può essere condiviso da più domini applicazione nel processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-224">The way the assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process.</span></span>  
  
- <span data-ttu-id="2f600-225">Se un assembly viene caricato come indipendente dal dominio, tutti i domini applicazione che condividono lo stesso set di autorizzazioni di sicurezza possono condividere lo stesso codice compilato tramite JIT.</span><span class="sxs-lookup"><span data-stu-id="2f600-225">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code.</span></span> <span data-ttu-id="2f600-226">In questo modo, la memoria richiesta dall'applicazione viene ridotta.</span><span class="sxs-lookup"><span data-stu-id="2f600-226">This reduces the memory required by the application.</span></span>  
  
- <span data-ttu-id="2f600-227">Se un assembly non viene caricato come indipendente dal dominio, deve essere compilato tramite JIT in ogni dominio applicazione in cui viene caricato e da parte del caricatore non devono essere condivise le risorse interne tra domini applicazione.</span><span class="sxs-lookup"><span data-stu-id="2f600-227">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded and the loader must not share internal resources across application domains.</span></span>  
  
 <span data-ttu-id="2f600-228">Se impostato su 1, tramite il flag di ambiente COMPLUS_LoaderOptimization viene forzato il caricamento di tutti gli assembly nella modalità non indipendente dal dominio nota come SingleDomain da parte dell'host di runtime.</span><span class="sxs-lookup"><span data-stu-id="2f600-228">When set to 1, the COMPLUS_LoaderOptimization environment flag forces the runtime host to load all assemblies in non-domain-neutral way known as SingleDomain.</span></span> <span data-ttu-id="2f600-229">Con SingleDomain non viene caricato alcun assembly come indipendente dal dominio, a eccezione di Mscorlib, che viene sempre caricato come indipendente dal dominio.</span><span class="sxs-lookup"><span data-stu-id="2f600-229">SingleDomain loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="2f600-230">Questa impostazione viene denominata a dominio singolo perché viene usata in genere quando sull'host è in esecuzione una sola applicazione nel processo.</span><span class="sxs-lookup"><span data-stu-id="2f600-230">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="2f600-231">Il flag di ambiente COMPLUS_LoaderOptimization è stato progettato per essere usato negli scenari di test e di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="2f600-231">The COMPLUS_LoaderOptimization environment flag was designed to be used in diagnostic and test scenarios.</span></span> <span data-ttu-id="2f600-232">L'abilitazione del flag può provocare notevoli rallentamenti e aumentare l'utilizzo della memoria.</span><span class="sxs-lookup"><span data-stu-id="2f600-232">Having the flag turned on can cause severe slow-down and increase in memory usage.</span></span>  
  
### <a name="code-example"></a><span data-ttu-id="2f600-233">Esempio di codice</span><span class="sxs-lookup"><span data-stu-id="2f600-233">Code example</span></span>

 <span data-ttu-id="2f600-234">Per evitare il caricamento di tutti gli assembly come indipendenti dal dominio per il servizio IISADMIN, aggiungere `COMPLUS_LoaderOptimization=1` al valore multistringa dell'ambiente nella chiave HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN.</span><span class="sxs-lookup"><span data-stu-id="2f600-234">To force all assemblies not to be loaded as domain-neutral for the IISADMIN service can be achieved by appending `COMPLUS_LoaderOptimization=1` to the Environment’s Multi-String Value in the HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN key.</span></span>  
  
```env  
Key = HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN  
Name = Environment  
Type = REG_MULTI_SZ  
Value (to append) = COMPLUS_LoaderOptimization=1  
```  
  
## <a name="see-also"></a><span data-ttu-id="2f600-235">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="2f600-235">See also</span></span>

- <xref:System.AppDomain?displayProperty=nameWithType>
- <xref:System.MarshalByRefObject?displayProperty=nameWithType>
- [<span data-ttu-id="2f600-236">Programmazione con i domini applicazione e gli assembly</span><span class="sxs-lookup"><span data-stu-id="2f600-236">Programming with Application Domains and Assemblies</span></span>](index.md)
- [<span data-ttu-id="2f600-237">Uso dei domini dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="2f600-237">Using Application Domains</span></span>](use.md)
