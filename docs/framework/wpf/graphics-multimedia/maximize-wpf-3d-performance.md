---
title: Massimizza le prestazioni 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 3825ea8e57c6863e2ee654072efda623db21c2a8
ms.sourcegitcommit: 267d092663aba36b6b2ea853034470aea493bfae
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/21/2020
ms.locfileid: "80111998"
---
# <a name="maximize-wpf-3d-performance"></a>Ottimizzazione delle prestazioni tridimensionali di WPF
Quando si [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] utilizza il per compilare controlli 3D e includere scene 3D nelle applicazioni, è importante considerare l'ottimizzazione delle prestazioni. In questo argomento viene fornito un elenco di classi e proprietà 3D che hanno implicazioni sulle prestazioni per l'applicazione, insieme a suggerimenti per l'ottimizzazione delle prestazioni quando vengono utilizzate.  
  
 In questo argomento si [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] presuppone una conoscenza avanzata delle funzionalità 3D. I suggerimenti in questo documento si applicano al "rendering tier 2", definito approssimativamente come hardware che supporta il pixel shader versione 2.0 e il vertex shader versione 2.0. Per ulteriori dettagli, consultate Livelli di [rendering della grafica.](../advanced/graphics-rendering-tiers.md)  
  
## <a name="performance-impact-high"></a>Impatto sulle prestazioni: Elevato  
  
|Proprietà|Recommendation|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Velocità pennello (dalla più veloce alla più lenta):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(memorizzati nella cache)<br /><br /> <xref:System.Windows.Media.VisualBrush>(memorizzati nella cache)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(non memorizzato nella cache)<br /><br /> <xref:System.Windows.Media.VisualBrush>(non memorizzato nella cache)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Impostare su `Viewport3D.ClipToBounds` false ogni volta [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] che non è <xref:System.Windows.Controls.Viewport3D> necessario ritagliare in modo esplicito il contenuto di un oggetto al rettangolo di Viewport3D. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]il ritaglio con antialiasing `ClipToBounds` può essere molto lento <xref:System.Windows.Controls.Viewport3D>ed è abilitato (lento) per impostazione predefinita su .|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Impostare su `Viewport3D.IsHitTestVisible` false ogni [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] volta che non <xref:System.Windows.Controls.Viewport3D> è necessario considerare il contenuto di un quando si esegue l'hit testing del mouse.  Il contenuto 3D di hit testing è fatto nel software e può essere lento con grandi maglie. <xref:System.Windows.UIElement.IsHitTestVisible%2A>è abilitato (lento) <xref:System.Windows.Controls.Viewport3D>per impostazione predefinita su .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Creare modelli diversi solo quando richiedono materiali o trasformazioni diversi.  In caso contrario, <xref:System.Windows.Media.Media3D.GeometryModel3D> provare a fondere molte istanze <xref:System.Windows.Media.Media3D.GeometryModel3D> <xref:System.Windows.Media.Media3D.MeshGeometry3D> con gli stessi materiali e trasformazioni in alcune istanze più grandi.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|L'animazione mesh, ovvero la modifica dei singoli vertici di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]una mesh in base al fotogramma, non è sempre efficiente in .  Per ridurre al minimo l'impatto sulle prestazioni delle notifiche di modifica quando ogni vertice viene modificato, scollegare la mesh dalla struttura ad albero visuale prima di eseguire la modifica per vertice.  Dopo aver modificato la mesh, ricollegarla alla struttura ad albero visuale.  Inoltre, cercare di ridurre al minimo le dimensioni delle maglie che verranno animate in questo modo.|  
|Antialiasing 3D|Per aumentare la velocità di <xref:System.Windows.Controls.Viewport3D> rendering, disattivate <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> `Aliased`il multicampionamento su un impostando la proprietà associata su .  Per impostazione predefinita, l'antialiasing 3D è abilitato in Windows con 4 campioni per pixel.|  
|Testo|Il testo in diretta in una scena 3D (dal vivo perché è in un <xref:System.Windows.Media.DrawingBrush> o <xref:System.Windows.Media.VisualBrush>) può essere lento. Provare a utilizzare immagini del <xref:System.Windows.Media.Imaging.RenderTargetBitmap>testo invece (via ) a meno che il testo non cambi.|  
|<xref:System.Windows.Media.TileBrush>|Se è necessario <xref:System.Windows.Media.VisualBrush> utilizzare <xref:System.Windows.Media.DrawingBrush> un oggetto o un oggetto in una scena 3D perché il contenuto <xref:System.Windows.Media.RenderOptions.CachingHint%2A> del `Cache`pennello non è statico, provare a memorizzare nella cache il pennello (impostando la proprietà associata su ).  Impostare le soglie di invalidazione della <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> scala <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>minima e massima (con le proprietà associate e ) in modo che i pennelli memorizzati nella cache non vengano rigenerati troppo frequentemente, pur mantenendo il livello di qualità desiderato.  Per impostazione predefinita, <xref:System.Windows.Media.DrawingBrush> e <xref:System.Windows.Media.VisualBrush> non vengono memorizzati nella cache, il che significa che ogni volta che è necessario eseguire nuovamente il rendering di un elemento disegnato con il pennello, l'intero contenuto del pennello deve prima essere sottoposto a nuovo rendering su una superficie intermedia.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect>forza il rendering di tutti i contenuti interessati senza accelerazione hardware.  Per ottenere prestazioni ottimali, non utilizzare <xref:System.Windows.Media.Effects.BitmapEffect>.|  
  
## <a name="performance-impact-medium"></a>Impatto sulle prestazioni: Medio  
  
|Proprietà|Recommendation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Quando una mesh è definita come triangoli adiacenti con vertici condivisi e tali vertici hanno la stessa posizione, normale <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>e coordinate di trama, definire ogni vertice condiviso una sola volta e quindi definire i triangoli in base all'indice con .|  
|<xref:System.Windows.Media.ImageBrush>|Cercate di ridurre al minimo le dimensioni delle trame <xref:System.Windows.Media.Imaging.RenderTargetBitmap> quando avete <xref:System.Windows.Media.ImageBrush>il controllo esplicito sulle dimensioni (quando state usando un e/o un).  Si noti che le trame a risoluzione inferiore possono ridurre la qualità visiva, quindi cerca te a trovare il giusto equilibrio tra qualità e prestazioni.|  
|Opacità|Quando si esegue il rendering di contenuto 3D traslucido (ad esempio riflessi), utilizzare le proprietà di opacità su pennelli o materiali <xref:System.Windows.Media.Brush.Opacity%2A> (tramite o <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>) anziché creare un traslucido <xref:System.Windows.Controls.Viewport3D> separato impostando `Viewport3D.Opacity` su un valore minore di 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Ridurre al <xref:System.Windows.Controls.Viewport3D> minimo il numero di oggetti in uso in una scena.  Inserire molti modelli 3D nello stesso Viewport3D anziché creare istanze Viewport3D separate per ogni modello.|  
|<xref:System.Windows.Freezable>|In genere è utile <xref:System.Windows.Media.Media3D.MeshGeometry3D>riutilizzare , <xref:System.Windows.Media.Media3D.GeometryModel3D>, Pennelli e Materiali.  Tutti sono multiparentable poiché `Freezable`sono derivati da .|  
|<xref:System.Windows.Freezable>|Chiamare <xref:System.Windows.Freezable.Freeze%2A> il metodo su Freezables quando le relative proprietà rimarranno invariate nell'applicazione.  Il congelamento può diminuire il working set e aumentare la velocità.|  
|<xref:System.Windows.Media.Brush>|Utilizzare <xref:System.Windows.Media.ImageBrush> al <xref:System.Windows.Media.VisualBrush> <xref:System.Windows.Media.DrawingBrush> posto o quando il contenuto del pennello non cambierà.  Il contenuto 2D può <xref:System.Windows.Controls.Image> <xref:System.Windows.Media.Imaging.RenderTargetBitmap> essere convertito in <xref:System.Windows.Media.ImageBrush>un via e quindi utilizzato in un file .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Non utilizzare <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> a meno che non è effettivamente necessario vedere le facce posteriori del file <xref:System.Windows.Media.Media3D.GeometryModel3D>.|  
|<xref:System.Windows.Media.Media3D.Light>|Velocità della luce (dalla velocità più veloce alla più lenta):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Cercate di mantenere le dimensioni delle mesh al di sotto di questi limiti:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20.001 <xref:System.Windows.Media.Media3D.Point3D> istanze<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60.003 <xref:System.Int32> istanze|  
|<xref:System.Windows.Media.Media3D.Material>|Velocità del materiale (dalla velocità più veloce alla più lenta):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]3D non opta di pennelli invisibili (pennelli ambientali neri, pennelli chiari, ecc.) in modo coerente.  Prendi in considerazione l'idea di ometterli dalla tua scena.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Ognuno <xref:System.Windows.Media.Media3D.Material> <xref:System.Windows.Media.Media3D.MaterialGroup> in un provoca un altro passaggio di rendering, quindi includendo molti materiali, anche materiali semplici, può aumentare drasticamente le richieste di riempimento per la GPU.  Ridurre al minimo il <xref:System.Windows.Media.Media3D.MaterialGroup>numero di materiali nel file .|  
  
## <a name="performance-impact-low"></a>Impatto sulle prestazioni: Basso  
  
|Proprietà|Recommendation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Quando non è necessaria l'animazione o l'associazione dati, anziché <xref:System.Windows.Media.Media3D.MatrixTransform3D>utilizzare un gruppo di trasformazioni contenente più trasformazioni, utilizzare un singolo , impostandolo come prodotto di tutte le trasformazioni che altrimenti esisterebbero in modo indipendente nel gruppo di trasformazioni.|  
|<xref:System.Windows.Media.Media3D.Light>|Ridurre al minimo il numero di luci nella scena. Troppe luci in una [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] scena forzano a tornare al rendering software.  I limiti sono circa <xref:System.Windows.Media.Media3D.DirectionalLight> 110 <xref:System.Windows.Media.Media3D.PointLight> oggetti, 70 <xref:System.Windows.Media.Media3D.SpotLight> oggetti o 40 oggetti.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Separare gli oggetti in movimento <xref:System.Windows.Media.Media3D.ModelVisual3D> dagli oggetti statici inserendoli in istanze separate.  ModelVisual3D è "più pesante" <xref:System.Windows.Media.Media3D.GeometryModel3D> che perché memorizza nella cache i limiti trasformati.  GeometryModel3D è ottimizzato per essere un modello; ModelVisual3D è ottimizzato per essere un nodo di scena.  Usare ModelVisual3D per inserire istanze condivise di GeometryModel3D nella scena.|  
|<xref:System.Windows.Media.Media3D.Light>|Ridurre al minimo il numero di volte in cui si modifica il numero di luci nella scena.  Ogni modifica del conteggio della luce forza una rigenerazione e ricompilazione dello shader, a meno che tale configurazione non esista in precedenza (e quindi il relativo shader sia stato memorizzato nella cache).|  
|Light|Le luci nere non saranno visibili, ma si aggiungeranno al tempo di rendering; prendere in considerazione di ometterli.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Per ridurre al minimo i [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]tempi di costruzione di raccolte <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>di <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>grandi <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>dimensioni in , ad esempio un oggetto MeshGeometry3D , , e , per la predimensione degli insiemi prima del popolamento del valore. Se possibile, passare le strutture di dati prepopolate dei costruttori delle raccolte, ad esempio matrici o elenchi.|  
  
## <a name="see-also"></a>Vedere anche

- [Panoramica della grafica 3D](3-d-graphics-overview.md)
