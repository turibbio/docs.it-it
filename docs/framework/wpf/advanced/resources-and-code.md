---
title: Risorse e codice
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: 8074562ddb865b482cf123743796ac68bb529f85
ms.sourcegitcommit: 62285ec11fa8e8424bab00511a90760c60e63c95
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/20/2020
ms.locfileid: "81646237"
---
# <a name="resources-and-code"></a><span data-ttu-id="f88e2-102">Risorse e codice</span><span class="sxs-lookup"><span data-stu-id="f88e2-102">Resources and Code</span></span>
<span data-ttu-id="f88e2-103">Questo argomento illustra le modalità di accesso alle risorse di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] o di creazione delle risorse stesse tramite codice anziché tramite la sintassi [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f88e2-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="f88e2-104">Per altre informazioni sull'uso delle risorse in generale e sulle risorse dal punto di vista della sintassi [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], vedere [Risorse XAML](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span><span class="sxs-lookup"><span data-stu-id="f88e2-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span></span>  

<a name="accessing"></a>
## <a name="accessing-resources-from-code"></a><span data-ttu-id="f88e2-105">Accesso alle risorse dal codice</span><span class="sxs-lookup"><span data-stu-id="f88e2-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="f88e2-106">Le chiavi che identificano le risorse, se definite tramite [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], possono essere usate anche per recuperare risorse specifiche qualora si richieda la risorsa nel codice.</span><span class="sxs-lookup"><span data-stu-id="f88e2-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="f88e2-107">Il modo più semplice per recuperare una <xref:System.Windows.FrameworkElement.FindResource%2A> risorsa <xref:System.Windows.FrameworkElement.TryFindResource%2A> dal codice consiste nel chiamare il o il metodo da oggetti a livello di framework nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f88e2-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="f88e2-108">La differenza di comportamento tra i due metodi sta nell'azione eseguita quando la chiave richiesta non viene trovata.</span><span class="sxs-lookup"><span data-stu-id="f88e2-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="f88e2-109"><xref:System.Windows.FrameworkElement.FindResource%2A>genera un'eccezione; <xref:System.Windows.FrameworkElement.TryFindResource%2A> non genererà un'eccezione, ma restituisce `null`.</span><span class="sxs-lookup"><span data-stu-id="f88e2-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="f88e2-110">Ogni metodo accetta la chiave di risorsa come parametro di input e restituisce un oggetto debolmente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="f88e2-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="f88e2-111">In genere una chiave di risorsa è una stringa, ma esistono utilizzi occasionali di tipo non stringa. Per informazioni dettagliate, vedere la sezione [Uso di oggetti come chiavi](#objectaskey).</span><span class="sxs-lookup"><span data-stu-id="f88e2-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="f88e2-112">Di regola, il cast dell'oggetto restituito viene eseguito nel tipo richiesto dalla proprietà impostata al momento della richiesta della risorsa.</span><span class="sxs-lookup"><span data-stu-id="f88e2-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="f88e2-113">La logica di ricerca per la risoluzione della risorsa codice è la stessa del codice [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] del riferimento di risorsa dinamica.</span><span class="sxs-lookup"><span data-stu-id="f88e2-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="f88e2-114">La ricerca delle risorse ha inizio dall'elemento chiamante e continua con gli elementi padre successivi dell'albero logico.</span><span class="sxs-lookup"><span data-stu-id="f88e2-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="f88e2-115">Prosegue quindi nelle risorse, nei temi e, se necessario, nelle risorse di sistema dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f88e2-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="f88e2-116">Una richiesta di codice per una risorsa terrà in considerazione le modifiche di runtime eventualmente apportate ai dizionari risorse successivamente al caricamento di un determinato dizionario risorse da [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], oltre che le modifiche apportate alle risorse di sistema in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="f88e2-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="f88e2-117">Di seguito è riportato un breve esempio di codice che trova una risorsa <xref:System.Windows.Controls.Primitives.ButtonBase.Click> in base alla chiave e usa il valore restituito per impostare una proprietà, implementata come gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="f88e2-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="f88e2-118">Un metodo alternativo per l'assegnazione di un riferimento di risorsa è <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="f88e2-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="f88e2-119">Questo metodo accetta due parametri: la chiave della risorsa e l'identificatore di una particolare proprietà di dipendenza presente nell'istanza dell'elemento a cui deve essere assegnato il valore della risorsa.</span><span class="sxs-lookup"><span data-stu-id="f88e2-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="f88e2-120">A livello funzionale, questo metodo è identico al precedente e presenta il vantaggio di non richiedere il cast dei valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="f88e2-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="f88e2-121">Un altro modo per accedere alle risorse a <xref:System.Windows.FrameworkElement.Resources%2A> livello di codice consiste nell'accedere al contenuto della proprietà come dizionario.</span><span class="sxs-lookup"><span data-stu-id="f88e2-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="f88e2-122">L'accesso al dizionario incluso in questa proprietà consente anche di aggiungere nuove risorse alle raccolte esistenti, di verificare se un determinato nome di chiave è già usato nella raccolta e di eseguire altre operazioni sul dizionario o sulla raccolta.</span><span class="sxs-lookup"><span data-stu-id="f88e2-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="f88e2-123">Se si scrive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] un'applicazione interamente nel codice, è anche possibile creare l'intera raccolta nel <xref:System.Windows.FrameworkElement.Resources%2A> codice, assegnarvi le chiavi e quindi assegnare la raccolta finita alla proprietà di un elemento stabilito.</span><span class="sxs-lookup"><span data-stu-id="f88e2-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="f88e2-124">Questa procedura sarà descritta nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="f88e2-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="f88e2-125">È possibile indicizzare all'interno di una determinata <xref:System.Windows.FrameworkElement.Resources%2A> raccolta, usando una chiave specifica come indice, ma è necessario tenere presente che l'accesso alla risorsa in questo modo non segue le normali regole di runtime della risoluzione delle risorse.</span><span class="sxs-lookup"><span data-stu-id="f88e2-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="f88e2-126">Viene eseguito l'accesso solo a quella particolare risorsa.</span><span class="sxs-lookup"><span data-stu-id="f88e2-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="f88e2-127">La ricerca della risorsa non attraversa l'ambito fino alla radice o all'applicazione se non è stato trovato alcun oggetto valido in corrispondenza della chiave richiesta.</span><span class="sxs-lookup"><span data-stu-id="f88e2-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="f88e2-128">Questo approccio, tuttavia, in alcuni casi può presentare vantaggi in termini di prestazioni, proprio perché l'ambito di ricerca della chiave è più limitato.</span><span class="sxs-lookup"><span data-stu-id="f88e2-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="f88e2-129">Vedere <xref:System.Windows.ResourceDictionary> la classe per ulteriori dettagli su come utilizzare direttamente il dizionario risorse.</span><span class="sxs-lookup"><span data-stu-id="f88e2-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>
## <a name="creating-resources-with-code"></a><span data-ttu-id="f88e2-130">Creazione delle risorse tramite codice</span><span class="sxs-lookup"><span data-stu-id="f88e2-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="f88e2-131">Se si vuole creare un'intera applicazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in codice, può essere necessario creare in codice anche eventuali risorse di tale applicazione.</span><span class="sxs-lookup"><span data-stu-id="f88e2-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="f88e2-132">A tale scopo, <xref:System.Windows.ResourceDictionary> creare una nuova istanza e quindi aggiungere tutte <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>le risorse al dizionario utilizzando chiamate successive a .</span><span class="sxs-lookup"><span data-stu-id="f88e2-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f88e2-133">Utilizzare quindi <xref:System.Windows.ResourceDictionary> l'oggetto creato <xref:System.Windows.FrameworkElement.Resources%2A> per impostare la proprietà su un <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>elemento presente in un ambito di pagina o su .</span><span class="sxs-lookup"><span data-stu-id="f88e2-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f88e2-134">È anche possibile <xref:System.Windows.ResourceDictionary> mantenere l'oggetto come oggetto autonomo senza aggiungerlo a un elemento.</span><span class="sxs-lookup"><span data-stu-id="f88e2-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="f88e2-135">In questo caso, tuttavia, è necessario accedere alle risorse al suo interno tramite la chiave dell'elemento, come se si trattasse di un dizionario generico.</span><span class="sxs-lookup"><span data-stu-id="f88e2-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="f88e2-136">Oggetto <xref:System.Windows.ResourceDictionary> che non è associato `Resources` a una proprietà dell'elemento non esisterebbe come parte della struttura <xref:System.Windows.FrameworkElement.FindResource%2A> ad albero dell'elemento e non ha alcun ambito in una sequenza di ricerca che può essere utilizzata da metodi correlati e da quelli correlati.</span><span class="sxs-lookup"><span data-stu-id="f88e2-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>
## <a name="using-objects-as-keys"></a><span data-ttu-id="f88e2-137">Uso di oggetti come chiavi</span><span class="sxs-lookup"><span data-stu-id="f88e2-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="f88e2-138">La chiave di una risorsa sarà impostata come stringa nella maggior parte degli utilizzi di quella risorsa.</span><span class="sxs-lookup"><span data-stu-id="f88e2-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="f88e2-139">Diverse funzionalità di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], tuttavia, non usano un tipo stringa per specificare le chiavi, quel parametro sarà un oggetto.</span><span class="sxs-lookup"><span data-stu-id="f88e2-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="f88e2-140">La possibilità di disporre di un oggetto come chiave della risorsa viene usata dal supporto degli stili e dei temi di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f88e2-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="f88e2-141">Gli stili nei temi che diventano lo stile predefinito per un <xref:System.Type> controllo altrimenti senza stile sono ognuno con chiave dal controllo che devono essere applicati.</span><span class="sxs-lookup"><span data-stu-id="f88e2-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="f88e2-142">L'uso di un tipo come chiave offre un meccanismo di ricerca affidabile che funziona sulle istanze predefinite di ogni tipo di controllo, pertanto il tipo può essere rilevato mediante reflection e usato per applicare uno stile alle classi derivate, anche se il tipo derivato non disporrebbe altrimenti di uno stile predefinito.</span><span class="sxs-lookup"><span data-stu-id="f88e2-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="f88e2-143">È possibile <xref:System.Type> specificare una chiave [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] per una risorsa definita in utilizzando l'estensione [x:Type Markup](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="f88e2-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span></span> <span data-ttu-id="f88e2-144">Esistono estensioni analoghe per altri utilizzi di chiavi di tipo non stringa che supportano funzionalità di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], come l'[estensione di markup ComponentResourceKey](componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="f88e2-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f88e2-145">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f88e2-145">See also</span></span>

- [<span data-ttu-id="f88e2-146">Risorse XAML</span><span class="sxs-lookup"><span data-stu-id="f88e2-146">XAML Resources</span></span>](../../../desktop-wpf/fundamentals/xaml-resources-define.md)
- [<span data-ttu-id="f88e2-147">Applicazione di stili e modelli</span><span class="sxs-lookup"><span data-stu-id="f88e2-147">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
