---
title: Contatori delle prestazioni e applicazioni affiancate in-process
description: Esaminare i contatori delle prestazioni e le applicazioni affiancate in-process in .NET. Usare Perfmon.exe per distinguere i contatori delle prestazioni in base al runtime.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
ms.openlocfilehash: eb05d9f5f930420827c6b3d94ea0ed34f64464fd
ms.sourcegitcommit: c23d9666ec75b91741da43ee3d91c317d68c7327
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/01/2020
ms.locfileid: "85803859"
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="257d8-104">Contatori delle prestazioni e applicazioni affiancate in-process</span><span class="sxs-lookup"><span data-stu-id="257d8-104">Performance Counters and In-Process Side-By-Side Applications</span></span>
<span data-ttu-id="257d8-105">Con Performance Monitor (Perfmon.exe) è possibile distinguere i contatori delle prestazioni in base al runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-105">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="257d8-106">Questo argomento descrive la modifica del Registro di sistema necessaria per abilitare questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="257d8-106">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="257d8-107">Comportamento predefinito</span><span class="sxs-lookup"><span data-stu-id="257d8-107">The Default Behavior</span></span>  
 <span data-ttu-id="257d8-108">Per impostazione predefinita, Performance Monitor visualizza i contatori delle prestazioni in base all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="257d8-108">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="257d8-109">In due scenari, tuttavia, ciò può rappresentare un problema:</span><span class="sxs-lookup"><span data-stu-id="257d8-109">However, there are two scenarios in which this is problematic:</span></span>  
  
- <span data-ttu-id="257d8-110">Quando viene eseguito il monitoraggio di due applicazioni con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="257d8-110">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="257d8-111">Ad esempio, se entrambe le applicazioni sono denominate app.exe, una verrà visualizzata come **app** e l'altra come **app#1** nella colonna **Istanza**.</span><span class="sxs-lookup"><span data-stu-id="257d8-111">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="257d8-112">In questo caso, è difficile associare un contatore delle prestazioni a un'applicazione specifica.</span><span class="sxs-lookup"><span data-stu-id="257d8-112">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="257d8-113">Non è chiaro se i dati raccolti per **app #1** fanno riferimento alla prima o alla seconda app.exe.</span><span class="sxs-lookup"><span data-stu-id="257d8-113">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
- <span data-ttu-id="257d8-114">Quando un'applicazione usa più istanze di Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-114">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="257d8-115">Il .NET Framework 4 supporta gli scenari di hosting affiancato in-process. ovvero un singolo processo o un'applicazione può caricare più istanze del Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-115">The .NET Framework 4 supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="257d8-116">Se una singola applicazione denominata app.exe carica due istanze di runtime, per impostazione predefinita verranno designate come **app** e **app#1** nella colonna **Istanza**.</span><span class="sxs-lookup"><span data-stu-id="257d8-116">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="257d8-117">In questo caso, non è chiaro se **app** e **app#1** fanno riferimento a due applicazioni con lo stesso nome o alla stessa applicazione con due runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-117">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="257d8-118">Se più applicazioni con lo stesso nome caricano più runtime, l'ambiguità è ancora maggiore.</span><span class="sxs-lookup"><span data-stu-id="257d8-118">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="257d8-119">È possibile impostare una chiave del Registro di sistema per evitare questa ambiguità.</span><span class="sxs-lookup"><span data-stu-id="257d8-119">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="257d8-120">Per le applicazioni sviluppate utilizzando il .NET Framework 4, questa modifica del registro di sistema aggiunge un identificatore di processo seguito da un identificatore dell'istanza di runtime al nome dell'applicazione nella colonna dell' **istanza** .</span><span class="sxs-lookup"><span data-stu-id="257d8-120">For applications developed using the .NET Framework 4, this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="257d8-121">Invece di *#1 dell'applicazione o* dell' *applicazione*, l'applicazione è ora identificata come *Application*_ `p` *ProcessID* \_ `r` *IDruntime* nella colonna dell' **istanza** .</span><span class="sxs-lookup"><span data-stu-id="257d8-121">Instead of *application* or *application*#1, the application is now identified as *application*_`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="257d8-122">Se un'applicazione è stata sviluppata utilizzando una versione precedente del Common Language Runtime, tale istanza viene rappresentata \*come \_ \* `p` *ProcessID* dell'applicazione purché sia installato il .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="257d8-122">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the .NET Framework 4 is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="257d8-123">Contatori delle prestazioni per applicazioni affiancate in-process</span><span class="sxs-lookup"><span data-stu-id="257d8-123">Performance Counters for In-Process Side-by-Side Applications</span></span>  
 <span data-ttu-id="257d8-124">Per gestire i contatori delle prestazioni per più versioni di Common Language Runtime ospitate in una singola applicazione, è necessario modificare una chiave del Registro di sistema, come illustrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="257d8-124">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="257d8-125">Nome della chiave</span><span class="sxs-lookup"><span data-stu-id="257d8-125">Key name</span></span>|<span data-ttu-id="257d8-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="257d8-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="257d8-127">Nome del valore</span><span class="sxs-lookup"><span data-stu-id="257d8-127">Value name</span></span>|<span data-ttu-id="257d8-128">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="257d8-128">ProcessNameFormat</span></span>|  
|<span data-ttu-id="257d8-129">Tipo valore</span><span class="sxs-lookup"><span data-stu-id="257d8-129">Value type</span></span>|<span data-ttu-id="257d8-130">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="257d8-130">REG_DWORD</span></span>|  
|<span data-ttu-id="257d8-131">Valore</span><span class="sxs-lookup"><span data-stu-id="257d8-131">Value</span></span>|<span data-ttu-id="257d8-132">1 (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="257d8-132">1 (0x00000001)</span></span>|  
  
 <span data-ttu-id="257d8-133">Il valore 0 per `ProcessNameFormat` indica che è abilitato il comportamento predefinito, ovvero Perfmon.exe visualizza i contatori delle prestazioni in base alle singole applicazioni.</span><span class="sxs-lookup"><span data-stu-id="257d8-133">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="257d8-134">Quando si imposta questo valore su 1, Perfmon.exe risolve l'ambiguità per più versioni di un'applicazione e fornisce i contatori delle prestazioni in base al runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-134">When you set this value to 1, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="257d8-135">Qualsiasi altro valore per l'impostazione della chiave del Registro di sistema `ProcessNameFormat` non è supportato ed è riservato per usi futuri.</span><span class="sxs-lookup"><span data-stu-id="257d8-135">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>  
  
 <span data-ttu-id="257d8-136">Dopo aver aggiornato l'impostazione della chiave del Registro di sistema `ProcessNameFormat`, è necessario riavviare Perfmon.exe o qualsiasi altro consumer di contatori delle prestazioni, in modo che la nuova funzionalità di denominazione delle istanze funzioni correttamente.</span><span class="sxs-lookup"><span data-stu-id="257d8-136">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="257d8-137">L'esempio seguente mostra come modificare il valore `ProcessNameFormat` a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="257d8-137">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="257d8-138">Quando si modifica il registro di sistema, Perfmon.exe Visualizza i nomi delle applicazioni destinate a .NET Framework 4 come *Application*_ `p` *ProcessID* \_ `r` *IDruntime*, dove *applicazione* è il nome dell'applicazione, *ProcessID* è l'identificatore del processo dell'applicazione e *IDruntime* è un identificatore Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-138">When you make this registry change, Perfmon.exe displays the names of applications that target the .NET Framework 4 as *application*_`p`*processID*\_`r`*runtimeID*, where *application* is the name of the application, *processID* is the application's process identifier, and *runtimeID* is a common language runtime identifier.</span></span> <span data-ttu-id="257d8-139">Ad esempio, se un'applicazione denominata app.exe carica due istanze di Common Language Runtime, Perfmon.exe può identificare un'istanza come app_p1416_r10 e la seconda come app_p3160_r10.</span><span class="sxs-lookup"><span data-stu-id="257d8-139">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_p1416_r10 and the second as myapp_p3160_r10.</span></span> <span data-ttu-id="257d8-140">L'identificatore di runtime risolve solo eventuali ambiguità per i runtime all'interno di un processo e non fornisce informazioni sul runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-140">The runtime identifier only disambiguates the runtimes within a process; it does not provide any other information about the runtime.</span></span> <span data-ttu-id="257d8-141">(Ad esempio, l'ID di runtime non ha alcuna relazione con la versione o lo SKU del runtime.)</span><span class="sxs-lookup"><span data-stu-id="257d8-141">(For example, the runtime ID has no relation to the version or the SKU of the runtime.)</span></span>  
  
 <span data-ttu-id="257d8-142">Se la .NET Framework 4 è installata, la modifica del registro di sistema influiscono anche sulle applicazioni sviluppate con versioni precedenti del .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="257d8-142">If the .NET Framework 4 is installed, the registry change also affects applications that were developed using earlier versions of the .NET Framework.</span></span> <span data-ttu-id="257d8-143">Questi vengono visualizzati in Perfmon.exe come *application_* `p` *ProcessID*, dove *applicazione* è il nome dell'applicazione e *ProcessID* è l'identificatore del processo.</span><span class="sxs-lookup"><span data-stu-id="257d8-143">These appear in Perfmon.exe as *application_*`p`*processID*, where *application* is the application name and *processID* is the process identifier.</span></span> <span data-ttu-id="257d8-144">Ad esempio, se vengono monitorati i contatori delle prestazioni di due applicazioni denominate app.exe, una potrebbe essere visualizzata come app_p23900 e l'altra come app_p24908.</span><span class="sxs-lookup"><span data-stu-id="257d8-144">For example, if the performance counters of two applications named myapp.exe are monitored, one might appear as myapp_p23900 and the other as myapp_p24908.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="257d8-145">L'identificatore di processo elimina l'ambiguità per la risoluzione di due applicazioni con lo stesso nome che usano versioni precedenti del runtime.</span><span class="sxs-lookup"><span data-stu-id="257d8-145">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="257d8-146">Un identificatore di runtime non è obbligatorio per le versioni precedenti, perché le versioni precedenti di Common Language Runtime non supportano gli scenari affiancati.</span><span class="sxs-lookup"><span data-stu-id="257d8-146">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="257d8-147">Se la .NET Framework 4 non è presente o è stata disinstallata, l'impostazione della chiave del registro di sistema non ha alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="257d8-147">If the .NET Framework 4 is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="257d8-148">Questo significa che due applicazioni con lo stesso nome continueranno a essere visualizzate in Perfmon.exe come *applicazione* e *applicazione#1* (ad esempio, come **app** e **app#1**).</span><span class="sxs-lookup"><span data-stu-id="257d8-148">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
