---
title: Query su singola tabella (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: 89c90fd217285fac449aba40682aa947fcfb3a07
ms.sourcegitcommit: 99b153b93bf94d0fecf7c7bcecb58ac424dfa47c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/25/2020
ms.locfileid: "80249090"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="9327a-102">Query su singola tabella (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="9327a-102">Single-Table Queries (LINQ to DataSet)</span></span>
<span data-ttu-id="9327a-103">Le query LINQ (Language-Integrated Query) funzionano su origini dati che implementano l'interfaccia <xref:System.Collections.Generic.IEnumerable%601> o l'interfaccia. <xref:System.Linq.IQueryable%601></span><span class="sxs-lookup"><span data-stu-id="9327a-103">Language-Integrated Query (LINQ) queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="9327a-104">La <xref:System.Data.DataTable> classe non implementa nessuna delle <xref:System.Data.DataTableExtensions.AsEnumerable%2A> due interfacce, pertanto è necessario chiamare il metodo se si desidera utilizzare l'oggetto <xref:System.Data.DataTable> come origine nella `From` clausola di una query LINQ.</span><span class="sxs-lookup"><span data-stu-id="9327a-104">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a LINQ query.</span></span>  
  
 <span data-ttu-id="9327a-105">Nell'esempio seguente vengono ottenuti tutti gli ordini online della tabella SalesOrderHeader e l'output costituito da ID ordine, data dell'ordine e numero di ordine viene inviato alla console.</span><span class="sxs-lookup"><span data-stu-id="9327a-105">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)]
  
 <span data-ttu-id="9327a-106">La query della variabile locale viene inizializzata con un'espressione di query, che opera su una o più origini di informazioni applicando uno o <xref:System.Data.DataSet> più operatori di query dagli operatori di query standard o, nel caso di LINQ to DataSet, operatori specifici della classe.</span><span class="sxs-lookup"><span data-stu-id="9327a-106">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="9327a-107">Nell'espressione di query dell'esempio precedente vengono usati due operatori di query standard: `Where` e `Select`.</span><span class="sxs-lookup"><span data-stu-id="9327a-107">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="9327a-108">La clausola `Where` filtra la sequenza in base a una condizione, in questo caso che `OnlineOrderFlag` sia impostato su `true`.</span><span class="sxs-lookup"><span data-stu-id="9327a-108">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="9327a-109">L'operatore `Select` alloca e restituisce un oggetto enumerabile che acquisisce gli argomenti passati all'operatore.</span><span class="sxs-lookup"><span data-stu-id="9327a-109">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="9327a-110">Nell'esempio precedente viene creato un tipo anonimo con tre proprietà: `SalesOrderID`, `OrderDate` e `SalesOrderNumber`.</span><span class="sxs-lookup"><span data-stu-id="9327a-110">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="9327a-111">I valori di queste tre proprietà vengono impostati sui valori delle colonne `SalesOrderID`, `OrderDate` e `SalesOrderNumber` della tabella `SalesOrderHeader`.</span><span class="sxs-lookup"><span data-stu-id="9327a-111">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="9327a-112">Il ciclo `foreach` enumera quindi gli oggetti enumerabili restituiti da `Select` e produce i risultati della query.</span><span class="sxs-lookup"><span data-stu-id="9327a-112">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="9327a-113">Poiché la query è un tipo <xref:System.Linq.Enumerable>, che implementa <xref:System.Collections.Generic.IEnumerable%601>, la valutazione della query viene posticipata finché non viene eseguita un'iterazione della variabile di query in un ciclo `foreach`.</span><span class="sxs-lookup"><span data-stu-id="9327a-113">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="9327a-114">La valutazione posticipata della query consente di mantenere le query come valori che è possibile valutare più volte, ogni volta con un risultato potenzialmente diverso.</span><span class="sxs-lookup"><span data-stu-id="9327a-114">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="9327a-115">Il metodo <xref:System.Data.DataRowExtensions.Field%2A> fornisce l'accesso ai valori di colonna di un oggetto <xref:System.Data.DataRow> e <xref:System.Data.DataRowExtensions.SetField%2A> (non illustrato nell'esempio precedente) imposta i valori di colonna in <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="9327a-115">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="9327a-116">Sia <xref:System.Data.DataRowExtensions.Field%2A> il <xref:System.Data.DataRowExtensions.SetField%2A> metodo che il metodo gestiscono i tipi di valore nullable, pertanto non è necessario verificare in modo esplicito la presenza di valori null.</span><span class="sxs-lookup"><span data-stu-id="9327a-116">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable value types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="9327a-117">Entrambi metodi sono inoltre generici, quindi non è necessario eseguire i cast del tipo restituito.</span><span class="sxs-lookup"><span data-stu-id="9327a-117">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="9327a-118">È possibile usare la funzione di accesso della colonna preesistente in <xref:System.Data.DataRow> (ad esempio, `o["OrderDate"]`), ma in questo caso è necessario eseguire il cast dell'oggetto restituito nel tipo appropriato.</span><span class="sxs-lookup"><span data-stu-id="9327a-118">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="9327a-119">Se la colonna è un tipo di valore nullable è <xref:System.Data.DataRow.IsNull%2A> necessario verificare se il valore è null utilizzando il metodo .</span><span class="sxs-lookup"><span data-stu-id="9327a-119">If the column is a nullable value type you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="9327a-120">Per ulteriori informazioni, vedere [Metodi Generic Field e SetField](generic-field-and-setfield-methods-linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="9327a-120">For more information, see [Generic Field and SetField Methods](generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="9327a-121">Si noti che il tipo di dati specificato nel parametro `T` generico del metodo <xref:System.Data.DataRowExtensions.Field%2A> e del metodo <xref:System.Data.DataRowExtensions.SetField%2A> deve corrispondere al tipo del valore sottostante; in caso contrario, verrà generata un'eccezione <xref:System.InvalidCastException>.</span><span class="sxs-lookup"><span data-stu-id="9327a-121">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="9327a-122">Il nome di colonna specificato deve inoltre corrispondere al nome di una colonna presente in <xref:System.Data.DataSet>; in caso contrario, verrà generata un'eccezione <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="9327a-122">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="9327a-123">In entrambi casi, l'eccezione viene generata in fase di esecuzione durante l'enumerazione dei dati quando viene eseguita la query.</span><span class="sxs-lookup"><span data-stu-id="9327a-123">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9327a-124">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9327a-124">See also</span></span>

- [<span data-ttu-id="9327a-125">Query su tabella incrociata</span><span class="sxs-lookup"><span data-stu-id="9327a-125">Cross-Table Queries</span></span>](cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="9327a-126">Esecuzione di query su dataset tipizzati</span><span class="sxs-lookup"><span data-stu-id="9327a-126">Querying Typed DataSets</span></span>](querying-typed-datasets.md)
- [<span data-ttu-id="9327a-127">Metodi generici Field e SetField</span><span class="sxs-lookup"><span data-stu-id="9327a-127">Generic Field and SetField Methods</span></span>](generic-field-and-setfield-methods-linq-to-dataset.md)
