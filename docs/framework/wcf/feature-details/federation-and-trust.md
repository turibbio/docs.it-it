---
title: Federazione e attendibilità
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: 8b924a4aeb9c667592e99d65666cd8f048d34c22
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/09/2020
ms.locfileid: "84595479"
---
# <a name="federation-and-trust"></a><span data-ttu-id="d5718-102">Federazione e attendibilità</span><span class="sxs-lookup"><span data-stu-id="d5718-102">Federation and Trust</span></span>
<span data-ttu-id="d5718-103">In questo argomento vengono illustrati i vari aspetti correlati alle applicazioni federate, i limiti di trust e la configurazione e l'utilizzo dei token emessi in Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="d5718-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="d5718-104">Servizi, servizi token di sicurezza e attendibilità</span><span class="sxs-lookup"><span data-stu-id="d5718-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="d5718-105">I servizi che espongono endpoint federati in genere prevedono che i client siano autenticati utilizzando un token fornito da un emittente specifico.</span><span class="sxs-lookup"><span data-stu-id="d5718-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="d5718-106">È importante che il servizio sia configurato con le credenziali corrette per l'emittente. In caso contrario, non sarà in grado di verificare le firme sui token emessi e il client non sarà in grado di comunicare con il servizio.</span><span class="sxs-lookup"><span data-stu-id="d5718-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="d5718-107">Per ulteriori informazioni sulla configurazione delle credenziali dell'autorità emittente nel servizio, vedere [procedura: configurare le credenziali in un servizio federativo](how-to-configure-credentials-on-a-federation-service.md).</span><span class="sxs-lookup"><span data-stu-id="d5718-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="d5718-108">In modo analogo, quando si utilizzano chiavi simmetriche, queste vengono crittografate per il servizio di destinazione, è pertanto necessario configurare il servizio token di sicurezza con le credenziali corrette per il servizio di destinazione. In caso contrario, non sarà in grado di crittografare la chiave per il servizio di destinazione e il client non sarà in grado di comunicare con il servizio.</span><span class="sxs-lookup"><span data-stu-id="d5718-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="d5718-109">I servizi WCF utilizzano il valore della <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> Proprietà in [SecurityBindingElement](../diagnostics/wmi/securitybindingelement.md) per consentire lo sfasamento di clock tra il client e il servizio.</span><span class="sxs-lookup"><span data-stu-id="d5718-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="d5718-110">Nella federazione, l'impostazione `MaxClockSkew` si applica agli sfasamenti dei segnali di clock tra client e servizio token di sicurezza da cui il client ha ottenuto il token emesso.</span><span class="sxs-lookup"><span data-stu-id="d5718-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="d5718-111">I servizi token di sicurezza, pertanto, non hanno necessità di concedere lo sfasamento dei segnali di clock durante l'impostazione dei periodi di attività e di scadenza dei token emessi.</span><span class="sxs-lookup"><span data-stu-id="d5718-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="d5718-112">L'importanza dello sfasamento dei segnali di clock aumenta con l'abbreviarsi della durata del token emesso.</span><span class="sxs-lookup"><span data-stu-id="d5718-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="d5718-113">Nella maggior parte dei casi, lo sfasamento dei segnali di clock non è un problema significativo se la durata del token è di 30 minuti o superiore.</span><span class="sxs-lookup"><span data-stu-id="d5718-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="d5718-114">Gli scenari con durate più brevi o in cui è importante conoscere il periodo di validità esatto del token, devono essere progettati in modo da prendere in considerazione lo sfasamento dei segnali di clock.</span><span class="sxs-lookup"><span data-stu-id="d5718-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="d5718-115">Endpoint e timeout federati</span><span class="sxs-lookup"><span data-stu-id="d5718-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="d5718-116">Quando un client comunica con un endpoint federato, deve innanzitutto acquisire un token appropriato da un servizio token di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="d5718-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="d5718-117">Se il servizio token di sicurezza espone un endpoint federato, il client deve innanzitutto ottenere un token dall'emittente per quell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="d5718-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="d5718-118">Ogni acquisizione di token richiede tempo e questo tempo è soggetto al timeout complessivo per l'invio del messaggio effettivo all'endpoint finale.</span><span class="sxs-lookup"><span data-stu-id="d5718-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="d5718-119">Il timeout, ad esempio, nel canale lato client è impostato su 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="d5718-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="d5718-120">È necessario chiamare due emittenti del token per recuperare i token prima di inviare il messaggio all'endpoint finale e ognuno di essi richiede 15 secondi di tempo per emettere un token.</span><span class="sxs-lookup"><span data-stu-id="d5718-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="d5718-121">In questo caso il tentativo non riuscirà e verrà generata un'eccezione <xref:System.TimeoutException>.</span><span class="sxs-lookup"><span data-stu-id="d5718-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="d5718-122">È pertanto necessario impostare il valore <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> nel canale client su un valore sufficientemente grande da includere il tempo richiesto per recuperare tutti i token emessi.</span><span class="sxs-lookup"><span data-stu-id="d5718-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="d5718-123">Nel caso in cui non sia specificato un valore per la proprietà <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A>, la proprietà <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> o <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> (o entrambe) devono essere impostate su un valore sufficientemente grande da includere il tempo richiesto per recuperare tutti i token emessi.</span><span class="sxs-lookup"><span data-stu-id="d5718-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="d5718-124">Durata e rinnovo dei token </span><span class="sxs-lookup"><span data-stu-id="d5718-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="d5718-125">I client WCF non controllano il token emesso quando si effettua una richiesta iniziale a un servizio.</span><span class="sxs-lookup"><span data-stu-id="d5718-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="d5718-126">Piuttosto, WCF considera attendibile il servizio token di sicurezza per emettere un token con i tempi di validità e di scadenza appropriati.</span><span class="sxs-lookup"><span data-stu-id="d5718-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="d5718-127">Se il token viene memorizzato nella cache dal client e riutilizzato, la sua durata viene controllata in base a richieste successive e il client lo rinnova automaticamente, se necessario.</span><span class="sxs-lookup"><span data-stu-id="d5718-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="d5718-128">Per ulteriori informazioni sulla memorizzazione dei token nella cache, vedere [procedura: creare un client federato](how-to-create-a-federated-client.md).</span><span class="sxs-lookup"><span data-stu-id="d5718-128">For more information about token caching, see [How to: Create a Federated Client](how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="d5718-129">Se si specificano durate brevi, in ordine di 30 secondi o meno per i token emessi o i token del contesto di sicurezza, è possibile che vengano generati timeout di negoziazione o altre eccezioni generate dai client WCF quando vengono richiesti token rilasciati o quando si negoziano o si rinnovano i token del contesto di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="d5718-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="d5718-130">Token emessi e InclusionMode</span><span class="sxs-lookup"><span data-stu-id="d5718-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="d5718-131">L'impostazione della proprietà <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> della classe <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> consente di controllare se un token emesso viene serializzato in un messaggio inviato da un client a un endpoint federato.</span><span class="sxs-lookup"><span data-stu-id="d5718-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="d5718-132">Questa proprietà può essere impostata su uno dei valori dell'enumerazione <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> ma non è di nessuna utilità nella maggior parte degli scenari federati.</span><span class="sxs-lookup"><span data-stu-id="d5718-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="d5718-133">I valori `SecurityTokenInclusionMode.Never` e `SecurityTokenInclusionMode.AlwaysToInitiator` fanno in modo che il client invii un riferimento al token emesso dal servizio token di sicurezza al componente.</span><span class="sxs-lookup"><span data-stu-id="d5718-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="d5718-134">A meno che il relying party non sia in possesso di una copia del token emesso, l'autenticazione non riuscirà poiché il riferimento al token non è risolvibile.</span><span class="sxs-lookup"><span data-stu-id="d5718-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="d5718-135">WCF considera `SecurityTokenInclusionMode.Once` equivalente a `SecurityTokenInclusionMode.AlwaysToRecipient` .</span><span class="sxs-lookup"><span data-stu-id="d5718-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d5718-136">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="d5718-136">See also</span></span>

- <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>
- [<span data-ttu-id="d5718-137">Procedura: creare un client federato</span><span class="sxs-lookup"><span data-stu-id="d5718-137">How to: Create a Federated Client</span></span>](how-to-create-a-federated-client.md)
- [<span data-ttu-id="d5718-138">Procedura: configurare le credenziali in un servizio federativo</span><span class="sxs-lookup"><span data-stu-id="d5718-138">How to: Configure Credentials on a Federation Service</span></span>](how-to-configure-credentials-on-a-federation-service.md)
- [<span data-ttu-id="d5718-139">Procedura: Creare una classe WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="d5718-139">How to: Create a WSFederationHttpBinding</span></span>](how-to-create-a-wsfederationhttpbinding.md)
