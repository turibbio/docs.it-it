---
title: Identità del servizio e autenticazione
description: Informazioni sull'identità dell'endpoint di un servizio, un valore generato dal servizio WSDL, che WCF USA per autenticare il servizio.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- authentication [WCF], specifying the identity of a service
ms.assetid: a4c8f52c-5b30-45c4-a545-63244aba82be
ms.openlocfilehash: ae217b4a2c3432321c7ef2e663922a87b82acbea
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/23/2020
ms.locfileid: "85246571"
---
# <a name="service-identity-and-authentication"></a><span data-ttu-id="516bd-103">Identità del servizio e autenticazione</span><span class="sxs-lookup"><span data-stu-id="516bd-103">Service Identity and Authentication</span></span>
<span data-ttu-id="516bd-104">L'identità dell' *endpoint* di un servizio è un valore generato dal Web Services Description Language di servizio (WSDL).</span><span class="sxs-lookup"><span data-stu-id="516bd-104">A service's *endpoint identity* is a value generated from the service Web Services Description Language (WSDL).</span></span> <span data-ttu-id="516bd-105">Questo valore, propagato a tutti i client, viene utilizzato per autenticare il servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-105">This value, propagated to any client, is used to authenticate the service.</span></span> <span data-ttu-id="516bd-106">Dopo che il client ha avviato una comunicazione con un endpoint e il servizio è stato autenticato nel client, quest'ultimo confronta il valore dell'identità endpoint con il valore effettivo restituito dal processo di autenticazione dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="516bd-106">After the client initiates a communication to an endpoint and the service authenticates itself to the client, the client compares the endpoint identity value with the actual value the endpoint authentication process returned.</span></span> <span data-ttu-id="516bd-107">La corrispondenza di questi due valori costituisce garanzia per il client di aver contattato l'endpoint del servizio previsto.</span><span class="sxs-lookup"><span data-stu-id="516bd-107">If they match, the client is assured it has contacted the expected service endpoint.</span></span> <span data-ttu-id="516bd-108">Questa funzione funge da protezione contro il *phishing* evitando che un client venga reindirizzato a un endpoint ospitato da un servizio dannoso.</span><span class="sxs-lookup"><span data-stu-id="516bd-108">This functions as a protection against *phishing* by preventing a client from being redirected to an endpoint hosted by a malicious service.</span></span>  
  
 <span data-ttu-id="516bd-109">Per un'applicazione di esempio che illustra l'impostazione Identity, vedere [esempio di identità del servizio](../samples/service-identity-sample.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-109">For a sample application that demonstrates identity setting, see [Service Identity Sample](../samples/service-identity-sample.md).</span></span> <span data-ttu-id="516bd-110">Per ulteriori informazioni sugli endpoint e sugli indirizzi endpoint, vedere [indirizzi](endpoint-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-110">For more information about endpoints and endpoint addresses, see [Addresses](endpoint-addresses.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="516bd-111">Quando si utilizza NTLM (NT LanMan) per l'autenticazione, l'identità del servizio non viene controllata, poiché, con NTLM, il client non è in grado di autenticare il server.</span><span class="sxs-lookup"><span data-stu-id="516bd-111">When you use NT LanMan (NTLM) for authentication, the service identity is not checked because, under NTLM, the client is unable to authenticate the server.</span></span> <span data-ttu-id="516bd-112">L'autenticazione NTLM viene utilizzata quando i computer fanno parte di un gruppo di lavoro di Windows o quando eseguono una versione precedente di Windows che non supporta l'autenticazione Kerberos.</span><span class="sxs-lookup"><span data-stu-id="516bd-112">NTLM is used when computers are part of a Windows workgroup, or when running an older version of Windows that does not support Kerberos authentication.</span></span>  
  
 <span data-ttu-id="516bd-113">Quando il client avvia un canale sicuro per l'invio di un messaggio a un servizio, l'infrastruttura di Windows Communication Foundation (WCF) autentica il servizio e invia il messaggio solo se l'identità del servizio corrisponde all'identità specificata nell'indirizzo dell'endpoint utilizzato dal client.</span><span class="sxs-lookup"><span data-stu-id="516bd-113">When the client initiates a secure channel to send a message to a service over it, the Windows Communication Foundation (WCF) infrastructure authenticates the service, and only sends the message if the service identity matches the identity specified in the endpoint address the client uses.</span></span>  
  
 <span data-ttu-id="516bd-114">L'elaborazione dell'identità si articola nelle fasi seguenti:</span><span class="sxs-lookup"><span data-stu-id="516bd-114">Identity processing consists of the following stages:</span></span>  
  
- <span data-ttu-id="516bd-115">In fase di progettazione, lo sviluppatore del client determina l'identità del servizio dai metadati dell'endpoint (esposti tramite WSDL).</span><span class="sxs-lookup"><span data-stu-id="516bd-115">At design time, the client developer determines the service's identity from the endpoint's metadata (exposed through WSDL).</span></span>  
  
- <span data-ttu-id="516bd-116">In fase di esecuzione, l'applicazione client controlla le attestazioni delle credenziali di sicurezza del servizio, prima di inviare messaggi al servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-116">At runtime, the client application checks the claims of the service's security credentials before sending any messages to the service.</span></span>  
  
 <span data-ttu-id="516bd-117">L'elaborazione dell'identità nel client è analoga all'autenticazione del client nel servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-117">Identity processing on the client is analogous to client authentication on the service.</span></span> <span data-ttu-id="516bd-118">Un servizio protetto non esegue codice fino a quando non vengono autenticate le credenziali del client.</span><span class="sxs-lookup"><span data-stu-id="516bd-118">A secure service does not execute code until the client's credentials have been authenticated.</span></span> <span data-ttu-id="516bd-119">Allo stesso modo, il client non invia messaggi al servizio fino a quando le credenziali del servizio non sono state autenticate in base a ciò che è noto in anticipo dai metadati del servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-119">Likewise, the client does not send messages to the service until the service's credentials have been authenticated based on what is known in advance from the service's metadata.</span></span>  
  
 <span data-ttu-id="516bd-120">La proprietà <xref:System.ServiceModel.EndpointAddress.Identity%2A> della classe <xref:System.ServiceModel.EndpointAddress> rappresenta l'identità del servizio chiamato dal client.</span><span class="sxs-lookup"><span data-stu-id="516bd-120">The <xref:System.ServiceModel.EndpointAddress.Identity%2A> property of the <xref:System.ServiceModel.EndpointAddress> class represents the identity of the service called by the client.</span></span> <span data-ttu-id="516bd-121">Il servizio pubblica <xref:System.ServiceModel.EndpointAddress.Identity%2A> nei propri metadati.</span><span class="sxs-lookup"><span data-stu-id="516bd-121">The service publishes the <xref:System.ServiceModel.EndpointAddress.Identity%2A> in its metadata.</span></span> <span data-ttu-id="516bd-122">Quando lo sviluppatore client esegue lo [strumento ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) nell'endpoint del servizio, la configurazione generata contiene il valore della proprietà del servizio <xref:System.ServiceModel.EndpointAddress.Identity%2A> .</span><span class="sxs-lookup"><span data-stu-id="516bd-122">When the client developer runs the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) against the service endpoint, the generated configuration contains the value of the service's <xref:System.ServiceModel.EndpointAddress.Identity%2A> property.</span></span> <span data-ttu-id="516bd-123">L'infrastruttura WCF (se configurata con sicurezza) verifica che il servizio disponga dell'identità specificata.</span><span class="sxs-lookup"><span data-stu-id="516bd-123">The WCF infrastructure (if configured with security) verifies that the service possesses the identity specified.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="516bd-124">I metadati contengono l'identità prevista del servizio, pertanto è consigliabile esporre i metadati del servizio tramite mezzi di comunicazione protetti, ad esempio creando un endpoint HTTPS per il servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-124">The metadata contains the expected identity of the service, so it is recommended that you expose the service metadata through secure means, for example, by creating an HTTPS endpoint for the service.</span></span> <span data-ttu-id="516bd-125">Per altre informazioni, vedere [procedura: proteggere gli endpoint dei metadati](how-to-secure-metadata-endpoints.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-125">For more information, see [How to: Secure Metadata Endpoints](how-to-secure-metadata-endpoints.md).</span></span>  
  
## <a name="identity-types"></a><span data-ttu-id="516bd-126">Tipi di identità</span><span class="sxs-lookup"><span data-stu-id="516bd-126">Identity Types</span></span>  
 <span data-ttu-id="516bd-127">Un servizio può fornire sei tipi di identità.</span><span class="sxs-lookup"><span data-stu-id="516bd-127">A service can provide six types of identities.</span></span> <span data-ttu-id="516bd-128">Ogni tipo di identità corrisponde a un elemento che può essere contenuto nell'elemento `<identity>` della configurazione.</span><span class="sxs-lookup"><span data-stu-id="516bd-128">Each identity type corresponds to an element that can be contained inside the `<identity>` element in configuration.</span></span> <span data-ttu-id="516bd-129">Il tipo utilizzato dipende dallo scenario e dai requisiti di sicurezza del servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-129">The type used depends on the scenario and the service's security requirements.</span></span> <span data-ttu-id="516bd-130">Nella tabella seguente vengono descritti tutti i singoli tipi di identità.</span><span class="sxs-lookup"><span data-stu-id="516bd-130">The following table describes each identity type.</span></span>  
  
|<span data-ttu-id="516bd-131">Tipo di identità</span><span class="sxs-lookup"><span data-stu-id="516bd-131">Identity type</span></span>|<span data-ttu-id="516bd-132">Descrizione</span><span class="sxs-lookup"><span data-stu-id="516bd-132">Description</span></span>|<span data-ttu-id="516bd-133">Scenario tipico</span><span class="sxs-lookup"><span data-stu-id="516bd-133">Typical scenario</span></span>|  
|-------------------|-----------------|----------------------|  
|<span data-ttu-id="516bd-134">Domain Name System (DNS)</span><span class="sxs-lookup"><span data-stu-id="516bd-134">Domain Name System (DNS)</span></span>|<span data-ttu-id="516bd-135">Utilizzare questo elemento con certificati X.509 o account di Windows.</span><span class="sxs-lookup"><span data-stu-id="516bd-135">Use this element with X.509 certificates or Windows accounts.</span></span> <span data-ttu-id="516bd-136">Confronta il nome DNS specificato nella credenziale con il valore specificato in questo elemento.</span><span class="sxs-lookup"><span data-stu-id="516bd-136">It compares the DNS name specified in the credential with the value specified in this element.</span></span>|<span data-ttu-id="516bd-137">Un controllo DNS consente di utilizzare certificati con nomi di soggetto o DNS.</span><span class="sxs-lookup"><span data-stu-id="516bd-137">A DNS check enables you to use certificates with DNS or subject names.</span></span> <span data-ttu-id="516bd-138">Se un certificato viene riemesso con lo stesso nome di soggetto o DNS, il controllo di identità resta valido.</span><span class="sxs-lookup"><span data-stu-id="516bd-138">If a certificate is reissued with the same DNS or subject name, then the identity check is still valid.</span></span> <span data-ttu-id="516bd-139">Quando un certificato viene riemesso, ottiene una nuova chiave RSA ma mantiene lo stesso nome di soggetto o DNS.</span><span class="sxs-lookup"><span data-stu-id="516bd-139">When a certificate is reissued, it gets a new RSA key but retains the same DNS or subject name.</span></span> <span data-ttu-id="516bd-140">Questo significa che i client non devono aggiornare le proprie informazioni di identità sul servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-140">This means that clients do not have to update their identity information about the service.</span></span>|  
|<span data-ttu-id="516bd-141">Certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-141">Certificate.</span></span> <span data-ttu-id="516bd-142">Impostazione predefinita quando `ClientCredentialType` è impostato su Certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-142">The default when `ClientCredentialType` is set to Certificate.</span></span>|<span data-ttu-id="516bd-143">Questo elemento specifica un certificato X.509 con codifica Base64 da confrontare con il client.</span><span class="sxs-lookup"><span data-stu-id="516bd-143">This element specifies a Base64-encoded X.509 certificate value to compare with the client.</span></span><br /><br /> <span data-ttu-id="516bd-144">Usare inoltre questo elemento quando si usa CardSpace come credenziale per autenticare il servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-144">Also use this element when using a CardSpace as a credential to authenticate the service.</span></span>|<span data-ttu-id="516bd-145">Questo elemento restringe l'autenticazione a un solo certificato in base al valore dell'identificazione personale.</span><span class="sxs-lookup"><span data-stu-id="516bd-145">This element restricts authentication to a single certificate based upon its thumbprint value.</span></span> <span data-ttu-id="516bd-146">Ciò rende possibile un'autenticazione più restrittiva, poiché i valori dell'identificazione personale sono univoci.</span><span class="sxs-lookup"><span data-stu-id="516bd-146">This enables stricter authentication because thumbprint values are unique.</span></span> <span data-ttu-id="516bd-147">Occorre tuttavia notare che il certificato, se viene riemesso con lo stesso nome di soggetto, avrà anche una nuova identificazione personale.</span><span class="sxs-lookup"><span data-stu-id="516bd-147">This comes with one caveat: If the certificate is reissued with the same Subject name, it also has a new Thumbprint.</span></span> <span data-ttu-id="516bd-148">I client non saranno pertanto in grado di convalidare il servizio, a meno che non sia nota la nuova identificazione digitale.</span><span class="sxs-lookup"><span data-stu-id="516bd-148">Therefore, clients are not able to validate the service unless the new thumbprint is known.</span></span> <span data-ttu-id="516bd-149">Per altre informazioni su come trovare l'identificazione personale di un certificato, vedere [procedura: recuperare l'identificazione personale di un certificato](how-to-retrieve-the-thumbprint-of-a-certificate.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-149">For more information about finding a certificate's thumbprint, see [How to: Retrieve the Thumbprint of a Certificate](how-to-retrieve-the-thumbprint-of-a-certificate.md).</span></span>|  
|<span data-ttu-id="516bd-150">Riferimento del certificato</span><span class="sxs-lookup"><span data-stu-id="516bd-150">Certificate Reference</span></span>|<span data-ttu-id="516bd-151">Identico all'opzione Certificato prima descritta.</span><span class="sxs-lookup"><span data-stu-id="516bd-151">Identical to the Certificate option described previously.</span></span> <span data-ttu-id="516bd-152">Tuttavia, questo elemento consente di specificare un nome di certificato e il percorso dell'archivio da cui recuperare il certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-152">However, this element enables you to specify a certificate name and store location from which to retrieve the certificate.</span></span>|<span data-ttu-id="516bd-153">Uguale allo scenario Certificato prima descritto.</span><span class="sxs-lookup"><span data-stu-id="516bd-153">Same as the Certificate scenario described previously.</span></span><br /><br /> <span data-ttu-id="516bd-154">Il vantaggio è che il percorso dell'archivio certificati può essere modificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-154">The benefit is that the certificate store location can change.</span></span>|  
|<span data-ttu-id="516bd-155">RSA</span><span class="sxs-lookup"><span data-stu-id="516bd-155">RSA</span></span>|<span data-ttu-id="516bd-156">Questo elemento specifica un valore della chiave RSA da confrontare con il client.</span><span class="sxs-lookup"><span data-stu-id="516bd-156">This element specifies an RSA key value to compare with the client.</span></span> <span data-ttu-id="516bd-157">È simile all'opzione certificato, ma invece dell'identificazione personale del certificato viene utilizzata la chiave RSA del certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-157">This is similar to the certificate option but rather than using the certificate's thumbprint, the certificate's RSA key is used instead.</span></span>|<span data-ttu-id="516bd-158">Un controllo RSA consente di restringere specificamente l'autenticazione a un solo certificato in base alla relativa chiave RSA.</span><span class="sxs-lookup"><span data-stu-id="516bd-158">An RSA check enables you to specifically restrict authentication to a single certificate based upon its RSA key.</span></span> <span data-ttu-id="516bd-159">Ciò rende possibile l'autenticazione più restrittiva di una chiave RSA specifica a spese del servizio, che non funziona più con i client esistenti, se il valore della chiave RSA viene modificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-159">This enables stricter authentication of a specific RSA key at the expense of the service, which no longer works with existing clients if the RSA key value changes.</span></span>|  
|<span data-ttu-id="516bd-160">Nome dell'entità utente.</span><span class="sxs-lookup"><span data-stu-id="516bd-160">User principal name (UPN).</span></span> <span data-ttu-id="516bd-161">Impostazione predefinita quando `ClientCredentialType` è impostato su Windows e il processo del servizio non è in esecuzione con uno degli account di sistema.</span><span class="sxs-lookup"><span data-stu-id="516bd-161">The default when the `ClientCredentialType` is set to Windows and the service process is not running under one of the system accounts.</span></span>|<span data-ttu-id="516bd-162">Questo elemento specifica l'UPN con cui è in esecuzione il servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-162">This element specifies the UPN that the service is running under.</span></span> <span data-ttu-id="516bd-163">Vedere la sezione relativa a protocollo e identità Kerberos di [override dell'identità di un servizio per l'autenticazione](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-163">See the Kerberos Protocol and Identity section of [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>|<span data-ttu-id="516bd-164">Questo assicura che il servizio sia in esecuzione con un account utente di Windows specifico.</span><span class="sxs-lookup"><span data-stu-id="516bd-164">This ensures that the service is running under a specific Windows user account.</span></span> <span data-ttu-id="516bd-165">L'account utente può essere l'utente attualmente connesso o il servizio in esecuzione con un particolare account utente.</span><span class="sxs-lookup"><span data-stu-id="516bd-165">The user account can be either the current logged-on user or the service running under a particular user account.</span></span><br /><br /> <span data-ttu-id="516bd-166">Questa impostazione sfrutta la protezione Kerberos di Windows, se il servizio è in esecuzione con un account di dominio all'interno di un ambiente Active Directory.</span><span class="sxs-lookup"><span data-stu-id="516bd-166">This setting takes advantage of Windows Kerberos security if the service is running under a domain account within an Active Directory environment.</span></span>|  
|<span data-ttu-id="516bd-167">Nome dell'entità servizio (SPN).</span><span class="sxs-lookup"><span data-stu-id="516bd-167">Service principal name (SPN).</span></span> <span data-ttu-id="516bd-168">Impostazione predefinita quando `ClientCredentialType` è impostato su Windows e il processo del servizio è in esecuzione con uno degli account di sistema: LocalService, LocalSystem o NetworkService.</span><span class="sxs-lookup"><span data-stu-id="516bd-168">The default when the `ClientCredentialType` is set to Windows and the service process is running under one of the system accounts—LocalService, LocalSystem, or NetworkService.</span></span>|<span data-ttu-id="516bd-169">Questo elemento specifica il nome SPN associato all'account del servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-169">This element specifies the SPN associated with the service's account.</span></span> <span data-ttu-id="516bd-170">Vedere la sezione relativa a protocollo e identità Kerberos di [override dell'identità di un servizio per l'autenticazione](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-170">See the Kerberos Protocol and Identity section of [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>|<span data-ttu-id="516bd-171">Questo assicura che il nome SPN e l'account specifico di Windows a esso associato identifichino il servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-171">This ensures that the SPN and the specific Windows account associated with the SPN identify the service.</span></span><br /><br /> <span data-ttu-id="516bd-172">È possibile utilizzare lo strumento Setspn.exe per associare un account computer per l'account utente del servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-172">You can use the Setspn.exe tool to associate a machine account for the service's user account.</span></span><br /><br /> <span data-ttu-id="516bd-173">Questa impostazione sfrutta la protezione Kerberos di Windows, se il servizio è in esecuzione con uno degli account di sistema o con un account di dominio associato a un nome SPN e il computer è un membro di un dominio interno a un ambiente Active Directory.</span><span class="sxs-lookup"><span data-stu-id="516bd-173">This setting takes advantage of Windows Kerberos security if the service is running under one of the system accounts or under a domain account that has an associated SPN name with it and the computer is a member of a domain within an Active Directory environment.</span></span>|  
  
## <a name="specifying-identity-at-the-service"></a><span data-ttu-id="516bd-174">Impostazione dell'identità nel servizio</span><span class="sxs-lookup"><span data-stu-id="516bd-174">Specifying Identity at the Service</span></span>  
 <span data-ttu-id="516bd-175">In genere non è necessario impostare l'identità in un servizio, perché la selezione del tipo di credenziale di un client impone il tipo di identità esposto nei metadati del servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-175">Typically, you do not have to set the identity on a service because the selection of a client credential type dictates the type of identity exposed in the service metadata.</span></span> <span data-ttu-id="516bd-176">Per ulteriori informazioni su come eseguire l'override o specificare l'identità del servizio, vedere override [dell'identità di un servizio per l'autenticazione](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-176">For more information about how to override or specify service identity, see [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>  
  
## <a name="using-the-identity-element-in-configuration"></a><span data-ttu-id="516bd-177">Utilizzo dell' \<identity> elemento nella configurazione</span><span class="sxs-lookup"><span data-stu-id="516bd-177">Using the \<identity> Element in Configuration</span></span>  
 <span data-ttu-id="516bd-178">Se si imposta su `Certificate,` il tipo di credenziale client nell'associazione prima descritta, il codice WSDL generato conterrà un certificato X.509 con serializzazione Base64 per il valore dell'identità, come illustrato nel codice seguente.</span><span class="sxs-lookup"><span data-stu-id="516bd-178">If you change the client credential type in the binding previously shown to `Certificate,` then the generated WSDL contains a Base64 serialized X.509 certificate for the identity value as shown in the following code.</span></span> <span data-ttu-id="516bd-179">Si tratta dell'impostazione predefinita per tutti i tipi di credenziale client diversi da Windows.</span><span class="sxs-lookup"><span data-stu-id="516bd-179">This is the default for all client credential types other than Windows.</span></span>  

 <span data-ttu-id="516bd-180">È possibile modificare il valore dell'identità del servizio predefinita o modificare il tipo dell'identità usando l' `<identity>` elemento nella configurazione o impostando l'identità nel codice.</span><span class="sxs-lookup"><span data-stu-id="516bd-180">You can change the value of the default service identity or change the type of the identity by using the `<identity>` element in configuration or by setting the identity in code.</span></span> <span data-ttu-id="516bd-181">Nel codice di configurazione seguente viene impostata un'identità DNS (Domain Name System) con il valore `contoso.com`.</span><span class="sxs-lookup"><span data-stu-id="516bd-181">The following configuration code sets a domain name system (DNS) identity with the value `contoso.com`.</span></span>  

## <a name="setting-identity-programmatically"></a><span data-ttu-id="516bd-182">Impostazione dell'identità a livello di programmazione</span><span class="sxs-lookup"><span data-stu-id="516bd-182">Setting Identity Programmatically</span></span>  
 <span data-ttu-id="516bd-183">Il servizio non deve specificare in modo esplicito un'identità, perché WCF la determina automaticamente.</span><span class="sxs-lookup"><span data-stu-id="516bd-183">Your service does not have to explicitly specify an identity, because WCF automatically determines it.</span></span> <span data-ttu-id="516bd-184">Tuttavia, WCF consente di specificare un'identità in un endpoint, se necessario.</span><span class="sxs-lookup"><span data-stu-id="516bd-184">However, WCF allows you to specify an identity on an endpoint, if required.</span></span> <span data-ttu-id="516bd-185">Nel codice seguente viene aggiunto un nuovo endpoint di servizio con un'identità DNS specifica.</span><span class="sxs-lookup"><span data-stu-id="516bd-185">The following code adds a new service endpoint with a specific DNS identity.</span></span>  
  
 [!code-csharp[C_Identity#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#5)]
 [!code-vb[C_Identity#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#5)]  
  
## <a name="specifying-identity-at-the-client"></a><span data-ttu-id="516bd-186">Impostazione dell'identità nel client</span><span class="sxs-lookup"><span data-stu-id="516bd-186">Specifying Identity at the Client</span></span>  
 <span data-ttu-id="516bd-187">In fase di progettazione uno sviluppatore client utilizza in genere lo [strumento ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) per generare la configurazione client.</span><span class="sxs-lookup"><span data-stu-id="516bd-187">At design time, a client developer typically uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) to generate client configuration.</span></span> <span data-ttu-id="516bd-188">Il file di configurazione generato (destinato a essere utilizzato dal client) contiene l'identità del server.</span><span class="sxs-lookup"><span data-stu-id="516bd-188">The generated configuration file (intended for use by the client) contains the server's identity.</span></span> <span data-ttu-id="516bd-189">Ad esempio, il codice seguente viene generato da un servizio che specifica un'identità DNS, come illustrato nell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="516bd-189">For example, the following code is generated from a service that specifies a DNS identity, as shown in the preceding example.</span></span> <span data-ttu-id="516bd-190">Si noti che il valore dell'identità endpoint del client corrisponde a quello del servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-190">Note that the client's endpoint identity value matches that of the service.</span></span> <span data-ttu-id="516bd-191">In questo caso, quando il client riceve le credenziali Windows (Kerberos) per il servizio, si aspetta che il valore sia `contoso.com`.</span><span class="sxs-lookup"><span data-stu-id="516bd-191">In this case, when the client receives the Windows (Kerberos) credentials for the service, it expects the value to be `contoso.com`.</span></span>  

 <span data-ttu-id="516bd-192">Se, invece di Windows, il servizio specifica un certificato come tipo di credenziale client, si prevede che la proprietà DNS del certificato corrisponda al valore `contoso.com`</span><span class="sxs-lookup"><span data-stu-id="516bd-192">If, instead of Windows, the service specifies a certificate as the client credential type, then the certificate's DNS property is expected to be the value `contoso.com`.</span></span> <span data-ttu-id="516bd-193">(oppure, se la proprietà DNS è `null`, il nome di soggetto del certificato deve essere `contoso.com`).</span><span class="sxs-lookup"><span data-stu-id="516bd-193">(Or if the DNS property is `null`, the certificate's subject name must be `contoso.com`.)</span></span>  
  
#### <a name="using-a-specific-value-for-identity"></a><span data-ttu-id="516bd-194">Utilizzo di un valore specifico per l'identità</span><span class="sxs-lookup"><span data-stu-id="516bd-194">Using a Specific Value for Identity</span></span>  
 <span data-ttu-id="516bd-195">Nel file di configurazione client seguente viene illustrato come si prevede che l'identità del servizio sia un valore specifico.</span><span class="sxs-lookup"><span data-stu-id="516bd-195">The following client configuration file shows how the service's identity is expected to be a specific value.</span></span> <span data-ttu-id="516bd-196">Nell'esempio seguente, il client può comunicare con due endpoint.</span><span class="sxs-lookup"><span data-stu-id="516bd-196">In the following example, the client can communicate with two endpoints.</span></span> <span data-ttu-id="516bd-197">Il primo viene identificato con un'identificazione personale del certificato e il secondo con una chiave RSA del certificato,</span><span class="sxs-lookup"><span data-stu-id="516bd-197">The first is identified with a certificate thumbprint and the second with a certificate RSA key.</span></span> <span data-ttu-id="516bd-198">ovvero un certificato che contiene solo una coppia chiave pubblica/chiave privata ma non viene emesso da un'autorità attendibile.</span><span class="sxs-lookup"><span data-stu-id="516bd-198">That is, a certificate that contains only a public key/private key pair, but is not issued by a trusted authority.</span></span>  

## <a name="identity-checking-at-run-time"></a><span data-ttu-id="516bd-199">Controllo dell'identità in fase di esecuzione</span><span class="sxs-lookup"><span data-stu-id="516bd-199">Identity Checking at Run Time</span></span>  
 <span data-ttu-id="516bd-200">In fase di progettazione, un sviluppatore di client determina l'identità del server tramite i relativi metadati.</span><span class="sxs-lookup"><span data-stu-id="516bd-200">At design time, a client developer determines the server's identity through its metadata.</span></span> <span data-ttu-id="516bd-201">In fase di esecuzione, il controllo dell'identità viene eseguito prima di chiamare qualsiasi endpoint nel servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-201">At runtime, the identity check is performed before calling any endpoints on the service.</span></span>  
  
 <span data-ttu-id="516bd-202">Il valore dell'identità è associato al tipo di autenticazione specificato dai metadati; in altre parole, al tipo di credenziali utilizzato per il servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-202">The identity value is tied to the type of authentication specified by metadata; in other words, the type of credentials used for the service.</span></span>  
  
 <span data-ttu-id="516bd-203">Se il canale è configurato per l'autenticazione tramite SSL (Secure Sockets Layer) a livello di messaggio o di trasporto con certificati X.509, sono validi i valori di identità seguenti:</span><span class="sxs-lookup"><span data-stu-id="516bd-203">If the channel is configured to authenticate using message- or transport-level Secure Sockets Layer (SSL) with X.509 certificates for authentication, the following identity values are valid:</span></span>  
  
- <span data-ttu-id="516bd-204">DNS.</span><span class="sxs-lookup"><span data-stu-id="516bd-204">DNS.</span></span> <span data-ttu-id="516bd-205">WCF garantisce che il certificato fornito durante l'handshake SSL contenga un attributo DNS o `CommonName` (CN) uguale al valore specificato nell'identità DNS sul client.</span><span class="sxs-lookup"><span data-stu-id="516bd-205">WCF ensures that the certificate provided during the SSL handshake contains a DNS or `CommonName` (CN) attribute equal to the value specified in the DNS identity on the client.</span></span> <span data-ttu-id="516bd-206">Si noti che questi controlli vengono eseguiti in aggiunta alla determinazione della validità del certificato server.</span><span class="sxs-lookup"><span data-stu-id="516bd-206">Note that these checks are done in addition to determining the validity of the server certificate.</span></span> <span data-ttu-id="516bd-207">Per impostazione predefinita, WCF convalida che il certificato del server viene emesso da un'autorità radice attendibile.</span><span class="sxs-lookup"><span data-stu-id="516bd-207">By default, WCF validates that the server certificate is issued by a trusted root authority.</span></span>  
  
- <span data-ttu-id="516bd-208">Certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-208">Certificate.</span></span> <span data-ttu-id="516bd-209">Durante l'handshake SSL, WCF garantisce che l'endpoint remoto fornisca il valore del certificato esatto specificato nell'identità.</span><span class="sxs-lookup"><span data-stu-id="516bd-209">During the SSL handshake, WCF ensures that the remote endpoint provides the exact certificate value specified in the identity.</span></span>  
  
- <span data-ttu-id="516bd-210">Riferimento del certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-210">Certificate Reference.</span></span> <span data-ttu-id="516bd-211">Uguale a Certificato.</span><span class="sxs-lookup"><span data-stu-id="516bd-211">Same as Certificate.</span></span>  
  
- <span data-ttu-id="516bd-212">RSA.</span><span class="sxs-lookup"><span data-stu-id="516bd-212">RSA.</span></span> <span data-ttu-id="516bd-213">Durante l'handshake SSL, WCF garantisce che l'endpoint remoto fornisca la chiave RSA esatta specificata nell'identità.</span><span class="sxs-lookup"><span data-stu-id="516bd-213">During the SSL handshake, WCF ensures that the remote endpoint provides the exact RSA key specified in the identity.</span></span>  
  
 <span data-ttu-id="516bd-214">Se il servizio esegue l'autenticazione utilizzando SSL a livello di messaggio o di trasporto con una credenziale Windows e negozia la credenziale, sono validi i valori di identità seguenti:</span><span class="sxs-lookup"><span data-stu-id="516bd-214">If the service authenticates using message- or transport-level SSL with a Windows credential for authentication, and negotiates the credential, the following identity values are valid:</span></span>  
  
- <span data-ttu-id="516bd-215">DNS.</span><span class="sxs-lookup"><span data-stu-id="516bd-215">DNS.</span></span> <span data-ttu-id="516bd-216">La negoziazione passa il nome SPN del servizio, in modo che il nome DNS possa essere controllato.</span><span class="sxs-lookup"><span data-stu-id="516bd-216">The negotiation passes the service's SPN so that the DNS name can be checked.</span></span> <span data-ttu-id="516bd-217">Il nome SPN presenta il formato `host/<dns name>`.</span><span class="sxs-lookup"><span data-stu-id="516bd-217">The SPN is in the form `host/<dns name>`.</span></span>  
  
- <span data-ttu-id="516bd-218">SPN.</span><span class="sxs-lookup"><span data-stu-id="516bd-218">SPN.</span></span> <span data-ttu-id="516bd-219">Viene restituito un SPN del servizio esplicito, ad esempio, `host/myservice`.</span><span class="sxs-lookup"><span data-stu-id="516bd-219">An explicit service SPN is returned, for example, `host/myservice`.</span></span>  
  
- <span data-ttu-id="516bd-220">UPN.</span><span class="sxs-lookup"><span data-stu-id="516bd-220">UPN.</span></span> <span data-ttu-id="516bd-221">UPN dell'account di servizio.</span><span class="sxs-lookup"><span data-stu-id="516bd-221">The UPN of the service account.</span></span> <span data-ttu-id="516bd-222">Il formato dell'UPN è `username` @ `domain` .</span><span class="sxs-lookup"><span data-stu-id="516bd-222">The UPN is in the form `username`@`domain`.</span></span> <span data-ttu-id="516bd-223">Ad esempio, quando il servizio è in esecuzione con un account utente, l'UPN può essere `username@contoso.com`.</span><span class="sxs-lookup"><span data-stu-id="516bd-223">For example, when the service is running in a user account, it may be `username@contoso.com`.</span></span>  
  
 <span data-ttu-id="516bd-224">L'impostazione dell'identità a livello di programmazione (utilizzando la proprietà <xref:System.ServiceModel.EndpointAddress.Identity%2A>) è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="516bd-224">Specifying the identity programmatically (using the <xref:System.ServiceModel.EndpointAddress.Identity%2A> property) is optional.</span></span> <span data-ttu-id="516bd-225">Se non viene specificata alcuna identità, e il tipo di credenziale client è Windows, l'impostazione predefinita è SPN con il valore impostato sulla parte del nome host dell'indirizzo dell'endpoint del servizio preceduta dal valore letterale "host/".</span><span class="sxs-lookup"><span data-stu-id="516bd-225">If no identity is specified, and the client credential type is Windows, the default is SPN with the value set to the hostname part of the service endpoint address prefixed with the "host/" literal.</span></span> <span data-ttu-id="516bd-226">Se non viene specificata alcuna identità, e il tipo di credenziale client è un certificato, l'impostazione predefinita è `Certificate`.</span><span class="sxs-lookup"><span data-stu-id="516bd-226">If no identity is specified, and the client credential type is a certificate, the default is `Certificate`.</span></span> <span data-ttu-id="516bd-227">Questo vale per la protezione a livello di messaggio e di trasporto.</span><span class="sxs-lookup"><span data-stu-id="516bd-227">This applies to both message- and transport-level security.</span></span>  
  
## <a name="identity-and-custom-bindings"></a><span data-ttu-id="516bd-228">Identità e associazioni personalizzate</span><span class="sxs-lookup"><span data-stu-id="516bd-228">Identity and Custom Bindings</span></span>  
 <span data-ttu-id="516bd-229">Poiché l'identità di un servizio dipende dal tipo di associazione utilizzato, assicurarsi che sia esposta un'identità appropriata quando si crea un'associazione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="516bd-229">Because the identity of a service depends on the binding type used, ensure that an appropriate identity is exposed when creating a custom binding.</span></span> <span data-ttu-id="516bd-230">Ad esempio, nell'esempio di codice seguente, l'identità esposta non è compatibile con il tipo di sicurezza, poiché l'identità per l'associazione bootstrap di conversazione protetta non corrisponde all'identità per l'associazione sull'endpoint.</span><span class="sxs-lookup"><span data-stu-id="516bd-230">For example, in the following code example, the identity exposed is not compatible with the security type, because the identity for the secure conversation bootstrap binding does not match the identity for the binding on the endpoint.</span></span> <span data-ttu-id="516bd-231">L'associazione di conversazione protetta imposta l'identità DNS, mentre <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement> imposta l'identità UPN o SPN.</span><span class="sxs-lookup"><span data-stu-id="516bd-231">The secure conversation binding sets the DNS identity, while the <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement> sets the UPN or SPN identity.</span></span>  
  
 [!code-csharp[C_Identity#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#8)]
 [!code-vb[C_Identity#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#8)]  
  
 <span data-ttu-id="516bd-232">Per ulteriori informazioni su come impilare correttamente gli elementi di associazione per un'associazione personalizzata, vedere [creazione di associazioni definite dall'utente](../extending/creating-user-defined-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-232">For more information about how to stack binding elements correctly for a custom binding, see [Creating User-Defined Bindings](../extending/creating-user-defined-bindings.md).</span></span> <span data-ttu-id="516bd-233">Per ulteriori informazioni sulla creazione di un'associazione personalizzata con <xref:System.ServiceModel.Channels.SecurityBindingElement> , vedere [procedura: creare un oggetto SecurityBindingElement per una modalità di autenticazione specificata](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md).</span><span class="sxs-lookup"><span data-stu-id="516bd-233">For more information about creating a custom binding with the <xref:System.ServiceModel.Channels.SecurityBindingElement>, see [How to: Create a SecurityBindingElement for a Specified Authentication Mode](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="516bd-234">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="516bd-234">See also</span></span>

- [<span data-ttu-id="516bd-235">Procedura: creare un'associazione personalizzata usando SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="516bd-235">How to: Create a Custom Binding Using the SecurityBindingElement</span></span>](how-to-create-a-custom-binding-using-the-securitybindingelement.md)
- [<span data-ttu-id="516bd-236">Procedura: creare un elemento SecurityBindingElement per una modalità di autenticazione specificata</span><span class="sxs-lookup"><span data-stu-id="516bd-236">How to: Create a SecurityBindingElement for a Specified Authentication Mode</span></span>](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md)
- [<span data-ttu-id="516bd-237">Procedura: creare un verificatore di identità client personalizzato</span><span class="sxs-lookup"><span data-stu-id="516bd-237">How to: Create a Custom Client Identity Verifier</span></span>](../extending/how-to-create-a-custom-client-identity-verifier.md)
- [<span data-ttu-id="516bd-238">Selezione di un tipo di credenziale</span><span class="sxs-lookup"><span data-stu-id="516bd-238">Selecting a Credential Type</span></span>](selecting-a-credential-type.md)
- [<span data-ttu-id="516bd-239">Working with Certificates</span><span class="sxs-lookup"><span data-stu-id="516bd-239">Working with Certificates</span></span>](working-with-certificates.md)
- [<span data-ttu-id="516bd-240">Strumento ServiceModel Metadata Utility Tool (Svcutil.exe)</span><span class="sxs-lookup"><span data-stu-id="516bd-240">ServiceModel Metadata Utility Tool (Svcutil.exe)</span></span>](../servicemodel-metadata-utility-tool-svcutil-exe.md)
- [<span data-ttu-id="516bd-241">Creazione di associazioni definite dall'utente</span><span class="sxs-lookup"><span data-stu-id="516bd-241">Creating User-Defined Bindings</span></span>](../extending/creating-user-defined-bindings.md)
- [<span data-ttu-id="516bd-242">Procedura: recuperare l'identificazione personale di un certificato</span><span class="sxs-lookup"><span data-stu-id="516bd-242">How to: Retrieve the Thumbprint of a Certificate</span></span>](how-to-retrieve-the-thumbprint-of-a-certificate.md)
