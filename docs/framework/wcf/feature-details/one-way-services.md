---
title: Servizi unidirezionali
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Communication Foundation [WCF], one-way service contracts
- WCF [WCF], one-way service contracts
- service contracts [WCF], defining one-way
ms.assetid: 19053a36-4492-45a3-bfe6-0365ee0205a3
ms.openlocfilehash: 0d69af40e4b9a0133e44b64b45466f9aac84ffe2
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/09/2020
ms.locfileid: "84598749"
---
# <a name="one-way-services"></a><span data-ttu-id="6c728-102">Servizi unidirezionali</span><span class="sxs-lookup"><span data-stu-id="6c728-102">One-Way Services</span></span>
<span data-ttu-id="6c728-103">Il comportamento predefinito di un'operazione del servizio segue il modello request-reply,</span><span class="sxs-lookup"><span data-stu-id="6c728-103">The default behavior of a service operation is the request-reply pattern.</span></span> <span data-ttu-id="6c728-104">in base al quale il client resta in attesa del messaggio di risposta, anche se l'operazione del servizio è rappresentata nel codice come metodo `void`.</span><span class="sxs-lookup"><span data-stu-id="6c728-104">In a request-reply pattern, the client waits for the reply message, even if the service operation is represented in code as a `void` method.</span></span> <span data-ttu-id="6c728-105">Con un'operazione unidirezionale, viene invece trasmesso solo un messaggio.</span><span class="sxs-lookup"><span data-stu-id="6c728-105">With a one-way operation, only one message is transmitted.</span></span> <span data-ttu-id="6c728-106">Il destinatario non invia un messaggio di risposta, né il mittente ne aspetta uno.</span><span class="sxs-lookup"><span data-stu-id="6c728-106">The receiver does not send a reply message, nor does the sender expect one.</span></span>  
  
 <span data-ttu-id="6c728-107">Utilizzare il modello di progettazione unidirezionale nelle situazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6c728-107">Use the one-way design pattern:</span></span>  
  
- <span data-ttu-id="6c728-108">Quando il client deve chiamare operazioni e il risultato dell'operazione non influisce su di esso a livello di operazione.</span><span class="sxs-lookup"><span data-stu-id="6c728-108">When the client must call operations and is not affected by the result of the operation at the operation level.</span></span>  
  
- <span data-ttu-id="6c728-109">Quando si utilizza la classe <xref:System.ServiceModel.NetMsmqBinding> o la classe <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span><span class="sxs-lookup"><span data-stu-id="6c728-109">When using the <xref:System.ServiceModel.NetMsmqBinding> or the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> class.</span></span> <span data-ttu-id="6c728-110">Per ulteriori informazioni su questo scenario, vedere [code in WCF](queues-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="6c728-110">(For more information about this scenario, see [Queues in WCF](queues-in-wcf.md).)</span></span>  
  
 <span data-ttu-id="6c728-111">Quando un'operazione è unidirezionale, non ci sarà alcun messaggio di risposta per trasportare le informazioni di errore al client.</span><span class="sxs-lookup"><span data-stu-id="6c728-111">When an operation is one-way, there is no response message to carry error information back to the client.</span></span> <span data-ttu-id="6c728-112">È possibile rilevare le condizioni di errore utilizzando le funzionalità dell'associazione sottostante, ad esempio le sessioni affidabili, o progettando un contratto di servizio duplex che utilizza due operazioni unidirezionali, ovvero un contratto unidirezionale dal client al servizio per chiamare l'operazione del servizio e un altro contratto unidirezionale tra il servizio e il client in modo che il servizio possa inviare gli errori al client utilizzando un callback implementato dal client.</span><span class="sxs-lookup"><span data-stu-id="6c728-112">You can detect error conditions by using features of the underlying binding, such as reliable sessions, or by designing a duplex service contract that uses two one-way operations—a one-way contract from the client to the service to call service operation and another one-way contract between the service and the client so that the service can send back faults to the client using a callback that the client implements.</span></span>  
  
 <span data-ttu-id="6c728-113">Per creare un contratto di servizio unidirezionale, definire il contratto del servizio, applicare la classe <xref:System.ServiceModel.OperationContractAttribute> a ogni operazione e impostare la proprietà <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> su `true`, come illustrato nel codice di esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="6c728-113">To create a one-way service contract, define your service contract, apply the <xref:System.ServiceModel.OperationContractAttribute> class to each operation, and set the <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> property to `true`, as shown in the following sample code.</span></span>  
  
```csharp
[ServiceContract(Namespace="http://Microsoft.ServiceModel.Samples")]  
public interface IOneWayCalculator  
{  
    [OperationContract(IsOneWay=true)]  
    void Add(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Subtract(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Multiply(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Divide(double n1, double n2);  
}  
```  
  
 <span data-ttu-id="6c728-114">Per un esempio completo, vedere l'esempio [unidirezionale](../samples/one-way.md) .</span><span class="sxs-lookup"><span data-stu-id="6c728-114">For a complete example, see the [One-Way](../samples/one-way.md) sample.</span></span>  
  
## <a name="clients-blocking-with-one-way-operations"></a><span data-ttu-id="6c728-115">Blocco dei client con operazioni unidirezionali</span><span class="sxs-lookup"><span data-stu-id="6c728-115">Clients Blocking with One-Way Operations</span></span>  
 <span data-ttu-id="6c728-116">È importante tenere presente che, mentre alcune applicazioni unidirezionali vengono restituite non appena i dati in uscita vengono scritti nella connessione di rete, in diversi scenari l'implementazione di un'associazione o di un servizio può causare il blocco di un client WCF mediante operazioni unidirezionali.</span><span class="sxs-lookup"><span data-stu-id="6c728-116">It is important to realize that while some one-way applications return as soon as the outbound data is written to the network connection, in several scenarios the implementation of a binding or of a service can cause a WCF client to block using one-way operations.</span></span> <span data-ttu-id="6c728-117">Nelle applicazioni client WCF, l'oggetto client WCF non restituisce alcun risultato fino a quando i dati in uscita non vengono scritti nella connessione di rete.</span><span class="sxs-lookup"><span data-stu-id="6c728-117">In WCF client applications, the WCF client object does not return until the outbound data has been written to the network connection.</span></span> <span data-ttu-id="6c728-118">Questo vale per tutti i modelli di scambio dei messaggi, comprese le operazioni bidirezionali; ciò significa che qualsiasi problema durante la scrittura dei dati sul trasporto impedisce al client di eseguire la restituzione.</span><span class="sxs-lookup"><span data-stu-id="6c728-118">This is true for all message exchange patterns, including one-way operations; this means that any problem writing the data to the transport prevents the client from returning.</span></span> <span data-ttu-id="6c728-119">A seconda del problema, il risultato potrebbe essere un'eccezione o un ritardo nell'invio di messaggi al servizio.</span><span class="sxs-lookup"><span data-stu-id="6c728-119">Depending upon the problem, the result could be an exception or a delay in sending messages to the service.</span></span>  
  
 <span data-ttu-id="6c728-120">Ad esempio, se il trasporto non è in grado di individuare l'endpoint, viene generata un'eccezione <xref:System.ServiceModel.EndpointNotFoundException?displayProperty=nameWithType> senza molto ritardo.</span><span class="sxs-lookup"><span data-stu-id="6c728-120">For example, if the transport cannot find the endpoint, a <xref:System.ServiceModel.EndpointNotFoundException?displayProperty=nameWithType> exception is thrown without much delay.</span></span> <span data-ttu-id="6c728-121">È tuttavia possibile che per qualche motivo il servizio non sia in grado di leggere i dati fuori transito, impedendo così all'operazione di invio del trasporto client di eseguire la restituzione.</span><span class="sxs-lookup"><span data-stu-id="6c728-121">However, it is also possible that the service is unable to read the data off the wire for some reason, which prevents the client transport send operation from returning.</span></span> <span data-ttu-id="6c728-122">In questi casi, se viene superato il periodo di <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A?displayProperty=nameWithType> sull'associazione del trasporto client, viene generata una <xref:System.TimeoutException?displayProperty=nameWithType>, ma non prima che il periodo di timeout sia scaduto.</span><span class="sxs-lookup"><span data-stu-id="6c728-122">In these cases, if the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A?displayProperty=nameWithType> period on the client transport binding is exceeded, a <xref:System.TimeoutException?displayProperty=nameWithType> is thrown—but not until the timeout period has been exceeded.</span></span> <span data-ttu-id="6c728-123">È inoltre possibile che siano generati così tanti messaggi su un servizio che il servizio non è in grado di elaborarli oltre un certo punto.</span><span class="sxs-lookup"><span data-stu-id="6c728-123">It is also possible to fire so many messages at a service that the service cannot process them past a certain point.</span></span> <span data-ttu-id="6c728-124">Anche in questo caso il client unidirezionale si blocca fino a quando il servizio non può elaborare i messaggi o fino a quando non viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="6c728-124">In this case, too, the one-way client blocks until the service can process the messages or until an exception is thrown.</span></span>  
  
 <span data-ttu-id="6c728-125">Un'altra variazione è rappresentata dalla situazione in cui la proprietà  <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> del servizio è impostata su <xref:System.ServiceModel.ConcurrencyMode.Single> e l'associazione utilizza sessioni.</span><span class="sxs-lookup"><span data-stu-id="6c728-125">Another variation is the situation in which the service <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ConcurrencyMode.Single> and the binding uses sessions.</span></span> <span data-ttu-id="6c728-126">In questo caso, il dispatcher applica l'ordinamento sui messaggi in arrivo (un requisito delle sessioni), il che impedisce ai messaggi successivi di essere letti fuori rete fino a quando il servizio non ha elaborato il messaggio precedente per tale sessione.</span><span class="sxs-lookup"><span data-stu-id="6c728-126">In this case, the dispatcher enforces ordering on the incoming messages (a requirement of sessions), which prevents subsequent messages from being read off the network until the service has processed the preceding message for that session.</span></span> <span data-ttu-id="6c728-127">Il client quindi si blocca, ma la generazione di un'eccezione dipende da se il servizio è in grado di elaborare i dati in attesa prima delle impostazioni di timeout sul client.</span><span class="sxs-lookup"><span data-stu-id="6c728-127">Again, the client blocks, but whether an exception occurs depends upon whether the service is able to process the waiting data prior to the timeout settings on the client.</span></span>  
  
 <span data-ttu-id="6c728-128">È possibile attenuare parte di questo problema inserendo un buffer tra l'oggetto client e l'operazione di invio del trasporto client.</span><span class="sxs-lookup"><span data-stu-id="6c728-128">You can mitigate some of this problem by inserting a buffer between the client object and the client transport's send operation.</span></span> <span data-ttu-id="6c728-129">Ad esempio, l'utilizzo di chiamate asincrone o di una coda di messaggi in memoria può consentire all'oggetto client di eseguire rapidamente la restituzione.</span><span class="sxs-lookup"><span data-stu-id="6c728-129">For example, using asynchronous calls or using an in-memory message queue can enable the client object to return quickly.</span></span> <span data-ttu-id="6c728-130">Entrambi gli approcci possono aumentare la funzionalità, ma la dimensione del pool di thread e della coda di messaggi impongono dei limiti.</span><span class="sxs-lookup"><span data-stu-id="6c728-130">Both approaches may increase functionality, but the size of the thread pool and the message queue still enforce limits.</span></span>  
  
 <span data-ttu-id="6c728-131">È invece consigliabile esaminare i vari controlli sul servizio e sul client e quindi testare gli scenari dell'applicazione per determinare la configurazione migliore su ogni lato.</span><span class="sxs-lookup"><span data-stu-id="6c728-131">It is recommended, instead, that you examine the various controls on the service as well as on the client, and then test your application scenarios to determine the best configuration on either side.</span></span> <span data-ttu-id="6c728-132">Ad esempio, se l'utilizzo di sessioni blocca l'elaborazione di messaggi nel servizio, è possibile impostare la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> su <xref:System.ServiceModel.InstanceContextMode.PerCall>, in modo che ogni messaggio possa essere elaborato da un'istanza diversa del servizio, e impostare la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> su <xref:System.ServiceModel.ConcurrencyMode.Multiple> per consentire a più di un thread alla volta di inviare messaggi.</span><span class="sxs-lookup"><span data-stu-id="6c728-132">For example, if the use of sessions is blocking the processing of messages on your service, you can set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.PerCall> so that each message can be processed by a different service instance, and set the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> to <xref:System.ServiceModel.ConcurrencyMode.Multiple> in order to allow more than one thread to dispatch messages at a time.</span></span> <span data-ttu-id="6c728-133">Un altro approccio consiste nell'aumentare le quote di lettura delle associazioni del servizio e del client.</span><span class="sxs-lookup"><span data-stu-id="6c728-133">Another approach is to increase the read quotas of the service and client bindings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6c728-134">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6c728-134">See also</span></span>

- [<span data-ttu-id="6c728-135">Unidirezionale</span><span class="sxs-lookup"><span data-stu-id="6c728-135">One-Way</span></span>](../samples/one-way.md)
