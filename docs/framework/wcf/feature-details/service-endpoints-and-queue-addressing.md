---
title: Mapping fra gli endpoint di servizio e l'indirizzamento delle code
ms.date: 03/30/2017
ms.assetid: 7d2d59d7-f08b-44ed-bd31-913908b83d97
ms.openlocfilehash: 8b323993a698dac219e0f2be43e9b508a19065dd
ms.sourcegitcommit: 71b8f5a2108a0f1a4ef1d8d75c5b3e129ec5ca1e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/29/2020
ms.locfileid: "84202416"
---
# <a name="service-endpoints-and-queue-addressing"></a><span data-ttu-id="f8c5a-102">Mapping fra gli endpoint di servizio e l'indirizzamento delle code</span><span class="sxs-lookup"><span data-stu-id="f8c5a-102">Service Endpoints and Queue Addressing</span></span>
<span data-ttu-id="f8c5a-103">Questo argomento descrive come i client indirizzano i servizi che leggono da code e il mapping fra gli endpoint di servizio e le code.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-103">This topic discusses how clients address services that read from queues and how service endpoints map to queues.</span></span> <span data-ttu-id="f8c5a-104">Come promemoria, nella figura seguente viene illustrata la distribuzione dell'applicazione in coda Windows Communication Foundation (WCF) classica.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-104">As a reminder, the following illustration shows the classic Windows Communication Foundation (WCF) queued application deployment.</span></span>  
  
 <span data-ttu-id="f8c5a-105">![Diagramma di applicazioni in coda](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span><span class="sxs-lookup"><span data-stu-id="f8c5a-105">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="f8c5a-106">Per inviare il messaggio al servizio, il client indirizza il messaggio alla coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-106">For the client to send the message to the service, the client addresses the message to the Target Queue.</span></span> <span data-ttu-id="f8c5a-107">Per leggere i messaggi da questa coda, il servizio imposta il proprio indirizzo di attesa sulla coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-107">For the service to read messages from the queue, it sets its listen address to the Target Queue.</span></span> <span data-ttu-id="f8c5a-108">L'indirizzamento in WCF è Uniform Resource Identifier basato su (URI), mentre i nomi delle code di Accodamento messaggi (MSMQ) non sono basati su URI.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-108">Addressing in WCF is Uniform Resource Identifier (URI)-based while Message Queuing (MSMQ) queue names are not URI-based.</span></span> <span data-ttu-id="f8c5a-109">È pertanto essenziale comprendere come indirizzare le code create in MSMQ tramite WCF.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-109">It is therefore essential to understand how to address queues created in MSMQ using WCF.</span></span>  
  
## <a name="msmq-addressing"></a><span data-ttu-id="f8c5a-110">Indirizzamento di MSMQ</span><span class="sxs-lookup"><span data-stu-id="f8c5a-110">MSMQ Addressing</span></span>  
 <span data-ttu-id="f8c5a-111">Nel sistema MSMQ le code vengono identificate tramite nomi di percorso e di formato.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-111">MSMQ uses paths and format names to identify a queue.</span></span> <span data-ttu-id="f8c5a-112">I percorsi specificano un nome host e un elemento `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-112">Paths specify a host name and a `QueueName`.</span></span> <span data-ttu-id="f8c5a-113">Fra il nome host e l'elemento `Private$` è inoltre previsto l'elemento facoltativo `QueueName`. Tale elemento indica una coda privata non pubblicata nel servizio di directory Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-113">Optionally, there can be a `Private$` between the host name and the `QueueName` to indicate a private queue that is not published in the Active Directory directory service.</span></span>  
  
 <span data-ttu-id="f8c5a-114">Viene eseguito il mapping dei nomi di percorso a "FormatNames" per determinare altri aspetti dell'indirizzo, tra cui routing e il protocollo di trasferimento del gestore code.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-114">Path names are mapped to "FormatNames" to determine additional aspects of the address, including routing and queue manager transfer protocol.</span></span> <span data-ttu-id="f8c5a-115">Questo servizio supporta due protocolli di trasferimento: il protocollo MSMQ nativo e il protocollo SOAP Reliable Messaging Protocol (SRMP).</span><span class="sxs-lookup"><span data-stu-id="f8c5a-115">The Queue Manager supports two transfer protocols: native MSMQ protocol and SOAP Reliable Messaging Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="f8c5a-116">Per ulteriori informazioni sui nomi di percorso e di formato MSMQ, vedere [informazioni su Accodamento messaggi](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="f8c5a-116">For more information about MSMQ path and format names, see [About Message Queuing](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span></span>  
  
## <a name="netmsmqbinding-and-service-addressing"></a><span data-ttu-id="f8c5a-117">Associazione NetMsmqBinding e indirizzamento del servizio</span><span class="sxs-lookup"><span data-stu-id="f8c5a-117">NetMsmqBinding and Service Addressing</span></span>  
 <span data-ttu-id="f8c5a-118">Quando si indirizza un messaggio a un servizio, lo schema contenuto nell'URI viene scelto in base al trasporto utilizzato per le comunicazioni.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-118">When addressing a message to a service, the scheme in the URI is chosen based on the transport used for communication.</span></span> <span data-ttu-id="f8c5a-119">Ogni trasporto in WCF ha uno schema univoco.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-119">Each transport in WCF has a unique scheme.</span></span> <span data-ttu-id="f8c5a-120">Lo schema deve riflettere le caratteristiche del trasporto utilizzato per le comunicazioni,</span><span class="sxs-lookup"><span data-stu-id="f8c5a-120">The scheme must reflect the nature of transport used for communication.</span></span> <span data-ttu-id="f8c5a-121">ad esempio net.tcp, net.pipe, HTTP e così via.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-121">For example, net.tcp, net.pipe, HTTP, and so on.</span></span>  
  
 <span data-ttu-id="f8c5a-122">Il trasporto accodato MSMQ in WCF espone uno schema net. MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-122">The MSMQ queued transport in WCF exposes a net.msmq scheme.</span></span> <span data-ttu-id="f8c5a-123">Tutti i messaggi indirizzati utilizzando lo schema net.msmq vengono inviati utilizzando l'associazione `NetMsmqBinding` sul canale del trasporto in coda del sistema MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-123">Any message addressed using the net.msmq scheme is sent using the `NetMsmqBinding` over the MSMQ queued transport channel.</span></span>  
  
 <span data-ttu-id="f8c5a-124">L'indirizzamento di una coda in WCF si basa sul modello seguente:</span><span class="sxs-lookup"><span data-stu-id="f8c5a-124">The addressing of a queue in WCF is based on the following pattern:</span></span>  
  
 <span data-ttu-id="f8c5a-125">NET. MSMQ:// \<*host-name*> /[privato/]\<*queue-name*></span><span class="sxs-lookup"><span data-stu-id="f8c5a-125">net.msmq: // \<*host-name*> / [private/] \<*queue-name*></span></span>  
  
 <span data-ttu-id="f8c5a-126">dove:</span><span class="sxs-lookup"><span data-stu-id="f8c5a-126">where:</span></span>  
  
- <span data-ttu-id="f8c5a-127">\<*host-name*>nome del computer che ospita la coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-127">\<*host-name*> is the name of the machine that hosts the Target Queue.</span></span>  
  
- <span data-ttu-id="f8c5a-128">L'elemento facoltativo [private]</span><span class="sxs-lookup"><span data-stu-id="f8c5a-128">[private] is optional.</span></span> <span data-ttu-id="f8c5a-129">viene utilizzato quando si indirizza una coda di destinazione privata.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-129">It is used when addressing a Target Queue that is a private queue.</span></span> <span data-ttu-id="f8c5a-130">Per indirizzare una coda pubblica è necessario non specificare [private].</span><span class="sxs-lookup"><span data-stu-id="f8c5a-130">To address a public queue, you must not specify private.</span></span> <span data-ttu-id="f8c5a-131">Si noti che, a differenza dei percorsi MSMQ, non esiste alcun "$" nel form URI WCF.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-131">Note that, unlike MSMQ paths, there is no "$" in the WCF URI form.</span></span>  
  
- <span data-ttu-id="f8c5a-132">\<*queue-name*>nome della coda.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-132">\<*queue-name*> is the name of the queue.</span></span> <span data-ttu-id="f8c5a-133">Il nome della coda può riferirsi anche a una coda secondaria.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-133">The queue name can also refer to a subqueue.</span></span> <span data-ttu-id="f8c5a-134">Quindi, \<*queue-name*>  =  \<*name-of-queue*> [;\* nome-coda secondaria\*].</span><span class="sxs-lookup"><span data-stu-id="f8c5a-134">Thus, \<*queue-name*> = \<*name-of-queue*>[;*sub-queue-name*].</span></span>  
  
 <span data-ttu-id="f8c5a-135">Esempio 1: per indirizzare una coda privata PurchaseOrders ospitata nel computer abc presso adatum.com, l'URI da utilizzare è net.msmq://abc.adatum.com/private/PurchaseOrders.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-135">Example1: To address a private queue PurchaseOrders hosted on computer abc atadatum.com, the URI would be net.msmq://abc.adatum.com/private/PurchaseOrders.</span></span>  
  
 <span data-ttu-id="f8c5a-136">Esempio 2: per indirizzare una coda pubblica AccountsPayable ospitata nel computer def presso adatum.com, l'URI da utilizzare è net.msmq://def.adatum.com/AccountsPayable.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-136">Example2: To address a public queue AccountsPayable hosted on computer def atadatum.com, the URI would be net.msmq://def.adatum.com/AccountsPayable.</span></span>  
  
 <span data-ttu-id="f8c5a-137">L'indirizzo della coda viene utilizzato dal listener come URI di ascolto da cui leggere i messaggi.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-137">The queue address is used as the Listen URI by the Listener to read messages from.</span></span> <span data-ttu-id="f8c5a-138">In altre parole, l'indirizzo della coda è equivalente alla porta di ascolto del socket TCP.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-138">In other words, the queue address is equivalent to the listen port of TCP socket.</span></span>  
  
 <span data-ttu-id="f8c5a-139">Un endpoint che legge da una coda deve specificare l'indirizzo della coda utilizzando lo stesso schema specificato in precedenza per l'apertura di ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-139">An endpoint that reads from a queue must specify the address of the queue using the same scheme specified previously when opening the ServiceHost.</span></span> <span data-ttu-id="f8c5a-140">Per esempi, vedere [associazione net MSMQ](../../../../docs/framework/wcf/samples/net-msmq-binding.md).</span><span class="sxs-lookup"><span data-stu-id="f8c5a-140">For examples, see [Net MSMQ Binding](../../../../docs/framework/wcf/samples/net-msmq-binding.md).</span></span>  
  
### <a name="multiple-contracts-in-a-queue"></a><span data-ttu-id="f8c5a-141">Contratti multipli in una coda</span><span class="sxs-lookup"><span data-stu-id="f8c5a-141">Multiple Contracts in a Queue</span></span>  
 <span data-ttu-id="f8c5a-142">I messaggi di una coda possono implementare più contratti.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-142">Messages in a queue can implement different contracts.</span></span> <span data-ttu-id="f8c5a-143">In questo caso, per leggere ed elaborare tutti i messaggi, è essenziale applicare uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="f8c5a-143">In this case, it is essential that one of the following is true to successfully read and process all messages:</span></span>  
  
- <span data-ttu-id="f8c5a-144">Specificare un endpoint per un servizio che implementa tutti i contratti.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-144">Specify an endpoint for a service that implements all the contracts.</span></span> <span data-ttu-id="f8c5a-145">Questo è l'approccio consigliato.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-145">This is the recommended approach.</span></span>  
  
- <span data-ttu-id="f8c5a-146">Specificare più endpoint con contratti diversi, garantendo tuttavia che tutti gli endpoint utilizzino lo stesso oggetto `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-146">Specify multiple endpoints with different contracts, but ensure that all the endpoints use the same `NetMsmqBinding` object.</span></span> <span data-ttu-id="f8c5a-147">La logica di distribuzione di ServiceModel utilizza una message pump che legge i messaggi dal canale di trasporto e quindi li distribuisce. Questa procedura, una volta completata, consente di ottenere il demultiplexing dei messaggi verso vari endpoint in base al contratto.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-147">The dispatching logic in ServiceModel uses a message pump that reads messages out of the transport channel for dispatch, which eventually de-multiplexes messages based on the contract to different endpoints.</span></span> <span data-ttu-id="f8c5a-148">Una message pump viene creata per una coppia URI di ascolto/associazione.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-148">A message pump is created for a listen URI/Binding pair.</span></span> <span data-ttu-id="f8c5a-149">L'indirizzo della coda viene utilizzato dal listener in coda come URI di ascolto.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-149">The queue address is used as the Listen URI by the queued listener.</span></span> <span data-ttu-id="f8c5a-150">Se si configurano tutti gli endpoint in modo da utilizzare lo stesso oggetto di associazione è possibile garantire che il sistema utilizzi un'unica message pump per leggere il messaggio e quindi eseguirne il demultiplexing verso gli endpoint appropriati in base al contratto.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-150">Having all the endpoints use the same binding object ensures that a single message pump is used to read the message and de-multiplex to relevant endpoints based on the contract.</span></span>  
  
### <a name="srmp-messaging"></a><span data-ttu-id="f8c5a-151">Messaggistica SRMP</span><span class="sxs-lookup"><span data-stu-id="f8c5a-151">SRMP Messaging</span></span>  
 <span data-ttu-id="f8c5a-152">Come già indicato, è possibile utilizzare il protocollo SRMP per i trasferimenti fra code.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-152">As previously discussed, you can use the SRMP protocol for queue-to-queue transfers.</span></span> <span data-ttu-id="f8c5a-153">Questo approccio in genere viene utilizzato quando un trasporto HTTP trasmette i messaggi fra la coda di trasmissione e la coda di destinazione.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-153">This is commonly used when an HTTP transport transmits messages between the Transmission Queue and the Target Queue.</span></span>  
  
 <span data-ttu-id="f8c5a-154">Per utilizzare il protocollo di trasferimento SRMP è necessario indirizzare i messaggi tramite lo schema degli URI net.msmq, come già menzionato, nonché impostare la proprietà `QueueTransferProtocol` dell'associazione `NetMsmqBinding` su SRMP o su SRMP protetto.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-154">To use the SRMP transfer protocol, address messages using the net.msmq URI scheme, as mentioned previously, and specify the choice of SRMP or Secured SRMP in the `QueueTransferProtocol` property of the `NetMsmqBinding`.</span></span>  
  
 <span data-ttu-id="f8c5a-155">La specifica della proprietà `QueueTransferProtocol` è una funzionalità di solo invio</span><span class="sxs-lookup"><span data-stu-id="f8c5a-155">Specifying the `QueueTransferProtocol` property is a send-only feature.</span></span> <span data-ttu-id="f8c5a-156">e rappresenta un'indicazione del tipo di protocollo di trasferimento fra code da utilizzare nel client.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-156">This is an indication by the client which kind of queue transfer protocol to use.</span></span>  
  
### <a name="using-active-directory"></a><span data-ttu-id="f8c5a-157">Utilizzo di Active Directory</span><span class="sxs-lookup"><span data-stu-id="f8c5a-157">Using Active Directory</span></span>  
 <span data-ttu-id="f8c5a-158">MSMQ supporta l'integrazione con Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-158">MSMQ comes with support for Active Directory integration.</span></span> <span data-ttu-id="f8c5a-159">Quando si installa MSMQ con l'opzione di integrazione con Active Directory, il computer deve appartenere a un dominio Windows.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-159">When MSMQ is installed with Active Directory integration, the machine must be part of a Windows domain.</span></span> <span data-ttu-id="f8c5a-160">Active Directory viene utilizzata per pubblicare le code per l'individuazione; tali code sono denominate *code pubbliche*.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-160">Active Directory is used to publish queues for discovery; such queues are called *public queues*.</span></span> <span data-ttu-id="f8c5a-161">Quando si indirizza una coda, il relativo indirizzo può essere risolto utilizzando Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-161">When addressing a queue, the queue can be resolved using Active Directory.</span></span> <span data-ttu-id="f8c5a-162">Questo approccio è analogo all'utilizzo di Domain Name System (DNS) per risolvere l'indirizzo IP di un nome di rete.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-162">This is similar to how Domain Name System (DNS) is used to resolve the IP address of a network name.</span></span> <span data-ttu-id="f8c5a-163">La proprietà `UseActiveDirectory` dell'associazione `NetMsmqBinding` è un valore booleano che indica se il canale in coda deve utilizzare Active Directory per risolvere l'URI della coda.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-163">The `UseActiveDirectory` property in `NetMsmqBinding` is a Boolean that indicates whether the queued channel must use Active Directory to resolve the queue URI.</span></span> <span data-ttu-id="f8c5a-164">Per impostazione predefinita, questa proprietà è impostata su `false`.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-164">By default it is set to `false`.</span></span> <span data-ttu-id="f8c5a-165">Se la proprietà `UseActiveDirectory` è impostata su `true`, il canale in coda utilizza Active Directory per convertire l'URI net.msmq:// nel nome di formato.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-165">If the `UseActiveDirectory` property is set to `true`, then the queued channel uses Active Directory to convert the net.msmq:// URI to format name.</span></span>  
  
 <span data-ttu-id="f8c5a-166">La proprietà `UseActiveDirectory` è rilevante solo per i client che stanno inviando un messaggio, in quanto tale proprietà viene utilizzata per risolvere l'indirizzo della coda durante la fase di invio dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-166">The `UseActiveDirectory` property is meaningful only for the client that is sending the message because it is used to resolve the address of the queue when sending messages.</span></span>  
  
### <a name="mapping-netmsmq-uri-to-message-queuing-format-names"></a><span data-ttu-id="f8c5a-167">Mapping fra gli URI net.msmq e i nomi di formato di MSMQ</span><span class="sxs-lookup"><span data-stu-id="f8c5a-167">Mapping net.msmq URI to Message Queuing Format Names</span></span>  
 <span data-ttu-id="f8c5a-168">Il canale in coda gestisce il mapping fra i nomi degli URI net.msmq forniti al canale e i nomi di formato di MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-168">The queued channel handles mapping the net.msmq URI name provided to the channel to MSMQ format names.</span></span> <span data-ttu-id="f8c5a-169">La tabella seguente riepiloga le regole di mapping.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-169">The following table summarizes the rules used to map between them.</span></span>  
  
|<span data-ttu-id="f8c5a-170">Indirizzo di coda basato sugli URI WCF</span><span class="sxs-lookup"><span data-stu-id="f8c5a-170">WCF URI-based queue address</span></span>|<span data-ttu-id="f8c5a-171">Impostazione della proprietà UseActiveDirectory</span><span class="sxs-lookup"><span data-stu-id="f8c5a-171">Use Active Directory property</span></span>|<span data-ttu-id="f8c5a-172">Impostazione della proprietà QueueTransferProtocol</span><span class="sxs-lookup"><span data-stu-id="f8c5a-172">Queue Transfer Protocol property</span></span>|<span data-ttu-id="f8c5a-173">Nomi di formato di MSMQ risultanti</span><span class="sxs-lookup"><span data-stu-id="f8c5a-173">Resulting MSMQ format names</span></span>|  
|----------------------------------|-----------------------------------|--------------------------------------|---------------------------------|  
|`Net.msmq://<machine-name>/private/abc`|<span data-ttu-id="f8c5a-174">False (impostazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="f8c5a-174">False (default)</span></span>|<span data-ttu-id="f8c5a-175">Native (impost. predef.)</span><span class="sxs-lookup"><span data-stu-id="f8c5a-175">Native (default)</span></span>|`DIRECT=OS:machine-name\private$\abc`|  
|`Net.msmq://<machine-name>/private/abc`|<span data-ttu-id="f8c5a-176">False</span><span class="sxs-lookup"><span data-stu-id="f8c5a-176">False</span></span>|<span data-ttu-id="f8c5a-177">SRMP</span><span class="sxs-lookup"><span data-stu-id="f8c5a-177">SRMP</span></span>|`DIRECT=http://machine/msmq/private$/abc`|  
|`Net.msmq://<machine-name>/private/abc`|<span data-ttu-id="f8c5a-178">True </span><span class="sxs-lookup"><span data-stu-id="f8c5a-178">True</span></span>|<span data-ttu-id="f8c5a-179">Nativa</span><span class="sxs-lookup"><span data-stu-id="f8c5a-179">Native</span></span>|<span data-ttu-id="f8c5a-180">`PUBLIC=some-guid`(GUID della coda)</span><span class="sxs-lookup"><span data-stu-id="f8c5a-180">`PUBLIC=some-guid` (the GUID of the queue)</span></span>|  
  
### <a name="reading-messages-from-the-dead-letter-queue-or-the-poison-message-queue"></a><span data-ttu-id="f8c5a-181">Lettura dei messaggi dalla coda dei messaggi non recapitabili o dalla coda dei messaggi non elaborabili</span><span class="sxs-lookup"><span data-stu-id="f8c5a-181">Reading Messages from the Dead-Letter Queue or the Poison-Message Queue</span></span>  
 <span data-ttu-id="f8c5a-182">Per leggere i messaggi da una coda di messaggi non elaborabili che è una coda secondaria della coda di destinazione, aprire l'elemento `ServiceHost` con l'indirizzo della coda secondaria.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-182">To read messages from a poison-message queue that is a subqueue of the target queue, open the `ServiceHost` with the address of the subqueue.</span></span>  
  
 <span data-ttu-id="f8c5a-183">Esempio: un servizio che legge dalla coda di messaggi non elaborabili della coda privata PurchaseOrders nel computer locale presenta l'indirizzo net.msmq://localhost/private/PurchaseOrders;poison.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-183">Example: A service that reads from the poison-message queue of the PurchaseOrders private queue from the local machine would address net.msmq://localhost/private/PurchaseOrders;poison.</span></span>  
  
 <span data-ttu-id="f8c5a-184">Per leggere messaggi da una coda transazionale di sistema di messaggi non recapitabili, l'URI deve presentarsi nel formato: net.msmq://localhost/system$;DeadXact.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-184">To read messages from a system transactional dead-letter queue, the URI must be of the form: net.msmq://localhost/system$;DeadXact.</span></span>  
  
 <span data-ttu-id="f8c5a-185">Per leggere messaggi da una coda non transazionale di sistema di messaggi non recapitabili, l'URI deve presentarsi nel formato: net.msmq://localhost/system$;DeadLetter.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-185">To read messages from a system nontransactional dead-letter queue, the URI must be of the form: net.msmq://localhost/system$;DeadLetter.</span></span>  
  
 <span data-ttu-id="f8c5a-186">Quando si utilizza una coda di messaggi non recapitabili personalizzata, si noti che questa coda deve trovarsi nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-186">When using a custom dead-letter queue, note that the dead-letter queue must reside on the local computer.</span></span> <span data-ttu-id="f8c5a-187">Ne consegue che l'URI della coda deve attenersi al formato:</span><span class="sxs-lookup"><span data-stu-id="f8c5a-187">As such, the URI for the dead-letter queue is restricted to the form:</span></span>  
  
 <span data-ttu-id="f8c5a-188">NET. MSMQ://localhost/[private/] \<*custom-dead-letter-queue-name*> .</span><span class="sxs-lookup"><span data-stu-id="f8c5a-188">net.msmq: //localhost/ [private/]  \<*custom-dead-letter-queue-name*>.</span></span>  
  
 <span data-ttu-id="f8c5a-189">Un servizio WCF verifica che tutti i messaggi ricevuti siano stati rivolti alla coda specifica su cui è in ascolto.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-189">A WCF service verifies that all messages it receives were addressed to the particular queue it is listening on.</span></span> <span data-ttu-id="f8c5a-190">Se un messaggio viene rilevato in una coda a cui non era destinato, tale messaggio non viene elaborato dal servizio.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-190">If the message’s destination queue does not match the queue it is found in, the service does not process the message.</span></span> <span data-ttu-id="f8c5a-191">Si tratta di un problema che i servizi in attesa di una coda di messaggi non recapitabili devono affrontare, poiché questo tipo di coda contiene messaggi che in realtà erano destinati altrove.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-191">This is an issue that services listening to a dead-letter queue must address because any message in the dead-letter queue was meant to be delivered elsewhere.</span></span> <span data-ttu-id="f8c5a-192">Per leggere i messaggi di una coda di messaggi non recapitabili o non elaborabili occorre utilizzare un comportamento `ServiceBehavior` con il parametro <xref:System.ServiceModel.AddressFilterMode.Any>.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-192">To read messages from a dead-letter queue, or from a poison queue, a `ServiceBehavior` with the <xref:System.ServiceModel.AddressFilterMode.Any> parameter must be used.</span></span> <span data-ttu-id="f8c5a-193">Per un esempio, vedere Code di messaggi non [recapitabili](../../../../docs/framework/wcf/samples/dead-letter-queues.md).</span><span class="sxs-lookup"><span data-stu-id="f8c5a-193">For an example, see [Dead Letter Queues](../../../../docs/framework/wcf/samples/dead-letter-queues.md).</span></span>  
  
## <a name="msmqintegrationbinding-and-service-addressing"></a><span data-ttu-id="f8c5a-194">Associazione MsmqIntegrationBinding e indirizzamento del servizio</span><span class="sxs-lookup"><span data-stu-id="f8c5a-194">MsmqIntegrationBinding and Service Addressing</span></span>  
 <span data-ttu-id="f8c5a-195">L'associazione `MsmqIntegrationBinding` viene utilizzata per comunicare con le applicazioni MSMQ tradizionali.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-195">The `MsmqIntegrationBinding` is used for communication with traditional MSMQ applications.</span></span> <span data-ttu-id="f8c5a-196">Per semplificare l'interazione con un'applicazione MSMQ esistente, WCF supporta solo l'indirizzamento dei nomi di formato.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-196">To ease interoperation with an existing MSMQ application, WCF supports only format name addressing.</span></span> <span data-ttu-id="f8c5a-197">Di conseguenza, i messaggi inviati tramite questa associazione devono attenersi allo schema degli URI seguente:</span><span class="sxs-lookup"><span data-stu-id="f8c5a-197">Thus, messages sent using this binding must conform to the URI scheme:</span></span>  
  
 <span data-ttu-id="f8c5a-198">MSMQ. formatname:\<*MSMQ-format-name*>></span><span class="sxs-lookup"><span data-stu-id="f8c5a-198">msmq.formatname:\<*MSMQ-format-name*>></span></span>  
  
 <span data-ttu-id="f8c5a-199">MSMQ-format-name ha il formato specificato da MSMQ in [About Accodamento messaggi](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="f8c5a-199">The MSMQ-format-name is of the form specified by MSMQ in [About Message Queuing](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span></span>  
  
 <span data-ttu-id="f8c5a-200">Si noti che quando si ricevono messaggi da una coda tramite l'associazione `MsmqIntegrationBinding` è possibile utilizzare soltanto i nomi di formato Direct e, se è stata scelta l'opzione di integrazione con Active Directory, i nomi di formato pubblici e privati.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-200">Note that you can only use direct format names, and public and private format names (requires Active Directory integration) when receiving messages from a queue using `MsmqIntegrationBinding`.</span></span> <span data-ttu-id="f8c5a-201">È tuttavia consigliabile utilizzare i nomi di formato Direct.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-201">However, it is advised that you use direct format names.</span></span> <span data-ttu-id="f8c5a-202">In Windows Vista, ad esempio, l'utilizzo di qualsiasi altro nome di formato causa un errore, in quanto il sistema tenta di aprire una coda secondaria, che può essere aperta solo con nomi di formato diretti.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-202">For example, on Windows Vista, using any other format name causes an error because the system attempts to open a subqueue, which can only be opened with direct format names.</span></span>  
  
 <span data-ttu-id="f8c5a-203">Quando si esegue l'indirizzamento tramite il protocollo SRMP usando l'associazione `MsmqIntegrationBinding` non occorre aggiungere /msmq/ nel nome di formato Direct per consentire ai servizi Internet Information Services (IIS) di eseguire la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-203">When addressing SRMP using `MsmqIntegrationBinding`, there is no requirement to add /msmq/ in the direct format name to help Internet Information Services (IIS) with dispatching.</span></span> <span data-ttu-id="f8c5a-204">Ad esempio: quando si indirizza una coda ABC usando il protocollo SRMP, anziché `DIRECT=http://adatum.com/msmq/private$/abc` , è necessario usare `DIRECT=http://adatum.com/private$/abc` .</span><span class="sxs-lookup"><span data-stu-id="f8c5a-204">For example: When addressing a queue abc using the SRMP protocol, instead of `DIRECT=http://adatum.com/msmq/private$/abc`, you should use `DIRECT=http://adatum.com/private$/abc`.</span></span>  
  
 <span data-ttu-id="f8c5a-205">Si noti che non è possibile utilizzare l'indirizzamento net.msmq:// con l'associazione `MsmqIntegrationBinding`.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-205">Note that you cannot use net.msmq:// addressing with `MsmqIntegrationBinding`.</span></span> <span data-ttu-id="f8c5a-206">Poiché `MsmqIntegrationBinding` supporta l'indirizzamento dei nomi in formato libero MSMQ, è possibile utilizzare un servizio WCF che utilizza questa associazione per utilizzare le funzionalità della lista di distribuzione e di multicast in MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-206">Because `MsmqIntegrationBinding` supports free-form MSMQ format name addressing, you can use a WCF service that uses this binding to use multicast and distribution list features in MSMQ.</span></span> <span data-ttu-id="f8c5a-207">Un'eccezione è la specifica dell'elemento `CustomDeadLetterQueue` quando si utilizza l'associazione `MsmqIntegrationBinding`.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-207">One exception is specifying `CustomDeadLetterQueue` when using the `MsmqIntegrationBinding`.</span></span> <span data-ttu-id="f8c5a-208">Analogamente al caso di specifica dell'elemento quando si utilizza l'associazione `NetMsmqBinding`, tale elemento deve presentare il formato net.msmq://.</span><span class="sxs-lookup"><span data-stu-id="f8c5a-208">It must be of the form net.msmq://, similar to how it is specified using the `NetMsmqBinding`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f8c5a-209">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f8c5a-209">See also</span></span>

- [<span data-ttu-id="f8c5a-210">Sito Web che ospita un'applicazione in coda</span><span class="sxs-lookup"><span data-stu-id="f8c5a-210">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)
