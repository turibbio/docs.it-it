---
title: Trasferimento dei messaggi di flusso
ms.date: 03/30/2017
ms.assetid: 72a47a51-e5e7-4b76-b24a-299d51e0ae5a
ms.openlocfilehash: 462144856750a1b8726b574fdc82746da2d72ff7
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/09/2020
ms.locfileid: "84594790"
---
# <a name="streaming-message-transfer"></a><span data-ttu-id="04510-102">Trasferimento dei messaggi di flusso</span><span class="sxs-lookup"><span data-stu-id="04510-102">Streaming Message Transfer</span></span>
<span data-ttu-id="04510-103">I trasporti Windows Communication Foundation (WCF) supportano due modalità per il trasferimento dei messaggi:</span><span class="sxs-lookup"><span data-stu-id="04510-103">Windows Communication Foundation (WCF) transports support two modes for transferring messages:</span></span>  
  
- <span data-ttu-id="04510-104">Trasferimento con memorizzazione nel buffer: in questa modalità, l'intero messaggio viene memorizzato in un buffer fino al completamento del trasferimento.</span><span class="sxs-lookup"><span data-stu-id="04510-104">Buffered transfers hold the entire message in a memory buffer until the transfer is complete.</span></span> <span data-ttu-id="04510-105">Un messaggio memorizzato nel buffer deve essere completamente recapitato prima che un destinatario sia in grado di leggerlo.</span><span class="sxs-lookup"><span data-stu-id="04510-105">A buffered message must be completely delivered before a receiver can read it.</span></span>  
  
- <span data-ttu-id="04510-106">Trasferimento con flusso: in questa modalità il messaggio viene esposto come flusso.</span><span class="sxs-lookup"><span data-stu-id="04510-106">Streamed transfers expose the message as a stream.</span></span> <span data-ttu-id="04510-107">Il destinatario inizia a elaborare il messaggio prima che quest'ultimo venga recapitato per intero.</span><span class="sxs-lookup"><span data-stu-id="04510-107">The receiver starts processing the message before it is completely delivered.</span></span>  
  
- <span data-ttu-id="04510-108">I trasferimenti con flusso possono migliorare la scalabilità di un servizio eliminando l'esigenza di utilizzare buffer di memoria di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="04510-108">Streamed transfers can improve the scalability of a service by eliminating the requirement for large memory buffers.</span></span> <span data-ttu-id="04510-109">La capacità di migliorare la scalabilità mediante l'impostazione della modalità di trasferimento con flusso dipende dalle dimensioni dei messaggi da trasferire.</span><span class="sxs-lookup"><span data-stu-id="04510-109">Whether changing the transfer mode improves scalability depends on the size of the messages being transferred.</span></span> <span data-ttu-id="04510-110">In particolare, la modalità di trasferimento con flusso risulta essere più efficiente negli scenari che prevedono messaggi di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="04510-110">Large message sizes favor using streamed transfers.</span></span>  
  
 <span data-ttu-id="04510-111">Per impostazione predefinita, i trasporti HTTP, TCP/IP e pipe con nome utilizzano la modalità di trasferimento con memorizzazione nel buffer.</span><span class="sxs-lookup"><span data-stu-id="04510-111">By default, the HTTP, TCP/IP, and named pipe transports use buffered transfers.</span></span> <span data-ttu-id="04510-112">Questo documento descrive come configurare questi trasporti in modo che utilizzino la modalità di trasferimento con flusso e le relative conseguenze.</span><span class="sxs-lookup"><span data-stu-id="04510-112">This document describes how to switch these transports from a buffered to streamed transfer mode and the consequences of doing so.</span></span>  
  
## <a name="enabling-streamed-transfers"></a><span data-ttu-id="04510-113">Attivazione dei trasferimenti con flusso</span><span class="sxs-lookup"><span data-stu-id="04510-113">Enabling Streamed Transfers</span></span>  
 <span data-ttu-id="04510-114">Per impostare una delle due modalità di trasferimento occorre intervenire sull'elemento di associazione del trasporto.</span><span class="sxs-lookup"><span data-stu-id="04510-114">Selecting between buffered and streamed transfer modes is done on the binding element of the transport.</span></span> <span data-ttu-id="04510-115">L'elemento di associazione presenta una proprietà <xref:System.ServiceModel.TransferMode> che può essere impostata su `Buffered`, `Streamed`, `StreamedRequest` o `StreamedResponse`.</span><span class="sxs-lookup"><span data-stu-id="04510-115">The binding element has a <xref:System.ServiceModel.TransferMode> property that can be set to `Buffered`, `Streamed`, `StreamedRequest`, or `StreamedResponse`.</span></span> <span data-ttu-id="04510-116">L'impostazione della modalità di trasferimento su `Streamed` consente di attivare la comunicazione con flusso bidirezionale.</span><span class="sxs-lookup"><span data-stu-id="04510-116">Setting the transfer mode to `Streamed` enables streaming communication in both directions.</span></span> <span data-ttu-id="04510-117">L'impostazione della modalità di trasferimento su `StreamedRequest` o `StreamedResponse` consente di attivare la comunicazione con flusso soltanto nella direzione scelta.</span><span class="sxs-lookup"><span data-stu-id="04510-117">Setting the transfer mode to `StreamedRequest` or `StreamedResponse` enables streaming communication in the indicated direction only.</span></span>  
  
 <span data-ttu-id="04510-118">Le associazioni <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding> e <xref:System.ServiceModel.NetNamedPipeBinding> espongono la proprietà <xref:System.ServiceModel.TransferMode>.</span><span class="sxs-lookup"><span data-stu-id="04510-118">The <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, and <xref:System.ServiceModel.NetNamedPipeBinding> bindings expose the <xref:System.ServiceModel.TransferMode> property.</span></span> <span data-ttu-id="04510-119">Per impostare la modalità di trasferimento degli altri trasporti è necessario creare un'associazione personalizzata.</span><span class="sxs-lookup"><span data-stu-id="04510-119">For other transports, you must create a custom binding to set the transfer mode.</span></span>  
  
 <span data-ttu-id="04510-120">La scelta di utilizzare trasferimenti memorizzati nel buffer o in flussi è una decisione specifica dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="04510-120">The decision to use either buffered or streamed transfers is a local decision of the endpoint.</span></span> <span data-ttu-id="04510-121">Per i trasporti HTTP, la modalità di trasferimento non si propaga attraverso una connessione, né verso server o altri intermediari.</span><span class="sxs-lookup"><span data-stu-id="04510-121">For HTTP transports, the transfer mode does not propagate across a connection, or to servers and other intermediaries.</span></span> <span data-ttu-id="04510-122">L'impostazione della modalità di trasferimento non si riflette nella descrizione dell'interfaccia del servizio.</span><span class="sxs-lookup"><span data-stu-id="04510-122">Setting the transfer mode is not reflected in the description of the service interface.</span></span> <span data-ttu-id="04510-123">Dopo aver generato una classe client per un servizio, per impostare la modalità è necessario modificare il file di configurazione dei servizi per cui si desidera utilizzare la modalità di trasferimento con flusso.</span><span class="sxs-lookup"><span data-stu-id="04510-123">After generating a client class for a service, you must edit the configuration file for services intended to be used with streamed transfers to set the mode.</span></span> <span data-ttu-id="04510-124">Per i trasporti TCP e named pipe, la modalità di trasferimento viene propagata come asserzione di criteri.</span><span class="sxs-lookup"><span data-stu-id="04510-124">For TCP and named pipe transports, the transfer mode is propagated as a policy assertion.</span></span>  
  
 <span data-ttu-id="04510-125">Per esempi di codice, vedere [procedura: abilitare il flusso](how-to-enable-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="04510-125">For code samples, see [How to: Enable Streaming](how-to-enable-streaming.md).</span></span>  
  
## <a name="enabling-asynchronous-streaming"></a><span data-ttu-id="04510-126">Abilitazione del flusso asincrono</span><span class="sxs-lookup"><span data-stu-id="04510-126">Enabling Asynchronous Streaming</span></span>  
 <span data-ttu-id="04510-127">Per abilitare il flusso asincrono, aggiungere il comportamento dell'endpoint <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> all'host del servizio e impostare la relativa proprietà <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> su `true`.</span><span class="sxs-lookup"><span data-stu-id="04510-127">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span>  
  
 <span data-ttu-id="04510-128">In questa versione di WCF è stata inoltre aggiunta la funzionalità di un vero flusso asincrono sul lato di invio.</span><span class="sxs-lookup"><span data-stu-id="04510-128">This version of WCF also adde the capability of true asynchronous streaming on the send side.</span></span> <span data-ttu-id="04510-129">In questo modo si migliora la scalabilità del servizio negli scenari in cui vengono trasmessi messaggi a più client, alcuni dei quali sono lenti nella lettura, probabilmente a causa della congestione della rete, o non effettuano l'operazione.</span><span class="sxs-lookup"><span data-stu-id="04510-129">This improves scalability of the service in scenarios where it is streaming messages to multiple clients some of which are slow in reading; possibly due to network congestion or are not reading at all.</span></span> <span data-ttu-id="04510-130">In questi scenari, WCF non blocca più i singoli thread sul servizio per client.</span><span class="sxs-lookup"><span data-stu-id="04510-130">In these scenarios WCF no longer blocks individual threads on the service per client.</span></span> <span data-ttu-id="04510-131">In questo modo si assicura che il servizio possa elaborare molti più client, migliorando pertanto la scalabilità del servizio.</span><span class="sxs-lookup"><span data-stu-id="04510-131">This ensures that the service is able to process many more clients thereby improving the scalability of the service.</span></span>  
  
## <a name="restrictions-on-streamed-transfers"></a><span data-ttu-id="04510-132">Restrizioni sui trasferimenti con flusso</span><span class="sxs-lookup"><span data-stu-id="04510-132">Restrictions on Streamed Transfers</span></span>  
 <span data-ttu-id="04510-133">L'utilizzo della modalità di trasferimento con flusso comporta l'applicazione di restrizioni aggiuntive da parte del runtime.</span><span class="sxs-lookup"><span data-stu-id="04510-133">Using the streamed transfer mode causes the run time to enforce additional restrictions.</span></span>  
  
 <span data-ttu-id="04510-134">Le operazioni che si verificano in un trasporto con flusso possono presentare un contratto avente al massimo un solo parametro di input oppure un solo parametro output.</span><span class="sxs-lookup"><span data-stu-id="04510-134">Operations that occur across a streamed transport can have a contract with at most one input or output parameter.</span></span> <span data-ttu-id="04510-135">Questo parametro corrisponde al corpo intero del messaggio e deve essere un messaggio <xref:System.ServiceModel.Channels.Message>, un tipo derivato dal flusso <xref:System.IO.Stream> oppure un'implementazione dell'interfaccia <xref:System.Xml.Serialization.IXmlSerializable>.</span><span class="sxs-lookup"><span data-stu-id="04510-135">That parameter corresponds to the entire body of the message and must be a <xref:System.ServiceModel.Channels.Message>, a derived type of <xref:System.IO.Stream>, or an <xref:System.Xml.Serialization.IXmlSerializable> implementation.</span></span> <span data-ttu-id="04510-136">Definire un valore restituito di un'operazione equivale a definire un parametro di output.</span><span class="sxs-lookup"><span data-stu-id="04510-136">Having a return value for an operation is equivalent to having an output parameter.</span></span>  
  
 <span data-ttu-id="04510-137">Alcune funzionalità WCF, ad esempio messaggistica affidabile, transazioni e sicurezza a livello di messaggio SOAP, si basano sul buffering dei messaggi per le trasmissioni.</span><span class="sxs-lookup"><span data-stu-id="04510-137">Some WCF features, such as reliable messaging, transactions, and SOAP message-level security, rely on buffering messages for transmissions.</span></span> <span data-ttu-id="04510-138">L'utilizzo di queste funzionalità può ridurre o eliminare del tutto i vantaggi in termini di prestazioni ottenuti mediante i flussi.</span><span class="sxs-lookup"><span data-stu-id="04510-138">Using these features may reduce or eliminate the performance benefits gained by using streaming.</span></span> <span data-ttu-id="04510-139">Per proteggere un trasporto con flusso, utilizzare soltanto la protezione a livello di trasporto oppure utilizzare la protezione a livello di trasporto insieme a una protezione a livello di messaggio di sola autenticazione.</span><span class="sxs-lookup"><span data-stu-id="04510-139">To secure a streamed transport, use transport-level security only or use transport-level security plus authentication-only message security.</span></span>  
  
 <span data-ttu-id="04510-140">Le intestazioni SOAP vengono sempre memorizzate nel buffer, anche quando si utilizza la modalità di trasferimento con flusso.</span><span class="sxs-lookup"><span data-stu-id="04510-140">SOAP headers are always buffered, even when the transfer mode is set to streamed.</span></span> <span data-ttu-id="04510-141">Le intestazioni di un messaggio non devono superare la quota di trasporto indicata da `MaxBufferSize`.</span><span class="sxs-lookup"><span data-stu-id="04510-141">The headers for a message must not exceed the size of the `MaxBufferSize` transport quota.</span></span> <span data-ttu-id="04510-142">Per ulteriori informazioni su questa impostazione, vedere [quote di trasporto](transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="04510-142">For more information about this setting, see [Transport Quotas](transport-quotas.md).</span></span>  
  
## <a name="differences-between-buffered-and-streamed-transfers"></a><span data-ttu-id="04510-143">Differenze tra trasferimenti con memorizzazione nel buffer e con flusso</span><span class="sxs-lookup"><span data-stu-id="04510-143">Differences Between Buffered and Streamed Transfers</span></span>  
 <span data-ttu-id="04510-144">Il passaggio dalla modalità di trasferimento con memorizzazione nel buffer alla modalità di trasferimento con flusso comporta la modifica della forma del canale nativo dei trasporti TCP e pipe con nome.</span><span class="sxs-lookup"><span data-stu-id="04510-144">Changing the transfer mode from buffered to streamed also changes the native channel shape of the TCP and named pipe transports.</span></span> <span data-ttu-id="04510-145">Per i trasferimenti con memorizzazione nel buffer, la forma del canale nativo è <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span><span class="sxs-lookup"><span data-stu-id="04510-145">For buffered transfers, the native channel shape is <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span> <span data-ttu-id="04510-146">Per i trasferimenti con flusso, i canali nativi sono <xref:System.ServiceModel.Channels.IRequestChannel> e <xref:System.ServiceModel.Channels.IReplyChannel>.</span><span class="sxs-lookup"><span data-stu-id="04510-146">For streamed transfers, the native channels are <xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span> <span data-ttu-id="04510-147">La modifica della modalità di trasferimento di un'applicazione esistente che utilizza questi trasporti in modo diretto (ovvero non tramite un contratto di servizio) richiede la modifica della forma del canale previsto di channel factory e listener.</span><span class="sxs-lookup"><span data-stu-id="04510-147">Changing the transfer mode in an existing application that uses these transports directly (that is, not through a service contract) requires changing the expected channel shape for channel factories and listeners.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="04510-148">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="04510-148">See also</span></span>

- [<span data-ttu-id="04510-149">Procedura: attivare il flusso</span><span class="sxs-lookup"><span data-stu-id="04510-149">How to: Enable Streaming</span></span>](how-to-enable-streaming.md)
