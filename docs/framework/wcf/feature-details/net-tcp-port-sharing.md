---
title: Condivisione delle porte Net.TCP
ms.date: 03/30/2017
helpviewer_keywords:
- port activation [WCF]
- port sharing [WCF]
ms.assetid: f13692ee-a179-4439-ae72-50db9534eded
ms.openlocfilehash: d9c6caa546d9f31f4e68b850dc1b1e750da2e93c
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/09/2020
ms.locfileid: "84598762"
---
# <a name="nettcp-port-sharing"></a><span data-ttu-id="a67d4-102">Condivisione delle porte Net.TCP</span><span class="sxs-lookup"><span data-stu-id="a67d4-102">Net.TCP Port Sharing</span></span>
<span data-ttu-id="a67d4-103">Windows Communication Foundation (WCF) fornisce un nuovo protocollo di rete basato su TCP (NET. TCP://) per la comunicazione a prestazioni elevate.</span><span class="sxs-lookup"><span data-stu-id="a67d4-103">Windows Communication Foundation (WCF) provides a new TCP-based network protocol (net.tcp://) for high-performance communication.</span></span> <span data-ttu-id="a67d4-104">WCF introduce inoltre un nuovo componente di sistema, il servizio di condivisione delle porte net. TCP che consente la condivisione delle porte net. TCP tra più processi utente.</span><span class="sxs-lookup"><span data-stu-id="a67d4-104">WCF also introduces a new system component, the Net.TCP Port Sharing Service that enables net.tcp ports to be shared across multiple user processes.</span></span>  
  
## <a name="background-and-motivation"></a><span data-ttu-id="a67d4-105">Informazioni generali e motivazione</span><span class="sxs-lookup"><span data-stu-id="a67d4-105">Background and Motivation</span></span>  
 <span data-ttu-id="a67d4-106">Quando il protocollo TCP/IP è stato introdotto per la prima volta, solo pochi protocolli di applicazione lo utilizzavano.</span><span class="sxs-lookup"><span data-stu-id="a67d4-106">When the TCP/IP protocol was first introduced, only a small number of application protocols made use of it.</span></span> <span data-ttu-id="a67d4-107">TCP/IP usa numeri di porta per differenziare le applicazioni, assegnando un numero di porta univoco a 16 bit a ogni protocollo di applicazione.</span><span class="sxs-lookup"><span data-stu-id="a67d4-107">TCP/IP used port numbers to differentiate between applications by assigning a unique 16-bit port number to each application protocol.</span></span> <span data-ttu-id="a67d4-108">Ad esempio, il traffico HTTP è oggi standardizzato sull'utilizzo del TCP sulla porta 80, l'SMTP usa il TCP sulla porta 25 e l'FTP usa il TCP sulle porte 20 e 21.</span><span class="sxs-lookup"><span data-stu-id="a67d4-108">For example, HTTP traffic today is standardized to use TCP port 80, SMTP uses TCP port 25, and FTP uses TCP ports 20 and 21.</span></span> <span data-ttu-id="a67d4-109">Per altre applicazioni che usano il TCP come trasporto è possibile scegliere un altro numero di porta disponibile, per convenzione o attraverso la standardizzazione formale.</span><span class="sxs-lookup"><span data-stu-id="a67d4-109">Other applications using TCP as a transport can choose another available port number, either by convention or through formal standardization.</span></span>  
  
 <span data-ttu-id="a67d4-110">L'utilizzo di numeri di porta per fare distinzioni tra le applicazioni comporta problemi di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="a67d4-110">Using port numbers to distinguish between applications had security problems.</span></span> <span data-ttu-id="a67d4-111">I firewall sono generalmente configurati per bloccare il traffico TCP su tutte le porte, a parte alcuni punti di ingresso conosciuti, pertanto la distribuzione di un'applicazione che usa una porta non standard è spesso complicata, se non impossibile, a causa della presenza di firewall aziendali e personali.</span><span class="sxs-lookup"><span data-stu-id="a67d4-111">Firewalls are generally configured to block TCP traffic on all ports except for a few well-known entry points, so deploying an application that uses a non-standard port is often complicated or even impossible due to the presence of corporate and personal firewalls.</span></span> <span data-ttu-id="a67d4-112">Le applicazioni che possono comunicare su porte note standard, già consentite, riducono la superficie d'attacco esterna.</span><span class="sxs-lookup"><span data-stu-id="a67d4-112">Applications that can communicate over standard, well-known ports that are already permitted, reduce the external attack surface.</span></span> <span data-ttu-id="a67d4-113">Molte applicazioni di rete usano il protocollo HTTP, poiché la maggior parte dei firewall è configurata, per impostazione predefinita, per consentire il traffico sulla porta TCP 80.</span><span class="sxs-lookup"><span data-stu-id="a67d4-113">Many network applications make use of the HTTP protocol because most firewalls are configured by default to allow traffic on TCP port 80.</span></span>  
  
 <span data-ttu-id="a67d4-114">Il modello HTTP.SYS, in cui il traffico per molte applicazioni HTTP diverse viene reso multiplex su una sola porta TCP, è diventato lo standard sulla piattaforma Windows.</span><span class="sxs-lookup"><span data-stu-id="a67d4-114">The HTTP.SYS model in which traffic for many different HTTP applications is multiplexed onto a single TCP port has become standard on the Windows platform.</span></span> <span data-ttu-id="a67d4-115">Questo offre un punto di controllo comune per gli amministratori dei firewall, consentendo al contempo agli sviluppatori di applicazioni di ridurre al minimo i costi di distribuzione associati alla creazione di nuove applicazioni che possono fare uso della rete.</span><span class="sxs-lookup"><span data-stu-id="a67d4-115">This provides a common point of control for firewall administrators while allowing application developers to minimize the deployment cost of building new applications that can make use of the network.</span></span>  
  
 <span data-ttu-id="a67d4-116">La possibilità di condividere porte tra più applicazioni HTTP caratterizza da molto tempo Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="a67d4-116">The ability to share ports across multiple HTTP applications has long been a feature of Internet Information Services (IIS).</span></span> <span data-ttu-id="a67d4-117">Tuttavia, era solo con l'introduzione del protocollo HTTP. SYS (il listener del protocollo HTTP in modalità kernel) con IIS 6,0 che questa infrastruttura è stata completamente generalizzata.</span><span class="sxs-lookup"><span data-stu-id="a67d4-117">However, it was only with the introduction of HTTP.SYS (the kernel-mode HTTP protocol listener) with IIS 6.0 that this infrastructure was fully generalized.</span></span> <span data-ttu-id="a67d4-118">In effetti, HTTP.SYS consente a processi utente arbitrari di condividere le porte TCP dedicate al traffico HTTP.</span><span class="sxs-lookup"><span data-stu-id="a67d4-118">In effect, HTTP.SYS allows arbitrary user processes to share the TCP ports dedicated to HTTP traffic.</span></span> <span data-ttu-id="a67d4-119">Questa capacità consente a molte applicazioni HTTP di coesistere sullo stesso computer fisico in processi isolati, distinti e nel contempo condividere l'infrastruttura di rete richiesta per inviare e ricevere il traffico su TCP sulla porta 80.</span><span class="sxs-lookup"><span data-stu-id="a67d4-119">This capability allows many HTTP applications to coexist on the same physical machine in separate, isolated processes while sharing the network infrastructure required to send and receive traffic over TCP port 80.</span></span> <span data-ttu-id="a67d4-120">Il Servizio di condivisione porte Net.TCP consente alle applicazioni net.tcp di condividere lo stesso tipo di porta.</span><span class="sxs-lookup"><span data-stu-id="a67d4-120">The Net.TCP Port Sharing Service enables the same type of port sharing for net.tcp applications.</span></span>  
  
## <a name="port-sharing-architecture"></a><span data-ttu-id="a67d4-121">Architettura di condivisione delle porte</span><span class="sxs-lookup"><span data-stu-id="a67d4-121">Port Sharing Architecture</span></span>  
 <span data-ttu-id="a67d4-122">L'architettura di condivisione delle porte in WCF è costituita da tre componenti principali:</span><span class="sxs-lookup"><span data-stu-id="a67d4-122">The Port Sharing architecture in WCF has three main components:</span></span>  
  
- <span data-ttu-id="a67d4-123">Un processo di lavoro: qualsiasi processo che comunica su net.tcp:// usando porte condivise.</span><span class="sxs-lookup"><span data-stu-id="a67d4-123">A Worker Process: Any process communicating over net.tcp:// using shared ports.</span></span>  
  
- <span data-ttu-id="a67d4-124">Il trasporto TCP WCF: implementa il protocollo net. TCP://.</span><span class="sxs-lookup"><span data-stu-id="a67d4-124">The WCF TCP transport: Implements the net.tcp:// protocol.</span></span>  
  
- <span data-ttu-id="a67d4-125">Il Servizio di condivisione porte Net.TCP: consente a molti processi di lavoro di condividere la stessa porta TCP.</span><span class="sxs-lookup"><span data-stu-id="a67d4-125">The Net.TCP Port Sharing Service: Allows many worker processes to share the same TCP port.</span></span>  
  
 <span data-ttu-id="a67d4-126">Il Servizio di condivisione porte Net.TCP è un servizio Windows in modalità utente che accetta connessioni net.tcp:// per conto dei processi di lavoro che stabiliscono connessioni tramite esso.</span><span class="sxs-lookup"><span data-stu-id="a67d4-126">The Net.TCP Port Sharing Service is a user-mode Windows service that accepts net.tcp:// connections on behalf of the worker processes that connect through it.</span></span> <span data-ttu-id="a67d4-127">Quando arriva una connessione socket, il servizio di condivisione delle porte esamina il flusso di messaggi in ingresso per ottenerne l'indirizzo di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a67d4-127">When a socket connection arrives, the port sharing service inspects the incoming message stream to obtain its destination address.</span></span> <span data-ttu-id="a67d4-128">In base a questo indirizzo, il servizio di condivisione delle porte può instradare il flusso di dati all'applicazione che in definitiva lo elaborerà.</span><span class="sxs-lookup"><span data-stu-id="a67d4-128">Based on this address, the port sharing service can route the data stream to the application that ultimately processes it.</span></span>  
  
 <span data-ttu-id="a67d4-129">Quando si apre un servizio WCF che usa la condivisione delle porte net. TCP://, l'infrastruttura di trasporto TCP WCF non apre direttamente un socket TCP nel processo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a67d4-129">When a WCF service that uses net.tcp:// port sharing opens, the WCF TCP transport infrastructure does not directly open a TCP socket in the application process.</span></span> <span data-ttu-id="a67d4-130">Registra, invece, l'URI (Uniform Resource Identifier) dell'indirizzo di base del servizio presso il Servizio di condivisione porte Net.TCP e attende che quest'ultimo ascolti i messaggi per suo conto.</span><span class="sxs-lookup"><span data-stu-id="a67d4-130">Instead, the transport infrastructure registers the service’s base address Uniform Resource Identifier (URI) with the Net.TCP Port Sharing Service and waits for the port sharing service to listen for messages on its behalf.</span></span>  <span data-ttu-id="a67d4-131">Il servizio di condivisione delle porte invia i messaggi indirizzati al servizio dell'applicazione non appena arrivano.</span><span class="sxs-lookup"><span data-stu-id="a67d4-131">The port sharing service dispatches messages addressed to the application service as they arrive.</span></span>  
  
## <a name="installing-port-sharing"></a><span data-ttu-id="a67d4-132">Installazione della condivisione delle porte</span><span class="sxs-lookup"><span data-stu-id="a67d4-132">Installing Port Sharing</span></span>  
 <span data-ttu-id="a67d4-133">Il servizio di condivisione porte net. TCP è disponibile in tutti i sistemi operativi che supportano WinFX, ma il servizio non è abilitato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a67d4-133">The Net.TCP Port Sharing Service is available on all operating systems that support WinFX, but the service is not enabled by default.</span></span> <span data-ttu-id="a67d4-134">Per motivi di sicurezza, gli amministratori devono attivare manualmente il Servizio di condivisione porte Net.TCP al primo utilizzo.</span><span class="sxs-lookup"><span data-stu-id="a67d4-134">As a security precaution, an administrator must manually enable the Net.TCP Port Sharing Service prior to first use.</span></span> <span data-ttu-id="a67d4-135">Il Servizio di condivisione porte Net.TCP espone opzioni di configurazione che consentono di modificare diverse caratteristiche dei socket di rete appartenenti al servizio stesso.</span><span class="sxs-lookup"><span data-stu-id="a67d4-135">The Net.TCP Port Sharing Service exposes configuration options that allow you to manipulate several characteristics of the network sockets owned by the port sharing service.</span></span> <span data-ttu-id="a67d4-136">Per altre informazioni, vedere [procedura: abilitare il servizio di condivisione porte net. TCP](how-to-enable-the-net-tcp-port-sharing-service.md).</span><span class="sxs-lookup"><span data-stu-id="a67d4-136">For more information, see [How to: Enable the Net.TCP Port Sharing Service](how-to-enable-the-net-tcp-port-sharing-service.md).</span></span>  
  
## <a name="using-nettcp-port-sharing-in-an-application"></a><span data-ttu-id="a67d4-137">Utilizzo della condivisione delle porte Net.tcp in un'applicazione</span><span class="sxs-lookup"><span data-stu-id="a67d4-137">Using Net.tcp Port Sharing in an Application</span></span>  
 <span data-ttu-id="a67d4-138">Il modo più semplice per utilizzare la condivisione delle porte net. TCP://nell'applicazione WCF consiste nell'esporre un servizio utilizzando <xref:System.ServiceModel.NetTcpBinding> e quindi abilitare il servizio di condivisione delle porte net. TCP utilizzando la <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> Proprietà.</span><span class="sxs-lookup"><span data-stu-id="a67d4-138">The easiest way to use net.tcp:// port sharing in your WCF application is to expose a service using the <xref:System.ServiceModel.NetTcpBinding> and then to enable Net.TCP Port Sharing Service using the <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> property.</span></span>  
  
 <span data-ttu-id="a67d4-139">Per altre informazioni su come eseguire questa operazione, vedere [procedura: configurare un servizio WCF per l'uso della condivisione delle porte](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span><span class="sxs-lookup"><span data-stu-id="a67d4-139">For more information about how to do this, see [How to: Configure a WCF Service to Use Port Sharing](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span></span>  
  
## <a name="security-implications-of-port-sharing"></a><span data-ttu-id="a67d4-140">Implicazioni di sicurezza della condivisione delle porte</span><span class="sxs-lookup"><span data-stu-id="a67d4-140">Security Implications of Port Sharing</span></span>  
 <span data-ttu-id="a67d4-141">Sebbene il Servizio di condivisione porte Net.TCP preveda un livello di elaborazione tra le applicazioni e la rete, le applicazioni che usano la condivisione delle porte dovrebbero comunque essere protette come se fossero direttamente in ascolto sulla rete.</span><span class="sxs-lookup"><span data-stu-id="a67d4-141">Although the Net.TCP Port Sharing Service provides a layer of processing between applications and the network, applications that use port sharing should still be secured as if they were directly listening on the network.</span></span> <span data-ttu-id="a67d4-142">In particolare, le applicazioni che usano la condivisione delle porte dovrebbero valutare i privilegi del processo con cui vengono eseguite.</span><span class="sxs-lookup"><span data-stu-id="a67d4-142">Specifically, applications that use port sharing should evaluate the process privileges under which they run.</span></span> <span data-ttu-id="a67d4-143">Considerare l'ipotesi di eseguire l'applicazione usando l'account predefinito Servizio di rete, che viene eseguito con il set minimo di privilegi del processo necessari per la comunicazione di rete.</span><span class="sxs-lookup"><span data-stu-id="a67d4-143">Consider running your application using the built-in Network Service account, which runs with the minimal set of process privileges required for network communication.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a67d4-144">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a67d4-144">See also</span></span>

- [<span data-ttu-id="a67d4-145">Configurazione del servizio di condivisione delle porte Net.TCP</span><span class="sxs-lookup"><span data-stu-id="a67d4-145">Configuring the Net.TCP Port Sharing Service</span></span>](configuring-the-net-tcp-port-sharing-service.md)
- [<span data-ttu-id="a67d4-146">Hosting</span><span class="sxs-lookup"><span data-stu-id="a67d4-146">Hosting</span></span>](hosting.md)
- [<span data-ttu-id="a67d4-147">Procedura: configurare un servizio WCF per l'uso della condivisione delle porte</span><span class="sxs-lookup"><span data-stu-id="a67d4-147">How to: Configure a WCF Service to Use Port Sharing</span></span>](how-to-configure-a-wcf-service-to-use-port-sharing.md)
- [<span data-ttu-id="a67d4-148">Procedura: attivare il servizio di condivisione delle porte Net.TCP</span><span class="sxs-lookup"><span data-stu-id="a67d4-148">How to: Enable the Net.TCP Port Sharing Service</span></span>](how-to-enable-the-net-tcp-port-sharing-service.md)
