---
title: Sessioni, istanze e concorrenza
ms.date: 03/30/2017
ms.assetid: 50797a3b-7678-44ed-8138-49ac1602f35b
ms.openlocfilehash: 19dedddadad2f27acdeeaceb2c186a731fa79c32
ms.sourcegitcommit: 7980a91f90ae5eca859db7e6bfa03e23e76a1a50
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/13/2020
ms.locfileid: "81243115"
---
# <a name="sessions-instancing-and-concurrency"></a><span data-ttu-id="4e6a5-102">Sessioni, istanze e concorrenza</span><span class="sxs-lookup"><span data-stu-id="4e6a5-102">Sessions, Instancing, and Concurrency</span></span>
<span data-ttu-id="4e6a5-103">Una *sessione* è una correlazione di tutti i messaggi inviati tra due endpoint.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-103">A *session* is a correlation of all messages sent between two endpoints.</span></span> <span data-ttu-id="4e6a5-104">La*creazione di istanze* fa riferimento al controllo della durata di oggetti servizio definiti dall'utente e di oggetti <xref:System.ServiceModel.InstanceContext> correlati.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-104">*Instancing* refers to controlling the lifetime of user-defined service objects and their related <xref:System.ServiceModel.InstanceContext> objects.</span></span> <span data-ttu-id="4e6a5-105">La*concorrenza* è il termine dato al controllo del numero di thread in esecuzione contemporaneamente in un <xref:System.ServiceModel.InstanceContext> .</span><span class="sxs-lookup"><span data-stu-id="4e6a5-105">*Concurrency* is the term given to the control of the number of threads executing in an <xref:System.ServiceModel.InstanceContext> at the same time.</span></span>  
  
 <span data-ttu-id="4e6a5-106">In questo argomento vengono descritte tali impostazioni, come utilizzarle e le varie interazioni tra di esse.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-106">This topic describes these settings, how to use them, and the various interactions between them.</span></span>  
  
## <a name="sessions"></a><span data-ttu-id="4e6a5-107">Sessioni</span><span class="sxs-lookup"><span data-stu-id="4e6a5-107">Sessions</span></span>  
 <span data-ttu-id="4e6a5-108">Quando la proprietà <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> viene impostata da un contratto di servizio su <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, tutte le chiamate, ovvero gli scambi di messaggi sottostanti che supportano le chiamate, devono essere parte della stessa conversazione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-108">When a service contract sets the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, that contract is saying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="4e6a5-109">Se un contratto consente sessioni ma non ne richiede, i client possono connettersi e possono stabilire o meno una sessione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-109">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not.</span></span> <span data-ttu-id="4e6a5-110">Se, al termine della sessione, un messaggio viene inviato sullo stesso canale basato sulla sessione, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-110">If the session ends and a message is sent over the same session-based channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="4e6a5-111">Le sessioni WCF hanno le seguenti funzionalità concettuali principali:</span><span class="sxs-lookup"><span data-stu-id="4e6a5-111">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="4e6a5-112">Vengono avviate e terminate esplicitamente dall'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-112">They are explicitly initiated and terminated by the calling application.</span></span>  
  
- <span data-ttu-id="4e6a5-113">I messaggi recapitati durante una sessione vengono elaborati nell'ordine in cui vengono ricevuti.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-113">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="4e6a5-114">Le sessioni consentono di correlare un gruppo di messaggi in una conversazione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-114">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="4e6a5-115">Il significato di tale correlazione è un'astrazione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-115">The meaning of that correlation is an abstraction.</span></span> <span data-ttu-id="4e6a5-116">Un canale basato sulla sessione, ad esempio, è in grado di correlare messaggi basati su una connessione di rete condivisa mentre un altro canale basato sulla sessione è in grado di correlare messaggi basati su un tag condiviso nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-116">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="4e6a5-117">Le funzionalità che possono derivare dalla sessione dipendono dalla natura della correlazione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-117">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="4e6a5-118">Non esiste un archivio dati generale associato a una sessione WCF.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-118">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="4e6a5-119">Se si ha <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> familiarità con la classe in ASP.NET applicazioni e le funzionalità che fornisce, è possibile notare le seguenti differenze tra quel tipo di sessione e sessioni WCF:</span><span class="sxs-lookup"><span data-stu-id="4e6a5-119">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="4e6a5-120">ASP.NET sessioni vengono sempre avviate dal server.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-120">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="4e6a5-121">ASP.NET le sessioni non sono ordinate in modo implicito.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-121">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="4e6a5-122">ASP.NET sessioni forniscono un meccanismo generale di archiviazione dei dati tra le richieste.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-122">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="4e6a5-123">Le applicazioni client e le applicazioni di servizio interagiscono con le sessioni in modi diversi.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-123">Client applications and service applications interact with sessions in different ways.</span></span> <span data-ttu-id="4e6a5-124">Le applicazioni client avviano sessioni e quindi ricevono ed elaborano i messaggi inviati all'interno della sessione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-124">Client applications initiate sessions and then receive and process the messages sent within the session.</span></span> <span data-ttu-id="4e6a5-125">Le applicazioni di servizio possono utilizzare le sessioni come punto di estensibilità per aggiungere comportamenti.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-125">Service applications can use sessions as an extensibility point to add additional behavior.</span></span> <span data-ttu-id="4e6a5-126">Ciò si ottiene utilizzando direttamente <xref:System.ServiceModel.InstanceContext> o implementando un provider di contesto dell'istanza personalizzato.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-126">This is done by working directly with the <xref:System.ServiceModel.InstanceContext> or implementing a custom instance context provider.</span></span>  
  
## <a name="instancing"></a><span data-ttu-id="4e6a5-127">creazione di istanze</span><span class="sxs-lookup"><span data-stu-id="4e6a5-127">Instancing</span></span>  
 <span data-ttu-id="4e6a5-128">Il comportamento delle istanze (impostato tramite la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> ) consente di controllare come viene creato <xref:System.ServiceModel.InstanceContext> in risposta ai messaggi in ingresso.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-128">The instancing behavior (set by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property) controls how the <xref:System.ServiceModel.InstanceContext> is created in response to incoming messages.</span></span> <span data-ttu-id="4e6a5-129">Per impostazione predefinita, ogni <xref:System.ServiceModel.InstanceContext> viene associato a uno oggetto servizio definito dall'utente. In questo modo l'impostazione (nel caso predefinito) della proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> consente di controllare anche le istanze di oggetti servizio definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-129">By default, each <xref:System.ServiceModel.InstanceContext> is associated with one user-defined service object, so (in the default case) setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property also controls the instancing of user-defined service objects.</span></span> <span data-ttu-id="4e6a5-130">L'enumerazione <xref:System.ServiceModel.InstanceContextMode> definisce le modalità di istanza.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-130">The <xref:System.ServiceModel.InstanceContextMode> enumeration defines the instancing modes.</span></span>  
  
 <span data-ttu-id="4e6a5-131">Sono disponibili le modalità di istanza seguenti:</span><span class="sxs-lookup"><span data-stu-id="4e6a5-131">The following instancing modes are available:</span></span>  
  
- <span data-ttu-id="4e6a5-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: viene creato un nuovo <xref:System.ServiceModel.InstanceContext> (e di conseguenza l'oggetto servizio) per ogni richiesta client.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each client request.</span></span>  
  
- <span data-ttu-id="4e6a5-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: viene creato un nuovo <xref:System.ServiceModel.InstanceContext> (e di conseguenza l'oggetto servizio) per ogni sessione client nuova e viene mantenuto per la durata di quella sessione (è necessaria un'associazione che supporti sessioni).</span><span class="sxs-lookup"><span data-stu-id="4e6a5-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each new client session and maintained for the lifetime of that session (this requires a binding that supports sessions).</span></span>  
  
- <span data-ttu-id="4e6a5-134"><xref:System.ServiceModel.InstanceContextMode.Single>: un unico <xref:System.ServiceModel.InstanceContext> (e di conseguenza l'oggetto servizio) gestisce tutte le richieste client per la durata dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-134"><xref:System.ServiceModel.InstanceContextMode.Single>: A single <xref:System.ServiceModel.InstanceContext> (and therefore service object) handles all client requests for the lifetime of the application.</span></span>  
  
 <span data-ttu-id="4e6a5-135">Nell'esempio di codice seguente viene illustrato il valore <xref:System.ServiceModel.InstanceContextMode> predefinito, con <xref:System.ServiceModel.InstanceContextMode.PerSession> impostato esplicitamente su una classe del servizio.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-135">The following code example shows the default <xref:System.ServiceModel.InstanceContextMode> value, <xref:System.ServiceModel.InstanceContextMode.PerSession> being explicitly set on a service class.</span></span>  
  
```csharp  
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession)]
public class CalculatorService : ICalculatorInstance
{
    ...  
}  
```  
  
 <span data-ttu-id="4e6a5-136">Mentre la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> consente di controllare la frequenza di rilascio di <xref:System.ServiceModel.InstanceContext> , le proprietà <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> e <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> consentono di controllare quando l'oggetto servizio viene rilasciato.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-136">And while the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property controls how often the <xref:System.ServiceModel.InstanceContext> is released, the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> and <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> properties control when the service object is released.</span></span>  
  
### <a name="well-known-singleton-services"></a><span data-ttu-id="4e6a5-137">Servizi Singleton noti</span><span class="sxs-lookup"><span data-stu-id="4e6a5-137">Well-Known Singleton Services</span></span>  
 <span data-ttu-id="4e6a5-138">Una variazione su oggetti servizio di una singola istanza può a volte essere utile. È infatti possibile creare un oggetto servizio e quindi creare l'host del servizio tramite quell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-138">One variation on single instance service objects is sometimes useful: you can create a service object yourself and create the service host using that object.</span></span> <span data-ttu-id="4e6a5-139">A tale scopo, è necessario impostare la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> su <xref:System.ServiceModel.InstanceContextMode.Single> , in caso contrario verrà generata un'eccezione quando l'host del servizio viene aperto.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-139">To do so, you must also set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.Single> or an exception is thrown when the service host is opened.</span></span>  
  
 <span data-ttu-id="4e6a5-140">Utilizzare il costruttore <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29> per creare tale servizio.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-140">Use the <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29> constructor to create such a service.</span></span> <span data-ttu-id="4e6a5-141">Fornisce un'alternativa all'implementazione di un'interfaccia <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> personalizzata quando si desidera fornire un'istanza specifica dell'oggetto utilizzabile da un servizio singleton.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-141">It provides an alternative to implementing a custom <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> when you wish to provide a specific object instance for use by a singleton service.</span></span> <span data-ttu-id="4e6a5-142">È possibile utilizzare questo overload quando il tipo di implementazione del servizio è difficile da costruire (ad esempio, se non implementa un costruttore pubblico senza parametri).</span><span class="sxs-lookup"><span data-stu-id="4e6a5-142">You can use this overload when your service implementation type is difficult to construct (for example, if it does not implement a parameterless public constructor).</span></span>  
  
 <span data-ttu-id="4e6a5-143">Si noti che quando un oggetto viene fornito a questo costruttore, alcune funzionalità correlate al comportamento di creazione di istanze di Windows Communication Foundation (WCF) funzionano in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-143">Note that when an object is provided to this constructor, some features related to the Windows Communication Foundation (WCF) instancing behavior work differently.</span></span> <span data-ttu-id="4e6a5-144">La chiamata, ad esempio, di <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> non ha effetto quando viene fornita l'istanza di un oggetto Singleton.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-144">For example, calling <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> has no effect when a singleton object instance is provided.</span></span> <span data-ttu-id="4e6a5-145">Analogamente, qualsiasi altro meccanismo di rilascio delle istanze viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-145">Similarly, any other instance-release mechanism is ignored.</span></span> <span data-ttu-id="4e6a5-146">L'host <xref:System.ServiceModel.ServiceHost> si comporta sempre come se la proprietà <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> fosse impostata su <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> per tutte le operazioni.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-146">The <xref:System.ServiceModel.ServiceHost> always behaves as if the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> for all operations.</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="4e6a5-147">Condivisione di oggetti InstanceContext</span><span class="sxs-lookup"><span data-stu-id="4e6a5-147">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="4e6a5-148">È inoltre possibile controllare l'associazione tra canali o chiamate con sessione e oggetti <xref:System.ServiceModel.InstanceContext> eseguendo quell'associazione.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-148">You can also control which sessionful channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>  
  
## <a name="concurrency"></a><span data-ttu-id="4e6a5-149">Concorrenza</span><span class="sxs-lookup"><span data-stu-id="4e6a5-149">Concurrency</span></span>  
 <span data-ttu-id="4e6a5-150">La concorrenza è il controllo del numero di thread attivi in un <xref:System.ServiceModel.InstanceContext> contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-150">Concurrency is the control of the number of threads active in an <xref:System.ServiceModel.InstanceContext> at any one time.</span></span> <span data-ttu-id="4e6a5-151">Viene controllato tramite <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> con l'enumerazione <xref:System.ServiceModel.ConcurrencyMode> .</span><span class="sxs-lookup"><span data-stu-id="4e6a5-151">This is controlled by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> with the <xref:System.ServiceModel.ConcurrencyMode> enumeration.</span></span>  
  
 <span data-ttu-id="4e6a5-152">Sono disponibili le tre modalità di concorrenza seguenti:</span><span class="sxs-lookup"><span data-stu-id="4e6a5-152">The following three concurrency modes are available:</span></span>  
  
- <span data-ttu-id="4e6a5-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: ogni contesto dell'istanza può avere al massimo un thread alla volta per l'elaborazione dei messaggi nel contesto dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Each instance context is allowed to have a maximum of one thread processing messages in the instance context at a time.</span></span> <span data-ttu-id="4e6a5-154">Altri thread che devono utilizzare lo stesso contesto dell'istanza, devono restare bloccati fino alla chiusura del thread originale dal contesto dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-154">Other threads wishing to use the same instance context must block until the original thread exits the instance context.</span></span>  
  
- <span data-ttu-id="4e6a5-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: ogni istanza del servizio può avere contemporaneamente più thread per l'elaborazione messaggi.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Each service instance can have multiple threads processing messages concurrently.</span></span> <span data-ttu-id="4e6a5-156">Per essere in grado di usare questa modalità di concorrenza, l'implementazione del servizio deve essere thread-safe.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-156">The service implementation must be thread-safe to use this concurrency mode.</span></span>  
  
- <span data-ttu-id="4e6a5-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: ogni istanza del servizio elabora un messaggio alla volta ma accetta chiamate di operazioni rientranti.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Each service instance processes one message at a time, but accepts re-entrant operation calls.</span></span> <span data-ttu-id="4e6a5-158">Il servizio accetta queste chiamate solo quando chiama tramite un oggetto client WCF.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-158">The service only accepts these calls when it is calling out through a WCF client object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4e6a5-159">Può essere difficile comprendere, scrivere correttamente e sviluppare codice che utilizza in modo sicuro più di un thread.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-159">Understanding and developing code that safely uses more than one thread can be difficult to write successfully.</span></span> <span data-ttu-id="4e6a5-160">Prima di utilizzare valori <xref:System.ServiceModel.ConcurrencyMode.Multiple> o <xref:System.ServiceModel.ConcurrencyMode.Reentrant> , verificare che il servizio sia progettato correttamente per queste modalità.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-160">Before using <xref:System.ServiceModel.ConcurrencyMode.Multiple> or <xref:System.ServiceModel.ConcurrencyMode.Reentrant> values, ensure that your service is properly designed for these modes.</span></span> <span data-ttu-id="4e6a5-161">Per altre informazioni, vedere <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-161">For more information, see <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span></span>  
  
 <span data-ttu-id="4e6a5-162">L'uso della concorrenza è correlato alla modalità di istanza.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-162">The use of concurrency is related to the instancing mode.</span></span> <span data-ttu-id="4e6a5-163">In <xref:System.ServiceModel.InstanceContextMode.PerCall> istanze, la <xref:System.ServiceModel.InstanceContext> <xref:System.ServiceModel.InstanceContext>concorrenza non è rilevante, perché ogni messaggio viene elaborato da un nuovo e, pertanto, mai più di un thread è attivo nel .</span><span class="sxs-lookup"><span data-stu-id="4e6a5-163">In <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, concurrency is not relevant, because each message is processed by a new <xref:System.ServiceModel.InstanceContext> and, therefore, never more than one thread is active in the <xref:System.ServiceModel.InstanceContext>.</span></span>  
  
 <span data-ttu-id="4e6a5-164">Nell'esempio di codice seguente viene illustrata l'impostazione della proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> su <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-164">The following code example demonstrates setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> property to <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span></span>  
  
```csharp
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]
public class CalculatorService : ICalculatorConcurrency
{
    ...  
}  
```  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="4e6a5-165">Sessioni che interagiscono con impostazioni InstanceContext</span><span class="sxs-lookup"><span data-stu-id="4e6a5-165">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="4e6a5-166">L'interazione di sessioni e di <xref:System.ServiceModel.InstanceContext> , che dipendono dalla combinazione tra il valore dell'enumerazione <xref:System.ServiceModel.SessionMode> in un contratto e la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> nell'implementazione del servizio, consente di controllare l'associazione tra canali e oggetti servizio specifici.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-166">Sessions and <xref:System.ServiceModel.InstanceContext> interact depending upon the combination of the value of the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property on the service implementation, which controls the association between channels and specific service objects.</span></span>  
  
 <span data-ttu-id="4e6a5-167">Nella tabella seguente viene mostrato il risultato di un canale in ingresso in cui le sessioni sono supportate o non supportate. Tale risultato è in funzione della combinazione dei valori delle proprietà <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> e <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> del servizio.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-167">The following table shows the result of an incoming channel either supporting sessions or not supporting sessions given a service's combination of the values of the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property.</span></span>  
  
|<span data-ttu-id="4e6a5-168">Valore InstanceContextMode</span><span class="sxs-lookup"><span data-stu-id="4e6a5-168">InstanceContextMode value</span></span>|<xref:System.ServiceModel.SessionMode.Required>|<xref:System.ServiceModel.SessionMode.Allowed>|<xref:System.ServiceModel.SessionMode.NotAllowed>|  
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="4e6a5-169">PerCall</span><span class="sxs-lookup"><span data-stu-id="4e6a5-169">PerCall</span></span>|<span data-ttu-id="4e6a5-170">- Comportamento con canale sessione: <xref:System.ServiceModel.InstanceContext> una sessione e per ogni chiamata.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-170">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="4e6a5-171">- Comportamento con canale senza sessione: viene generata un'eccezione.- Behavior with sessionless channel: An exception is thrown.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-171">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="4e6a5-172">- Comportamento con canale sessione: <xref:System.ServiceModel.InstanceContext> una sessione e per ogni chiamata.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-172">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="4e6a5-173">- Comportamento con canale <xref:System.ServiceModel.InstanceContext> senza sessione: un per ogni chiamata.- Behavior with sessionless channel: An for each call.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-173">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="4e6a5-174">- Comportamento con canale con sessione: viene generata un'eccezione.- Behavior with sessionful channel: An exception is thrown.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-174">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="4e6a5-175">- Comportamento con canale <xref:System.ServiceModel.InstanceContext> senza sessione: un per ogni chiamata.- Behavior with sessionless channel: An for each call.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-175">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="4e6a5-176">PerSession</span><span class="sxs-lookup"><span data-stu-id="4e6a5-176">PerSession</span></span>|<span data-ttu-id="4e6a5-177">- Comportamento con canale sessione: <xref:System.ServiceModel.InstanceContext> una sessione e per ogni canale.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-177">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="4e6a5-178">- Comportamento con canale senza sessione: viene generata un'eccezione.- Behavior with sessionless channel: An exception is thrown.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-178">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="4e6a5-179">- Comportamento con canale sessione: <xref:System.ServiceModel.InstanceContext> una sessione e per ogni canale.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-179">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="4e6a5-180">- Comportamento con canale <xref:System.ServiceModel.InstanceContext> senza sessione: un per ogni chiamata.- Behavior with sessionless channel: An for each call.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-180">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="4e6a5-181">- Comportamento con canale con sessione: viene generata un'eccezione.- Behavior with sessionful channel: An exception is thrown.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-181">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="4e6a5-182">- Comportamento con canale <xref:System.ServiceModel.InstanceContext> senza sessione: un per ogni chiamata.- Behavior with sessionless channel: An for each call.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-182">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="4e6a5-183">Single</span><span class="sxs-lookup"><span data-stu-id="4e6a5-183">Single</span></span>|<span data-ttu-id="4e6a5-184">- Comportamento con canale sessione: <xref:System.ServiceModel.InstanceContext> una sessione e una per tutte le chiamate.- Behavior with sessionful channel: A session and one for all calls.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-184">-   Behavior with sessionful channel: A session and one <xref:System.ServiceModel.InstanceContext> for all calls.</span></span><br /><span data-ttu-id="4e6a5-185">- Comportamento con canale senza sessione: viene generata un'eccezione.- Behavior with sessionless channel: An exception is thrown.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-185">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="4e6a5-186">- Comportamento con canale con <xref:System.ServiceModel.InstanceContext> sessione: una sessione e per il singleton creato o specificato dall'utente.- Behavior with sessionful channel: A session and for the created or user-specified singleton.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-186">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span><br /><span data-ttu-id="4e6a5-187">- Comportamento con canale <xref:System.ServiceModel.InstanceContext> senza sessione: un singleton creato o specificato dall'utente.- Behavior with sessionless channel: An for the created or user-specified singleton.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-187">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span>|<span data-ttu-id="4e6a5-188">- Comportamento con canale con sessione: viene generata un'eccezione.- Behavior with sessionful channel: An exception is thrown.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-188">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="4e6a5-189">- Comportamento con canale <xref:System.ServiceModel.InstanceContext> senza sessione: un singleton creato per ogni singleton creato o per il singleton specificato dall'utente.- Behavior with sessionless channel: An for each created singleton or for the user-specified singleton.</span><span class="sxs-lookup"><span data-stu-id="4e6a5-189">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each created singleton or for the user-specified singleton.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4e6a5-190">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4e6a5-190">See also</span></span>

- [<span data-ttu-id="4e6a5-191">Uso di sessioni</span><span class="sxs-lookup"><span data-stu-id="4e6a5-191">Using Sessions</span></span>](../../../../docs/framework/wcf/using-sessions.md)
- [<span data-ttu-id="4e6a5-192">Procedura: creare un servizio che richiede sessioni</span><span class="sxs-lookup"><span data-stu-id="4e6a5-192">How to: Create a Service That Requires Sessions</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md)
- [<span data-ttu-id="4e6a5-193">Procedura: Controllare le istanze del servizio</span><span class="sxs-lookup"><span data-stu-id="4e6a5-193">How to: Control Service Instancing</span></span>](../../../../docs/framework/wcf/feature-details/how-to-control-service-instancing.md)
- [<span data-ttu-id="4e6a5-194">Concorrenza</span><span class="sxs-lookup"><span data-stu-id="4e6a5-194">Concurrency</span></span>](../../../../docs/framework/wcf/samples/concurrency.md)
- [<span data-ttu-id="4e6a5-195">Creazione di istanze</span><span class="sxs-lookup"><span data-stu-id="4e6a5-195">Instancing</span></span>](../../../../docs/framework/wcf/samples/instancing.md)
- [<span data-ttu-id="4e6a5-196">sessione</span><span class="sxs-lookup"><span data-stu-id="4e6a5-196">Session</span></span>](../../../../docs/framework/wcf/samples/session.md)
