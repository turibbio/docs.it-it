---
title: Programmazione delle funzionalità di sicurezza di WCF
description: Informazioni su come creare un'applicazione WCF sicura, tra cui l'autenticazione, la riservatezza e l'integrità.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- message security [WCF], programming overview
ms.assetid: 739ec222-4eda-4cc9-a470-67e64a7a3f10
ms.openlocfilehash: 8e77c667dd8904c10bbab88e1413690677cef53b
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/23/2020
ms.locfileid: "85244985"
---
# <a name="programming-wcf-security"></a><span data-ttu-id="3965f-103">Programmazione delle funzionalità di sicurezza di WCF</span><span class="sxs-lookup"><span data-stu-id="3965f-103">Programming WCF Security</span></span>
<span data-ttu-id="3965f-104">In questo argomento vengono descritte le attività di programmazione fondamentali utilizzate per creare un'applicazione Secure Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="3965f-104">This topic describes the fundamental programming tasks used to create a secure Windows Communication Foundation (WCF) application.</span></span> <span data-ttu-id="3965f-105">Questo argomento descrive solo l'autenticazione, la riservatezza e l'integrità, collettivamente nota come *protezione del trasferimento*.</span><span class="sxs-lookup"><span data-stu-id="3965f-105">This topic covers only authentication, confidentiality, and integrity, collectively known as *transfer security*.</span></span> <span data-ttu-id="3965f-106">In questo argomento non viene illustrata l'autorizzazione (controllo dell'accesso a risorse o servizi); per informazioni sull'autorizzazione, vedere [autorizzazione](authorization-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-106">This topic does not cover authorization (the control of access to resources or services); for information on authorization, see [Authorization](authorization-in-wcf.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3965f-107">Per un'introduzione importante ai concetti relativi alla sicurezza, in particolare per quanto riguarda WCF, vedere le esercitazioni sui modelli e sulle procedure in MSDN in [scenari, modelli e indicazioni sull'implementazione di WSE (Web Services Enhancements) 3,0](https://docs.microsoft.com/previous-versions/msp-n-p/ff648183(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="3965f-107">For a valuable introduction to security concepts, especially in regard to WCF, see the set of patterns and practices tutorials on MSDN at [Scenarios, Patterns, and Implementation Guidance for Web Services Enhancements (WSE) 3.0](https://docs.microsoft.com/previous-versions/msp-n-p/ff648183(v=pandp.10)).</span></span>  
  
 <span data-ttu-id="3965f-108">La programmazione della sicurezza WCF si basa su tre passaggi che configurano quanto segue: la modalità di sicurezza, un tipo di credenziale client e i valori delle credenziali.</span><span class="sxs-lookup"><span data-stu-id="3965f-108">Programming WCF security is based on three steps setting the following: the security mode, a client credential type, and the credential values.</span></span> <span data-ttu-id="3965f-109">Questi passaggi possono essere eseguiti in codice o in configurazione.</span><span class="sxs-lookup"><span data-stu-id="3965f-109">You can perform these steps either through code or configuration.</span></span>  
  
## <a name="setting-the-security-mode"></a><span data-ttu-id="3965f-110">Impostazione della modalità di sicurezza</span><span class="sxs-lookup"><span data-stu-id="3965f-110">Setting the Security Mode</span></span>  
 <span data-ttu-id="3965f-111">Di seguito vengono illustrati i passaggi generali per la programmazione con la modalità di sicurezza in WCF:</span><span class="sxs-lookup"><span data-stu-id="3965f-111">The following explains the general steps for programming with the security mode in WCF:</span></span>  
  
1. <span data-ttu-id="3965f-112">Scegliere fra le associazioni predefinite un'associazione appropriata ai requisiti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3965f-112">Select one of the predefined bindings appropriate to your application requirements.</span></span> <span data-ttu-id="3965f-113">Per un elenco delle opzioni di associazione, vedere [associazioni fornite dal sistema](../system-provided-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-113">For a list of the binding choices, see [System-Provided Bindings](../system-provided-bindings.md).</span></span> <span data-ttu-id="3965f-114">Per impostazione predefinita, quasi tutte le associazioni presentano un meccanismo di sicurezza abilitato.</span><span class="sxs-lookup"><span data-stu-id="3965f-114">By default, nearly every binding has security enabled.</span></span> <span data-ttu-id="3965f-115">L'unica eccezione è la <xref:System.ServiceModel.BasicHttpBinding> classe (mediante la configurazione, [\<basicHttpBinding>](../../configure-apps/file-schema/wcf/basichttpbinding.md) ).</span><span class="sxs-lookup"><span data-stu-id="3965f-115">The one exception is the <xref:System.ServiceModel.BasicHttpBinding> class (using configuration, the [\<basicHttpBinding>](../../configure-apps/file-schema/wcf/basichttpbinding.md)).</span></span>  
  
     <span data-ttu-id="3965f-116">L'associazione scelta determina il trasporto.</span><span class="sxs-lookup"><span data-stu-id="3965f-116">The binding you select determines the transport.</span></span> <span data-ttu-id="3965f-117">Ad esempio, l'associazione <xref:System.ServiceModel.WSHttpBinding> utilizza il protocollo HTTP come trasporto, mentre l'associazione <xref:System.ServiceModel.NetTcpBinding> utilizza il trasporto TCP.</span><span class="sxs-lookup"><span data-stu-id="3965f-117">For example, <xref:System.ServiceModel.WSHttpBinding> uses HTTP as the transport; <xref:System.ServiceModel.NetTcpBinding> uses TCP.</span></span>  
  
2. <span data-ttu-id="3965f-118">Selezionare per l'associazione una delle modalità di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="3965f-118">Select one of the security modes for the binding.</span></span> <span data-ttu-id="3965f-119">Si noti che l'insieme delle modalità fra cui è possibile scegliere dipende dall'associazione scelta.</span><span class="sxs-lookup"><span data-stu-id="3965f-119">Note that the binding you select determines the available mode choices.</span></span> <span data-ttu-id="3965f-120">Ad esempio, l'associazione <xref:System.ServiceModel.WSDualHttpBinding> non consente di scegliere la sicurezza a livello di trasporto.</span><span class="sxs-lookup"><span data-stu-id="3965f-120">For example, the <xref:System.ServiceModel.WSDualHttpBinding> does not allow transport security (it is not an option).</span></span> <span data-ttu-id="3965f-121">Analogamente, né l'associazione <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> né l'associazione <xref:System.ServiceModel.NetNamedPipeBinding> consentono di scegliere la sicurezza a livello di messaggio.</span><span class="sxs-lookup"><span data-stu-id="3965f-121">Similarly, neither the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> nor the <xref:System.ServiceModel.NetNamedPipeBinding> allows message security.</span></span>  
  
     <span data-ttu-id="3965f-122">Sono disponibili tre opzioni:</span><span class="sxs-lookup"><span data-stu-id="3965f-122">You have three choices:</span></span>  
  
    1. `Transport`  
  
         <span data-ttu-id="3965f-123">La sicurezza a livello di trasporto dipende dal meccanismo utilizzato dall'associazione scelta.</span><span class="sxs-lookup"><span data-stu-id="3965f-123">Transport security depends on the mechanism that the binding you have selected uses.</span></span> <span data-ttu-id="3965f-124">Ad esempio, se si utilizza l'associazione `WSHttpBinding`, il meccanismo di sicurezza è Secure Sockets Layer (SSL), che peraltro è anche il meccanismo del protocollo HTTPS.</span><span class="sxs-lookup"><span data-stu-id="3965f-124">For example, if you are using `WSHttpBinding` then the security mechanism is Secure Sockets Layer (SSL) (also the mechanism for the HTTPS protocol).</span></span> <span data-ttu-id="3965f-125">In generale, il vantaggio principale della sicurezza a livello di trasporto è che offre una buona velocità effettiva indipendentemente dal trasporto utilizzato.</span><span class="sxs-lookup"><span data-stu-id="3965f-125">Generally speaking, the main advantage of transport security is that it delivers good throughput no matter which transport you are using.</span></span> <span data-ttu-id="3965f-126">Tuttavia, tale tipo di sicurezza presenta due limiti. Anzitutto, il meccanismo di trasporto impone il tipo di credenziale utilizzato per autenticare un utente.</span><span class="sxs-lookup"><span data-stu-id="3965f-126">However, it does have two limitations: The first is that the transport mechanism dictates the credential type used to authenticate a user.</span></span> <span data-ttu-id="3965f-127">Di fatto ciò rappresenta uno svantaggio solo se un servizio deve garantire l'interoperabilità con altri servizi che richiedono vari tipi di credenziali.</span><span class="sxs-lookup"><span data-stu-id="3965f-127">This is a drawback only if a service needs to interoperate with other services that demand different types of credentials.</span></span> <span data-ttu-id="3965f-128">Inoltre, poiché la sicurezza non viene applicata a livello di messaggio, la sicurezza viene implementata in modo hop-by-hop anziché end-to-end.</span><span class="sxs-lookup"><span data-stu-id="3965f-128">The second is that, because the security is not applied at the message level, security is implemented in a hop-by-hop manner rather than end-to-end.</span></span> <span data-ttu-id="3965f-129">Questo secondo limite rappresenta un problema solo se il percorso dei messaggi fra client e servizio prevede intermediari.</span><span class="sxs-lookup"><span data-stu-id="3965f-129">This latter limitation is an issue only if the message path between client and service includes intermediaries.</span></span> <span data-ttu-id="3965f-130">Per ulteriori informazioni sul trasporto da utilizzare, vedere [scelta di un trasporto](choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-130">For more information about which transport to use, see [Choosing a Transport](choosing-a-transport.md).</span></span> <span data-ttu-id="3965f-131">Per altre informazioni sull'uso della sicurezza del trasporto, vedere [Panoramica della sicurezza del trasporto](transport-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-131">For more information about using transport security, see [Transport Security Overview](transport-security-overview.md).</span></span>  
  
    2. `Message`  
  
         <span data-ttu-id="3965f-132">Nella sicurezza a livello di messaggio, ogni messaggio contiene le intestazioni e i dati necessari a garantire la sicurezza del messaggio.</span><span class="sxs-lookup"><span data-stu-id="3965f-132">Message security means that every message includes the necessary headers and data to keep the message secure.</span></span> <span data-ttu-id="3965f-133">Poiché la composizione delle intestazioni è variabile, è possibile includere qualsiasi numero di credenziali.</span><span class="sxs-lookup"><span data-stu-id="3965f-133">Because the composition of the headers varies, you can include any number of credentials.</span></span> <span data-ttu-id="3965f-134">Ciò risulta essere un fattore rilevante se occorre interoperare con altri servizi che richiedono un tipo di credenziale specifico che un meccanismo di trasporto non è in grado di fornire, oppure se il messaggio deve essere utilizzato in più servizi, ognuno avente un requisito specifico di tipo di credenziale.</span><span class="sxs-lookup"><span data-stu-id="3965f-134">This becomes a factor if you are interoperating with other services that demand a specific credential type that a transport mechanism can't supply, or if the message must be used with more than one service, where each service demands a different credential type.</span></span>  
  
         <span data-ttu-id="3965f-135">Per ulteriori informazioni, vedere [sicurezza dei messaggi](message-security-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-135">For more information, see [Message Security](message-security-in-wcf.md).</span></span>  
  
    3. `TransportWithMessageCredential`  
  
         <span data-ttu-id="3965f-136">Questa scelta utilizza il livello di trasporto per proteggere il trasferimento dei messaggi, ognuno dei quali contiene le credenziali dettagliate richieste dagli altri servizi.</span><span class="sxs-lookup"><span data-stu-id="3965f-136">This choice uses the transport layer to secure the message transfer, while every message includes the rich credentials other services need.</span></span> <span data-ttu-id="3965f-137">Ciò combina il vantaggio in termini di prestazioni della sicurezza a livello di trasporto con il vantaggio delle credenziali dettagliate della sicurezza a livello di messaggio.</span><span class="sxs-lookup"><span data-stu-id="3965f-137">This combines the performance advantage of transport security with the rich credentials advantage of message security.</span></span> <span data-ttu-id="3965f-138">Questa opzione è disponibile per le associazioni seguenti: <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.WSFederationHttpBinding>, <xref:System.ServiceModel.NetPeerTcpBinding> e <xref:System.ServiceModel.WSHttpBinding>.</span><span class="sxs-lookup"><span data-stu-id="3965f-138">This is available with the following bindings: <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.WSFederationHttpBinding>, <xref:System.ServiceModel.NetPeerTcpBinding>, and <xref:System.ServiceModel.WSHttpBinding>.</span></span>  
  
3. <span data-ttu-id="3965f-139">Se si decide di utilizzare la sicurezza a livello di trasporto per il protocollo HTTP (ovvero il protocollo HTTPS), è inoltre necessario configurare l'host con un certificato SSL e quindi abilitare il protocollo SSL su una porta.</span><span class="sxs-lookup"><span data-stu-id="3965f-139">If you decide to use transport security for HTTP (in other words, HTTPS), you must also configure the host with an SSL certificate and enable SSL on a port.</span></span> <span data-ttu-id="3965f-140">Per ulteriori informazioni, vedere la pagina relativa alla [sicurezza del trasporto http](http-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-140">For more information, see [HTTP Transport Security](http-transport-security.md).</span></span>  
  
4. <span data-ttu-id="3965f-141">Se si utilizza l'associazione <xref:System.ServiceModel.WSHttpBinding> e non occorre stabilire una sessione protetta, impostare la proprietà <xref:System.ServiceModel.NonDualMessageSecurityOverHttp.EstablishSecurityContext%2A> su `false`.</span><span class="sxs-lookup"><span data-stu-id="3965f-141">If you are using the <xref:System.ServiceModel.WSHttpBinding> and do not need to establish a secure session, set the <xref:System.ServiceModel.NonDualMessageSecurityOverHttp.EstablishSecurityContext%2A> property to `false`.</span></span>  
  
     <span data-ttu-id="3965f-142">Una sessione protetta si verifica quando un client e un servizio creano un canale utilizzando una chiave simmetrica, ovvero quando sia il client sia il server utilizzano la stessa chiave per la durata della conversazione e fino alla chiusura del dialogo.</span><span class="sxs-lookup"><span data-stu-id="3965f-142">A secure session occurs when a client and service create a channel using a symmetric key (both client and server use the same key for the length of a conversation, until the dialog is closed).</span></span>  
  
## <a name="setting-the-client-credential-type"></a><span data-ttu-id="3965f-143">Impostazione del tipo di credenziale client</span><span class="sxs-lookup"><span data-stu-id="3965f-143">Setting the Client Credential Type</span></span>  
 <span data-ttu-id="3965f-144">Selezionare un tipo di credenziale client in base alle proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="3965f-144">Select a client credential type as appropriate.</span></span> <span data-ttu-id="3965f-145">Per ulteriori informazioni, vedere [selezione di un tipo di credenziale](selecting-a-credential-type.md).</span><span class="sxs-lookup"><span data-stu-id="3965f-145">For more information, see [Selecting a Credential Type](selecting-a-credential-type.md).</span></span> <span data-ttu-id="3965f-146">Sono disponibili i tipi di credenziale client seguenti:</span><span class="sxs-lookup"><span data-stu-id="3965f-146">The following client credential types are available:</span></span>  
  
- `Windows`  
  
- `Certificate`  
  
- `Digest`  
  
- `Basic`  
  
- `UserName`  
  
- `NTLM`  
  
- `IssuedToken`  
  
 <span data-ttu-id="3965f-147">L'impostazione del tipo di credenziale dipende dalla modalità impostata.</span><span class="sxs-lookup"><span data-stu-id="3965f-147">Depending on how you set the mode, you must set the credential type.</span></span> <span data-ttu-id="3965f-148">Se ad esempio è stata selezionata l'associazione `wsHttpBinding` e la modalità è stata impostata sulla sicurezza a livello di messaggio, l'attributo `clientCredentialType` dell'elemento Message può essere impostato su uno dei valori seguenti: `None`, `Windows`, `UserName`, `Certificate` e `IssuedToken`, come mostrato nell'esempio di configurazione seguente.</span><span class="sxs-lookup"><span data-stu-id="3965f-148">For example, if you have selected the `wsHttpBinding`, and have set the mode to "Message," then you can also set the `clientCredentialType` attribute of the Message element to one of the following values: `None`, `Windows`, `UserName`, `Certificate`, and `IssuedToken`, as shown in the following configuration example.</span></span>  
  
```xml  
<system.serviceModel>  
<bindings>  
  <wsHttpBinding>  
    <binding name="myBinding">  
      <security mode="Message"/>  
      <message clientCredentialType="Windows"/>  
    </binding>
  </wsHttpBinding>
</bindings>  
</system.serviceModel>  
```  
  
 <span data-ttu-id="3965f-149">Oppure nel codice:</span><span class="sxs-lookup"><span data-stu-id="3965f-149">Or in code:</span></span>  
  
 [!code-csharp[c_WsHttpService#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_wshttpservice/cs/source.cs#1)]
 [!code-vb[c_WsHttpService#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_wshttpservice/vb/source.vb#1)]  
  
## <a name="setting-service-credential-values"></a><span data-ttu-id="3965f-150">Impostazione dei valori di credenziale del servizio</span><span class="sxs-lookup"><span data-stu-id="3965f-150">Setting Service Credential Values</span></span>  
 <span data-ttu-id="3965f-151">Dopo aver selezionato un tipo di credenziale client è necessario impostare le credenziali effettivamente utilizzate dal servizio e dal client.</span><span class="sxs-lookup"><span data-stu-id="3965f-151">Once you select a client credential type, you must set the actual credentials for the service and client to use.</span></span> <span data-ttu-id="3965f-152">Nel servizio, le credenziali vengono impostate utilizzando la classe <xref:System.ServiceModel.Description.ServiceCredentials> e restituite tramite la proprietà <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> della classe <xref:System.ServiceModel.ServiceHostBase>.</span><span class="sxs-lookup"><span data-stu-id="3965f-152">On the service, credentials are set using the <xref:System.ServiceModel.Description.ServiceCredentials> class and returned by the <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> property of the <xref:System.ServiceModel.ServiceHostBase> class.</span></span> <span data-ttu-id="3965f-153">L'associazione utilizzata determina il tipo di credenziale del servizio, la scelta della modalità di sicurezza e il tipo di credenziale client.</span><span class="sxs-lookup"><span data-stu-id="3965f-153">The binding in use implies the service credential type, the security mode chosen, and the type of the client credential.</span></span> <span data-ttu-id="3965f-154">Nel codice seguente un certificato viene impostato come credenziale di servizio.</span><span class="sxs-lookup"><span data-stu-id="3965f-154">The following code sets a certificate for a service credential.</span></span>  
  
 [!code-csharp[c_tcpService#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_tcpservice/cs/source.cs#3)]
 [!code-vb[c_tcpService#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_tcpservice/vb/source.vb#3)]  
  
## <a name="setting-client-credential-values"></a><span data-ttu-id="3965f-155">Impostazione dei valori di credenziale del client</span><span class="sxs-lookup"><span data-stu-id="3965f-155">Setting Client Credential Values</span></span>  
 <span data-ttu-id="3965f-156">Nel client, i valori di credenziale vengono impostati utilizzando la classe <xref:System.ServiceModel.Description.ClientCredentials> e restituiti tramite la proprietà <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> della classe <xref:System.ServiceModel.ClientBase%601>.</span><span class="sxs-lookup"><span data-stu-id="3965f-156">On the client, set client credential values using the <xref:System.ServiceModel.Description.ClientCredentials> class and returned by the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property of the <xref:System.ServiceModel.ClientBase%601> class.</span></span> <span data-ttu-id="3965f-157">Nel codice seguente un certificato viene impostato come credenziale in un client che utilizza il protocollo TCP.</span><span class="sxs-lookup"><span data-stu-id="3965f-157">The following code sets a certificate as a credential on a client using the TCP protocol.</span></span>  
  
 [!code-csharp[c_TcpClient#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_tcpclient/cs/source.cs#1)]
 [!code-vb[c_TcpClient#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_tcpclient/vb/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="3965f-158">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="3965f-158">See also</span></span>

- [<span data-ttu-id="3965f-159">Programmazione WCF di base</span><span class="sxs-lookup"><span data-stu-id="3965f-159">Basic WCF Programming</span></span>](../basic-wcf-programming.md)
- [<span data-ttu-id="3965f-160">Scenari di sicurezza comuni</span><span class="sxs-lookup"><span data-stu-id="3965f-160">Common Security Scenarios</span></span>](common-security-scenarios.md)
