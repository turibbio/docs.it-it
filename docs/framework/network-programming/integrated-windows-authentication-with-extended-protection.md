---
title: Integrated Windows Authentication with Extended Protection
ms.date: 03/30/2017
ms.assetid: 81731998-d5e7-49e4-ad38-c8e6d01689d0
ms.openlocfilehash: d69471f4be0f102381dee4fc5037e8f8b0c625c3
ms.sourcegitcommit: ee5b798427f81237a3c23d1fd81fff7fdc21e8d3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/28/2020
ms.locfileid: "84144851"
---
# <a name="integrated-windows-authentication-with-extended-protection"></a><span data-ttu-id="ba29f-102">Integrated Windows Authentication with Extended Protection</span><span class="sxs-lookup"><span data-stu-id="ba29f-102">Integrated Windows Authentication with Extended Protection</span></span>
<span data-ttu-id="ba29f-103">Sono stati apportati alcuni miglioramenti che influiscono sul modo in cui l'autenticazione integrata di Windows viene gestita da <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream> e dalle classi correlate in <xref:System.Net> e negli spazi dei nomi correlati.</span><span class="sxs-lookup"><span data-stu-id="ba29f-103">Enhancements were made that affect how integrated Windows authentication is handled by the <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream>, and related classes in the <xref:System.Net> and related namespaces.</span></span> <span data-ttu-id="ba29f-104">È stato aggiunto il supporto per la protezione estesa per migliorare la sicurezza.</span><span class="sxs-lookup"><span data-stu-id="ba29f-104">Support was added for extended protection to enhance security.</span></span>  
  
 <span data-ttu-id="ba29f-105">Queste modifiche possono influire sulle applicazioni che usano queste classi per effettuare richieste Web e ricevere risposte in cui viene usata l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="ba29f-105">These changes can affect applications that use these classes to make web requests and receive responses where integrated Windows authentication is used.</span></span> <span data-ttu-id="ba29f-106">Questa modifica può anche influire sulle applicazioni client e sui server Web configurati per l'uso dell'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="ba29f-106">This change can also impact web servers and client applications that are configured to use integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="ba29f-107">Queste modifiche possono influire anche sulle applicazioni che usano queste classi per effettuare altri tipi di richieste e ricevere risposte in cui viene usata l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="ba29f-107">These changes can also affect applications that use these classes to make other types of requests and receive responses where integrated Windows authentication is used.</span></span>  
  
 <span data-ttu-id="ba29f-108">Le modifiche per supportare la protezione estesa sono disponibili solo per le applicazioni in esecuzione su Windows 7 e Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="ba29f-108">The changes to support extended protection are available only for applications on Windows 7 and Windows Server 2008 R2.</span></span> <span data-ttu-id="ba29f-109">Le funzionalità di protezione estesa non sono disponibili nelle versioni precedenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="ba29f-109">The extended protection features are not available on earlier versions of Windows.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="ba29f-110">Panoramica</span><span class="sxs-lookup"><span data-stu-id="ba29f-110">Overview</span></span>  
 <span data-ttu-id="ba29f-111">La progettazione dell'autenticazione integrata di Windows fa sì che alcune risposte con richiesta di verifica delle credenziali siano universali, ovvero possano essere riutilizzate o inoltrate.</span><span class="sxs-lookup"><span data-stu-id="ba29f-111">The design of integrated Windows authentication allows for some credential challenge responses to be universal, meaning they can be re-used or forwarded.</span></span> <span data-ttu-id="ba29f-112">Le risposte con richiesta di verifica devono essere costruite almeno con informazioni specifiche sulla destinazione e preferibilmente anche con alcune informazioni specifiche sul canale.</span><span class="sxs-lookup"><span data-stu-id="ba29f-112">The challenge responses should be constructed at a minimum with target specific information and preferably also with some channel specific information.</span></span> <span data-ttu-id="ba29f-113">I servizi possono quindi fornire protezione estesa per garantire che le risposte con richiesta di verifica delle credenziali contengano informazioni specifiche sui servizi, ad esempio un nome dell'entità servizio (SPN).</span><span class="sxs-lookup"><span data-stu-id="ba29f-113">Services can then provide extended protection to ensure that credential challenge responses contain service specific information such as a Service Principal Name (SPN).</span></span> <span data-ttu-id="ba29f-114">Con queste informazioni nello scambio di credenziali, i servizi possono offrire protezione migliore contro l'uso dannoso di risposte con richiesta di verifica di credenziali usate in modo improprio.</span><span class="sxs-lookup"><span data-stu-id="ba29f-114">With this information in the credential exchanges, services are able to better protect against malicious use of credential challenge responses that might have been improperly used.</span></span>  
  
 <span data-ttu-id="ba29f-115">La progettazione con protezione estesa è un miglioramento per i protocolli di autenticazione sviluppati per prevenire gli attacchi di inoltro autenticato.</span><span class="sxs-lookup"><span data-stu-id="ba29f-115">The extended protection design is an enhancement to authentication protocols designed to mitigate authentication relay attacks.</span></span> <span data-ttu-id="ba29f-116">Questo tipo di progettazione è basato sul concetto di informazioni sull'associazione di canali e servizi.</span><span class="sxs-lookup"><span data-stu-id="ba29f-116">It revolves around the concept of channel and service binding information.</span></span>  
  
 <span data-ttu-id="ba29f-117">Gli obiettivi complessivi sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba29f-117">The overall objectives are the following:</span></span>  
  
1. <span data-ttu-id="ba29f-118">Se il client viene aggiornato per supportare la protezione estesa, le applicazioni devono fornire informazioni sull'associazione di canali e sull'associazione di servizi a tutti i protocolli di autenticazione supportati.</span><span class="sxs-lookup"><span data-stu-id="ba29f-118">If the client is updated to support the extended protection, applications should supply a channel binding and service binding information to all supported authentication protocols.</span></span> <span data-ttu-id="ba29f-119">Le informazioni sull'associazione di canali possono essere fornite solo quando è presente un canale (TLS) a cui eseguire l'associazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-119">Channel binding information can only be supplied when there is a channel (TLS) to bind to.</span></span> <span data-ttu-id="ba29f-120">Le informazioni sull'associazione di servizi devono essere fornite sempre.</span><span class="sxs-lookup"><span data-stu-id="ba29f-120">Service binding information should always be supplied.</span></span>  
  
2. <span data-ttu-id="ba29f-121">I server aggiornati configurati correttamente possono verificare le informazioni sull'associazione di canali e servizi quando queste sono presenti nel token di autenticazione client e rifiutare il tentativo di autenticazione se le associazioni di canali non corrispondono.</span><span class="sxs-lookup"><span data-stu-id="ba29f-121">Updated servers which are properly configured may verify the channel and service binding information when it is present in the client authentication token and reject the authentication attempt if the channel bindings do not match.</span></span> <span data-ttu-id="ba29f-122">A seconda dello scenario di distribuzione, i server possono verificare l'associazione di canali, l'associazione di servizi o entrambe.</span><span class="sxs-lookup"><span data-stu-id="ba29f-122">Depending on the deployment scenario, servers may verify channel binding, service binding or both.</span></span>  
  
3. <span data-ttu-id="ba29f-123">I server aggiornati possono accettare o rifiutare richieste client di livello inferiore che non contengono le informazioni sull'associazione di canali basate sui criteri.</span><span class="sxs-lookup"><span data-stu-id="ba29f-123">Updated servers have the ability to accept or reject down-level client requests that do not contain the channel binding information based on policy.</span></span>  
  
 <span data-ttu-id="ba29f-124">Le informazioni usate dalla protezione estesa sono costituite da uno o entrambi gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba29f-124">Information used by extended protection consists of one or both of the following two parts:</span></span>  
  
1. <span data-ttu-id="ba29f-125">Token di associazione del canale.</span><span class="sxs-lookup"><span data-stu-id="ba29f-125">A Channel Binding Token or CBT.</span></span>  
  
2. <span data-ttu-id="ba29f-126">Informazioni sull'associazione di servizi sotto forma di nome dell'entità servizio o SPN.</span><span class="sxs-lookup"><span data-stu-id="ba29f-126">Service Binding information in the form of a Service Principal Name or SPN.</span></span>  
  
 <span data-ttu-id="ba29f-127">Le informazioni sull'associazione di servizi indicano l'intenzione di un client di eseguire l'autenticazione in un endpoint servizio specifico.</span><span class="sxs-lookup"><span data-stu-id="ba29f-127">Service Binding information is an indication of a client’s intent to authenticate to a particular service endpoint.</span></span> <span data-ttu-id="ba29f-128">Queste informazioni vengono comunicate dal client al server con le proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba29f-128">It is communicated from client to server with the following properties:</span></span>  
  
- <span data-ttu-id="ba29f-129">Il valore SPN deve essere disponibile al server che esegue l'autenticazione client in formato testo non crittografato.</span><span class="sxs-lookup"><span data-stu-id="ba29f-129">The SPN value must be available to the server performing client authentication in clear text form.</span></span>  
  
- <span data-ttu-id="ba29f-130">Il valore dell'SPN è pubblico.</span><span class="sxs-lookup"><span data-stu-id="ba29f-130">The value of the SPN is public.</span></span>  
  
- <span data-ttu-id="ba29f-131">L'SPN deve essere protetto con crittografia durante il transito, in modo che un attacco man-in-the-middle non possa inserirne, rimuoverne o modificarne il valore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-131">The SPN must be cryptographically protected in transit such that a man-in-the-middle attack cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="ba29f-132">Un token di associazione del canale è una proprietà del canale sicuro esterno, ad esempio TLS, usata per associarlo a una conversazione tramite un canale autenticato dal client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-132">A CBT is a property of the outer secure channel (such as TLS) used to tie (bind) it to a conversation over an inner, client-authenticated channel.</span></span> <span data-ttu-id="ba29f-133">Il token di associazione del canale deve avere le proprietà seguenti, definite anche dal documento IETF RFC 5056:</span><span class="sxs-lookup"><span data-stu-id="ba29f-133">The CBT must have the following properties (also defined by IETF RFC 5056):</span></span>  
  
- <span data-ttu-id="ba29f-134">Quando è presente un canale esterno, il valore del token di associazione del canale deve essere una proprietà che identifica il canale esterno o l'endpoint servizio, cui arrivano in modo indipendente sia il lato client sia il lato server di una conversazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-134">When an outer channel exists, the value of the CBT must be a property identifying either the outer channel or the server endpoint, independently arrived at by both client and server sides of a conversation.</span></span>  
  
- <span data-ttu-id="ba29f-135">Il valore del token di associazione del canale inviato dal client non deve poter essere danneggiato da un utente malintenzionato.</span><span class="sxs-lookup"><span data-stu-id="ba29f-135">Value of the CBT sent by the client must not be something an attacker can influence.</span></span>  
  
- <span data-ttu-id="ba29f-136">La segretezza del valore del token di associazione del canale non è garantita.</span><span class="sxs-lookup"><span data-stu-id="ba29f-136">No guarantees are made about secrecy of the CBT value.</span></span> <span data-ttu-id="ba29f-137">Tuttavia, questo non significa che il valore delle informazioni sull'associazione di servizi e di canali possa essere sempre esaminato da altri componenti oltre al server che esegue l'autenticazione, in quanto può essere crittografato dal protocollo usato per trasmettere il token di associazione del canale.</span><span class="sxs-lookup"><span data-stu-id="ba29f-137">This does not however mean that the value of the service binding as well as channel binding information can always be examined by any other but the server performing authentication, as the protocol carrying the CBT may be encrypting it.</span></span>  
  
- <span data-ttu-id="ba29f-138">L'integrità del token di associazione del canale deve essere protetta con crittografia durante il transito, in modo che un utente malintenzionato non possa inserirne, rimuoverne o modificarne il valore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-138">The CBT must be cryptographically integrity protected in transit such that an attacker cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="ba29f-139">L'associazione di canali viene eseguita dal client che trasferisce l'SPN e il token di associazione del canale al server in modo a prova di manomissione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-139">Channel binding is accomplished by the client transferring the SPN and the CBT to the server in a tamperproof fashion.</span></span> <span data-ttu-id="ba29f-140">Il server convalida le informazioni sull'associazione di canali in base ai criteri e rifiuta i tentativi di autenticazione per cui determina di non essere la destinazione prevista.</span><span class="sxs-lookup"><span data-stu-id="ba29f-140">The server validates the channel binding information in accordance with its policy and rejects authentication attempts for which it does not believe itself to have been the intended target.</span></span> <span data-ttu-id="ba29f-141">In questo modo, i due canali vengono associati con crittografia.</span><span class="sxs-lookup"><span data-stu-id="ba29f-141">This way, the two channels become cryptographically bound together.</span></span>  
  
 <span data-ttu-id="ba29f-142">Per mantenere la compatibilità con client e applicazioni esistenti, un server può essere configurato per consentire i tentativi di autenticazione da parte dei client che non supportano ancora la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-142">To preserve compatibility with existing clients and applications, a server may be configured to allow authentication attempts by clients that do not yet support extended protection.</span></span> <span data-ttu-id="ba29f-143">Questa è definita una configurazione "parzialmente avanzata", diversa da una configurazione "completamente avanzata".</span><span class="sxs-lookup"><span data-stu-id="ba29f-143">This is referred to as a "partially hardened" configuration, in contrast to a "fully hardened" configuration.</span></span>  
  
 <span data-ttu-id="ba29f-144">Più componenti negli spazi dei nomi <xref:System.Net> e <xref:System.Net.Security> eseguono l'autenticazione integrata di Windows per conto di un'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="ba29f-144">Multiple components in the <xref:System.Net> and <xref:System.Net.Security> namespaces perform integrated Windows authentication on behalf of a calling application.</span></span> <span data-ttu-id="ba29f-145">Questa sezione descrive le modifiche apportate ai componenti System.Net per aggiungere la protezione estesa quando usano l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="ba29f-145">This section describes changes to System.Net components to add extended protection in their use of integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="ba29f-146">La protezione estesa è attualmente supportata in Windows 7.</span><span class="sxs-lookup"><span data-stu-id="ba29f-146">Extended protection is currently supported on Windows 7.</span></span> <span data-ttu-id="ba29f-147">Viene fornito un meccanismo in base al quale un'applicazione può determinare se il sistema operativo supporta la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-147">A mechanism is provided so an application can determine if the operating system supports extended protection.</span></span>  
  
## <a name="changes-to-support-extended-protection"></a><span data-ttu-id="ba29f-148">Modifiche apportate per supportare la protezione estesa</span><span class="sxs-lookup"><span data-stu-id="ba29f-148">Changes to Support Extended Protection</span></span>  
 <span data-ttu-id="ba29f-149">A seconda del protocollo di autenticazione in uso, il processo di autenticazione usato con l'autenticazione integrata di Windows include spesso una richiesta di verifica inviata dal computer di destinazione e quindi ritrasmessa al computer client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-149">The authentication process used with integrated Windows authentication, depending on the authentication protocol used, often includes a challenge issued by the destination computer and sent back to the client computer.</span></span> <span data-ttu-id="ba29f-150">La protezione estesa aggiunge nuove funzionalità a questo processo di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-150">Extended protection adds new features to this authentication process</span></span>  
  
 <span data-ttu-id="ba29f-151">Lo spazio dei nomi <xref:System.Security.Authentication.ExtendedProtection> fornisce il supporto per l'autenticazione con protezione estesa per le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="ba29f-151">The <xref:System.Security.Authentication.ExtendedProtection> namespace provides support for authentication using extended protection for applications.</span></span> <span data-ttu-id="ba29f-152">La classe <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> in questo spazio dei nomi rappresenta un'associazione di canali.</span><span class="sxs-lookup"><span data-stu-id="ba29f-152">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> class in this namespace represents a channel binding.</span></span> <span data-ttu-id="ba29f-153">La classe <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> in questo spazio dei nomi rappresenta i criteri di protezione estesa usati dal server per convalidare le connessioni client in ingresso.</span><span class="sxs-lookup"><span data-stu-id="ba29f-153">The <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class in this namespace represents the extended protection policy used by the server to validate incoming client connections.</span></span> <span data-ttu-id="ba29f-154">Altri membri della classe vengono usati con la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-154">Other class members are used with extended protection.</span></span>  
  
 <span data-ttu-id="ba29f-155">Per le applicazioni server, queste classi includono gli oggetti seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba29f-155">For server applications, these classes include the following:</span></span>  
  
 <span data-ttu-id="ba29f-156"><xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> che include gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba29f-156">A <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> that has the following elements:</span></span>  
  
- <span data-ttu-id="ba29f-157">Proprietà <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> che indica se il sistema operativo supporta l'autenticazione integrata di Windows con protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-157">An <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> property that indicates whether the operating system supports integrated windows authentication with extended protection.</span></span>  
  
- <span data-ttu-id="ba29f-158">Valore di <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> che indica quando i criteri di protezione estesa devono essere applicati.</span><span class="sxs-lookup"><span data-stu-id="ba29f-158">A <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> value that indicates when the extended protection policy should be enforced.</span></span>  
  
- <span data-ttu-id="ba29f-159">Valore di <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> che indica lo scenario di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-159">A <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> value that indicates the deployment scenario.</span></span> <span data-ttu-id="ba29f-160">Questo valore influisce sul modo in cui viene verificata la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-160">This influences how extended protection is checked.</span></span>  
  
- <span data-ttu-id="ba29f-161">Oggetto <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> facoltativo che contiene l'elenco di SPN personalizzati, usato per verificare la corrispondenza rispetto all'SPN fornito dal client come destinazione prevista dell'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-161">An optional <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> that contains the custom SPN list that is used to match against the SPN provided by the client as the intended target of the authentication.</span></span>  
  
- <span data-ttu-id="ba29f-162">Oggetto <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> facoltativo che contiene un'associazione di canali personalizzata da usare per la convalida.</span><span class="sxs-lookup"><span data-stu-id="ba29f-162">An optional <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> that contains a custom channel binding to use for validation.</span></span> <span data-ttu-id="ba29f-163">Questo scenario non rappresenta un caso comune</span><span class="sxs-lookup"><span data-stu-id="ba29f-163">This scenario is not a common case</span></span>  
  
 <span data-ttu-id="ba29f-164">Lo spazio dei nomi <xref:System.Security.Authentication.ExtendedProtection.Configuration> fornisce il supporto per la configurazione dell'autenticazione con protezione estesa per le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="ba29f-164">The <xref:System.Security.Authentication.ExtendedProtection.Configuration> namespace provides support for configuration of authentication using extended protection for applications.</span></span>  
  
 <span data-ttu-id="ba29f-165">Sono state apportate alcune modifiche alle funzionalità per supportare la protezione estesa nello spazio dei nomi <xref:System.Net> esistente.</span><span class="sxs-lookup"><span data-stu-id="ba29f-165">A number of feature changes were made to support extended protection in the existing <xref:System.Net> namespace.</span></span> <span data-ttu-id="ba29f-166">Queste modifiche includono, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="ba29f-166">These changes include the following:</span></span>  
  
- <span data-ttu-id="ba29f-167">Nuova classe <xref:System.Net.TransportContext> aggiunta allo spazio dei nomi <xref:System.Net> che rappresenta un contesto di trasporto.</span><span class="sxs-lookup"><span data-stu-id="ba29f-167">A new <xref:System.Net.TransportContext> class added to the <xref:System.Net> namespace that represents a transport context.</span></span>  
  
- <span data-ttu-id="ba29f-168">Nuovi metodi di overload <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> e <xref:System.Net.HttpWebRequest.GetRequestStream%2A> nella classe <xref:System.Net.HttpWebRequest> che permettono il recupero di <xref:System.Net.TransportContext> per supportare la protezione estesa per le applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-168">New <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> and <xref:System.Net.HttpWebRequest.GetRequestStream%2A> overload methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> to support extended protection for client applications.</span></span>  
  
- <span data-ttu-id="ba29f-169">Aggiunte alle classi <xref:System.Net.HttpListener> e <xref:System.Net.HttpListenerRequest> per supportare le applicazioni server.</span><span class="sxs-lookup"><span data-stu-id="ba29f-169">Additions to the <xref:System.Net.HttpListener> and <xref:System.Net.HttpListenerRequest> classes to support server applications.</span></span>  
  
 <span data-ttu-id="ba29f-170">È stata apportata una modifica per supportare la protezione estesa per le applicazioni client SMTP nello spazio dei nomi <xref:System.Net.Mail> esistente:</span><span class="sxs-lookup"><span data-stu-id="ba29f-170">A feature change was made to support extended protection for SMTP client applications in the existing <xref:System.Net.Mail> namespace:</span></span>  
  
- <span data-ttu-id="ba29f-171">Proprietà <xref:System.Net.Mail.SmtpClient.TargetName%2A> nella classe <xref:System.Net.Mail.SmtpClient> che rappresenta l'SPN da usare per l'autenticazione quando si usa la protezione estesa per applicazioni client SMTP.</span><span class="sxs-lookup"><span data-stu-id="ba29f-171">A <xref:System.Net.Mail.SmtpClient.TargetName%2A> property in the <xref:System.Net.Mail.SmtpClient> class that represents the SPN to use for authentication when using extended protection for SMTP client applications.</span></span>  
  
 <span data-ttu-id="ba29f-172">Sono state apportate alcune modifiche alle funzionalità per supportare la protezione estesa nello spazio dei nomi <xref:System.Net.Security> esistente.</span><span class="sxs-lookup"><span data-stu-id="ba29f-172">A number of feature changes were made to support extended protection in the existing <xref:System.Net.Security> namespace.</span></span> <span data-ttu-id="ba29f-173">Queste modifiche includono, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="ba29f-173">These changes include the following:</span></span>  
  
- <span data-ttu-id="ba29f-174">Nuovi metodi di overload <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> e <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> nella classe <xref:System.Net.Security.NegotiateStream> che permettono il passaggio di un token di associazione del canale per supportare la protezione estesa per le applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-174">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing a CBT to support extended protection for client applications.</span></span>  
  
- <span data-ttu-id="ba29f-175">Nuovi metodi di overload <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> e <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> nella classe <xref:System.Net.Security.NegotiateStream> che permettono il passaggio di un oggetto <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> per supportare la protezione estesa per le applicazioni server.</span><span class="sxs-lookup"><span data-stu-id="ba29f-175">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> to support extended protection for server applications.</span></span>  
  
- <span data-ttu-id="ba29f-176">Nuova proprietà <xref:System.Net.Security.SslStream.TransportContext%2A> nella classe <xref:System.Net.Security.SslStream> per supportare la protezione estesa per le applicazioni client e server.</span><span class="sxs-lookup"><span data-stu-id="ba29f-176">A new <xref:System.Net.Security.SslStream.TransportContext%2A> property in the <xref:System.Net.Security.SslStream> class to support extended protection for client and server applications.</span></span>  
  
 <span data-ttu-id="ba29f-177">Proprietà <xref:System.Net.Configuration.SmtpNetworkElement> aggiunta per supportare la configurazione della protezione estesa per client SMTP nello spazio dei nomi <xref:System.Net.Security>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-177">A <xref:System.Net.Configuration.SmtpNetworkElement> property was added to support configuration of extended protection for SMTP clients in the <xref:System.Net.Security> namespace.</span></span>  
  
## <a name="extended-protection-for-client-applications"></a><span data-ttu-id="ba29f-178">Protezione estesa per applicazioni client</span><span class="sxs-lookup"><span data-stu-id="ba29f-178">Extended Protection for Client Applications</span></span>  
 <span data-ttu-id="ba29f-179">Il supporto della protezione estesa per la maggior parte delle applicazioni client viene applicato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="ba29f-179">Extended protection support for most client applications happens automatically.</span></span> <span data-ttu-id="ba29f-180">Le classi <xref:System.Net.HttpWebRequest> e <xref:System.Net.Mail.SmtpClient> supportano la protezione estesa ogni volta che la versione sottostante di Windows supporta la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-180">The <xref:System.Net.HttpWebRequest> and <xref:System.Net.Mail.SmtpClient> classes support extended protection whenever the underlying version of Windows supports extended protection.</span></span> <span data-ttu-id="ba29f-181">Un'istanza <xref:System.Net.HttpWebRequest> invia un SPN costruito da <xref:System.Uri>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-181">An <xref:System.Net.HttpWebRequest> instance sends an SPN constructed from the <xref:System.Uri>.</span></span> <span data-ttu-id="ba29f-182">Per impostazione predefinita, un'istanza <xref:System.Net.Mail.SmtpClient> invia un SPN costruito dal nome host del server di posta SMTP.</span><span class="sxs-lookup"><span data-stu-id="ba29f-182">By default, an <xref:System.Net.Mail.SmtpClient> instance sends an SPN constructed from the host name of the SMTP mail server.</span></span>  
  
 <span data-ttu-id="ba29f-183">Per l'autenticazione personalizzata, le applicazioni client possono usare i metodi <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> e <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> nella classe <xref:System.Net.HttpWebRequest>, che permettono il recupero di <xref:System.Net.TransportContext> e del token di associazione del canale con il metodo <xref:System.Net.TransportContext.GetChannelBinding%2A>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-183">For custom authentication, client applications can use the <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> or <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> and the CBT using the <xref:System.Net.TransportContext.GetChannelBinding%2A> method.</span></span>  
  
 <span data-ttu-id="ba29f-184">L'SPN da usare per l'autenticazione integrata di Windows inviato da un'istanza <xref:System.Net.HttpWebRequest> a un servizio specifico può essere sostituito impostando la proprietà <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-184">The SPN to use for integrated Windows authentication sent by an <xref:System.Net.HttpWebRequest> instance to a given service can be overridden by setting the <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> property.</span></span>  
  
 <span data-ttu-id="ba29f-185">La proprietà <xref:System.Net.Mail.SmtpClient.TargetName%2A> può essere usata per impostare un SPN personalizzato da usare per l'autenticazione integrata di Windows per la connessione SMTP.</span><span class="sxs-lookup"><span data-stu-id="ba29f-185">The <xref:System.Net.Mail.SmtpClient.TargetName%2A> property can be used to set a custom SPN to use for integrated Windows authentication for the SMTP connection.</span></span>  
  
## <a name="extended-protection-for-server-applications"></a><span data-ttu-id="ba29f-186">Protezione estesa per applicazioni server</span><span class="sxs-lookup"><span data-stu-id="ba29f-186">Extended Protection for Server Applications</span></span>  
 <span data-ttu-id="ba29f-187"><xref:System.Net.HttpListener> fornisce automaticamente i meccanismi per la convalida delle associazioni di servizi durante l'autenticazione HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba29f-187"><xref:System.Net.HttpListener> automatically provides mechanisms for validating service bindings when performing HTTP authentication.</span></span>  
  
 <span data-ttu-id="ba29f-188">Lo scenario più sicuro consiste nell'abilitare la protezione estesa per i `HTTPS://` prefissi.</span><span class="sxs-lookup"><span data-stu-id="ba29f-188">The most secure scenario is to enable extended protection for `HTTPS://` prefixes.</span></span> <span data-ttu-id="ba29f-189">In questo caso, impostare <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> su <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> con <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> impostato su <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> o <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> e <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> impostato su <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected>. Il valore <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> attiva la modalità parzialmente avanzata per <xref:System.Net.HttpListener>, mentre <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corrisponde alla modalità completamente avanzata.</span><span class="sxs-lookup"><span data-stu-id="ba29f-189">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="ba29f-190">Quando in questa configurazione viene effettuata una richiesta al server tramite un canale sicuro esterno, viene eseguita una query sul canale esterno per ottenere un'associazione di canali.</span><span class="sxs-lookup"><span data-stu-id="ba29f-190">In this configuration when a request is made to the server through an outer secure channel, the outer channel is queried for a channel binding.</span></span> <span data-ttu-id="ba29f-191">Questa associazione di canali viene passata alle chiamate SSPI di autenticazione, che convalidano la corrispondenza dell'associazione di canali nel BLOB di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-191">This channel binding is passed to the authentication SSPI calls, which validate that the channel binding in the authentication blob matches.</span></span> <span data-ttu-id="ba29f-192">I risultati possono essere tre:</span><span class="sxs-lookup"><span data-stu-id="ba29f-192">There are three possible outcomes:</span></span>  
  
1. <span data-ttu-id="ba29f-193">Il sistema operativo sottostante del server non supporta la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-193">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="ba29f-194">La richiesta non viene esposta all'applicazione e viene restituita una risposta di mancata autorizzazione (401) al client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-194">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="ba29f-195">Viene registrato un messaggio nell'origine di traccia <xref:System.Net.HttpListener> che specifica il motivo dell'errore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-195">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2. <span data-ttu-id="ba29f-196">La chiamata SSPI non riesce, indicando che il client ha specificato un'associazione di canali che non corrisponde al valore previsto recuperato dal canale esterno oppure che il client non è riuscito a fornire l'associazione di canali quando sono stati configurati i criteri di protezione estesa nel server per <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-196">The SSPI call fails indicating that either the client specified a channel binding that did not match the expected value retrieved from the outer channel or the client failed to supply a channel binding when the extended protection policy on the server was configured for <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span></span> <span data-ttu-id="ba29f-197">In entrambi i casi, la richiesta non viene esposta all'applicazione e viene restituita una risposta di mancata autorizzazione (401) al client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-197">In both cases, the request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="ba29f-198">Viene registrato un messaggio nell'origine di traccia <xref:System.Net.HttpListener> che specifica il motivo dell'errore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-198">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3. <span data-ttu-id="ba29f-199">Il client specifica l'associazione di canali corretta o viene autorizzato a connettersi senza specificare alcuna associazione, in quanto i criteri di protezione estesa nel server sono configurati con <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported>. La richiesta viene restituita all'applicazione per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-199">The client specifies the correct channel binding or is allowed to connect without specifying a channel binding since the extended protection policy on the server is configured with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> The request is returned to the application for processing.</span></span> <span data-ttu-id="ba29f-200">Non viene eseguito automaticamente alcun controllo del nome di servizio.</span><span class="sxs-lookup"><span data-stu-id="ba29f-200">No service name check is performed automatically.</span></span> <span data-ttu-id="ba29f-201">Un'applicazione può scegliere di eseguire la propria convalida del nome di servizio usando la proprietà <xref:System.Net.HttpListenerRequest.ServiceName%2A>, ma in questo caso il controllo è superfluo.</span><span class="sxs-lookup"><span data-stu-id="ba29f-201">An application may choose to perform its own service name validation using the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property, but under these circumstances it is redundant.</span></span>  
  
 <span data-ttu-id="ba29f-202">Se un'applicazione effettua le proprie chiamate SSPI per eseguire l'autenticazione in base a BLOB scambiati all'interno del corpo di una richiesta HTTP e vuole supportare l'associazione di canali, deve recuperare l'associazione di canali prevista dal canale sicuro esterno usando <xref:System.Net.HttpListener> per passarla alla funzione [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) Win32 nativa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-202">If an application makes its own SSPI calls to perform authentication based on blobs passed back and forth within the body of an HTTP request and wishes to support channel binding, it needs to retrieve the expected channel binding from the outer secure channel using <xref:System.Net.HttpListener> in order to pass it to native Win32 [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="ba29f-203">A questo scopo, usare la proprietà <xref:System.Net.HttpListenerRequest.TransportContext%2A> e chiamare il metodo <xref:System.Net.TransportContext.GetChannelBinding%2A> per recuperare il token di associazione del canale.</span><span class="sxs-lookup"><span data-stu-id="ba29f-203">To do this, use the <xref:System.Net.HttpListenerRequest.TransportContext%2A> property and call <xref:System.Net.TransportContext.GetChannelBinding%2A> method to retrieve the CBT.</span></span> <span data-ttu-id="ba29f-204">Sono supportate solo le associazioni di endpoint.</span><span class="sxs-lookup"><span data-stu-id="ba29f-204">Only endpoint bindings are supported.</span></span> <span data-ttu-id="ba29f-205">Se si specifica altro rispetto a <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint>, viene generata un'eccezione <xref:System.NotSupportedException>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-205">If anything other <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> is specified, a <xref:System.NotSupportedException> will be thrown.</span></span> <span data-ttu-id="ba29f-206">Se il sistema operativo sottostante supporta l'associazione di canale, il <xref:System.Net.TransportContext.GetChannelBinding%2A> metodo restituirà un oggetto che effettua il <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> <xref:System.Runtime.InteropServices.SafeHandle> wrapping di un puntatore a un'associazione di canale adatta per passare alla funzione [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) come membro pvBuffer di una struttura SecBuffer passata nel `pInput` parametro.</span><span class="sxs-lookup"><span data-stu-id="ba29f-206">If the underlying operating system supports channel binding, the <xref:System.Net.TransportContext.GetChannelBinding%2A> method will return a <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> wrapping a pointer to a channel binding suitable for passing to [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function as the pvBuffer member of a SecBuffer structure passed in the `pInput` parameter.</span></span> <span data-ttu-id="ba29f-207">La proprietà <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> contiene la lunghezza in byte dell'associazione di canali.</span><span class="sxs-lookup"><span data-stu-id="ba29f-207">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> property contains the length, in bytes, of the channel binding.</span></span> <span data-ttu-id="ba29f-208">Se il sistema operativo sottostante non supporta le associazioni di canali, la funzione restituisce `null`.</span><span class="sxs-lookup"><span data-stu-id="ba29f-208">If the underlying operating system does not support channel bindings, the function will return `null`.</span></span>  
  
 <span data-ttu-id="ba29f-209">Un altro possibile scenario consiste nell'abilitare la protezione estesa per i `HTTP://` prefissi quando i proxy non vengono usati.</span><span class="sxs-lookup"><span data-stu-id="ba29f-209">Another possible scenario is to enable extended protection for `HTTP://` prefixes when proxies are not used.</span></span> <span data-ttu-id="ba29f-210">In questo caso, impostare <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> su <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> con <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> impostato su <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> o <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> e <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> impostato su <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected>. Il valore <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> attiva la modalità parzialmente avanzata per <xref:System.Net.HttpListener>, mentre <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corrisponde alla modalità completamente avanzata.</span><span class="sxs-lookup"><span data-stu-id="ba29f-210">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="ba29f-211">Viene creato un elenco predefinito dei nomi di servizio consentiti in base ai prefissi registrati con <xref:System.Net.HttpListener>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-211">A default list of allowed service names is created based on the prefixes which have been registered with the <xref:System.Net.HttpListener>.</span></span> <span data-ttu-id="ba29f-212">Questo elenco predefinito può essere esaminato tramite la proprietà <xref:System.Net.HttpListener.DefaultServiceNames%2A>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-212">This default list can be examined through the <xref:System.Net.HttpListener.DefaultServiceNames%2A> property.</span></span> <span data-ttu-id="ba29f-213">Se questo elenco non è completo, un'applicazione può specificare una raccolta di nomi di servizio personalizzata nel costruttore per la classe <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy>, da usare al posto dell'elenco dei nomi di servizio predefinito.</span><span class="sxs-lookup"><span data-stu-id="ba29f-213">If this list is not comprehensive, an application can specify a custom service name collection in the constructor for the <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class which will be used instead of the default service name list.</span></span>  
  
 <span data-ttu-id="ba29f-214">Quando in questa configurazione viene effettuata una richiesta al server tramite un canale sicuro esterno, l'autenticazione procede normalmente senza alcun controllo dell'associazione di canali.</span><span class="sxs-lookup"><span data-stu-id="ba29f-214">In this configuration, when a request is made to the server without an outer secure channel authentication proceeds normally without a channel binding check.</span></span> <span data-ttu-id="ba29f-215">Se l'autenticazione riesce, viene eseguita una query sul contesto per ottenere il nome di servizio fornito dal client e convalidato rispetto all'elenco dei nomi di servizio accettabili.</span><span class="sxs-lookup"><span data-stu-id="ba29f-215">If the authentication succeeds, the context is queried for the service name that the client provided and validated against the list of acceptable service names.</span></span> <span data-ttu-id="ba29f-216">I risultati possono essere quattro:</span><span class="sxs-lookup"><span data-stu-id="ba29f-216">There are four possible outcomes:</span></span>  
  
1. <span data-ttu-id="ba29f-217">Il sistema operativo sottostante del server non supporta la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-217">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="ba29f-218">La richiesta non viene esposta all'applicazione e viene restituita una risposta di mancata autorizzazione (401) al client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-218">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="ba29f-219">Viene registrato un messaggio nell'origine di traccia <xref:System.Net.HttpListener> che specifica il motivo dell'errore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-219">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2. <span data-ttu-id="ba29f-220">Il sistema operativo sottostante del client non supporta la protezione estesa.</span><span class="sxs-lookup"><span data-stu-id="ba29f-220">The client’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="ba29f-221">Nella configurazione <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> il tentativo di autenticazione riesce e la richiesta viene restituita all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-221">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> configuration, the authentication attempt will succeed and the request will be returned to the application.</span></span> <span data-ttu-id="ba29f-222">Nella configurazione <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> il tentativo di autenticazione non riesce.</span><span class="sxs-lookup"><span data-stu-id="ba29f-222">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> configuration, the authentication attempt will fail.</span></span> <span data-ttu-id="ba29f-223">La richiesta non viene esposta all'applicazione e viene restituita una risposta di mancata autorizzazione (401) al client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-223">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="ba29f-224">Viene registrato un messaggio nell'origine di traccia <xref:System.Net.HttpListener> che specifica il motivo dell'errore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-224">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3. <span data-ttu-id="ba29f-225">Il sistema operativo sottostante del client supporta la protezione estesa, ma l'applicazione non ha specificato un'associazione di servizi.</span><span class="sxs-lookup"><span data-stu-id="ba29f-225">The client’s underlying operating system supports extended protection, but the application did not specify a service binding.</span></span> <span data-ttu-id="ba29f-226">La richiesta non viene esposta all'applicazione e viene restituita una risposta di mancata autorizzazione (401) al client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-226">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="ba29f-227">Viene registrato un messaggio nell'origine di traccia <xref:System.Net.HttpListener> che specifica il motivo dell'errore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-227">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
4. <span data-ttu-id="ba29f-228">Il client ha specificato un'associazione di servizi.</span><span class="sxs-lookup"><span data-stu-id="ba29f-228">The client specified a service binding.</span></span> <span data-ttu-id="ba29f-229">L'associazione di servizi viene confrontata con l'elenco delle associazioni consentite.</span><span class="sxs-lookup"><span data-stu-id="ba29f-229">The service binding is compared to the list of allowed service bindings.</span></span> <span data-ttu-id="ba29f-230">Se corrisponde, la richiesta viene restituita all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ba29f-230">If it matches, the request is returned to the application.</span></span> <span data-ttu-id="ba29f-231">In caso contrario, la richiesta non viene esposta all'applicazione e viene automaticamente restituita una risposta di mancata autorizzazione (401) al client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-231">Otherwise, the request will not be exposed to the application, and an unauthorized (401) response will be automatically returned to the client.</span></span> <span data-ttu-id="ba29f-232">Viene registrato un messaggio nell'origine di traccia <xref:System.Net.HttpListener> che specifica il motivo dell'errore.</span><span class="sxs-lookup"><span data-stu-id="ba29f-232">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
 <span data-ttu-id="ba29f-233">Se questo semplice approccio tramite un elenco di nomi di servizio accettabili è insufficiente, un'applicazione può fornire la propria convalida del nome di servizio eseguendo una query sulla proprietà <xref:System.Net.HttpListenerRequest.ServiceName%2A>.</span><span class="sxs-lookup"><span data-stu-id="ba29f-233">If this simple approach using an allowed list of acceptable service names is insufficient, an application may provide its own service name validation by querying the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property.</span></span> <span data-ttu-id="ba29f-234">Nei casi 1 e 2 descritti sopra la proprietà restituisce `null`.</span><span class="sxs-lookup"><span data-stu-id="ba29f-234">In cases 1 and 2 above, the property will return `null`.</span></span> <span data-ttu-id="ba29f-235">Nel caso 3 la proprietà restituisce una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="ba29f-235">In case 3, it will return an empty string.</span></span> <span data-ttu-id="ba29f-236">Nel caso 4 viene restituito il nome di servizio specificato dal client.</span><span class="sxs-lookup"><span data-stu-id="ba29f-236">In case 4, the service name specified by the client will be returned.</span></span>  
  
 <span data-ttu-id="ba29f-237">Queste funzionalità di protezione estesa possono essere usate dalle applicazioni server anche per l'autenticazione con altri tipi di richieste e quando si usano proxy attendibili.</span><span class="sxs-lookup"><span data-stu-id="ba29f-237">These extended protection features can also be used by server applications for authentication with other types of requests and when trusted proxies are used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ba29f-238">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ba29f-238">See also</span></span>

- <xref:System.Security.Authentication.ExtendedProtection>
- <xref:System.Security.Authentication.ExtendedProtection.Configuration>
