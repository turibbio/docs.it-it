---
title: 'Attributi riservati di C: analisi statica nullable'
ms.date: 04/14/2020
description: Questi attributi vengono interpretati dal compilatore per fornire un'analisi statica migliore per i tipi di riferimento nullable e non nullable.
ms.openlocfilehash: 33521133a6a01196e6e1ab9c3cdc191a24f1ecf3
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2020
ms.locfileid: "82102710"
---
# <a name="reserved-attributes-contribute-to-the-compilers-null-state-static-analysis"></a><span data-ttu-id="3250d-103">Gli attributi riservati contribuiscono all'analisi statica dello stato null del compilatore</span><span class="sxs-lookup"><span data-stu-id="3250d-103">Reserved attributes contribute to the compiler's null state static analysis</span></span>

<span data-ttu-id="3250d-104">In un contesto nullable, il compilatore esegue l'analisi statica del codice per determinare lo stato null di tutte le variabili di tipo riferimento:In a nullable context, the compiler performs static analysis of code to determine the null state of all reference type variables:</span><span class="sxs-lookup"><span data-stu-id="3250d-104">In a nullable context, the compiler performs static analysis of code to determine the null state of all reference type variables:</span></span>

- <span data-ttu-id="3250d-105">*non null*: l'analisi statica ha determinato che la variabile viene assegnata a un valore non null.</span><span class="sxs-lookup"><span data-stu-id="3250d-105">*not null*: Static analysis determined that the variable is assigned to a non-null value.</span></span>
- <span data-ttu-id="3250d-106">*forse null*: L'analisi statica non può determinare che a una variabile sia assegnato un valore non null.</span><span class="sxs-lookup"><span data-stu-id="3250d-106">*maybe null*: Static analysis cannot determine that a variable is assigned a non-null value.</span></span>

<span data-ttu-id="3250d-107">È possibile applicare un numero di attributi che forniscono informazioni al compilatore sulla semantica delle API.</span><span class="sxs-lookup"><span data-stu-id="3250d-107">You can apply a number of attributes that provide information to the compiler about the semantics of your APIs.</span></span> <span data-ttu-id="3250d-108">Tali informazioni consentono al compilatore di eseguire l'analisi statica e determinare quando una variabile non è null.</span><span class="sxs-lookup"><span data-stu-id="3250d-108">That information helps the compiler perform static analysis and determine when a variable is not null.</span></span> <span data-ttu-id="3250d-109">In questo articolo viene fornita una breve descrizione di ognuno di questi attributi e di come utilizzarli.</span><span class="sxs-lookup"><span data-stu-id="3250d-109">This article provides a brief description of each of those attributes and how to use them.</span></span> <span data-ttu-id="3250d-110">Tutti gli esempi presuppongono che il linguaggio c'è 8.0 o più recente e il codice si trova in un contesto nullable.</span><span class="sxs-lookup"><span data-stu-id="3250d-110">All the examples assume C# 8.0 or newer, and the code is in a nullable context.</span></span>

<span data-ttu-id="3250d-111">Iniziamo con un esempio familiare.</span><span class="sxs-lookup"><span data-stu-id="3250d-111">Let's start with a familiar example.</span></span> <span data-ttu-id="3250d-112">Si supponga che la libreria disponga dell'API seguente per recuperare una stringa di risorsa:Imagine your library has the following API to retrieve a resource string:</span><span class="sxs-lookup"><span data-stu-id="3250d-112">Imagine your library has the following API to retrieve a resource string:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="3250d-113">L'esempio precedente segue `Try*` il modello familiare in .NET.</span><span class="sxs-lookup"><span data-stu-id="3250d-113">The preceding example follows the familiar `Try*` pattern in .NET.</span></span> <span data-ttu-id="3250d-114">Esistono due argomenti di riferimento `key` per `message` questa API: il e il parametro.</span><span class="sxs-lookup"><span data-stu-id="3250d-114">There are two reference arguments for this API: the `key` and the `message` parameter.</span></span> <span data-ttu-id="3250d-115">Questa API ha le seguenti regole relative al nullo di questi argomenti:</span><span class="sxs-lookup"><span data-stu-id="3250d-115">This API has the following rules relating to the nullness of these arguments:</span></span>

- <span data-ttu-id="3250d-116">I chiamanti non `null` devono passare `key`come argomento per .</span><span class="sxs-lookup"><span data-stu-id="3250d-116">Callers shouldn't pass `null` as the argument for `key`.</span></span>
- <span data-ttu-id="3250d-117">I chiamanti possono passare `null` una variabile `message`il cui valore è come argomento per .</span><span class="sxs-lookup"><span data-stu-id="3250d-117">Callers can pass a variable whose value is `null` as the argument for `message`.</span></span>
- <span data-ttu-id="3250d-118">Se `TryGetMessage` il `true`metodo restituisce `message` , il valore di non è null.</span><span class="sxs-lookup"><span data-stu-id="3250d-118">If the `TryGetMessage` method returns `true`, the value of `message` isn't null.</span></span> <span data-ttu-id="3250d-119">Se il valore `false,` restituito `message` è il valore di (e il relativo stato null) è null.</span><span class="sxs-lookup"><span data-stu-id="3250d-119">If the return value is `false,` the value of `message` (and its null state) is null.</span></span>

<span data-ttu-id="3250d-120">La regola `key` per può essere espressa `key` dal tipo di variabile: deve essere un tipo di riferimento non nullable.</span><span class="sxs-lookup"><span data-stu-id="3250d-120">The rule for `key` can be expressed by the variable type: `key` should be a non-nullable reference type.</span></span> <span data-ttu-id="3250d-121">Il `message` parametro è più complesso.</span><span class="sxs-lookup"><span data-stu-id="3250d-121">The `message` parameter is more complex.</span></span> <span data-ttu-id="3250d-122">Permette `null` come argomento, ma garantisce che, `out` in caso di esito positivo, tale argomento non sia null.</span><span class="sxs-lookup"><span data-stu-id="3250d-122">It allows `null` as the argument, but guarantees that, on success, that `out` argument isn't null.</span></span> <span data-ttu-id="3250d-123">Per questi scenari, è necessario un vocabolario più ricco per descrivere le aspettative.</span><span class="sxs-lookup"><span data-stu-id="3250d-123">For these scenarios, you need a richer vocabulary to describe the expectations.</span></span>

<span data-ttu-id="3250d-124">Sono stati aggiunti diversi attributi per esprimere informazioni aggiuntive sullo stato null delle variabili.</span><span class="sxs-lookup"><span data-stu-id="3250d-124">Several attributes have been added to express additional information about the null state of variables.</span></span> <span data-ttu-id="3250d-125">Tutto il codice scritto prima dell'introduzione di tipi di riferimento nullable in C, 8, era *null oblio.*</span><span class="sxs-lookup"><span data-stu-id="3250d-125">All code you wrote before C# 8 introduced nullable reference types was *null oblivious*.</span></span> <span data-ttu-id="3250d-126">Ciò significa che qualsiasi variabile di tipo riferimento può essere null, ma i controlli null non sono necessari.</span><span class="sxs-lookup"><span data-stu-id="3250d-126">That means any reference type variable may be null, but null checks aren't required.</span></span> <span data-ttu-id="3250d-127">Una volta che il codice è *nullable in grado di riconoscere*, tali regole cambiano.</span><span class="sxs-lookup"><span data-stu-id="3250d-127">Once your code is *nullable aware*, those rules change.</span></span> <span data-ttu-id="3250d-128">I tipi di `null` riferimento non devono mai essere il `null` valore e i tipi di riferimento nullable devono essere confrontati prima di essere dereferenziati.</span><span class="sxs-lookup"><span data-stu-id="3250d-128">Reference types should never be the `null` value, and nullable reference types must be checked against `null` before being dereferenced.</span></span>

<span data-ttu-id="3250d-129">Le regole per le API sono probabilmente più `TryGetValue` complicate, come si è visto con lo scenario API.</span><span class="sxs-lookup"><span data-stu-id="3250d-129">The rules for your APIs are likely more complicated, as you saw with the `TryGetValue` API scenario.</span></span> <span data-ttu-id="3250d-130">Molte delle API hanno regole più complesse per quando le `null`variabili possono o non possono essere .</span><span class="sxs-lookup"><span data-stu-id="3250d-130">Many of your APIs have more complex rules for when variables can or can't be `null`.</span></span> <span data-ttu-id="3250d-131">In questi casi, si utilizzerà uno dei seguenti attributi per esprimere tali regole:</span><span class="sxs-lookup"><span data-stu-id="3250d-131">In these cases, you'll use one of the following attributes to express those rules:</span></span>

- <span data-ttu-id="3250d-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Un argomento di input non nullable può essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="3250d-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argomento di input nullable non deve mai essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="3250d-134">[MaybeNull:](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute)un valore restituito non nullable può essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="3250d-135">[NotNull:](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute)un valore restituito nullable non sarà mai null.</span><span class="sxs-lookup"><span data-stu-id="3250d-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="3250d-136">[ForseNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argomento di input non nullable può `bool` essere null quando il metodo restituisce il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="3250d-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argomento di input nullable non `bool` sarà null quando il metodo restituisce il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="3250d-138">[NotNullIfNotNull:](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute)un valore restituito non è null se l'argomento per il parametro specificato non è null.</span><span class="sxs-lookup"><span data-stu-id="3250d-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="3250d-139">[DoesNotReturn:](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute)un metodo non restituisce mai .</span><span class="sxs-lookup"><span data-stu-id="3250d-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="3250d-140">In altre parole, genera sempre un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="3250d-140">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="3250d-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): questo metodo non `bool` restituisce mai se il parametro associato ha il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>

<span data-ttu-id="3250d-142">Le descrizioni precedenti sono un riferimento rapido alle operazioni eseguite da ogni attributo.</span><span class="sxs-lookup"><span data-stu-id="3250d-142">The preceding descriptions are a quick reference to what each attribute does.</span></span> <span data-ttu-id="3250d-143">Ogni sezione seguente descrive il comportamento e il significato in modo più approfondito.</span><span class="sxs-lookup"><span data-stu-id="3250d-143">Each following section describes the behavior and meaning more thoroughly.</span></span>

<span data-ttu-id="3250d-144">L'aggiunta di questi attributi fornisce al compilatore ulteriori informazioni sulle regole per l'API.</span><span class="sxs-lookup"><span data-stu-id="3250d-144">Adding these attributes gives the compiler more information about the rules for your API.</span></span> <span data-ttu-id="3250d-145">Quando il codice chiamante viene compilato in un contesto abilitato nullable, il compilatore avviserà i chiamanti quando violano tali regole.</span><span class="sxs-lookup"><span data-stu-id="3250d-145">When calling code is compiled in a nullable enabled context, the compiler will warn callers when they violate those rules.</span></span> <span data-ttu-id="3250d-146">Questi attributi non abilitano controlli aggiuntivi sull'implementazione.</span><span class="sxs-lookup"><span data-stu-id="3250d-146">These attributes don't enable additional checks on your implementation.</span></span>

## <a name="specify-preconditions-allownull-and-disallownull"></a><span data-ttu-id="3250d-147">Specificare le `AllowNull` precondizioni: e`DisallowNull`</span><span class="sxs-lookup"><span data-stu-id="3250d-147">Specify preconditions: `AllowNull` and `DisallowNull`</span></span>

<span data-ttu-id="3250d-148">Si consideri una proprietà `null` di lettura/scrittura che non restituisce mai perché ha un valore predefinito ragionevole.</span><span class="sxs-lookup"><span data-stu-id="3250d-148">Consider a read/write property that never returns `null` because it has a reasonable default value.</span></span> <span data-ttu-id="3250d-149">I chiamanti passano `null` alla funzione di accesso set quando lo impostano sul valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="3250d-149">Callers pass `null` to the set accessor when setting it to that default value.</span></span> <span data-ttu-id="3250d-150">Si consideri, ad esempio, un sistema di messaggistica che richiede un nome di schermata in una chat room.</span><span class="sxs-lookup"><span data-stu-id="3250d-150">For example, consider a messaging system that asks for a screen name in a chat room.</span></span> <span data-ttu-id="3250d-151">Se non viene fornito alcun nome, il sistema genera un nome casuale:If noe is provided, the system generates a random name:</span><span class="sxs-lookup"><span data-stu-id="3250d-151">If none is provided, the system generates a random name:</span></span>

```csharp
public string ScreenName
{
   get => screenName;
   set => screenName = value ?? GenerateRandomScreenName();
}
private string screenName;
```

<span data-ttu-id="3250d-152">Quando si compila il codice precedente in un contesto ignario nullable, tutto va bene.</span><span class="sxs-lookup"><span data-stu-id="3250d-152">When you compile the preceding code in a nullable oblivious context, everything is fine.</span></span> <span data-ttu-id="3250d-153">Dopo aver abilitato i tipi `ScreenName` di riferimento nullable, la proprietà diventa un riferimento non nullable.</span><span class="sxs-lookup"><span data-stu-id="3250d-153">Once you enable nullable reference types, the `ScreenName` property becomes a non-nullable reference.</span></span> <span data-ttu-id="3250d-154">Questo è corretto `get` per la funzione `null`di accesso: non restituisce mai .</span><span class="sxs-lookup"><span data-stu-id="3250d-154">That's correct for the `get` accessor: it never returns `null`.</span></span> <span data-ttu-id="3250d-155">I chiamanti non devono controllare la `null`proprietà restituita per .</span><span class="sxs-lookup"><span data-stu-id="3250d-155">Callers don't need to check the returned property for `null`.</span></span> <span data-ttu-id="3250d-156">Ma ora l'impostazione della proprietà su `null` genera un avviso.</span><span class="sxs-lookup"><span data-stu-id="3250d-156">But now setting the property to `null` generates a warning.</span></span> <span data-ttu-id="3250d-157">Per continuare a supportare questo tipo di <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> codice, aggiungere l'attributo alla proprietà, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="3250d-157">In order to continue to support this type of code, you add the <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> attribute to the property, as shown in the following code:</span></span>

```csharp
[AllowNull]
public string ScreenName
{
   get => screenName;
   set => screenName = value ?? GenerateRandomScreenName();
}
private string screenName = GenerateRandomScreenName();
```

<span data-ttu-id="3250d-158">Potrebbe essere necessario `using` aggiungere <xref:System.Diagnostics.CodeAnalysis> una direttiva per utilizzare questo e altri attributi illustrati in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="3250d-158">You may need to add a `using` directive for <xref:System.Diagnostics.CodeAnalysis> to use this and other attributes discussed in this article.</span></span> <span data-ttu-id="3250d-159">L'attributo viene applicato alla `set` proprietà, non alla funzione di accesso.</span><span class="sxs-lookup"><span data-stu-id="3250d-159">The attribute is applied to the property, not the `set` accessor.</span></span> <span data-ttu-id="3250d-160">L'attributo `AllowNull` specifica le *precondizioni*e si applica solo agli input.</span><span class="sxs-lookup"><span data-stu-id="3250d-160">The `AllowNull` attribute specifies *pre-conditions*, and only applies to inputs.</span></span> <span data-ttu-id="3250d-161">La `get` funzione di accesso ha un valore restituito, ma nessun argomento di input.</span><span class="sxs-lookup"><span data-stu-id="3250d-161">The `get` accessor has a return value, but no input arguments.</span></span> <span data-ttu-id="3250d-162">Pertanto, `AllowNull` l'attributo `set` si applica solo alla funzione di accesso.</span><span class="sxs-lookup"><span data-stu-id="3250d-162">Therefore, the `AllowNull` attribute only applies to the `set` accessor.</span></span>

<span data-ttu-id="3250d-163">Nell'esempio precedente viene illustrato cosa `AllowNull` cercare quando si aggiunge l'attributo su un argomento:The preceding example demonstrates what to look for when adding the attribute on an argument:</span><span class="sxs-lookup"><span data-stu-id="3250d-163">The preceding example demonstrates what to look for when adding the `AllowNull` attribute on an argument:</span></span>

1. <span data-ttu-id="3250d-164">Il contratto generale per tale variabile è `null`che non deve essere , pertanto si desidera un tipo di riferimento non nullable.</span><span class="sxs-lookup"><span data-stu-id="3250d-164">The general contract for that variable is that it shouldn't be `null`, so you want a non-nullable reference type.</span></span>
1. <span data-ttu-id="3250d-165">Esistono scenari affinché la `null`variabile di input sia , anche se non sono l'utilizzo più comune.</span><span class="sxs-lookup"><span data-stu-id="3250d-165">There are scenarios for the input variable to be `null`, though they aren't the most common usage.</span></span>

<span data-ttu-id="3250d-166">Molto spesso questo attributo è necessario `in` `out`per `ref` le proprietà o , e gli argomenti .</span><span class="sxs-lookup"><span data-stu-id="3250d-166">Most often you'll need this attribute for properties, or `in`, `out`, and `ref` arguments.</span></span> <span data-ttu-id="3250d-167">L'attributo `AllowNull` è la scelta migliore quando una variabile è `null` in genere non null, ma è necessario consentire come precondizione.</span><span class="sxs-lookup"><span data-stu-id="3250d-167">The `AllowNull` attribute is the best choice when a variable is typically non-null, but you need to allow `null` as a precondition.</span></span>

<span data-ttu-id="3250d-168">A differenza di `DisallowNull`ciò con gli scenari per l'utilizzo: questo attributo viene `null`utilizzato per specificare che una variabile di input di un tipo di riferimento nullable non deve essere .</span><span class="sxs-lookup"><span data-stu-id="3250d-168">Contrast that with scenarios for using `DisallowNull`: You use this attribute to specify that an input variable of a nullable reference type shouldn't be `null`.</span></span> <span data-ttu-id="3250d-169">Si consideri `null` una proprietà in cui è il valore predefinito, ma i client possono impostarla solo su un valore non null.</span><span class="sxs-lookup"><span data-stu-id="3250d-169">Consider a property where `null` is the default value, but clients can only set it to a non-null value.</span></span> <span data-ttu-id="3250d-170">Esaminare il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="3250d-170">Consider the following code:</span></span>

```csharp
public string ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string _comment;
```

<span data-ttu-id="3250d-171">Il codice precedente è il modo migliore `ReviewComment` per `null`esprimere il progetto che `null`potrebbe essere , ma non può essere impostato su .</span><span class="sxs-lookup"><span data-stu-id="3250d-171">The preceding code is the best way to express your design that the `ReviewComment` could be `null`, but can't be set to `null`.</span></span> <span data-ttu-id="3250d-172">Una volta che questo codice è nullable in grado di <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>riconoscere, è possibile esprimere questo concetto in modo più chiaro ai chiamanti utilizzando il:</span><span class="sxs-lookup"><span data-stu-id="3250d-172">Once this code is nullable aware, you can express this concept more clearly to callers using the <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>:</span></span>

```csharp
[DisallowNull]
public string? ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string? _comment;
```

<span data-ttu-id="3250d-173">In un contesto `ReviewComment` `get` nullable, la funzione `null`di accesso potrebbe restituire il valore predefinito di .</span><span class="sxs-lookup"><span data-stu-id="3250d-173">In a nullable context, the `ReviewComment` `get` accessor could return the default value of `null`.</span></span> <span data-ttu-id="3250d-174">Il compilatore avverte che deve essere controllato prima dell'accesso.</span><span class="sxs-lookup"><span data-stu-id="3250d-174">The compiler warns that it must be checked before access.</span></span> <span data-ttu-id="3250d-175">Inoltre, avvisa i chiamanti che, anche `null`se potrebbe essere , i `null`chiamanti non devono impostarlo in modo esplicito su .</span><span class="sxs-lookup"><span data-stu-id="3250d-175">Furthermore, it warns callers that, even though it could be `null`, callers shouldn't explicitly set it to `null`.</span></span> <span data-ttu-id="3250d-176">L'attributo `DisallowNull` specifica anche una *precondizione*, `get` non influisce sulla funzione di accesso.</span><span class="sxs-lookup"><span data-stu-id="3250d-176">The `DisallowNull` attribute also specifies a *pre-condition*, it does not affect the `get` accessor.</span></span> <span data-ttu-id="3250d-177">Utilizzare l'attributo `DisallowNull` quando si osservano queste caratteristiche su:</span><span class="sxs-lookup"><span data-stu-id="3250d-177">You use the `DisallowNull` attribute when you observe these characteristics about:</span></span>

1. <span data-ttu-id="3250d-178">La variabile `null` potrebbe essere in scenari principali, spesso quando viene creata la prima istanza.</span><span class="sxs-lookup"><span data-stu-id="3250d-178">The variable could be `null` in core scenarios, often when first instantiated.</span></span>
1. <span data-ttu-id="3250d-179">La variabile non deve essere `null`impostata in modo esplicito su .</span><span class="sxs-lookup"><span data-stu-id="3250d-179">The variable shouldn't be explicitly set to `null`.</span></span>

<span data-ttu-id="3250d-180">Queste situazioni sono comuni nel codice che in origine era *null oblio .*</span><span class="sxs-lookup"><span data-stu-id="3250d-180">These situations are common in code that was originally *null oblivious*.</span></span> <span data-ttu-id="3250d-181">È possibile che le proprietà dell'oggetto siano impostate in due operazioni di inizializzazione distinte.</span><span class="sxs-lookup"><span data-stu-id="3250d-181">It may be that object properties are set in two distinct initialization operations.</span></span> <span data-ttu-id="3250d-182">È possibile che alcune proprietà vengano impostate solo dopo il completamento di alcune operazioni asincrone.</span><span class="sxs-lookup"><span data-stu-id="3250d-182">It may be that some properties are set only after some asynchronous work has completed.</span></span>

<span data-ttu-id="3250d-183">Gli `AllowNull` `DisallowNull` attributi e consentono di specificare che le precondizioni sulle variabili potrebbero non corrispondere alle annotazioni nullable in tali variabili.</span><span class="sxs-lookup"><span data-stu-id="3250d-183">The `AllowNull` and `DisallowNull` attributes enable you to specify that preconditions on variables may not match the nullable annotations on those variables.</span></span> <span data-ttu-id="3250d-184">Questi forniscono maggiori dettagli sulle caratteristiche dell'API.</span><span class="sxs-lookup"><span data-stu-id="3250d-184">These provide more detail about the characteristics of your API.</span></span> <span data-ttu-id="3250d-185">Queste informazioni aggiuntive consentono ai chiamanti di utilizzare correttamente l'API.</span><span class="sxs-lookup"><span data-stu-id="3250d-185">This additional information helps callers use your API correctly.</span></span> <span data-ttu-id="3250d-186">Tenere presente che si specificano le precondizioni utilizzando i seguenti attributi:</span><span class="sxs-lookup"><span data-stu-id="3250d-186">Remember you specify preconditions using the following attributes:</span></span>

- <span data-ttu-id="3250d-187">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Un argomento di input non nullable può essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-187">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="3250d-188">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argomento di input nullable non deve mai essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-188">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>

## <a name="specify-post-conditions-maybenull-and-notnull"></a><span data-ttu-id="3250d-189">Specificare le `MaybeNull` post-condizioni: e`NotNull`</span><span class="sxs-lookup"><span data-stu-id="3250d-189">Specify post-conditions: `MaybeNull` and `NotNull`</span></span>

<span data-ttu-id="3250d-190">Si supponga di disporre di un metodo con la firma seguente:</span><span class="sxs-lookup"><span data-stu-id="3250d-190">Suppose you have a method with the following signature:</span></span>

```csharp
public Customer FindCustomer(string lastName, string firstName)
```

<span data-ttu-id="3250d-191">Probabilmente hai scritto un metodo `null` come questo per restituire quando il nome cercato non è stato trovato.</span><span class="sxs-lookup"><span data-stu-id="3250d-191">You've likely written a method like this to return `null` when the name sought wasn't found.</span></span> <span data-ttu-id="3250d-192">Indica `null` chiaramente che il record non è stato trovato.</span><span class="sxs-lookup"><span data-stu-id="3250d-192">The `null` clearly indicates that the record wasn't found.</span></span> <span data-ttu-id="3250d-193">In questo esempio, è probabile che `Customer` si `Customer?`modifichi il tipo restituito da a .</span><span class="sxs-lookup"><span data-stu-id="3250d-193">In this example, you'd likely change the return type from `Customer` to `Customer?`.</span></span> <span data-ttu-id="3250d-194">La dichiarazione del valore restituito come tipo di riferimento nullable specifica chiaramente lo scopo di questa API.</span><span class="sxs-lookup"><span data-stu-id="3250d-194">Declaring the return value as a nullable reference type specifies the intent of this API clearly.</span></span>

<span data-ttu-id="3250d-195">Per i motivi trattati in [Definizioni generiche e supporto di valori Null,](../../nullable-migration-strategies.md#generic-definitions-and-nullability) tale tecnica non funziona con i metodi generici.</span><span class="sxs-lookup"><span data-stu-id="3250d-195">For reasons covered under [Generic definitions and nullability](../../nullable-migration-strategies.md#generic-definitions-and-nullability) that technique does not work with generic methods.</span></span> <span data-ttu-id="3250d-196">Si può avere un metodo generico che segue un modello simile:You may have a generic method that follows a similar pattern:</span><span class="sxs-lookup"><span data-stu-id="3250d-196">You may have a generic method that follows a similar pattern:</span></span>

```csharp
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> match)
```

<span data-ttu-id="3250d-197">Non è possibile specificare che `T?`il valore restituito sia .</span><span class="sxs-lookup"><span data-stu-id="3250d-197">You can't specify that the return value is `T?`.</span></span> <span data-ttu-id="3250d-198">Il metodo `null` restituisce quando l'elemento cercato non viene trovato.</span><span class="sxs-lookup"><span data-stu-id="3250d-198">The method returns `null` when the sought item isn't found.</span></span> <span data-ttu-id="3250d-199">Poiché non è `T?` possibile dichiarare un `MaybeNull` tipo restituito, aggiungere l'annotazione al metodo restituito:Since you can't declare a return type, you add the annotation to the method return:</span><span class="sxs-lookup"><span data-stu-id="3250d-199">Since you can't declare a `T?` return type, you add the `MaybeNull` annotation to the method return:</span></span>

```csharp
[return: MaybeNull]
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> match)
```

<span data-ttu-id="3250d-200">Il codice precedente informa i chiamanti che il contratto implica un tipo non nullable, ma il valore restituito *può* effettivamente essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-200">The preceding code informs callers that the contract implies a non-nullable type, but the return value *may* actually be null.</span></span>  <span data-ttu-id="3250d-201">Usare `MaybeNull` l'attributo quando l'API deve essere un tipo non nullable, `null` in genere un parametro di tipo generico, ma possono essere presenti istanze in cui verrebbero restituite.</span><span class="sxs-lookup"><span data-stu-id="3250d-201">Use the `MaybeNull` attribute when your API should be a non-nullable type, typically a generic type parameter, but there may be instances where `null` would be returned.</span></span>

<span data-ttu-id="3250d-202">È inoltre possibile specificare che `out` `ref` un valore restituito o un argomento o non è null anche se il tipo è un tipo di riferimento nullable.</span><span class="sxs-lookup"><span data-stu-id="3250d-202">You can also specify that a return value or an `out` or `ref` argument isn't null even though the type is a nullable reference type.</span></span> <span data-ttu-id="3250d-203">Si consideri un metodo che garantisce che una matrice sia sufficientemente grande da contenere un numero di elementi.</span><span class="sxs-lookup"><span data-stu-id="3250d-203">Consider a method that ensures an array is large enough to hold a number of elements.</span></span> <span data-ttu-id="3250d-204">Se l'argomento di input non dispone di capacità, la routine allocherebbe una nuova matrice e copia tutti gli elementi esistenti in essa.</span><span class="sxs-lookup"><span data-stu-id="3250d-204">If the input argument doesn't have capacity, the routine would allocate a new array and copy all the existing elements into it.</span></span> <span data-ttu-id="3250d-205">Se l'argomento `null`input è , la routine allocherà nuova risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="3250d-205">If the input argument is `null`, the routine would allocate new storage.</span></span> <span data-ttu-id="3250d-206">Se la capacità è sufficiente, la routine non esegue alcuna operazione:If there's sufficient capacity, the routine does nothing:</span><span class="sxs-lookup"><span data-stu-id="3250d-206">If there's sufficient capacity, the routine does nothing:</span></span>

```csharp
public void EnsureCapacity<T>(ref T[] storage, int size)
```

<span data-ttu-id="3250d-207">È possibile chiamare questa routine come segue:</span><span class="sxs-lookup"><span data-stu-id="3250d-207">You could call this routine as follows:</span></span>

```csharp
// messages has the default value (null) when EnsureCapacity is called:
EnsureCapacity<string>(ref messages, 10);
// messages is not null.
EnsureCapacity<string>(messages, 50);
```

<span data-ttu-id="3250d-208">Dopo aver abilitato i tipi di riferimento null, si desidera assicurarsi che il codice precedente venga compilato senza avvisi.</span><span class="sxs-lookup"><span data-stu-id="3250d-208">After enabling null reference types, you want to ensure that the preceding code compiles without warnings.</span></span> <span data-ttu-id="3250d-209">Quando il metodo `storage` restituisce , l'argomento è garantito non essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-209">When the method returns, the `storage` argument is guaranteed to be not null.</span></span> <span data-ttu-id="3250d-210">Tuttavia, è accettabile `EnsureCapacity` chiamare con un riferimento null.</span><span class="sxs-lookup"><span data-stu-id="3250d-210">However, it's acceptable to call `EnsureCapacity` with a null reference.</span></span> <span data-ttu-id="3250d-211">È possibile `storage` creare un tipo di `NotNull` riferimento nullable e aggiungere la post-condizione alla dichiarazione del parametro:You can make a nullable reference type, and add the post-condition to the parameter declaration:</span><span class="sxs-lookup"><span data-stu-id="3250d-211">You can make `storage` a nullable reference type, and add the `NotNull` post-condition to the parameter declaration:</span></span>

```csharp
public void EnsureCapacity<T>([NotNull]ref T[]? storage, int size)
```

<span data-ttu-id="3250d-212">Il codice precedente esprime chiaramente il contratto esistente: `null` i chiamanti possono passare una variabile con il valore, ma il valore restituito è garantito per non essere mai null.</span><span class="sxs-lookup"><span data-stu-id="3250d-212">The preceding code expresses the existing contract clearly: Callers can pass a variable with the `null` value, but the return value is guaranteed to never be null.</span></span> <span data-ttu-id="3250d-213">`NotNull` L'attributo è `ref` `out` più `null` utile per e argomenti in cui può essere passato come argomento, ma tale argomento è garantito per essere non null quando il metodo restituisce.</span><span class="sxs-lookup"><span data-stu-id="3250d-213">The `NotNull` attribute is most useful for `ref` and `out` arguments where `null` may be passed as an argument, but that argument is guaranteed to be not null when the method returns.</span></span>

<span data-ttu-id="3250d-214">Le condizioni postcondizionali incondizionate vengono specificate utilizzando i seguenti attributi:</span><span class="sxs-lookup"><span data-stu-id="3250d-214">You specify unconditional postconditions using the following attributes:</span></span>

- <span data-ttu-id="3250d-215">[MaybeNull:](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute)un valore restituito non nullable può essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-215">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="3250d-216">[NotNull:](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute)un valore restituito nullable non sarà mai null.</span><span class="sxs-lookup"><span data-stu-id="3250d-216">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>

## <a name="specify-conditional-post-conditions-notnullwhen-maybenullwhen-and-notnullifnotnull"></a><span data-ttu-id="3250d-217">Specificare post-condizioni condizionali: `NotNullWhen`, `MaybeNullWhen`, e`NotNullIfNotNull`</span><span class="sxs-lookup"><span data-stu-id="3250d-217">Specify conditional post-conditions: `NotNullWhen`, `MaybeNullWhen`, and `NotNullIfNotNull`</span></span>

<span data-ttu-id="3250d-218">È probabile che si `string` <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>abbia familiarità con il metodo .</span><span class="sxs-lookup"><span data-stu-id="3250d-218">You're likely familiar with the `string` method <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>.</span></span> <span data-ttu-id="3250d-219">Questo metodo `true` restituisce quando l'argomento è null o una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="3250d-219">This method returns `true` when the argument is null or an empty string.</span></span> <span data-ttu-id="3250d-220">È una forma di controllo null: i chiamanti non devono controllare i `false`valori Null dell'argomento se il metodo restituisce .</span><span class="sxs-lookup"><span data-stu-id="3250d-220">It's a form of null-check: Callers don't need to null-check the argument if the method returns `false`.</span></span> <span data-ttu-id="3250d-221">Per rendere un metodo come questo nullable aware, è necessario impostare l'argomento su un tipo di riferimento nullable e aggiungere l'attributo:To make a method like this nullable aware, you'd set the argument to a nullable reference type, and add the `NotNullWhen` attribute:</span><span class="sxs-lookup"><span data-stu-id="3250d-221">To make a method like this nullable aware, you'd set the argument to a nullable reference type, and add the `NotNullWhen` attribute:</span></span>

```csharp
bool IsNullOrEmpty([NotNullWhen(false)]string? value);
```

<span data-ttu-id="3250d-222">In questo modo viene informa il `false` compilatore che qualsiasi codice in cui il valore restituito non deve essere controllato con null.</span><span class="sxs-lookup"><span data-stu-id="3250d-222">That informs the compiler that any code where the return value is `false` need not be null-checked.</span></span> <span data-ttu-id="3250d-223">L'aggiunta dell'attributo informa l'analisi statica del compilatore che `IsNullOrEmpty` esegue il controllo null necessario: quando restituisce `false`, l'argomento di input non `null`è .</span><span class="sxs-lookup"><span data-stu-id="3250d-223">The addition of the attribute informs the compiler's static analysis that `IsNullOrEmpty` performs the necessary null check: when it returns `false`, the input argument is not `null`.</span></span>

```csharp
string? userInput = GetUserInput();
if (!string.IsNullOrEmpty(userInput))
{
   int messageLength = userInput.Length; // no null check needed.
}
// null check needed on userInput here.
```

<span data-ttu-id="3250d-224">Il <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> metodo verrà annotato come illustrato in precedenza per .NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="3250d-224">The <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> method will be annotated as shown above for .NET Core 3.0.</span></span> <span data-ttu-id="3250d-225">È possibile disporre di metodi simili nella codebase che controllano lo stato degli oggetti per i valori null.</span><span class="sxs-lookup"><span data-stu-id="3250d-225">You may have similar methods in your codebase that check the state of objects for null values.</span></span> <span data-ttu-id="3250d-226">Il compilatore non riconoscerà i metodi di controllo null personalizzati e sarà necessario aggiungere le annotazioni manualmente.</span><span class="sxs-lookup"><span data-stu-id="3250d-226">The compiler won't recognize custom null check methods, and you'll need to add the annotations yourself.</span></span> <span data-ttu-id="3250d-227">Quando si aggiunge l'attributo, l'analisi statica del compilatore sa quando la variabile testata è stata controllata con null.</span><span class="sxs-lookup"><span data-stu-id="3250d-227">When you add the attribute, the compiler's static analysis knows when the tested variable has been null checked.</span></span>

<span data-ttu-id="3250d-228">Un altro utilizzo per `Try*` questi attributi è il modello.</span><span class="sxs-lookup"><span data-stu-id="3250d-228">Another use for these attributes is the `Try*` pattern.</span></span> <span data-ttu-id="3250d-229">Le postcondizioni per `ref` e `out` le variabili vengono comunicate tramite il valore restituito.</span><span class="sxs-lookup"><span data-stu-id="3250d-229">The postconditions for `ref` and `out` variables are communicated through the return value.</span></span> <span data-ttu-id="3250d-230">Si consideri questo metodo illustrato in precedenza:Consider this method shown earlier:</span><span class="sxs-lookup"><span data-stu-id="3250d-230">Consider this method shown earlier:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="3250d-231">Il metodo precedente segue un tipico linguaggio .NET: il `message` valore restituito indica se è stato impostato sul valore trovato o, se non viene trovato alcun messaggio, sul valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="3250d-231">The preceding method follows a typical .NET idiom: the return value indicates if `message` was set to the found value or, if no message is found, to the default value.</span></span> <span data-ttu-id="3250d-232">Se il `true`metodo restituisce `message` , il valore di non è null; in caso contrario, il metodo imposta `message` su null.</span><span class="sxs-lookup"><span data-stu-id="3250d-232">If the method returns `true`, the value of `message` isn't null; otherwise, the method sets `message` to null.</span></span>

<span data-ttu-id="3250d-233">È possibile comunicare tale idioma utilizzando l'attributo `NotNullWhen` .</span><span class="sxs-lookup"><span data-stu-id="3250d-233">You can communicate that idiom using the `NotNullWhen` attribute.</span></span> <span data-ttu-id="3250d-234">Quando si aggiorna la firma per `message` i `string?` tipi di riferimento nullable, creare un attributo e aggiungere un attributo:</span><span class="sxs-lookup"><span data-stu-id="3250d-234">When you update the signature for nullable reference types, make `message` a `string?` and add an attribute:</span></span>

```csharp
bool TryGetMessage(string key, [NotNullWhen(true)] out string? message)
```

<span data-ttu-id="3250d-235">Nell'esempio precedente, il `message` valore di è noto per essere non null quando `TryGetMessage` restituisce `true`.</span><span class="sxs-lookup"><span data-stu-id="3250d-235">In the preceding example, the value of `message` is known to be not null when `TryGetMessage` returns `true`.</span></span> <span data-ttu-id="3250d-236">È necessario annotare metodi simili nella codebase nello `null`stesso modo: gli argomenti potrebbero essere `true`, e sono noti per non essere null quando il metodo restituisce .</span><span class="sxs-lookup"><span data-stu-id="3250d-236">You should annotate similar methods in your codebase in the same way: the arguments could be `null`, and are known to be not null when the method returns `true`.</span></span>

<span data-ttu-id="3250d-237">C'è un attributo finale che potrebbe anche essere necessario.</span><span class="sxs-lookup"><span data-stu-id="3250d-237">There's one final attribute you may also need.</span></span> <span data-ttu-id="3250d-238">Talvolta lo stato null di un valore restituito dipende dallo stato null di uno o più argomenti di input.</span><span class="sxs-lookup"><span data-stu-id="3250d-238">Sometimes the null state of a return value depends on the null state of one or more input arguments.</span></span> <span data-ttu-id="3250d-239">Questi metodi restituiranno un valore non null ogni `null`volta che determinati argomenti di input non sono .</span><span class="sxs-lookup"><span data-stu-id="3250d-239">These methods will return a non-null value whenever certain input arguments aren't `null`.</span></span> <span data-ttu-id="3250d-240">Per annotare correttamente questi `NotNullIfNotNull` metodi, utilizzare l'attributo .</span><span class="sxs-lookup"><span data-stu-id="3250d-240">To correctly annotate these methods, you use the `NotNullIfNotNull` attribute.</span></span> <span data-ttu-id="3250d-241">Si consideri il metodo seguente:Consider the following method:</span><span class="sxs-lookup"><span data-stu-id="3250d-241">Consider the following method:</span></span>

```csharp
string GetTopLevelDomainFromFullUrl(string url);
```

<span data-ttu-id="3250d-242">Se `url` l'argomento non è null, `null`l'output non è .</span><span class="sxs-lookup"><span data-stu-id="3250d-242">If the `url` argument isn't null, the output isn't `null`.</span></span> <span data-ttu-id="3250d-243">Una volta abilitati i riferimenti nullable, tale firma funziona correttamente, a condizione che l'API non accetti mai un input null.</span><span class="sxs-lookup"><span data-stu-id="3250d-243">Once nullable references are enabled, that signature works correctly, provided your API never accepts a null input.</span></span> <span data-ttu-id="3250d-244">Tuttavia, se l'input potrebbe essere null, quindi valore restituito potrebbe anche essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-244">However, if the input could be null, then return value could also be null.</span></span> <span data-ttu-id="3250d-245">Pertanto, è possibile modificare la firma nel codice seguente:Therefore, you could change the signature to the following code:</span><span class="sxs-lookup"><span data-stu-id="3250d-245">Therefore, you could change the signature to the following code:</span></span>

```csharp
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="3250d-246">Anche questo funziona, ma spesso costringe `null` i chiamanti a implementare controlli aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="3250d-246">That also works, but will often force callers to implement extra `null` checks.</span></span> <span data-ttu-id="3250d-247">Il contratto è che `null` il valore restituito `url` `null`sarebbe solo quando l'argomento di input è .</span><span class="sxs-lookup"><span data-stu-id="3250d-247">The contract is that the return value would be `null` only when the input argument `url` is `null`.</span></span> <span data-ttu-id="3250d-248">Per esprimere tale contratto, è necessario annotare questo metodo come illustrato nel codice seguente:To express that contract, you would annotate this method as shown in the following code:</span><span class="sxs-lookup"><span data-stu-id="3250d-248">To express that contract, you would annotate this method as shown in the following code:</span></span>

```csharp
[return: NotNullIfNotNull("url")]
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="3250d-249">Il valore restituito e l'argomento sono stati `?` entrambi annotati con l'indicazione che uno dei due potrebbe essere `null`.</span><span class="sxs-lookup"><span data-stu-id="3250d-249">The return value and the argument have both been annotated with the `?` indicating that either could be `null`.</span></span> <span data-ttu-id="3250d-250">L'attributo chiarisce inoltre che il valore `url` restituito non `null`sarà null quando l'argomento non è .</span><span class="sxs-lookup"><span data-stu-id="3250d-250">The attribute further clarifies that the return value won't be null when the `url` argument isn't `null`.</span></span>

<span data-ttu-id="3250d-251">Le condizioni postcondizioni condizionali vengono specificate utilizzando questi attributi:</span><span class="sxs-lookup"><span data-stu-id="3250d-251">You specify conditional postconditions using these attributes:</span></span>

- <span data-ttu-id="3250d-252">[ForseNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argomento di input non nullable può `bool` essere null quando il metodo restituisce il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-252">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="3250d-253">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argomento di input nullable non `bool` sarà null quando il metodo restituisce il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-253">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="3250d-254">[NotNullIfNotNull:](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute)un valore restituito non è null se l'argomento di input per il parametro specificato non è null.</span><span class="sxs-lookup"><span data-stu-id="3250d-254">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>

## <a name="verify-unreachable-code"></a><span data-ttu-id="3250d-255">Verificare il codice non raggiungibileVerify unreachable code</span><span class="sxs-lookup"><span data-stu-id="3250d-255">Verify unreachable code</span></span>

<span data-ttu-id="3250d-256">Alcuni metodi, in genere helper di eccezione o altri metodi di utilità, vengono sempre chiusi generando un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="3250d-256">Some methods, typically exception helpers or other utility methods, always exit by throwing an exception.</span></span> <span data-ttu-id="3250d-257">In alternativa, un helper può generare un'eccezione in base al valore di un argomento booleano.</span><span class="sxs-lookup"><span data-stu-id="3250d-257">Or, a helper may throw an exception based on the value of a Boolean argument.</span></span>

<span data-ttu-id="3250d-258">Nel primo caso, è `DoesNotReturn` possibile aggiungere l'attributo alla dichiarazione del metodo.</span><span class="sxs-lookup"><span data-stu-id="3250d-258">In the first case, you can add the `DoesNotReturn` attribute to the method declaration.</span></span> <span data-ttu-id="3250d-259">Il compilatore ti aiuta in tre modi.</span><span class="sxs-lookup"><span data-stu-id="3250d-259">The compiler helps you in three ways.</span></span> <span data-ttu-id="3250d-260">In primo luogo, il compilatore genera un avviso se è presente un percorso in cui il metodo può uscire senza generare un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="3250d-260">First, the compiler issues a warning if there is a path where the method can exit without throwing an exception.</span></span> <span data-ttu-id="3250d-261">In secondo luogo, il compilatore contrassegna qualsiasi codice dopo `catch` una chiamata a tale metodo come *irraggiungibile,* finché non viene rilevata una clausola appropriata.</span><span class="sxs-lookup"><span data-stu-id="3250d-261">Second, the compiler marks any code after a call to that method as *unreachable*, until an appropriate `catch` clause is encountered.</span></span> <span data-ttu-id="3250d-262">In terzo luogo, il codice non raggiungibile non influirà su eventuali stati null.</span><span class="sxs-lookup"><span data-stu-id="3250d-262">Third, the unreachable code won't affect any null states.</span></span> <span data-ttu-id="3250d-263">Si consideri il metodo seguente:</span><span class="sxs-lookup"><span data-stu-id="3250d-263">Consider this method:</span></span>

```csharp
[DoesNotReturn]
private void FailFast()
{
   throw new InvalidOperationException();
}

public void SetState(object containedField)
{
   if (!isInitialized)
      FailFast();

   // unreachable code:
   this.field = containedField;
}
```

<span data-ttu-id="3250d-264">Nel secondo caso, aggiungere `DoesNotReturnIf` l'attributo a un parametro booleano del metodo.</span><span class="sxs-lookup"><span data-stu-id="3250d-264">In the second case, you add the `DoesNotReturnIf` attribute to a Boolean parameter of the method.</span></span> <span data-ttu-id="3250d-265">È possibile modificare l'esempio precedente come segue:</span><span class="sxs-lookup"><span data-stu-id="3250d-265">You can modify the previous example as follows:</span></span>

```csharp
private void FailFast([DoesNotReturnIf(false)]bool isValid)
{
   if (!isValid)
       throw new InvalidOperationException();
}

public void SetState(object containedField)
{
   FailFast(isInitialized);

   // unreachable code when "isInitialized" is false:
   this.field = containedField;
}
```

## <a name="summary"></a><span data-ttu-id="3250d-266">Summary</span><span class="sxs-lookup"><span data-stu-id="3250d-266">Summary</span></span>

<span data-ttu-id="3250d-267">L'aggiunta di tipi di riferimento nullable fornisce un vocabolario iniziale per descrivere le aspettative delle API per le variabili che potrebbero essere `null`.</span><span class="sxs-lookup"><span data-stu-id="3250d-267">Adding nullable reference types provides an initial vocabulary to describe your APIs expectations for variables that could be `null`.</span></span> <span data-ttu-id="3250d-268">Gli attributi aggiuntivi forniscono un vocabolario più ricco per descrivere lo stato null delle variabili come precondizioni e postcondizioni.</span><span class="sxs-lookup"><span data-stu-id="3250d-268">The additional attributes provide a richer vocabulary to describe the null state of variables as preconditions and postconditions.</span></span> <span data-ttu-id="3250d-269">Questi attributi descrivono in modo più chiaro le aspettative e offrono un'esperienza migliore per gli sviluppatori che usano le API.</span><span class="sxs-lookup"><span data-stu-id="3250d-269">These attributes more clearly describe your expectations and provide a better experience for the developers using your APIs.</span></span>

<span data-ttu-id="3250d-270">Quando si aggiornano le librerie per un contesto nullable, aggiungere questi attributi per guidare gli utenti delle API all'utilizzo corretto.</span><span class="sxs-lookup"><span data-stu-id="3250d-270">As you update libraries for a nullable context, add these attributes to guide users of your APIs to the correct usage.</span></span> <span data-ttu-id="3250d-271">Questi attributi consentono di descrivere completamente lo stato null degli argomenti di input e dei valori restituiti:These attributes help you fully describe the null-state of input arguments and return values:</span><span class="sxs-lookup"><span data-stu-id="3250d-271">These attributes help you fully describe the null-state of input arguments and return values:</span></span>

- <span data-ttu-id="3250d-272">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Un argomento di input non nullable può essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-272">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="3250d-273">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argomento di input nullable non deve mai essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-273">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="3250d-274">[MaybeNull:](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute)un valore restituito non nullable può essere null.</span><span class="sxs-lookup"><span data-stu-id="3250d-274">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="3250d-275">[NotNull:](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute)un valore restituito nullable non sarà mai null.</span><span class="sxs-lookup"><span data-stu-id="3250d-275">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="3250d-276">[ForseNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argomento di input non nullable può `bool` essere null quando il metodo restituisce il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-276">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="3250d-277">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argomento di input nullable non `bool` sarà null quando il metodo restituisce il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-277">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="3250d-278">[NotNullIfNotNull:](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute)un valore restituito non è null se l'argomento di input per il parametro specificato non è null.</span><span class="sxs-lookup"><span data-stu-id="3250d-278">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="3250d-279">[DoesNotReturn:](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute)un metodo non restituisce mai .</span><span class="sxs-lookup"><span data-stu-id="3250d-279">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="3250d-280">In altre parole, genera sempre un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="3250d-280">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="3250d-281">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): questo metodo non `bool` restituisce mai se il parametro associato ha il valore specificato.</span><span class="sxs-lookup"><span data-stu-id="3250d-281">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>
