---
title: Tipi di riferimento nullable - Riferimenti in C
description: Informazioni sui tipi di riferimento nullable di C'è e su come usarli
ms.date: 04/06/2020
ms.openlocfilehash: cbc7397ac76b43b79a4168f4c61fe2c631b4a46b
ms.sourcegitcommit: 2b3b2d684259463ddfc76ad680e5e09fdc1984d2
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/08/2020
ms.locfileid: "80888316"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="ff79a-103">Tipi di riferimento nullable (riferimenti per C</span><span class="sxs-lookup"><span data-stu-id="ff79a-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="ff79a-104">In questo articolo vengono illustrati i tipi di riferimento nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-104">This article covers nullable reference types.</span></span> <span data-ttu-id="ff79a-105">È inoltre possibile dichiarare [tipi di valore nullable](nullable-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="ff79a-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="ff79a-106">I tipi di riferimento nullable sono disponibili a partire da C .NET 8.0, nel codice che ha acconsentito esplicitamente a un contesto di *windows.*</span><span class="sxs-lookup"><span data-stu-id="ff79a-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="ff79a-107">I tipi di riferimento nullable, gli avvisi di analisi statica null e l'operatore di [perdono null](../operators/null-forgiving.md) sono funzionalità di linguaggio facoltative.</span><span class="sxs-lookup"><span data-stu-id="ff79a-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="ff79a-108">Tutti sono disattivati per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="ff79a-108">All are turned off by default.</span></span> <span data-ttu-id="ff79a-109">Un *contesto nullable* viene controllato a livello di progetto usando le impostazioni di compilazione o nel codice usando i pragma.</span><span class="sxs-lookup"><span data-stu-id="ff79a-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="ff79a-110">In un contesto di riconoscere i valori Null:In a nullable aware context:</span><span class="sxs-lookup"><span data-stu-id="ff79a-110">In a nullable aware context:</span></span>

- <span data-ttu-id="ff79a-111">Una variabile di `T` un tipo di riferimento deve essere inizializzata con non `null`null e non può mai essere assegnata un valore che può essere .</span><span class="sxs-lookup"><span data-stu-id="ff79a-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="ff79a-112">Una variabile di `T?` un tipo di `null` riferimento `null`può essere inizializzata `null` con o assegnata , ma deve essere verificata prima di dereferenziare.</span><span class="sxs-lookup"><span data-stu-id="ff79a-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="ff79a-113">Una `m` variabile `T?` di tipo viene considerata non null quando si applica l'operatore di perdono null, come in `m!`.</span><span class="sxs-lookup"><span data-stu-id="ff79a-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="ff79a-114">Le distinzioni tra un tipo `T` di riferimento non `T?` nullable e un tipo di riferimento nullable vengono applicate dall'interpretazione del compilatore delle regole precedenti.</span><span class="sxs-lookup"><span data-stu-id="ff79a-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="ff79a-115">Una variabile `T` di tipo e `T?` una variabile di tipo sono rappresentate dallo stesso tipo .NET.</span><span class="sxs-lookup"><span data-stu-id="ff79a-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="ff79a-116">Nell'esempio seguente viene dichiarata una stringa non nullable e una stringa nullable, quindi viene utilizzato l'operatore di supporto null per assegnare un valore a una stringa non nullable:The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span><span class="sxs-lookup"><span data-stu-id="ff79a-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="ff79a-117">Le `notNull` variabili `nullable` e sono <xref:System.String> entrambe rappresentate dal tipo.</span><span class="sxs-lookup"><span data-stu-id="ff79a-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="ff79a-118">Poiché i tipi non nullable e nullable sono entrambi archiviati come lo stesso tipo, esistono diverse posizioni in cui non è consentito l'utilizzo di un tipo di riferimento nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="ff79a-119">In generale, un tipo di riferimento nullable non può essere utilizzato come classe base o interfaccia implementata.</span><span class="sxs-lookup"><span data-stu-id="ff79a-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="ff79a-120">Un tipo di riferimento nullable non può essere utilizzato in alcuna espressione di test di tipo o creazione di oggetti.</span><span class="sxs-lookup"><span data-stu-id="ff79a-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="ff79a-121">Un tipo di riferimento nullable non può essere il tipo di un'espressione di accesso ai membri.</span><span class="sxs-lookup"><span data-stu-id="ff79a-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="ff79a-122">Gli esempi seguenti illustrano questi costrutti:The following examples show these constructs:</span><span class="sxs-lookup"><span data-stu-id="ff79a-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="ff79a-123">Riferimenti nullable e analisi statica</span><span class="sxs-lookup"><span data-stu-id="ff79a-123">Nullable references and static analysis</span></span>

<span data-ttu-id="ff79a-124">Negli esempi della sezione precedente viene illustrata la natura dei tipi di riferimento nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="ff79a-125">I tipi di riferimento nullable non sono nuovi tipi di classe, ma piuttosto annotazioni sui tipi di riferimento esistenti.</span><span class="sxs-lookup"><span data-stu-id="ff79a-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="ff79a-126">Il compilatore utilizza tali annotazioni per individuare potenziali errori di riferimento null nel codice.</span><span class="sxs-lookup"><span data-stu-id="ff79a-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="ff79a-127">Non esiste alcuna differenza di runtime tra un tipo di riferimento non nullable e un tipo di riferimento nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="ff79a-128">Il compilatore non aggiunge alcun controllo di runtime per i tipi di riferimento non nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="ff79a-129">I vantaggi sono nell'analisi in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="ff79a-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="ff79a-130">Il compilatore genera avvisi che consentono di individuare e correggere potenziali errori null nel codice.</span><span class="sxs-lookup"><span data-stu-id="ff79a-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="ff79a-131">Dichiarare la finalità e il compilatore avvisa quando il codice viola tale finalità.</span><span class="sxs-lookup"><span data-stu-id="ff79a-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="ff79a-132">In un contesto abilitato per i valori Null, il compilatore esegue l'analisi statica su variabili di qualsiasi tipo di riferimento, sia nullable che non nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="ff79a-133">Il compilatore tiene traccia dello stato null di ogni variabile di riferimento come *non null* o *forse null.*</span><span class="sxs-lookup"><span data-stu-id="ff79a-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="ff79a-134">Lo stato predefinito di un riferimento non nullable non è *null.*</span><span class="sxs-lookup"><span data-stu-id="ff79a-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="ff79a-135">Lo stato predefinito di un riferimento nullable è *forse null*.</span><span class="sxs-lookup"><span data-stu-id="ff79a-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="ff79a-136">I tipi di riferimento non nullable devono essere sempre sicuri per dereferenziare perché il relativo stato null non è *null*.</span><span class="sxs-lookup"><span data-stu-id="ff79a-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="ff79a-137">Per applicare tale regola, il compilatore genera avvisi se un tipo di riferimento non nullable non viene inizializzato su un valore non null.</span><span class="sxs-lookup"><span data-stu-id="ff79a-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="ff79a-138">Le variabili locali devono essere assegnate nel punto in cui vengono dichiarate.</span><span class="sxs-lookup"><span data-stu-id="ff79a-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="ff79a-139">Ogni costruttore deve assegnare ogni campo, nel corpo, un costruttore chiamato o utilizzando un inizializzatore di campo.</span><span class="sxs-lookup"><span data-stu-id="ff79a-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="ff79a-140">Il compilatore genera avvisi se un riferimento non nullable viene assegnato a un riferimento il cui stato è *forse null*.</span><span class="sxs-lookup"><span data-stu-id="ff79a-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="ff79a-141">Tuttavia, poiché un riferimento non nullable non è *null*, non viene generato alcun avviso quando tali variabili vengono dereferenziati.</span><span class="sxs-lookup"><span data-stu-id="ff79a-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="ff79a-142">I tipi di riferimento nullable `null`possono essere inizializzati o assegnati a .</span><span class="sxs-lookup"><span data-stu-id="ff79a-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="ff79a-143">Pertanto, l'analisi statica deve determinare che una variabile non è *null* prima che venga dereferenziata.</span><span class="sxs-lookup"><span data-stu-id="ff79a-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="ff79a-144">Se viene determinato che un riferimento nullable è *diverso da null*, non può essere assegnato a una variabile di riferimento non nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="ff79a-145">La classe seguente mostra esempi di questi avvisi:The following class shows examples of these warnings:</span><span class="sxs-lookup"><span data-stu-id="ff79a-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="ff79a-146">Il frammento di codice seguente mostra dove il compilatore genera avvisi quando si usa questa classe:The following snippet shows where the compiler emits warnings when using this class:</span><span class="sxs-lookup"><span data-stu-id="ff79a-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="ff79a-147">Negli esempi precedenti viene illustrata l'analisi statica del compilatore per determinare lo stato null delle variabili di riferimento.</span><span class="sxs-lookup"><span data-stu-id="ff79a-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="ff79a-148">Il compilatore applica le regole di linguaggio per i controlli null e le assegnazioni per informare l'analisi.</span><span class="sxs-lookup"><span data-stu-id="ff79a-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="ff79a-149">Il compilatore non è in grado di formulare ipotesi sulla semantica di metodi o proprietà.</span><span class="sxs-lookup"><span data-stu-id="ff79a-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="ff79a-150">Se si chiamano metodi che eseguono controlli null, il compilatore non può conoscere tali metodi influiscono sullo stato null di una variabile.</span><span class="sxs-lookup"><span data-stu-id="ff79a-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="ff79a-151">Esistono diversi attributi che è possibile aggiungere alle API per informare il compilatore sulla semantica degli argomenti e dei valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="ff79a-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="ff79a-152">Questi attributi sono stati applicati a molte API comuni nelle librerie .NET Core.These attributes have been applied to many common APIs in the .NET Core libraries.</span><span class="sxs-lookup"><span data-stu-id="ff79a-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="ff79a-153">Ad esempio, <xref:System.String.IsNullOrEmpty%2A> è stato aggiornato e il compilatore interpreta correttamente tale metodo come un controllo null.</span><span class="sxs-lookup"><span data-stu-id="ff79a-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="ff79a-154">Per ulteriori informazioni sugli attributi che si applicano all'analisi statica dello stato Null, vedere l'articolo sugli [attributi nullable](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="ff79a-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../../nullable-attributes.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="ff79a-155">Impostazione del contesto nullableSetting the nullable context</span><span class="sxs-lookup"><span data-stu-id="ff79a-155">Setting the nullable context</span></span>

<span data-ttu-id="ff79a-156">Esistono due modi per controllare il contesto nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="ff79a-157">A livello di progetto, `<Nullable>enable</Nullable>` è possibile aggiungere l'impostazione del progetto.</span><span class="sxs-lookup"><span data-stu-id="ff79a-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="ff79a-158">In un singolo file di origine `#nullable enable` in C, è possibile aggiungere il pragma per abilitare il contesto nullable.</span><span class="sxs-lookup"><span data-stu-id="ff79a-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="ff79a-159">Vedere l'articolo sull'impostazione di [una strategia nullable](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="ff79a-159">See the article on [setting a nullable strategy](../../nullable-attributes.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="ff79a-160">Specifiche del linguaggio C#</span><span class="sxs-lookup"><span data-stu-id="ff79a-160">C# language specification</span></span>

<span data-ttu-id="ff79a-161">Per ulteriori informazioni, vedere le seguenti proposte per la specifica del [linguaggio C:](~/_csharplang/spec/introduction.md)</span><span class="sxs-lookup"><span data-stu-id="ff79a-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="ff79a-162">Tipi riferimento nullable</span><span class="sxs-lookup"><span data-stu-id="ff79a-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="ff79a-163">Specifica dei tipi di riferimento nullable Draft nullable reference types specification</span><span class="sxs-lookup"><span data-stu-id="ff79a-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="ff79a-164">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ff79a-164">See also</span></span>

- [<span data-ttu-id="ff79a-165">Informazioni di riferimento su C#</span><span class="sxs-lookup"><span data-stu-id="ff79a-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="ff79a-166">Tipi valore nullable</span><span class="sxs-lookup"><span data-stu-id="ff79a-166">Nullable value types</span></span>](nullable-value-types.md)
