---
title: Informazioni su AssemblyLoadContext - .NET CoreUnderstanding AssemblyLoadContext - .NET Core
description: Concetti chiave per comprendere lo scopo e il comportamento di AssemblyLoadContext in .NET Core.Key concepts to understand the purpose and behavior of AssemblyLoadContext in .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 43fb0d792ddeb20b8a141af452a86dd50f37ba43
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/01/2020
ms.locfileid: "80523604"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="b4cb7-103">Informazioni su System.Runtime.Loader.AssemblyLoadContextUnderstanding System.Runtime.Loader.AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="b4cb7-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="b4cb7-104">La <xref:System.Runtime.Loader.AssemblyLoadContext> classe è univoca per .NET Core.The class is unique to .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="b4cb7-105">Questo articolo tenta <xref:System.Runtime.Loader.AssemblyLoadContext> di integrare la documentazione dell'API con informazioni concettuali.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="b4cb7-106">Questo articolo è rilevante per gli sviluppatori che implementano il caricamento dinamico, in particolare gli sviluppatori di framework di caricamento dinamico.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="b4cb7-107">Che cos'è AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="b4cb7-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="b4cb7-108">Ogni applicazione .NET Core <xref:System.Runtime.Loader.AssemblyLoadContext>utilizza in modo implicito l'oggetto .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="b4cb7-109">È il provider del runtime per l'individuazione e il caricamento delle dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="b4cb7-110">Ogni volta che viene <xref:System.Runtime.Loader.AssemblyLoadContext> caricata una dipendenza, viene richiamata un'istanza per individuarla.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="b4cb7-111">Fornisce un servizio di individuazione, caricamento e memorizzazione nella cache di assembly gestiti e altre dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="b4cb7-112">Per supportare il caricamento e lo scaricamento dinamici del codice, <xref:System.Runtime.Loader.AssemblyLoadContext> crea un contesto isolato per il caricamento del codice e le relative dipendenze nella propria istanza.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="b4cb7-113">Quando sono necessarie più istanze di AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="b4cb7-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="b4cb7-114">Una <xref:System.Runtime.Loader.AssemblyLoadContext> singola istanza è limitata al <xref:System.Reflection.Assembly> caricamento di esattamente <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>una versione di un nome di assembly per un nome di assembly semplice, .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="b4cb7-115">Questa restrizione può diventare un problema durante il caricamento dinamico dei moduli di codice.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="b4cb7-116">Ogni modulo è compilato in modo indipendente <xref:System.Reflection.Assembly>e può dipendere da versioni diverse di un file .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="b4cb7-117">Questo problema si verifica in genere quando diversi moduli dipendono da versioni diverse di una libreria di uso comune.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="b4cb7-118">Per supportare il <xref:System.Runtime.Loader.AssemblyLoadContext> caricamento dinamico del codice, <xref:System.Reflection.Assembly> l'API fornisce per il caricamento di versioni in conflitto di un oggetto nella stessa applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="b4cb7-119">Ogni <xref:System.Runtime.Loader.AssemblyLoadContext> istanza fornisce un <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> dizionario <xref:System.Reflection.Assembly> univoco che esegue il mapping di ogni istanza a un'istanza specifica.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="b4cb7-120">Fornisce inoltre un pratico meccanismo per raggruppare le dipendenze correlate a un modulo di codice per uno scaricamento successivo.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="b4cb7-121">Quali sono le caratteristiche speciali dell'istanza di AssemblyLoadContext.Default?</span><span class="sxs-lookup"><span data-stu-id="b4cb7-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="b4cb7-122">L'istanza <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> viene popolata automaticamente dal runtime all'avvio.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="b4cb7-123">Utilizza il [probe predefinito](default-probing.md) per individuare e trovare tutte le dipendenze statiche.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="b4cb7-124">Risolve gli scenari di caricamento delle dipendenze più comuni.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="b4cb7-125">In che modo AssemblyLoadContext supporta le dipendenze dinamiche?</span><span class="sxs-lookup"><span data-stu-id="b4cb7-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="b4cb7-126"><xref:System.Runtime.Loader.AssemblyLoadContext>ha vari eventi e funzioni virtuali che possono essere sostituiti.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="b4cb7-127">L'istanza <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> supporta solo l'override degli eventi.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="b4cb7-128">Gli articoli Algoritmo di [caricamento assembly gestiti](loading-managed.md), [Algoritmo](loading-resources.md)di caricamento assembly Satellite e Algoritmo di [caricamento libreria non gestita (nativa)](loading-unmanaged.md) fanno riferimento a tutti gli eventi e le funzioni virtuali disponibili.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="b4cb7-129">Gli articoli mostrano la posizione relativa di ogni evento e funzione negli algoritmi di caricamento.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="b4cb7-130">In questo articolo non vengono riprodotti tali informazioni.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="b4cb7-131">In questa sezione vengono illustrati i principi generali per gli eventi e le funzioni pertinenti.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="b4cb7-132">**Essere ripetibile**.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-132">**Be repeatable**.</span></span> <span data-ttu-id="b4cb7-133">Una query per una dipendenza specifica deve sempre generare la stessa risposta.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="b4cb7-134">Deve essere restituita la stessa istanza di dipendenza caricata.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="b4cb7-135">Questo requisito è fondamentale per la coerenza della cache.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="b4cb7-136">Per gli assembly gestiti in <xref:System.Reflection.Assembly> particolare, stiamo creando una cache.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-136">For managed assemblies in particular, we're creating a <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="b4cb7-137">La chiave di cache è <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>un nome di assembly semplice, .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="b4cb7-138">**In genere non gettare**.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-138">**Typically don't throw**.</span></span>  <span data-ttu-id="b4cb7-139">Si prevede che queste `null` funzioni restituiscano anziché generare quando non è possibile trovare la dipendenza richiesta.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="b4cb7-140">La generazione terminerà prematuramente la ricerca e verrà propagata un'eccezione al chiamante.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="b4cb7-141">La generazione deve essere limitata a errori imprevisti, ad esempio un assembly danneggiato o una condizione di memoria insufficiente.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="b4cb7-142">**Evitare la ricorsione**.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-142">**Avoid recursion**.</span></span> <span data-ttu-id="b4cb7-143">Tenere presente che queste funzioni e gestori implementano le regole di caricamento per individuare le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="b4cb7-144">L'implementazione non deve chiamare API che attivano la ricorsione.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="b4cb7-145">Il codice deve in genere chiamare funzioni di caricamento **AssemblyLoadContext** che richiedono un percorso specifico o un argomento di riferimento alla memoria.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="b4cb7-146">**Caricare nell'assemblyLoadContext corretto.**</span><span class="sxs-lookup"><span data-stu-id="b4cb7-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="b4cb7-147">La scelta della posizione in cui caricare le dipendenze è specifica dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="b4cb7-148">La scelta è implementata da questi eventi e funzioni.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="b4cb7-149">Quando il codice chiama le funzioni load-by-path **AssemblyLoadContext** le chiamano nell'istanza in cui si desidera caricare il codice.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="b4cb7-150">A volte `null` la restituzione e la lasciare che il <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> carico possa essere l'opzione più semplice.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="b4cb7-151">**Essere consapevoli delle gare di thread**.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-151">**Be aware of thread races**.</span></span> <span data-ttu-id="b4cb7-152">Il caricamento può essere attivato da più thread.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="b4cb7-153">Il AssemblyLoadContext gestisce le gare di thread aggiungendo in modo atomico gli assembly alla relativa cache.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="b4cb7-154">L'istanza del perdente di razza viene scartata.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="b4cb7-155">Nella logica di implementazione, non aggiungere logica aggiuntiva che non gestisce correttamente più thread.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="b4cb7-156">Come vengono isolate le dipendenze dinamiche?</span><span class="sxs-lookup"><span data-stu-id="b4cb7-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="b4cb7-157">Ogni <xref:System.Runtime.Loader.AssemblyLoadContext> istanza rappresenta un <xref:System.Reflection.Assembly> ambito <xref:System.Type> univoco per istanze e definizioni.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="b4cb7-158">Non esiste alcun isolamento binario tra queste dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="b4cb7-159">Sono isolati solo non trovandosi l'un l'altro per nome.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="b4cb7-160">In <xref:System.Runtime.Loader.AssemblyLoadContext>ogni :</span><span class="sxs-lookup"><span data-stu-id="b4cb7-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="b4cb7-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>può riferirsi <xref:System.Reflection.Assembly> a un'istanza diversa.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="b4cb7-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType>può restituire un'istanza di `name`tipo diversa per lo stesso tipo .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="b4cb7-163">Come vengono condivise le dipendenze?</span><span class="sxs-lookup"><span data-stu-id="b4cb7-163">How are dependencies shared?</span></span>

<span data-ttu-id="b4cb7-164">Le dipendenze possono <xref:System.Runtime.Loader.AssemblyLoadContext> essere facilmente condivise tra le istanze.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="b4cb7-165">Il modello generale <xref:System.Runtime.Loader.AssemblyLoadContext> prevede che uno carichi una dipendenza.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="b4cb7-166">L'altro condivide la dipendenza utilizzando un riferimento all'assembly caricato.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="b4cb7-167">Questa condivisione è obbligatoria per gli assembly di runtime.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="b4cb7-168">Questi assembly possono essere <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>caricati solo nel file .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b4cb7-169">Lo stesso è necessario `ASP.NET`per `WPF`framework `WinForms`come , , o .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="b4cb7-170">È consigliabile caricare le dipendenze <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>condivise in .</span><span class="sxs-lookup"><span data-stu-id="b4cb7-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b4cb7-171">Questa condivisione è il modello di progettazione comune.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="b4cb7-172">La condivisione viene implementata <xref:System.Runtime.Loader.AssemblyLoadContext> nella codifica dell'istanza personalizzata.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="b4cb7-173"><xref:System.Runtime.Loader.AssemblyLoadContext>ha vari eventi e funzioni virtuali che possono essere sostituiti.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="b4cb7-174">Quando una di queste funzioni <xref:System.Reflection.Assembly> restituisce un riferimento <xref:System.Runtime.Loader.AssemblyLoadContext> a <xref:System.Reflection.Assembly> un'istanza caricata in un'altra istanza, l'istanza viene condivisa.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="b4cb7-175">L'algoritmo di <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> caricamento standard rinvia a per il caricamento per semplificare il modello di condivisione comune.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="b4cb7-176">Vedere Algoritmo di [caricamento di assembly gestiti](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="b4cb7-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="b4cb7-177">Complicazioni</span><span class="sxs-lookup"><span data-stu-id="b4cb7-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="b4cb7-178">Problemi di conversione dei tipi</span><span class="sxs-lookup"><span data-stu-id="b4cb7-178">Type conversion issues</span></span>

<span data-ttu-id="b4cb7-179">Quando <xref:System.Runtime.Loader.AssemblyLoadContext> due istanze contengono `name`definizioni di tipo con lo stesso , non sono dello stesso tipo.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="b4cb7-180">Sono dello stesso tipo se e solo se <xref:System.Reflection.Assembly> provengono dalla stessa istanza.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="b4cb7-181">Per complicare le cose, i messaggi di eccezione su questi tipi non corrispondenti possono creare confusione.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="b4cb7-182">I tipi sono indicati nei messaggi di eccezione dai relativi nomi di tipo semplice.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="b4cb7-183">Il messaggio di eccezione comune in questo caso sarebbe nel formato:</span><span class="sxs-lookup"><span data-stu-id="b4cb7-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="b4cb7-184">Impossibile convertire l'oggetto di tipo 'IsolatedType' nel tipo 'IsolatedType'.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="b4cb7-185">Problemi di conversione dei tipi di debugDebugging type conversion issues</span><span class="sxs-lookup"><span data-stu-id="b4cb7-185">Debugging type conversion issues</span></span>

<span data-ttu-id="b4cb7-186">Data una coppia di tipi non corrispondenti è importante conoscere anche:</span><span class="sxs-lookup"><span data-stu-id="b4cb7-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="b4cb7-187">Ogni tipo di<xref:System.Type.Assembly?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="b4cb7-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="b4cb7-188">Di <xref:System.Runtime.Loader.AssemblyLoadContext>ogni tipo, che può <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> essere ottenuto tramite la funzione.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="b4cb7-189">Dato due `a` `b`oggetti e , la valutazione di quanto segue nel debugger sarà utile:</span><span class="sxs-lookup"><span data-stu-id="b4cb7-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="b4cb7-190">Risoluzione dei problemi di conversione dei tipi</span><span class="sxs-lookup"><span data-stu-id="b4cb7-190">Resolving type conversion issues</span></span>

<span data-ttu-id="b4cb7-191">Esistono due modelli di progettazione per risolvere questi problemi di conversione dei tipi.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="b4cb7-192">Utilizzare tipi condivisi comuni.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-192">Use common shared types.</span></span> <span data-ttu-id="b4cb7-193">Questo tipo condiviso può essere un tipo di runtime primitivo o può comportare la creazione di un nuovo tipo condiviso in un assembly condiviso.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="b4cb7-194">Spesso il tipo condiviso è [un'interfaccia](../../csharp/language-reference/keywords/interface.md) definita in un assembly dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="b4cb7-195">Vedere anche: [Come vengono condivise le dipendenze?](#how-are-dependencies-shared).</span><span class="sxs-lookup"><span data-stu-id="b4cb7-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="b4cb7-196">Utilizzare tecniche di marshalling per eseguire la conversione da un tipo a un altro.</span><span class="sxs-lookup"><span data-stu-id="b4cb7-196">Use marshaling techniques to convert from one type to another.</span></span>
