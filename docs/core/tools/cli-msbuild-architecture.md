---
title: Architettura degli strumenti della riga di comando di .NET Core
description: Informazioni sui livelli degli strumenti di .NET Core e sulle modifiche apportate nelle versioni più recenti.
ms.date: 03/06/2017
ms.openlocfilehash: e1a9fe59225c17d54f6e7213d2b3c3fa70ee58e0
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2020
ms.locfileid: "82102879"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="3a898-103">Panoramica generale delle modifiche agli strumenti di .NET Core</span><span class="sxs-lookup"><span data-stu-id="3a898-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="3a898-104">Questo documento descrive le modifiche associate al passaggio da *project.json* a MSBuild e al sistema di progetti *csproj* con informazioni sulle modifiche ai livelli degli strumenti .NET Core e all'implementazione dei comandi dell'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="3a898-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="3a898-105">Queste modifiche sono state introdotte con il rilascio di .NET Core SDK 1.0 e Visual Studio 2017 il 7 marzo 2017 (vedere l'[annuncio](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)), ma sono state implementate inizialmente con il rilascio di .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="3a898-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="3a898-106">Abbandono di project.json</span><span class="sxs-lookup"><span data-stu-id="3a898-106">Moving away from project.json</span></span>

<span data-ttu-id="3a898-107">Il cambiamento più significativo negli strumenti di .NET Core è il [passaggio da project.json a csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) come sistema di progetto.</span><span class="sxs-lookup"><span data-stu-id="3a898-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="3a898-108">Le versioni più recenti degli strumenti da riga di comando non supportano i file *project.json*.</span><span class="sxs-lookup"><span data-stu-id="3a898-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="3a898-109">Ciò significa che non può essere utilizzato per compilare, eseguire o pubblicare applicazioni e librerie basate su project.json.</span><span class="sxs-lookup"><span data-stu-id="3a898-109">That means that it cannot be used to build, run, or publish project.json based applications and libraries.</span></span> <span data-ttu-id="3a898-110">Per utilizzare questa versione degli strumenti, eseguire la migrazione dei progetti esistenti o crearne di nuovi.</span><span class="sxs-lookup"><span data-stu-id="3a898-110">To use this version of the tools, migrate your existing projects or start new ones.</span></span>

<span data-ttu-id="3a898-111">Come parte di questo passaggio, il motore di compilazione personalizzato sviluppato per i progetti project.json è stato sostituito da un motore di compilazione maturo e dotato di funzionalità complete denominato [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="3a898-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="3a898-112">MSBuild è un motore noto nella community di .NET.</span><span class="sxs-lookup"><span data-stu-id="3a898-112">MSBuild is a well-known engine in the .NET community.</span></span> <span data-ttu-id="3a898-113">È stata una tecnologia chiave fin dalla prima versione della piattaforma.</span><span class="sxs-lookup"><span data-stu-id="3a898-113">It has been a key technology since the platform's first release.</span></span> <span data-ttu-id="3a898-114">Poiché è necessario compilare applicazioni .NET Core, MSBuild è stato portato in .NET Core e può essere utilizzato su qualsiasi piattaforma in cui viene eseguito .NET Core.</span><span class="sxs-lookup"><span data-stu-id="3a898-114">Because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="3a898-115">Una delle promesse principali di .NET Core è la realizzazione di uno stack di sviluppo multipiattaforma, e Microsoft ha mantenuto tale promessa.</span><span class="sxs-lookup"><span data-stu-id="3a898-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!TIP]
> <span data-ttu-id="3a898-116">Se non si ha familiarità con MSBuild e si desidera ottenere ulteriori informazioni, è possibile iniziare leggendo l'articolo sui concetti di [MSBuild.If](/visualstudio/msbuild/msbuild-concepts) you are new to MSBuild and would to learn more about it, you can start by reading the MSBuild concepts article.</span><span class="sxs-lookup"><span data-stu-id="3a898-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span>

## <a name="the-tooling-layers"></a><span data-ttu-id="3a898-117">Livelli degli strumenti</span><span class="sxs-lookup"><span data-stu-id="3a898-117">The tooling layers</span></span>

<span data-ttu-id="3a898-118">Con il cambiamento nel motore di compilazione e l'allontanarsi dal sistema di progetto esistente, alcune domande naturalmente seguono.</span><span class="sxs-lookup"><span data-stu-id="3a898-118">With the change in build engine and the move away from the existing project system, some questions naturally follow.</span></span> <span data-ttu-id="3a898-119">Una di queste modifiche modifica la "stratificazione" complessiva dell'ecosistema degli strumenti di .NET Core?</span><span class="sxs-lookup"><span data-stu-id="3a898-119">Do any of these changes change the overall "layering" of the .NET Core tooling ecosystem?</span></span> <span data-ttu-id="3a898-120">Esistono nuovi elementi e componenti?</span><span class="sxs-lookup"><span data-stu-id="3a898-120">Are there new bits and components?</span></span>

<span data-ttu-id="3a898-121">Nella figura seguente viene fornito un breve riepilogo dei livelli dell'anteprima 2:</span><span class="sxs-lookup"><span data-stu-id="3a898-121">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Architettura di alto livello degli strumenti dell'anteprima 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="3a898-123">La stratificazione degli strumenti in Anteprima 2 è semplice.</span><span class="sxs-lookup"><span data-stu-id="3a898-123">The layering of the tools in Preview 2 is straightforward.</span></span> <span data-ttu-id="3a898-124">Nella parte inferiore, la base è l'interfaccia della riga di comando di .NET Core.</span><span class="sxs-lookup"><span data-stu-id="3a898-124">At the bottom, the foundation is the .NET Core CLI.</span></span> <span data-ttu-id="3a898-125">Tutti gli altri strumenti di livello superiore, ad esempio Visual Studio o Visual Studio Code, dipendono e si basano sull'interfaccia della riga di comando per compilare progetti, ripristinare le dipendenze e così via.</span><span class="sxs-lookup"><span data-stu-id="3a898-125">All other, higher-level tools, such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies, and so on.</span></span> <span data-ttu-id="3a898-126">Ad esempio, se Visual Studio desidera eseguire un'operazione `dotnet restore` di ripristino, chiamerebbe il comando nell'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="3a898-126">For example, if Visual Studio wanted to perform a restore operation, it would call into the `dotnet restore` command in the CLI.</span></span>

<span data-ttu-id="3a898-127">Con il passaggio al nuovo sistema di progetto, il diagramma precedente risulta modificato nel modo illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="3a898-127">With the move to the new project system, the previous diagram changes:</span></span>

![Architettura di alto livello di .NET Core SDK 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="3a898-129">La differenza principale è che l'interfaccia della riga di comando non è più il livello di base. Tale ruolo viene ora svolto dal "componente SDK condiviso".</span><span class="sxs-lookup"><span data-stu-id="3a898-129">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="3a898-130">Questo componente SDK condiviso è un set di destinazioni e attività associate responsabili della compilazione del codice, della pubblicazione, della creazione di pacchetti NuGet e così via.</span><span class="sxs-lookup"><span data-stu-id="3a898-130">This shared SDK component is a set of targets and associated tasks that are responsible for compiling code, publishing it, packing NuGet packages, and so on.</span></span> <span data-ttu-id="3a898-131">.NET Core SDK è open source ed è disponibile in GitHub nel [repository SDK.](https://github.com/dotnet/sdk)</span><span class="sxs-lookup"><span data-stu-id="3a898-131">The .NET Core SDK is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span>

> [!NOTE]
> <span data-ttu-id="3a898-132">Una "destinazione" è un termine MSBuild che indica un'operazione denominata che MSBuild può richiamare.</span><span class="sxs-lookup"><span data-stu-id="3a898-132">A "target" is an MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="3a898-133">La destinazione è in genere associata a una o più attività che eseguono la logica dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="3a898-133">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="3a898-134">MSBuild supporta diverse destinazioni predefinite, ad esempio `Copy` o `Execute`. Consente inoltre agli utenti di scrivere le proprie attività usando codice gestito e definire destinazioni per eseguire tali attività.</span><span class="sxs-lookup"><span data-stu-id="3a898-134">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="3a898-135">Per altre informazioni, vedere [Attività di MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="3a898-135">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span>

<span data-ttu-id="3a898-136">Tutti i set di strumenti, inclusa l'interfaccia della riga di comando, utilizzano ora il componente SDK condiviso e le relative destinazioni.</span><span class="sxs-lookup"><span data-stu-id="3a898-136">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="3a898-137">Ad esempio, Visual Studio 2019 non `dotnet restore` chiama il comando per ripristinare le dipendenze per i progetti .NET Core.For example, Visual Studio 2019 doesn't call into the command to restore dependencies for .NET Core projects.</span><span class="sxs-lookup"><span data-stu-id="3a898-137">For example, Visual Studio 2019 doesn't call into the `dotnet restore` command to restore dependencies for .NET Core projects.</span></span> <span data-ttu-id="3a898-138">Al contrario, utilizza direttamente la destinazione "Ripristina".</span><span class="sxs-lookup"><span data-stu-id="3a898-138">Instead, it uses the "Restore" target directly.</span></span> <span data-ttu-id="3a898-139">Poiché si tratta di destinazioni MSBuild, è anche possibile usare direttamente MSBuild per eseguirle mediante il comando [dotnet-msbuild](dotnet-msbuild.md).</span><span class="sxs-lookup"><span data-stu-id="3a898-139">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span>

### <a name="cli-commands"></a><span data-ttu-id="3a898-140">Comandi dell'interfaccia della riga di comando</span><span class="sxs-lookup"><span data-stu-id="3a898-140">CLI commands</span></span>

<span data-ttu-id="3a898-141">Il componente SDK condiviso significa che la maggior parte dei comandi DELL-interfaccia della riga di comando esistenti sono stati reimplementati come attività e destinazioni MSBuild.</span><span class="sxs-lookup"><span data-stu-id="3a898-141">The shared SDK component means that the majority of existing CLI commands have been reimplemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="3a898-142">Cosa significa questo per i comandi dell'interfaccia della riga di comando e per l'utilizzo del set di strumenti?</span><span class="sxs-lookup"><span data-stu-id="3a898-142">What does this mean for the CLI commands and your usage of the toolset?</span></span>

<span data-ttu-id="3a898-143">Dal punto di vista dell'utilizzo, non cambia il modo in cui si usa l'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="3a898-143">From a usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="3a898-144">L'interfaccia della riga di comando contiene ancora i comandi di base esistenti nella versione di .NET Core 1.0 Preview 2:The CLI still has the core commands that existed in the .NET Core 1.0 Preview 2 release:</span><span class="sxs-lookup"><span data-stu-id="3a898-144">The CLI still has the core commands that existed in the .NET Core 1.0 Preview 2 release:</span></span>

- `new`
- `restore`
- `run`
- `build`
- `publish`
- `test`
- `pack`

<span data-ttu-id="3a898-145">Questi comandi fanno ancora quello che ti aspetti che facciano (nuovo un progetto, compilarlo, pubblicarlo, imballare e così via).</span><span class="sxs-lookup"><span data-stu-id="3a898-145">These commands still do what you expect them to do (new up a project, build it, publish it, pack it, and so on).</span></span> <span data-ttu-id="3a898-146">È possibile consultare la schermata `dotnet <command> --help`di aiuto del comando (utilizzando ) o la documentazione su questo sito per acquisire familiarità con il loro comportamento.</span><span class="sxs-lookup"><span data-stu-id="3a898-146">You can consult either the command's help screen (using `dotnet <command> --help`) or documentation on this site to get familiar with their behavior.</span></span>

<span data-ttu-id="3a898-147">Dal punto di vista dell'esecuzione, i comandi dell'interfaccia della riga di comando accettano i parametri e creano una chiamata a MSBuild "non elaborato" che imposta le proprietà necessarie ed esegue la destinazione desiderata.</span><span class="sxs-lookup"><span data-stu-id="3a898-147">From an execution perspective, the CLI commands take their parameters and construct a call to "raw" MSBuild that sets the needed properties and runs the desired target.</span></span> <span data-ttu-id="3a898-148">Per comprendere meglio quanto esposto sopra, prendere in considerazione il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="3a898-148">To better illustrate this, consider the following command:</span></span>

   ```dotnetcli
   dotnet publish -o pub -c Release
   ```

<span data-ttu-id="3a898-149">Questo comando pubblica un'applicazione `pub` in una cartella utilizzando la configurazione "Release".</span><span class="sxs-lookup"><span data-stu-id="3a898-149">This command publishes an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="3a898-150">A livello interno, il comando viene tradotto nella chiamata a MSBuild seguente:</span><span class="sxs-lookup"><span data-stu-id="3a898-150">Internally, this command gets translated into the following MSBuild invocation:</span></span>

   ```dotnetcli
   dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release
   ```

<span data-ttu-id="3a898-151">Eccezioni degne di `new` nota a questa regola sono i comandi e `run` .</span><span class="sxs-lookup"><span data-stu-id="3a898-151">Notable exceptions to this rule are the `new` and `run` commands.</span></span> <span data-ttu-id="3a898-152">Non sono stati implementati come destinazioni MSBuild.</span><span class="sxs-lookup"><span data-stu-id="3a898-152">They have not been implemented as MSBuild targets.</span></span>

### <a name="implicit-restore"></a><span data-ttu-id="3a898-153">Ripristino implicito</span><span class="sxs-lookup"><span data-stu-id="3a898-153">Implicit restore</span></span>

[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
