---
title: Panoramica delle estensioni di markup per XAML
ms.date: 03/30/2017
helpviewer_keywords:
- markup extensions [XAML Services], custom
- XAML [XAML Services], markup extensions
ms.assetid: 261b2b11-2dc0-462f-8c66-55b8c9c6e436
ms.openlocfilehash: c0ca8e7d0d68d4730173385540cbcec66c7bf03a
ms.sourcegitcommit: c2d9718996402993cf31541f11e95531bc68bad0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/27/2020
ms.locfileid: "82071717"
---
# <a name="overview-of-markup-extensions-for-xaml"></a><span data-ttu-id="d1b78-102">Panoramica delle estensioni di markup per XAMLOverview of markup extensions for XAML</span><span class="sxs-lookup"><span data-stu-id="d1b78-102">Overview of markup extensions for XAML</span></span>

<span data-ttu-id="d1b78-103">Le estensioni di markup sono una tecnica XAML per ottenere un valore che non è una primitiva o un tipo XAML specifico.</span><span class="sxs-lookup"><span data-stu-id="d1b78-103">Markup extensions are a XAML technique for obtaining a value that's not a primitive or a specific XAML type.</span></span> <span data-ttu-id="d1b78-104">Per utilizzo dell'attributo, le estensioni di markup usano la sequenza di caratteri nota costituita da una parentesi graffa aperta `{` per l'immissione dell'ambito dell'estensione di markup e da una parentesi graffa chiusa `}` .</span><span class="sxs-lookup"><span data-stu-id="d1b78-104">For attribute usage, markup extensions use the known character sequence of an opening curly brace `{` to enter the markup extension scope, and a closing curly brace `}` to exit.</span></span> <span data-ttu-id="d1b78-105">Quando si usano i servizi XAML .NET, è possibile usare alcune delle estensioni di markup del linguaggio XAML predefinite dall'assembly System.Xaml.</span><span class="sxs-lookup"><span data-stu-id="d1b78-105">When using .NET XAML Services, you can use some of the predefined XAML language markup extensions from the System.Xaml assembly.</span></span> <span data-ttu-id="d1b78-106">inoltre possibile creare una sottoclasse dalla classe <xref:System.Windows.Markup.MarkupExtension> , definita in System.Xaml, e definire estensioni di markup personalizzate.</span><span class="sxs-lookup"><span data-stu-id="d1b78-106">You can also subclass from the <xref:System.Windows.Markup.MarkupExtension> class, defined in System.Xaml, and define your own markup extensions.</span></span> <span data-ttu-id="d1b78-107">In alternativa, è possibile utilizzare le estensioni di markup definite da un particolare framework se si fa già riferimento a tale framework.</span><span class="sxs-lookup"><span data-stu-id="d1b78-107">Or you can use markup extensions defined by a particular framework if you are already referencing that framework.</span></span>

<span data-ttu-id="d1b78-108">Quando viene eseguito l'accesso a un utilizzo dell'estensione di markup, il writer di oggetti XAML può fornire servizi a una classe <xref:System.Windows.Markup.MarkupExtension> personalizzata tramite un punto di connessione del servizio nell'override del metodo <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="d1b78-108">When a markup extension usage is accessed, the XAML object writer can provide services to a custom <xref:System.Windows.Markup.MarkupExtension> class through a service connection point in the <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A?displayProperty=nameWithType> override.</span></span> <span data-ttu-id="d1b78-109">I servizi possono essere usati per ottenere il contesto relativo all'utilizzo, funzionalità specifiche del writer di oggetti, il contesto dello schema XAML e così via.</span><span class="sxs-lookup"><span data-stu-id="d1b78-109">The services can be used to obtain context about the usage, specific capabilities of the object writer, XAML schema context, and so on.</span></span>

## <a name="xaml-defined-markup-extensions"></a><span data-ttu-id="d1b78-110">Estensioni di markup definite da XAMLXAML-defined markup extensions</span><span class="sxs-lookup"><span data-stu-id="d1b78-110">XAML-defined markup extensions</span></span>

<span data-ttu-id="d1b78-111">Diverse estensioni di markup vengono implementate dai servizi XAML .NET per il supporto del linguaggio XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-111">Several markup extensions are implemented by .NET XAML Services for XAML language support.</span></span> <span data-ttu-id="d1b78-112">Le estensioni di markup corrispondono a parti della specifica di XAML come linguaggio.</span><span class="sxs-lookup"><span data-stu-id="d1b78-112">These markup extensions correspond to parts of the specification of XAML as a language.</span></span> <span data-ttu-id="d1b78-113">In genere, queste estensioni sono identificabili dal prefisso `x:` nella sintassi come illustrato nell'utilizzo comune.</span><span class="sxs-lookup"><span data-stu-id="d1b78-113">These are typically identifiable by the `x:` prefix in the syntax as seen in common usage.</span></span> <span data-ttu-id="d1b78-114">Le implementazioni dei servizi XAML .NET per <xref:System.Windows.Markup.MarkupExtension> questi elementi del linguaggio XAML derivano tutte dalla classe base.</span><span class="sxs-lookup"><span data-stu-id="d1b78-114">.NET XAML Services implementations for these XAML language elements all derive from the  <xref:System.Windows.Markup.MarkupExtension> base class.</span></span>

> [!NOTE]
> <span data-ttu-id="d1b78-115">Il prefisso `x:` viene usato per il mapping dello spazio dei nomi XAML tipico dello spazio dei nomi del linguaggio XAML, nell'elemento radice di una produzione XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-115">The `x:` prefix is used for the typical XAML namespace mapping of the XAML language namespace, in the root element of a XAML production.</span></span> <span data-ttu-id="d1b78-116">Ad esempio, il progetto di Visual Studio e i modelli `x:` di pagina per vari framework specifici avviano un file XAML utilizzando questo mapping.</span><span class="sxs-lookup"><span data-stu-id="d1b78-116">For example, the Visual Studio project and page templates for various specific frameworks initiate a XAML file using this `x:` mapping.</span></span> <span data-ttu-id="d1b78-117">Nel mapping dello spazio dei nomi XAML personalizzato è possibile scegliere un token di prefisso diverso. Tuttavia, per identificare le entità che rappresentano una parte definita dello spazio dei nomi XAML del linguaggio XAML, in questa documentazione viene usato il mapping `x:` predefinito anziché lo spazio dei nomi XAML predefinito di un framework specifico o altri spazi dei nomi CLR o XML arbitrari.</span><span class="sxs-lookup"><span data-stu-id="d1b78-117">You could choose a different prefix token in your own XAML namespace mapping, but this documentation will assume the default `x:` mapping as a means of identifying those entities that are a defined part of the XAML language XAML namespace, as opposed to a specific framework's default XAML namespace or other arbitrary CLR or XML namespaces.</span></span>

### <a name="xtype"></a><span data-ttu-id="d1b78-118">x:Type</span><span class="sxs-lookup"><span data-stu-id="d1b78-118">x:Type</span></span>

<span data-ttu-id="d1b78-119">`x:Type` fornisce l'oggetto <xref:System.Type> per il tipo denominato.</span><span class="sxs-lookup"><span data-stu-id="d1b78-119">`x:Type` supplies the <xref:System.Type> object for the named type.</span></span> <span data-ttu-id="d1b78-120">Questa funzionalità viene il più delle volte usata nei meccanismi di rinvio che usano il tipo CLR sottostante e la derivazione del tipo come moniker o identificatore di raggruppamento.</span><span class="sxs-lookup"><span data-stu-id="d1b78-120">This functionality is used most frequently in deferral mechanisms that use underlying CLR type and type derivation as a grouping moniker or identifier.</span></span> <span data-ttu-id="d1b78-121">Gli stili e i modelli WPF, nonché il loro utilizzo delle proprietà `TargetType` , sono un esempio specifico.</span><span class="sxs-lookup"><span data-stu-id="d1b78-121">WPF styles and templates, and their usage of `TargetType` properties, are a specific example.</span></span> <span data-ttu-id="d1b78-122">Per altre informazioni, vedere [x:Type Markup Extension](xtype-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-122">For more information, see [x:Type Markup Extension](xtype-markup-extension.md).</span></span>

### <a name="xstatic"></a><span data-ttu-id="d1b78-123">x:Static</span><span class="sxs-lookup"><span data-stu-id="d1b78-123">x:Static</span></span>

<span data-ttu-id="d1b78-124">`x:Static` produce valori statici da entità di codice di tipo di valore che non sono direttamente il tipo del valore di una proprietà, ma possono essere valutate in base a tale tipo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-124">`x:Static` produces static values from value-type code entities that are not directly the type of a property's value, but can be evaluated to that type.</span></span> <span data-ttu-id="d1b78-125">Questo è utile per specificare valori già esistenti come costanti note in una definizione del tipo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-125">This is useful for specifying values that already exist as well-known constants in a type definition.</span></span> <span data-ttu-id="d1b78-126">Per altre informazioni, vedere [x:Static Markup Extension](xstatic-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-126">For more information, see [x:Static Markup Extension](xstatic-markup-extension.md).</span></span>

### <a name="xnull"></a><span data-ttu-id="d1b78-127">x:Null</span><span class="sxs-lookup"><span data-stu-id="d1b78-127">x:Null</span></span>

<span data-ttu-id="d1b78-128">`x:Null` specifica `null` come valore per un membro XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-128">`x:Null` specifies `null` as a value for a XAML member.</span></span> <span data-ttu-id="d1b78-129">In base alla progettazione di tipi specifici o a concetti di framework più ampi, non sempre `null` è un valore predefinito di una proprietà o il valore implicito dell'attributo di una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="d1b78-129">Depending on the design of specific types or on larger framework concepts, `null` is not always a default value for a property, or the implied value of an empty string attribute.</span></span> <span data-ttu-id="d1b78-130">Per altre informazioni, vedere [x:Null Markup Extension](xnull-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-130">For more information, see [x:Null Markup Extension](xnull-markup-extension.md).</span></span>

### <a name="xarray"></a><span data-ttu-id="d1b78-131">x:Array</span><span class="sxs-lookup"><span data-stu-id="d1b78-131">x:Array</span></span>

<span data-ttu-id="d1b78-132">`x:Array` supporta la creazione di matrici generali nella sintassi XAML nei casi in cui si sceglie intenzionalmente di non usare il supporto delle raccolte fornito dagli elementi di base e dai modelli di controllo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-132">`x:Array` supports creation of general arrays in XAML syntax in cases where the collection support that is provided by base elements and control models is deliberately not used.</span></span> <span data-ttu-id="d1b78-133">Per altre informazioni, vedere [x:Array Markup Extension](xarray-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-133">For more information, see [x:Array Markup Extension](xarray-markup-extension.md).</span></span> <span data-ttu-id="d1b78-134">Nel caso specifico di XAML 2009, l'accesso alle matrici avviene come primitive di linguaggio anziché come un'estensione.</span><span class="sxs-lookup"><span data-stu-id="d1b78-134">In XAML 2009 specifically, arrays are accessed as language primitives instead of as an extension.</span></span> <span data-ttu-id="d1b78-135">Per altre informazioni, vedere [XAML 2009 Language Features](xaml-2009-language-features.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-135">For more information, see [XAML 2009 Language Features](xaml-2009-language-features.md).</span></span>

### <a name="xreference"></a><span data-ttu-id="d1b78-136">x:Reference</span><span class="sxs-lookup"><span data-stu-id="d1b78-136">x:Reference</span></span>

<span data-ttu-id="d1b78-137">`x:Reference` fa parte di XAML 2009, un'estensione del set del linguaggio originale (2006).</span><span class="sxs-lookup"><span data-stu-id="d1b78-137">`x:Reference` is part of XAML 2009, an extension of the original (2006) language set.</span></span> <span data-ttu-id="d1b78-138">`x:Reference` rappresenta un riferimento a un altro oggetto esistente in un oggetto grafico.</span><span class="sxs-lookup"><span data-stu-id="d1b78-138">`x:Reference` represents a reference to another existing object in an object graph.</span></span> <span data-ttu-id="d1b78-139">Questo oggetto viene definito dal relativo attributo `x:Name`.</span><span class="sxs-lookup"><span data-stu-id="d1b78-139">That object is identified by its `x:Name`.</span></span> <span data-ttu-id="d1b78-140">Per altre informazioni, vedere [x:Reference Markup Extension](xreference-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-140">For more information, see [x:Reference Markup Extension](xreference-markup-extension.md).</span></span>

### <a name="other-x-constructs"></a><span data-ttu-id="d1b78-141">Altri costrutti x:</span><span class="sxs-lookup"><span data-stu-id="d1b78-141">Other x: Constructs</span></span>

<span data-ttu-id="d1b78-142">Esistono altri costrutti `x:` che supportano le funzionalità del linguaggio XAML, che però non sono implementati come estensioni di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-142">Other `x:` constructs to support XAML language features exist, but these are not implemented as markup extensions.</span></span> <span data-ttu-id="d1b78-143">Per altre informazioni, vedere [XAML Namespace (x:) Language Features](namespace-language-features.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-143">For more information, see [XAML Namespace (x:) Language Features](namespace-language-features.md).</span></span>

## <a name="the-markupextension-base-class"></a><span data-ttu-id="d1b78-144">Classe base MarkupExtension</span><span class="sxs-lookup"><span data-stu-id="d1b78-144">The MarkupExtension Base Class</span></span>

<span data-ttu-id="d1b78-145">Per definire un'estensione di markup personalizzata che possa interagire con le implementazioni predefinite di reader XAML e writer XAML in System.Xaml, è possibile derivare una classe dalla classe <xref:System.Windows.Markup.MarkupExtension> astratta.</span><span class="sxs-lookup"><span data-stu-id="d1b78-145">To define a custom markup extension that can interact with the default implementations of XAML readers and XAML writers in System.Xaml, you derive a class from the abstract <xref:System.Windows.Markup.MarkupExtension> class.</span></span> <span data-ttu-id="d1b78-146">Questa classe ha di un unico metodo di cui eseguire l'override, ovvero <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="d1b78-146">That class has one method to override, which is <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>.</span></span> <span data-ttu-id="d1b78-147">Potrebbe anche essere necessario definire costruttori aggiuntivi per il supporto di argomenti dell'utilizzo dell'estensione di markup, nonché le proprietà impostabili.</span><span class="sxs-lookup"><span data-stu-id="d1b78-147">You might also need to define additional constructors to support arguments to the markup extension usage, and matching settable properties.</span></span>

<span data-ttu-id="d1b78-148">Tramite <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>un'estensione di markup personalizzata ha accesso a un contesto di servizio che segnala l'ambiente in cui l'estensione di markup viene richiamata da un processore XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-148">Through <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>, a custom markup extension has access to a service context that reports the environment where the markup extension is invoked by a XAML processor.</span></span> <span data-ttu-id="d1b78-149">Nel percorso di caricamento si <xref:System.Xaml.XamlObjectWriter>tratta in genere di un oggetto .</span><span class="sxs-lookup"><span data-stu-id="d1b78-149">In the load path, this is typically a <xref:System.Xaml.XamlObjectWriter>.</span></span> <span data-ttu-id="d1b78-150">Nel percorso di salvataggio si tratta in genere di un oggetto <xref:System.Xaml.XamlXmlWriter>.</span><span class="sxs-lookup"><span data-stu-id="d1b78-150">In the save path this is typically a <xref:System.Xaml.XamlXmlWriter>.</span></span> <span data-ttu-id="d1b78-151">Il contesto del servizio viene segnalato come classe di contesto del provider di servizi XAML interna che implementa un modello del provider di servizi.</span><span class="sxs-lookup"><span data-stu-id="d1b78-151">Each report the service context as an internal XAML service provider context class that implements a service provider pattern.</span></span> <span data-ttu-id="d1b78-152">Per altre informazioni sui servizi disponibili e su ciò che rappresentano, vedere [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-152">For more information about the available services and what they represent, see [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span></span>

<span data-ttu-id="d1b78-153">La classe dell'estensione di markup deve usare un livello di accesso pubblico. I processori XAML devono essere sempre in grado di creare un'istanza della classe di supporto dell'estensione di markup in modo da usare i relativi servizi.</span><span class="sxs-lookup"><span data-stu-id="d1b78-153">Your markup extension class must use a public access level; XAML processors must always be able to instantiate the markup extension's support class in order to use its services.</span></span>

## <a name="defining-the-support-type-for-a-custom-markup-extension"></a><span data-ttu-id="d1b78-154">Definizione del tipo di supporto per un'estensione di markup personalizzata</span><span class="sxs-lookup"><span data-stu-id="d1b78-154">Defining the Support Type for a Custom Markup Extension</span></span>

<span data-ttu-id="d1b78-155">Quando usi i servizi XAML .NET o i framework che si basano sui servizi XAML .NET, hai due opzioni per denominare il tipo di supporto dell'estensione di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-155">When you use .NET XAML Services or frameworks that build on .NET XAML Services, you have two choices for how to name the markup extension support type.</span></span> <span data-ttu-id="d1b78-156">Il nome del tipo è rilevante per la modalità con cui i writer dell'oggetto XAML tentano di accedere e richiamare un tipo di supporto dell'estensione di markup quando rilevano un utilizzo dell'estensione di markup in XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-156">The type name is relevant to how XAML object writers attempt to access and invoke a markup extension support type when they encounter a markup extension usage in XAML.</span></span> <span data-ttu-id="d1b78-157">Usare una delle strategie di denominazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="d1b78-157">Use one of the following naming strategies:</span></span>

- <span data-ttu-id="d1b78-158">Denominare il tipo in modo che corrisponda esattamente al token di utilizzo del markup XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-158">Name the type name to be an exact match to the XAML markup usage token.</span></span> <span data-ttu-id="d1b78-159">Ad esempio, per supportare l'utilizzo di un'estensione `{Collate ...}` , denominare il tipo di supporto `Collate`.</span><span class="sxs-lookup"><span data-stu-id="d1b78-159">For example, to support a `{Collate ...}` extension usage, name the support type `Collate`.</span></span>
- <span data-ttu-id="d1b78-160">Denominare il tipo in modo che corrisponda al token della stringa dell'utilizzo seguito dal suffisso `Extension`.</span><span class="sxs-lookup"><span data-stu-id="d1b78-160">Name the type name to be the usage string token plus the suffix `Extension`.</span></span> <span data-ttu-id="d1b78-161">Ad esempio, per supportare l'utilizzo di un'estensione `{Collate ...}` , denominare il tipo di supporto `CollateExtension`.</span><span class="sxs-lookup"><span data-stu-id="d1b78-161">For example, to support a `{Collate ...}` extension usage, name the support type `CollateExtension`.</span></span>

<span data-ttu-id="d1b78-162">L'ordine di ricerca prevede che venga cercato per primo il nome della classe con il suffisso `Extension`, quindi il nome della classe senza il suffisso `Extension` .</span><span class="sxs-lookup"><span data-stu-id="d1b78-162">The order of lookup is to look for the `Extension`-suffixed class name first and then look for the class name without the `Extension` suffix.</span></span>

<span data-ttu-id="d1b78-163">Dal punto di vista dell'utilizzo del markup, l'inclusione del suffisso `Extension` come parte dell'utilizzo è una procedura valida.</span><span class="sxs-lookup"><span data-stu-id="d1b78-163">From the markup usage perspective, including the `Extension` suffix as part of the usage is valid.</span></span> <span data-ttu-id="d1b78-164">Tuttavia, `Extension` viene considerato a tutti gli effetti parte del nome della classe, per cui i writer di oggetti XAML non riuscirebbero a risolvere una classe di supporto dell'estensione di markup per quell'utilizzo se la stessa classe non avesse il suffisso `Extension` .</span><span class="sxs-lookup"><span data-stu-id="d1b78-164">However, this behaves as if `Extension` is truly part of the class name, and XAML object writers would fail to resolve a markup extension support class for that usage if the support class did not have the `Extension` suffix.</span></span>

### <a name="the-parameterless-constructor"></a><span data-ttu-id="d1b78-165">Il costruttore senza parametri</span><span class="sxs-lookup"><span data-stu-id="d1b78-165">The parameterless constructor</span></span>

<span data-ttu-id="d1b78-166">Per tutti i tipi di supporto dell'estensione di markup, è necessario esporre un costruttore pubblico senza parametri.</span><span class="sxs-lookup"><span data-stu-id="d1b78-166">For all markup extension support types, you should expose a public parameterless constructor.</span></span> <span data-ttu-id="d1b78-167">Un costruttore senza parametri è necessario per tutti i casi in cui un writer di oggetti XAML crea un'istanza dell'estensione di markup dall'utilizzo di un elemento oggetto.</span><span class="sxs-lookup"><span data-stu-id="d1b78-167">A parameterless constructor is required for any case where a XAML object writer instantiates the markup extension from an object element usage.</span></span> <span data-ttu-id="d1b78-168">L'utilizzo dell'elemento oggetto di supporto è un'aspettativa legittima per un'estensione di markup, specialmente per la serializzazione.</span><span class="sxs-lookup"><span data-stu-id="d1b78-168">Supporting object element usage is a fair expectation for a markup extension, particularly for serialization.</span></span> <span data-ttu-id="d1b78-169">Si può tuttavia possibile implementare un'estensione di markup senza un costruttore pubblico quando si intende supportare solo gli utilizzi degli attributi dell'estensione di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-169">However, you can implement a markup extension without a public constructor if you only intend to support attribute usages of the markup extension.</span></span>

<span data-ttu-id="d1b78-170">Se l'utilizzo dell'estensione di markup non dispone di argomenti, il costruttore senza parametri è necessario per supportare l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-170">If your markup extension usage has no arguments, the parameterless constructor is required to support usage.</span></span>

## <a name="constructor-patterns-and-positional-arguments-for-a-custom-markup-extension"></a><span data-ttu-id="d1b78-171">Modelli di costruttore e argomenti posizionali per un'estensione di markup personalizzata</span><span class="sxs-lookup"><span data-stu-id="d1b78-171">Constructor Patterns and Positional Arguments for a Custom Markup Extension</span></span>

<span data-ttu-id="d1b78-172">Per un'estensione di markup con utilizzo degli argomenti previsto, i costruttori pubblici devono corrispondere alle modalità dell'utilizzo previsto.</span><span class="sxs-lookup"><span data-stu-id="d1b78-172">For a markup extension with intended argument usage, the public constructors must correspond to the modes of the intended usage.</span></span> <span data-ttu-id="d1b78-173">In altri termini, se l'estensione di markup viene progettata per richiedere un argomento posizionale come utilizzo valido, è necessario supportare un costruttore pubblico con un parametro di input che accetti l'argomento posizionale.</span><span class="sxs-lookup"><span data-stu-id="d1b78-173">In other words, if your markup extension is designed to require one positional argument as a valid usage, you should support a public constructor with one input parameter that takes the positional argument.</span></span>

<span data-ttu-id="d1b78-174">Si supponga ad esempio che sia previsto che l'estensione di markup `Collate` supporti solo una modalità in cui è presente un argomento posizionale che rappresenta la relativa modalità, specificato come costante di enumerazione `CollationMode` .</span><span class="sxs-lookup"><span data-stu-id="d1b78-174">For example, suppose the `Collate` markup extension is intended to support only a mode where there is one positional argument that represents its mode, specified as a `CollationMode` enumeration constant.</span></span> <span data-ttu-id="d1b78-175">In questo caso, è necessario che sia presente un costruttore nel formato seguente:</span><span class="sxs-lookup"><span data-stu-id="d1b78-175">In this case, there should be a constructor with the following form:</span></span>

```csharp
public Collate(CollationMode collationMode) {...}
```

<span data-ttu-id="d1b78-176">A un livello di base, gli argomenti passati a un'estensione di markup sono costituiti da una stringa in quanto vengono inoltrati dai valori dell'attributo del markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-176">At a basic level, the arguments passed to a markup extension are a string because they are being forwarded from the markup's attribute values.</span></span> <span data-ttu-id="d1b78-177">È possibile rendere stringhe tutti gli argomenti e utilizzare l'input a tale livello.</span><span class="sxs-lookup"><span data-stu-id="d1b78-177">You can make all of your arguments strings and work with input at that level.</span></span> <span data-ttu-id="d1b78-178">Si dispone tuttavia dell'accesso a determinate attività di elaborazione che vengono eseguite prima del passaggio degli argomenti dell'estensione di markup alla classe di supporto.</span><span class="sxs-lookup"><span data-stu-id="d1b78-178">However, you do have access to certain processing that occurs before the markup extension arguments are passed to the support class.</span></span>

<span data-ttu-id="d1b78-179">L'elaborazione viene eseguita a livello concettuale come se l'estensione di markup fosse un oggetto da creare, quindi vengono impostati i valori di membro.</span><span class="sxs-lookup"><span data-stu-id="d1b78-179">The processing works conceptually as if the markup extension is an object to be created, and then its member values are set.</span></span> <span data-ttu-id="d1b78-180">Ogni proprietà specificata da impostare viene valutata nello stesso modo in cui un membro specificato può essere impostato su un oggetto creato durante l'analisi del codice XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-180">Each specified property to set is evaluated similar to how a specified member can be set on a created object when XAML is parsed.</span></span> <span data-ttu-id="d1b78-181">Vi sono due differenze importanti:</span><span class="sxs-lookup"><span data-stu-id="d1b78-181">There are two important differences:</span></span>

- <span data-ttu-id="d1b78-182">Come indicato in precedenza, non è necessario che un tipo di supporto dell'estensione di markup disponga di un costruttore senza parametri per poter creare un'istanza in XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-182">As noted previously, a markup extension support type does not need to have a parameterless constructor in order to be instantiated in XAML.</span></span> <span data-ttu-id="d1b78-183">La costruzione di oggetti viene rinviata fino a quando gli argomenti possibili corrispondenti nella sintassi del testo non vengono convertiti in formato token e valutati come argomenti posizionali o denominati e il costruttore appropriato non viene a quel punto chiamato.</span><span class="sxs-lookup"><span data-stu-id="d1b78-183">Its object construction is deferred until its possible arguments in the text syntax are tokenized and evaluated as either positional or named arguments, and the appropriate constructor is called at that time.</span></span>
- <span data-ttu-id="d1b78-184">Gli utilizzi delle estensioni di markup possono essere annidati.</span><span class="sxs-lookup"><span data-stu-id="d1b78-184">Markup extensions usages can be nested.</span></span> <span data-ttu-id="d1b78-185">L'estensione di markup più interna viene valutata per prima.</span><span class="sxs-lookup"><span data-stu-id="d1b78-185">The innermost markup extension is evaluated first.</span></span> <span data-ttu-id="d1b78-186">È dunque possibile presupporre tale utilizzo e dichiarare uno dei parametri della costruzione come tipo che richiede un convertitore di valori, ad esempio un'estensione di markup, da produrre.</span><span class="sxs-lookup"><span data-stu-id="d1b78-186">Therefore, you can assume such a usage and declare one of the construction parameters to be a type that requires a value converter (such as a markup extension) to produce.</span></span>

<span data-ttu-id="d1b78-187">Nell'esempio precedente viene illustrato l'affidamento su tale elaborazione.</span><span class="sxs-lookup"><span data-stu-id="d1b78-187">A reliance on such processing was shown in the previous example.</span></span> <span data-ttu-id="d1b78-188">Il writer di oggetti XAML dei servizi XAML .NET elabora i nomi delle costanti di enumerazione in valori enumerati a livello nativo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-188">.NET XAML Services XAML object writer processes enumeration constant names into enumerated values at a native level.</span></span>

<span data-ttu-id="d1b78-189">L'elaborazione della sintassi del testo di un parametro posizionale dell'estensione di markup può anche basarsi su un convertitore di tipi associato al tipo nell'argomento della costruzione.</span><span class="sxs-lookup"><span data-stu-id="d1b78-189">Processing text syntax of a markup extension positional parameter can also rely on a type converter that is associated with the type that is in the construction argument.</span></span>

<span data-ttu-id="d1b78-190">Gli argomenti sono detti argomenti posizionali perché l'ordine in base al quale vengono rilevati i token nell'utilizzo corrisponde all'ordine posizionale del parametro del costruttore a cui sono assegnati.</span><span class="sxs-lookup"><span data-stu-id="d1b78-190">The arguments are called positional arguments because the order in which the tokens in the usage is encountered corresponds to the positional order of the constructor parameter to which they are assigned.</span></span> <span data-ttu-id="d1b78-191">Si consideri ad esempio la firma del costruttore seguente:</span><span class="sxs-lookup"><span data-stu-id="d1b78-191">For example, consider the following constructor signature:</span></span>

```csharp
public Collate(CollationMode collationMode, object collateThis) {...}
```

<span data-ttu-id="d1b78-192">Un processore XAML prevede la presenza di due argomenti posizionali per questa estensione di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-192">A XAML processor expects two positional arguments for this markup extension.</span></span> <span data-ttu-id="d1b78-193">Per un utilizzo `{Collate AlphaUp,{x:Reference circularFile}}`, il token `AlphaUp` viene inviato al primo parametro e quindi valutato come costante denominata dell'enumerazione `CollationMode` .</span><span class="sxs-lookup"><span data-stu-id="d1b78-193">If there was a usage `{Collate AlphaUp,{x:Reference circularFile}}`, the `AlphaUp` token is sent to the first parameter and evaluated as a `CollationMode` enumeration named constant.</span></span> <span data-ttu-id="d1b78-194">Il risultato dell'argomento `x:Reference` interno viene inviato al secondo parametro e valutato come oggetto.</span><span class="sxs-lookup"><span data-stu-id="d1b78-194">The result of the inner `x:Reference` is sent to the second parameter and evaluated as an object.</span></span>

<span data-ttu-id="d1b78-195">Nelle regole specificate per XAML per la sintassi e l'elaborazione dell'estensione di markup, la virgola è il delimitatore degli argomenti, sia posizionali che denominati.</span><span class="sxs-lookup"><span data-stu-id="d1b78-195">In the XAML specified rules for markup extension syntax and processing, the comma is the delimiter between arguments, whether those arguments are positional arguments or named arguments.</span></span>

### <a name="duplicate-arity-of-positional-arguments"></a><span data-ttu-id="d1b78-196">Duplica arità di argomenti posizionali</span><span class="sxs-lookup"><span data-stu-id="d1b78-196">Duplicate arity of positional arguments</span></span>

<span data-ttu-id="d1b78-197">Se un writer di oggetti XAML rileva un utilizzo dell'estensione di markup con argomenti posizionali e sono presenti più argomenti del costruttore che accettano il numero di argomenti specificato (un grado duplicato), non si tratta necessariamente di un errore.</span><span class="sxs-lookup"><span data-stu-id="d1b78-197">If a XAML object writer encounters a markup extension usage with positional arguments, and there are multiple constructor arguments that take that number of arguments (a duplicate arity), that is not necessarily an error.</span></span> <span data-ttu-id="d1b78-198">Il comportamento dipende da un'impostazione del contesto dello schema XAML personalizzabile, <xref:System.Xaml.XamlSchemaContextSettings.SupportMarkupExtensionsWithDuplicateArity%2A>.</span><span class="sxs-lookup"><span data-stu-id="d1b78-198">The behavior depends on a customizable XAML schema context setting, <xref:System.Xaml.XamlSchemaContextSettings.SupportMarkupExtensionsWithDuplicateArity%2A>.</span></span> <span data-ttu-id="d1b78-199">Se <xref:System.Xaml.XamlSchemaContextSettings.SupportMarkupExtensionsWithDuplicateArity%2A> è `true`, un writer di oggetti XAML non genera un'eccezione solo per motivi di grado duplicato.</span><span class="sxs-lookup"><span data-stu-id="d1b78-199">If <xref:System.Xaml.XamlSchemaContextSettings.SupportMarkupExtensionsWithDuplicateArity%2A> is `true`, a XAML object writer should not throw an exception only for reasons of duplicate arity.</span></span> <span data-ttu-id="d1b78-200">Il comportamento oltre tale punto non è definito con precisione.</span><span class="sxs-lookup"><span data-stu-id="d1b78-200">Behavior beyond that point is not strictly defined.</span></span> <span data-ttu-id="d1b78-201">Il presupposto di base per la progettazione è che il contesto dello schema disponga di informazioni sul tipo disponibili per i parametri specifici e possa tentare cast espliciti corrispondenti ai candidati duplicati per individuare la firma che potenzialmente costituisce la corrispondenza ottimale.</span><span class="sxs-lookup"><span data-stu-id="d1b78-201">The basic design assumption is that the schema context has type information available for the specific parameters and can attempt explicit casts that match the duplicate candidates to see which signature might be the best match.</span></span> <span data-ttu-id="d1b78-202">È comunque possibile che venga generata un'eccezione se nessuna delle firme supera i test imposti da tale particolare contesto dello schema in esecuzione in un writer di oggetti XAML.</span><span class="sxs-lookup"><span data-stu-id="d1b78-202">An exception might still be thrown if no signatures can pass the tests that are imposed by that particular schema context that is running on a XAML object writer.</span></span>

<span data-ttu-id="d1b78-203">Per impostazione predefinita, <xref:System.Xaml.XamlSchemaContextSettings.SupportMarkupExtensionsWithDuplicateArity%2A> è `false` in BASE a <xref:System.Xaml.XamlSchemaContext> CLR per i servizi XAML .NET.</span><span class="sxs-lookup"><span data-stu-id="d1b78-203">By default, <xref:System.Xaml.XamlSchemaContextSettings.SupportMarkupExtensionsWithDuplicateArity%2A> is `false` in the CLR-based <xref:System.Xaml.XamlSchemaContext> for .NET XAML Services.</span></span> <span data-ttu-id="d1b78-204">L'oggetto <xref:System.Xaml.XamlObjectWriter> predefinito, pertanto, genera eccezioni se rileva un utilizzo dell'estensione di markup con grado duplicato nei costruttori del tipo sottostante.</span><span class="sxs-lookup"><span data-stu-id="d1b78-204">Thus, the default <xref:System.Xaml.XamlObjectWriter> throws exceptions if it encounters a markup extension usage where there is duplicate arity in the backing type's constructors.</span></span>

## <a name="named-arguments-for-a-custom-markup-extension"></a><span data-ttu-id="d1b78-205">Argomenti denominati per un'estensione di markup personalizzataNamed arguments for a custom markup extension</span><span class="sxs-lookup"><span data-stu-id="d1b78-205">Named arguments for a custom markup extension</span></span>

<span data-ttu-id="d1b78-206">Le estensioni di markup specificate da XAML possono anche usare argomenti denominati per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-206">Markup extensions as specified by XAML can also use a named arguments form for usage.</span></span> <span data-ttu-id="d1b78-207">Al primo livello di tokenizzazione, la sintassi del testo è divisa in argomenti.</span><span class="sxs-lookup"><span data-stu-id="d1b78-207">At the first level of tokenization, the text syntax is divided into arguments.</span></span> <span data-ttu-id="d1b78-208">La presenza di un segno di uguale (=) all'interno di qualsiasi argomento lo identifica come argomento denominato.</span><span class="sxs-lookup"><span data-stu-id="d1b78-208">The presence of an equals sign (=) within any argument identifies an argument as a named argument.</span></span> <span data-ttu-id="d1b78-209">L'argomento viene inoltre convertito in formato token in una coppia nome/valore.</span><span class="sxs-lookup"><span data-stu-id="d1b78-209">Such an argument is also tokenized into a name/value pair.</span></span> <span data-ttu-id="d1b78-210">Il nome in questo caso denomina una proprietà impostabile pubblica del tipo di supporto dell'estensione di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-210">The name in this case names a public settable property of the markup extension's support type.</span></span> <span data-ttu-id="d1b78-211">Se si intende supportare l'utilizzo di argomenti denominati, sarà necessario fornire queste proprietà impostabili pubbliche.</span><span class="sxs-lookup"><span data-stu-id="d1b78-211">If you intend to support named argument usage, you should provide these public settable properties.</span></span> <span data-ttu-id="d1b78-212">Le proprietà possono essere proprietà ereditate, fino a quando rimangono pubbliche.</span><span class="sxs-lookup"><span data-stu-id="d1b78-212">The properties can be inherited properties as long as they remain public.</span></span>

## <a name="accessing-service-provider-context-from-a-markup-extension-implementation"></a><span data-ttu-id="d1b78-213">Accesso al contesto del provider di servizi da un'implementazione dell'estensione di markup</span><span class="sxs-lookup"><span data-stu-id="d1b78-213">Accessing Service Provider Context from a Markup Extension Implementation</span></span>

<span data-ttu-id="d1b78-214">I servizi disponibili sono gli stessi per qualsiasi convertitore di valori.</span><span class="sxs-lookup"><span data-stu-id="d1b78-214">The services available are the same for any value converter.</span></span> <span data-ttu-id="d1b78-215">L'unica differenza risiede nel modo in cui ogni convertitore di valori riceve il contesto del servizio.</span><span class="sxs-lookup"><span data-stu-id="d1b78-215">The difference is in how each value converter receives the service context.</span></span> <span data-ttu-id="d1b78-216">L'accesso ai servizi e i servizi disponibili sono illustrati nell'argomento [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="d1b78-216">Accessing services and the services available are documented in the topic [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span></span>

## <a name="property-element-usage-of-a-markup-extension"></a><span data-ttu-id="d1b78-217">Utilizzo dell'elemento proprietà di un'estensione di markupProperty element usage of a markup extension</span><span class="sxs-lookup"><span data-stu-id="d1b78-217">Property element usage of a markup extension</span></span>

<span data-ttu-id="d1b78-218">Gli scenari per gli utilizzi di estensioni di markup sono spesso progettati attorno all'uso dell'estensione di markup nell'utilizzo dell'attributo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-218">The scenarios for markup extension usages are often designed around using the markup extension in attribute usage.</span></span> <span data-ttu-id="d1b78-219">Tuttavia, si può anche definire la classe sottostante in modo che supporti l'utilizzo dell'elemento proprietà.</span><span class="sxs-lookup"><span data-stu-id="d1b78-219">However, it is also potentially possible to define the backing class to support property element usage.</span></span>

<span data-ttu-id="d1b78-220">Per supportare l'utilizzo dell'elemento proprietà dell'estensione di markup, definire un costruttore pubblico senza parametri.</span><span class="sxs-lookup"><span data-stu-id="d1b78-220">To support property element usage of your markup extension, define a public parameterless constructor.</span></span> <span data-ttu-id="d1b78-221">Deve trattarsi di un costruttore di istanza, non di un costruttore statico.</span><span class="sxs-lookup"><span data-stu-id="d1b78-221">This should be an instance constructor not a static constructor.</span></span> <span data-ttu-id="d1b78-222">Questa operazione è necessaria perché un processore XAML deve in genere richiamare il costruttore senza parametri su qualsiasi elemento oggetto elaborato dal markup e sono incluse le classi di estensione di markup come elementi oggetto.</span><span class="sxs-lookup"><span data-stu-id="d1b78-222">This is required because a XAML processor must generally invoke the parameterless constructor on any object element it processes from markup, and this includes markup extension classes as object elements.</span></span> <span data-ttu-id="d1b78-223">Per gli scenari avanzati, è possibile definire percorsi di costruzione non predefiniti per le classi.</span><span class="sxs-lookup"><span data-stu-id="d1b78-223">For advanced scenarios, you can define non-default construction paths for classes.</span></span> <span data-ttu-id="d1b78-224">(Per ulteriori informazioni, vedere [x:FactoryMethod direttiva](xfactorymethod-directive.md).) Tuttavia, è consigliabile non usare questi modelli per scopi di estensione di markup perché questo rende l'individuazione del modello di utilizzo molto più difficile, sia per i progettisti che per gli utenti di markup non elaborato.</span><span class="sxs-lookup"><span data-stu-id="d1b78-224">(For more information, see [x:FactoryMethod Directive](xfactorymethod-directive.md).) However, you should not use these patterns for markup extension purposes because this makes discovery of the usage pattern much more difficult, both for designers and for users of raw markup.</span></span>

## <a name="attributing-for-a-custom-markup-extension"></a><span data-ttu-id="d1b78-225">Attribuzione per un'estensione di markup personalizzata</span><span class="sxs-lookup"><span data-stu-id="d1b78-225">Attributing for a custom markup extension</span></span>

<span data-ttu-id="d1b78-226">Per supportare sia gli ambienti di progettazione sia determinati scenari dei writer di oggetti XAML, è necessario associare al tipo di supporto dell'estensione di markup diversi attributi CLR.</span><span class="sxs-lookup"><span data-stu-id="d1b78-226">To support both design environments and certain XAML object writer scenarios, you should attribute a markup extension support type with several CLR attributes.</span></span> <span data-ttu-id="d1b78-227">Questi attributi indicano l'utilizzo dell'estensione di markup desiderato.</span><span class="sxs-lookup"><span data-stu-id="d1b78-227">These attributes report the intended markup extension usage.</span></span>

 <span data-ttu-id="d1b78-228"><xref:System.Windows.Markup.MarkupExtensionReturnTypeAttribute> specifica le informazioni <xref:System.Type> per il tipo di oggetto restituito da <xref:System.Windows.Markup.ArrayExtension.ProvideValue%2A> .</span><span class="sxs-lookup"><span data-stu-id="d1b78-228"><xref:System.Windows.Markup.MarkupExtensionReturnTypeAttribute> reports the <xref:System.Type> information for the object type that <xref:System.Windows.Markup.ArrayExtension.ProvideValue%2A> returns.</span></span> <span data-ttu-id="d1b78-229">In base alla semplice firma, <xref:System.Windows.Markup.ArrayExtension.ProvideValue%2A> restituisce <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="d1b78-229">By its pure signature, <xref:System.Windows.Markup.ArrayExtension.ProvideValue%2A> returns <xref:System.Object>.</span></span> <span data-ttu-id="d1b78-230">Diversi consumer potrebbero però richiedere informazioni più precise sul tipo restituito,</span><span class="sxs-lookup"><span data-stu-id="d1b78-230">But various consumers might want more precise return type information.</span></span> <span data-ttu-id="d1b78-231">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="d1b78-231">This includes:</span></span>

- <span data-ttu-id="d1b78-232">Finestre di progettazione e IDE, potenzialmente in grado di fornire supporto dipendente dal tipo per gli utilizzi delle estensioni di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-232">Designers and IDEs, who might be able to provide type-aware support for markup extension usages.</span></span>
- <span data-ttu-id="d1b78-233">Implementazioni avanzate di gestori `SetMarkupExtension` in classi di destinazione, che possono basarsi sulla reflection per determinare il tipo restituito di un'estensione di markup anziché creare un ramo in implementazioni di <xref:System.Windows.Markup.MarkupExtension> specifiche note in base al nome.</span><span class="sxs-lookup"><span data-stu-id="d1b78-233">Advanced implementations of `SetMarkupExtension` handlers on target classes, which might rely on reflection to determine a markup extension's return type instead of branching on specific known <xref:System.Windows.Markup.MarkupExtension> implementations by name.</span></span>

## <a name="serialization-of-markup-extension-usages"></a><span data-ttu-id="d1b78-234">Serializzazione degli utilizzi delle estensioni di markupSerialization of markup extension usages</span><span class="sxs-lookup"><span data-stu-id="d1b78-234">Serialization of markup extension usages</span></span>

<span data-ttu-id="d1b78-235">Quando un writer di oggetti XAML elabora un utilizzo dell'estensione di markup e chiama <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>, il contesto del metodo che è stato precedentemente un utilizzo dell'estensione di markup viene reso persistente nel flusso del nodo XAML, ma non nell'oggetto grafico.</span><span class="sxs-lookup"><span data-stu-id="d1b78-235">When a XAML object writer processes a markup extension usage and calls <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>, the context for it previously being a markup extension usage persists in the XAML node stream but not in the object graph.</span></span> <span data-ttu-id="d1b78-236">Nell'oggetto grafico viene mantenuto solo il valore.</span><span class="sxs-lookup"><span data-stu-id="d1b78-236">In the object graph, only the value is preserved.</span></span> <span data-ttu-id="d1b78-237">In presenza di scenari di progettazione o altri motivi che determinano la necessità di rendere persistente l'utilizzo dell'estensione di markup originale nell'output serializzato, sarà necessario progettare un'infrastruttura personalizzata per la verifica degli utilizzi delle estensioni di markup dal flusso del nodo XAML del percorso di caricamento.</span><span class="sxs-lookup"><span data-stu-id="d1b78-237">If you have design scenarios or other reasons for persisting the original markup extension usage into the serialized output, you must design your own infrastructure for tracking the markup extension usages from the load path XAML node stream.</span></span> <span data-ttu-id="d1b78-238">Si può implementare il comportamento per ricreare gli elementi del flusso del nodo dal percorso di caricamento e riprodurli per i writer XAML per la serializzazione nel percorso di salvataggio, sostituendo il valore nella posizione appropriata del flusso del nodo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-238">You can implement behavior to recreate the elements of the node stream from the load path and play them back to XAML writers for serialization in the save path, substituting for the value in the appropriate position of the node stream.</span></span>

## <a name="markup-extensions-in-the-xaml-node-stream"></a><span data-ttu-id="d1b78-239">Estensioni di markup nel flusso del nodo XAMLMarkup extensions in the XAML node stream</span><span class="sxs-lookup"><span data-stu-id="d1b78-239">Markup extensions in the XAML node stream</span></span>

<span data-ttu-id="d1b78-240">Se si usa un flusso del nodo XAML nel percorso di caricamento, un utilizzo dell'estensione di markup viene visualizzato come oggetto nel flusso del nodo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-240">If you are working with a XAML node stream on the load path, a markup extension usage appears in the node stream as an object.</span></span>

<span data-ttu-id="d1b78-241">Se l'utilizzo dell'estensione di markup usa argomenti posizionali, viene rappresentato come oggetto iniziale con un valore di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="d1b78-241">If the markup extension usage uses positional arguments, it is represented as a start object with an initialization value.</span></span> <span data-ttu-id="d1b78-242">Come rappresentazione di testo approssimativa, il flusso del nodo sarà simile a quanto segue:</span><span class="sxs-lookup"><span data-stu-id="d1b78-242">As a rough text representation, the node stream resembles the following:</span></span>

<span data-ttu-id="d1b78-243">`StartObject` (<xref:System.Xaml.XamlType> è il tipo di definizione dell'estensione di markup, non il tipo restituito)</span><span class="sxs-lookup"><span data-stu-id="d1b78-243">`StartObject` (<xref:System.Xaml.XamlType> is the markup extension's definition type, not its return type)</span></span>

<span data-ttu-id="d1b78-244">`StartMember` (il nome di <xref:System.Xaml.XamlMember> è `_InitializationText`)</span><span class="sxs-lookup"><span data-stu-id="d1b78-244">`StartMember` (name of the <xref:System.Xaml.XamlMember> is `_InitializationText`)</span></span>

<span data-ttu-id="d1b78-245">`Value` (rappresenta gli argomenti posizionali sotto forma di stringa, inclusi i delimitatori frapposti)</span><span class="sxs-lookup"><span data-stu-id="d1b78-245">`Value` (value is the positional arguments as a string including the intervening delimiters)</span></span>

`EndMember`

`EndObject`

<span data-ttu-id="d1b78-246">Un utilizzo dell'estensione di markup con argomenti denominati viene rappresentato come oggetto con membri dei nomi pertinenti, ognuno impostato con valori della stringa di testo.</span><span class="sxs-lookup"><span data-stu-id="d1b78-246">A markup extension usage with named arguments is represented as an object with members of the relevant names, each set with text string values.</span></span>

<span data-ttu-id="d1b78-247">In realtà, il richiamo dell'implementazione di `ProvideValue` di un'estensione di markup necessita del contesto dello schema XAML, poiché questo richiede il mapping dei tipi e la creazione di un'istanza del tipo di supporto dell'estensione di markup.</span><span class="sxs-lookup"><span data-stu-id="d1b78-247">Actually invoking the `ProvideValue` implementation of a markup extension requires the XAML schema context because that requires type-mapping and creating a markup extension support type instance.</span></span> <span data-ttu-id="d1b78-248">Questo è uno dei motivi per cui gli utilizzi delle estensioni di markup vengono mantenuti in questo modo nei flussi di nodi dei servizi XAML .NET predefiniti: la parte del lettore di un percorso di caricamento spesso non dispone del contesto dello schema XAML necessario disponibile.</span><span class="sxs-lookup"><span data-stu-id="d1b78-248">This is one reason why markup extension usages are preserved this way in the default .NET XAML Services node streams -  the reader part of a load path often does not have the necessary XAML schema context available.</span></span>

<span data-ttu-id="d1b78-249">Se si utilizza un flusso del nodo XAML nel percorso di salvataggio, in genere la rappresentazione dell'oggetto grafico non contiene alcun elemento che possa indicare che l'oggetto da serializzare fosse originariamente fornito da un utilizzo dell'estensione di markup e un risultato `ProvideValue` .</span><span class="sxs-lookup"><span data-stu-id="d1b78-249">If you are working with a XAML node stream on the save path, there generally is nothing present in an object graph representation that can inform you that the object to serialize was originally provided by a markup extension usage and a `ProvideValue` result.</span></span> <span data-ttu-id="d1b78-250">Negli scenari che richiedono il salvataggio permanente degli utilizzi dell'estensione di markup per le sequenze di andata e ritorno e al contempo l'acquisizione di altre modifiche nell'oggetto grafico, è necessario ideare tecniche personalizzate per preservare la conoscenza di un utilizzo dell'estensione di markup dall'input XAML originale.</span><span class="sxs-lookup"><span data-stu-id="d1b78-250">Scenarios that need to persist markup extension usages for round-tripping while also capturing other changes in the object graph must devise their own techniques for preserving the knowledge of a markup extension usage from the original XAML input.</span></span> <span data-ttu-id="d1b78-251">Ad esempio, per ripristinare gli utilizzi dell'estensione di markup, può essere necessario usare il flusso del nodo nel percorso di salvataggio oppure eseguire una sorta di unione tra XAML originale e XAML sottoposto a sequenza di andata e ritorno.</span><span class="sxs-lookup"><span data-stu-id="d1b78-251">For example, to restore the markup extension usages, you may need to work with the node stream on the save path in order to restore markup extension usages, or perform some type of merge between the original XAML and the round-tripped XAML.</span></span> <span data-ttu-id="d1b78-252">Alcuni framework che implementano XAML, ad esempio WPF, usano tipi intermedi (espressioni) per rappresentare i casi in cui gli utilizzi dell'estensione di markup hanno fornito i valori.</span><span class="sxs-lookup"><span data-stu-id="d1b78-252">Some XAML-implementing frameworks such as WPF use intermediate types (expressions) to help represent cases where markup extension usages provided the values.</span></span>

## <a name="see-also"></a><span data-ttu-id="d1b78-253">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="d1b78-253">See also</span></span>

- <xref:System.Windows.Markup.MarkupExtension>
- [<span data-ttu-id="d1b78-254">Convertitori di tipi ed estensioni di markup per XAML</span><span class="sxs-lookup"><span data-stu-id="d1b78-254">Type Converters and Markup Extensions for XAML</span></span>](type-converters-and-markup-extensions.md)
- [<span data-ttu-id="d1b78-255">Estensioni di markup e XAML WPF</span><span class="sxs-lookup"><span data-stu-id="d1b78-255">Markup Extensions and WPF XAML</span></span>](../../framework/wpf/advanced/markup-extensions-and-wpf-xaml.md)
