---
title: Panoramica dei convertitori di tipi per XAML
ms.date: 03/30/2017
helpviewer_keywords:
- XAML [XAML Services], type converters
- XAML [XAML Services], TypeConverter
- type conversion for XAML [XAML Services]
ms.assetid: 51a65860-efcb-4fe0-95a0-1c679cde66b7
ms.openlocfilehash: c3c69aebacd140a14e74545d601c0207cb8de681
ms.sourcegitcommit: c2d9718996402993cf31541f11e95531bc68bad0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/27/2020
ms.locfileid: "82071633"
---
# <a name="overview-of-type-converters-for-xaml"></a><span data-ttu-id="302fb-102">Panoramica dei convertitori di tipi per XAMLOverview of type converters for XAML</span><span class="sxs-lookup"><span data-stu-id="302fb-102">Overview of type converters for XAML</span></span>

<span data-ttu-id="302fb-103">I convertitori di tipi forniscono la logica per un writer di oggetti che esegue una conversione da una stringa nel markup XAML in particolari oggetti in un oggetto grafico.</span><span class="sxs-lookup"><span data-stu-id="302fb-103">Type converters supply logic for an object writer that converts from a string in XAML markup into particular objects in an object graph.</span></span> <span data-ttu-id="302fb-104">Nei servizi XAML .NET, il convertitore di <xref:System.ComponentModel.TypeConverter>tipi deve essere una classe che deriva da .</span><span class="sxs-lookup"><span data-stu-id="302fb-104">In .NET XAML Services, the type converter must be a class that derives from <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="302fb-105">Alcuni convertitori supportano anche il percorso di salvataggio XAML e possono essere usati per serializzare un oggetto in un formato stringa nel markup di serializzazione.</span><span class="sxs-lookup"><span data-stu-id="302fb-105">Some converters also support the XAML save path and can be used to serialize an object into a string form in serialization markup.</span></span> <span data-ttu-id="302fb-106">Questo argomento descrive come e quando vengono richiamati i convertitori di tipi in XAML e vengono forniti consigli di implementazione per gli override del metodo di <xref:System.ComponentModel.TypeConverter>.</span><span class="sxs-lookup"><span data-stu-id="302fb-106">This topic describes how and when type converters in XAML are invoked, and provides implementation advice for the method overrides of <xref:System.ComponentModel.TypeConverter>.</span></span>

## <a name="type-conversion-concepts"></a><span data-ttu-id="302fb-107">Concetti relativi alla conversione di tipi</span><span class="sxs-lookup"><span data-stu-id="302fb-107">Type Conversion Concepts</span></span>

<span data-ttu-id="302fb-108">Nelle sezioni seguenti vengono illustrati i concetti di base sull'utilizzo delle stringhe da parte di XAML e sull'utilizzo dei convertitori di tipi nei servizi XAML .NET da parte dei writer di oggetti.</span><span class="sxs-lookup"><span data-stu-id="302fb-108">The following sections explain basic concepts about how XAML uses strings, and how object writers in .NET XAML Services use type converters to process some of the string values that are encountered in a XAML source.</span></span>

### <a name="xaml-and-string-values"></a><span data-ttu-id="302fb-109">Valori XAML e stringa</span><span class="sxs-lookup"><span data-stu-id="302fb-109">XAML and String Values</span></span>

<span data-ttu-id="302fb-110">Quando si imposta un valore dell'attributo in un file XAML, il tipo iniziale del valore è una stringa in senso generale e un valore dell'attributo di stringa in XML.</span><span class="sxs-lookup"><span data-stu-id="302fb-110">When you set an attribute value in a XAML file, the initial type of that value is a string in a general sense, and a string attribute value in an XML sense.</span></span> <span data-ttu-id="302fb-111">Anche altre primitive, ad esempio <xref:System.Double> , sono inizialmente stringhe per un processore XAML.</span><span class="sxs-lookup"><span data-stu-id="302fb-111">Even other primitives such as <xref:System.Double> are initially strings to a XAML processor.</span></span>

<span data-ttu-id="302fb-112">Nella maggior parte dei casi, un processore XAML deve disporre di due informazioni per elaborare un valore di attributo.</span><span class="sxs-lookup"><span data-stu-id="302fb-112">In most cases, a XAML processor needs two pieces of information to process an attribute value.</span></span> <span data-ttu-id="302fb-113">La prima informazione è il tipo di valore della proprietà che si imposta.</span><span class="sxs-lookup"><span data-stu-id="302fb-113">The first piece of information is the value type of the property that is being set.</span></span> <span data-ttu-id="302fb-114">Qualsiasi stringa che definisce un valore di attributo e che viene elaborata in XAML deve essere convertita o risolta in un valore di quel tipo.</span><span class="sxs-lookup"><span data-stu-id="302fb-114">Any string that defines an attribute value and that is processed in XAML must ultimately be converted or resolved to a value of that type.</span></span> <span data-ttu-id="302fb-115">Se il valore è una primitiva riconosciuta dal parser XAML (ad esempio un valore numerico), viene tentata una conversione diretta della stringa.</span><span class="sxs-lookup"><span data-stu-id="302fb-115">If the value is a primitive that is understood by the XAML parser (such as a numeric value), a direct conversion of the string is attempted.</span></span> <span data-ttu-id="302fb-116">Se il valore dell'attributo fa riferimento a un'enumerazione, nella stringa specificata viene verificata la corrispondenza del nome con una costante denominata in tale enumerazione.</span><span class="sxs-lookup"><span data-stu-id="302fb-116">If the value for the attribute references an enumeration, the supplied string is checked for a name match to a named constant in that enumeration.</span></span> <span data-ttu-id="302fb-117">Se il valore non è una primitiva riconosciuta dal parser o un nome costante da un'enumerazione, il tipo applicabile deve essere in grado di fornire un valore o un riferimento basato su una stringa convertita.</span><span class="sxs-lookup"><span data-stu-id="302fb-117">If the value is not a parser-understood primitive or a constant name from an enumeration, the applicable type must be able to provide a value or reference that is based on a converted string.</span></span>

> [!NOTE]
> <span data-ttu-id="302fb-118">Le direttive del linguaggio XAML non usano convertitori di tipi.</span><span class="sxs-lookup"><span data-stu-id="302fb-118">XAML language directives do not use type converters.</span></span>

### <a name="type-converters-and-markup-extensions"></a><span data-ttu-id="302fb-119">Convertitori di tipi ed estensioni di markup</span><span class="sxs-lookup"><span data-stu-id="302fb-119">Type Converters and Markup Extensions</span></span>

<span data-ttu-id="302fb-120">Gli utilizzi di estensioni di markup devono essere gestiti da un processore XAML prima che questo verifichi il tipo di proprietà e altre considerazioni.</span><span class="sxs-lookup"><span data-stu-id="302fb-120">Markup extension usages must be handled by a XAML processor before it checks for property type and other considerations.</span></span> <span data-ttu-id="302fb-121">Ad esempio, se una proprietà impostata come attributo viene associata normalmente a una conversione di tipi, ma in un caso particolare viene impostata mediante un utilizzo dell'estensione di markup, viene innanzitutto elaborato il comportamento dell'estensione di markup.</span><span class="sxs-lookup"><span data-stu-id="302fb-121">For example, if a property being set as an attribute normally has a type conversion, but in a particular case is set by a markup extension usage, then the markup extension behavior processes first.</span></span> <span data-ttu-id="302fb-122">Una situazione comune che richiede un'estensione di markup è la creazione di un riferimento a un oggetto già esistente.</span><span class="sxs-lookup"><span data-stu-id="302fb-122">One common situation where a markup extension is necessary is to make a reference to an object that already exists.</span></span> <span data-ttu-id="302fb-123">Per questo scenario, un convertitore di tipi senza stato può solo generare una nuova istanza, che non necessariamente è appropriata.</span><span class="sxs-lookup"><span data-stu-id="302fb-123">For this scenario, a stateless type converter can only generate a new instance, which might not be desirable.</span></span> <span data-ttu-id="302fb-124">Per ulteriori informazioni sulle estensioni di markup, vedere [Markup Extensions for XAML Overview](markup-extensions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="302fb-124">For more information about markup extensions, see [Markup Extensions for XAML Overview](markup-extensions-overview.md).</span></span>

### <a name="native-type-converters"></a><span data-ttu-id="302fb-125">Convertitori di tipi nativi</span><span class="sxs-lookup"><span data-stu-id="302fb-125">Native Type Converters</span></span>

<span data-ttu-id="302fb-126">Nelle implementazioni dei servizi XAML di Windows Presentation Foundation (WPF) e .NET sono disponibili alcuni tipi CLR con gestione della conversione dei tipi nativi.</span><span class="sxs-lookup"><span data-stu-id="302fb-126">In the Windows Presentation Foundation (WPF) and .NET XAML services implementations, there are certain CLR types that have native type conversion handling.</span></span> <span data-ttu-id="302fb-127">Tuttavia, tali tipi CLR non sono convenzionalmente considerati come primitive.</span><span class="sxs-lookup"><span data-stu-id="302fb-127">However, those CLR types are not conventionally thought of as primitives.</span></span> <span data-ttu-id="302fb-128">Un esempio dei tipi in questione è <xref:System.DateTime>.</span><span class="sxs-lookup"><span data-stu-id="302fb-128">An example of such a type is <xref:System.DateTime>.</span></span> <span data-ttu-id="302fb-129">Un motivo consiste nel funzionamento dell'architettura di .NET Framework: il tipo <xref:System.DateTime> è definito in mscorlib, la libreria più elementare di .NET.</span><span class="sxs-lookup"><span data-stu-id="302fb-129">One reason for this is how the .NET Framework architecture works: the type <xref:System.DateTime> is defined in mscorlib, the most basic library in .NET.</span></span> <span data-ttu-id="302fb-130"><xref:System.DateTime>non è consentito essere attribuito con un attributo proveniente<xref:System.ComponentModel.TypeConverterAttribute> da un altro assembly che introduce una dipendenza ( è da System).</span><span class="sxs-lookup"><span data-stu-id="302fb-130"><xref:System.DateTime> is not permitted to be attributed with an attribute that comes from another assembly that introduces a dependency (<xref:System.ComponentModel.TypeConverterAttribute> is from System).</span></span> <span data-ttu-id="302fb-131">Pertanto, il meccanismo di individuazione del convertitore di tipi consueto attribuendo non può essere supportato.</span><span class="sxs-lookup"><span data-stu-id="302fb-131">Therefore, the usual type converter discovery mechanism by attributing cannot be supported.</span></span> <span data-ttu-id="302fb-132">Il parser XAML dispone invece di un elenco di tipi che necessitano di elaborazione nativa ed elabora questi tipi con modalità analoghe all'elaborazione delle primitive effettive.</span><span class="sxs-lookup"><span data-stu-id="302fb-132">Instead, the XAML parser has a list of types that need native processing, and it processes these types similar to how the true primitives are processed.</span></span> <span data-ttu-id="302fb-133">Nel caso di <xref:System.DateTime>, l'elaborazione comporta una chiamata a <xref:System.DateTime.Parse%2A>.</span><span class="sxs-lookup"><span data-stu-id="302fb-133">In the case of <xref:System.DateTime>, this processing involves a call to <xref:System.DateTime.Parse%2A>.</span></span>

## <a name="implementing-a-type-converter"></a><span data-ttu-id="302fb-134">Implementazione di un convertitore di tipi</span><span class="sxs-lookup"><span data-stu-id="302fb-134">Implementing a Type Converter</span></span>

<span data-ttu-id="302fb-135">Le sezioni seguenti illustrano l'API della classe <xref:System.ComponentModel.TypeConverter> .</span><span class="sxs-lookup"><span data-stu-id="302fb-135">The following sections discuss the API of the <xref:System.ComponentModel.TypeConverter> class.</span></span>

### <a name="typeconverter"></a><span data-ttu-id="302fb-136">TypeConverter</span><span class="sxs-lookup"><span data-stu-id="302fb-136">TypeConverter</span></span>

<span data-ttu-id="302fb-137">In Servizi XAML .NET tutti i convertitori di tipi utilizzati per <xref:System.ComponentModel.TypeConverter>scopi XAML sono classi che derivano dalla classe base.</span><span class="sxs-lookup"><span data-stu-id="302fb-137">Under .NET XAML Services, all type converters that are used for XAML purposes are classes that derive from the base class <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="302fb-138">La classe <xref:System.ComponentModel.TypeConverter> era presente nelle versioni di .NET Framework precedenti all'introduzione di XAML; in origine, uno degli scenari di <xref:System.ComponentModel.TypeConverter> consisteva nel fornire la conversione delle stringhe per gli editor delle proprietà nelle finestre di progettazione visiva.</span><span class="sxs-lookup"><span data-stu-id="302fb-138">The <xref:System.ComponentModel.TypeConverter> class existed in versions of the .NET Framework before XAML existed; one of the original <xref:System.ComponentModel.TypeConverter> scenarios was to provide string conversion for property editors in visual designers.</span></span>

<span data-ttu-id="302fb-139">Per XAML, il ruolo di <xref:System.ComponentModel.TypeConverter> viene esteso.</span><span class="sxs-lookup"><span data-stu-id="302fb-139">For XAML, the role of <xref:System.ComponentModel.TypeConverter> is expanded.</span></span> <span data-ttu-id="302fb-140">In XAML, <xref:System.ComponentModel.TypeConverter> è la classe base che fornisce il supporto per determinate conversioni da stringa e in stringa.</span><span class="sxs-lookup"><span data-stu-id="302fb-140">For XAML purposes, <xref:System.ComponentModel.TypeConverter> is the base class for providing support for certain to-string and from-string conversions.</span></span> <span data-ttu-id="302fb-141">La conversione da stringa consente l'analisi di un valore dell'attributo di stringa da XAML.</span><span class="sxs-lookup"><span data-stu-id="302fb-141">From-string enables parsing a string attribute value from XAML.</span></span> <span data-ttu-id="302fb-142">La conversione in stringa può permettere l'elaborazione di un valore di runtime di una particolare proprietà dell'oggetto in un attributo in XAML per la serializzazione.</span><span class="sxs-lookup"><span data-stu-id="302fb-142">To-string might enable processing a run-time value of a particular object property back into an attribute in XAML for serialization.</span></span>

<span data-ttu-id="302fb-143"><xref:System.ComponentModel.TypeConverter> definisce quattro membri rilevanti per la conversione da e in stringa per l'elaborazione XAML:</span><span class="sxs-lookup"><span data-stu-id="302fb-143"><xref:System.ComponentModel.TypeConverter> defines four members that are relevant for converting to-string and from-string for XAML processing purposes:</span></span>

- <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A>

- <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A>

- <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>

- <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A>

<span data-ttu-id="302fb-144">Di questi membri, il metodo più importante è <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A>, che converte la stringa di input nel tipo di oggetto richiesto.</span><span class="sxs-lookup"><span data-stu-id="302fb-144">Of these members, the most important method is <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A>, which converts the input string to the required object type.</span></span> <span data-ttu-id="302fb-145">È possibile implementare il metodo <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> per convertire una più vasta gamma di tipi nel tipo di destinazione previsto dal convertitore.</span><span class="sxs-lookup"><span data-stu-id="302fb-145">The <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> method can be implemented to convert a wider range of types into the intended destination type of the converter.</span></span> <span data-ttu-id="302fb-146">Il metodo assolve quindi scopi che si estendono oltre quelli definiti per XAML, ad esempio il supporto delle conversioni in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="302fb-146">Therefore, it can serve purposes that extend beyond XAML, such as supporting run-time conversions.</span></span> <span data-ttu-id="302fb-147">Per quanto riguarda XAML, tuttavia, l'unico elemento importante è il percorso del codice che consente di elaborare un input <xref:System.String> .</span><span class="sxs-lookup"><span data-stu-id="302fb-147">However, for XAML use, only the code path that can process a <xref:System.String> input is important.</span></span>

<span data-ttu-id="302fb-148">Il secondo metodo più <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>importante è .</span><span class="sxs-lookup"><span data-stu-id="302fb-148">The second-most important method is <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>.</span></span> <span data-ttu-id="302fb-149">Se un'applicazione viene convertita in una rappresentazione di markup (ad esempio, se viene salvata in XAML come file), <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> è coinvolta nello scenario più ampio di un writer di testo XAML per produrre una rappresentazione di markup.</span><span class="sxs-lookup"><span data-stu-id="302fb-149">If an application is converted to a markup representation (for example, if it is saved to XAML as a file), <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> is involved in the larger scenario of a XAML text writer to produce a markup representation.</span></span> <span data-ttu-id="302fb-150">In questo caso, il percorso di codice importante per XAML è il passaggio di `destinationType` di <xref:System.String>da parte del chiamante.</span><span class="sxs-lookup"><span data-stu-id="302fb-150">In this case, the important code path for XAML is when the caller passes a `destinationType` of <xref:System.String>.</span></span>

<span data-ttu-id="302fb-151"><xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> e <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> sono metodi di supporto usati quando un servizio esegue una query sulle funzionalità dell'implementazione di <xref:System.ComponentModel.TypeConverter> .</span><span class="sxs-lookup"><span data-stu-id="302fb-151"><xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> and <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> are support methods that are used when a service queries the capabilities of the <xref:System.ComponentModel.TypeConverter> implementation.</span></span> <span data-ttu-id="302fb-152">È necessario implementare questi metodi per restituire `true` per i casi specifici del tipo supportati dai metodi di conversione equivalenti del convertitore.</span><span class="sxs-lookup"><span data-stu-id="302fb-152">You must implement these methods to return `true` for type-specific cases that the equivalent conversion methods of your converter support.</span></span> <span data-ttu-id="302fb-153">Per XAML, si tratta in genere del tipo <xref:System.String> .</span><span class="sxs-lookup"><span data-stu-id="302fb-153">For XAML purposes, this generally means the <xref:System.String> type.</span></span>

### <a name="culture-information-and-type-converters-for-xaml"></a><span data-ttu-id="302fb-154">Informazioni relative alle impostazioni cultura e convertitori di tipi per XAML</span><span class="sxs-lookup"><span data-stu-id="302fb-154">Culture Information and Type Converters for XAML</span></span>

<span data-ttu-id="302fb-155">Ogni implementazione di <xref:System.ComponentModel.TypeConverter> può interpretare in modo univoco il concetto di stringa valida per una conversione e può quindi usare o ignorare la descrizione del tipo passata come parametri.</span><span class="sxs-lookup"><span data-stu-id="302fb-155">Each <xref:System.ComponentModel.TypeConverter> implementation can uniquely interpret what is a valid string for a conversion, and it can also use or ignore the type description that is passed as parameters.</span></span> <span data-ttu-id="302fb-156">Una considerazione importante circa le impostazioni cultura e la conversione di tipi XAML: anche se l'uso di stringhe localizzabili come valori di attributo è supportato da XAML, non è possibile usare queste stringhe come input del convertitore di tipi con requisiti specifici per le impostazioni cultura.</span><span class="sxs-lookup"><span data-stu-id="302fb-156">An important consideration for culture and XAML type conversion is the following: although using localizable strings as attribute values is supported by XAML, you cannot use these localizable strings as type converter input with specific culture requirements.</span></span> <span data-ttu-id="302fb-157">Questa limitazione è dovuta al fatto che i convertitori di tipi per i valori di attributo XAML implicano necessariamente un comportamento di elaborazione XAML basato su un'unica lingua che usa le impostazioni cultura `en-US` .</span><span class="sxs-lookup"><span data-stu-id="302fb-157">This limitation is because type converters for XAML attribute values involve a necessarily fixed-language XAML-processing behavior that uses `en-US` culture.</span></span> <span data-ttu-id="302fb-158">Per ulteriori informazioni sui motivi di progettazione di questa restrizione, vedere la specifica del linguaggio XAML ([\[MS-XAML\]](https://docs.microsoft.com/previous-versions/msp-n-p/ff650760(v=pandp.10))) o Cenni preliminari sulla [globalizzazione e localizzazione WPF](../../framework/wpf/advanced/wpf-globalization-and-localization-overview.md).</span><span class="sxs-lookup"><span data-stu-id="302fb-158">For more information about the design reasons for this restriction, see the XAML language specification ([\[MS-XAML\]](https://docs.microsoft.com/previous-versions/msp-n-p/ff650760(v=pandp.10))) or [WPF Globalization and Localization Overview](../../framework/wpf/advanced/wpf-globalization-and-localization-overview.md).</span></span>

<span data-ttu-id="302fb-159">Un esempio delle problematiche che possono presentarsi con le impostazioni cultura è rappresentato dal separatore decimale per i numeri in formato stringa, che per alcune impostazioni cultura è la virgola anziché il punto.</span><span class="sxs-lookup"><span data-stu-id="302fb-159">As an example where culture can be an issue, some cultures use a comma instead of a period as the decimal point delimiter for numbers in string form.</span></span> <span data-ttu-id="302fb-160">Quest'uso è in conflitto con il comportamento di molti convertitori di tipi esistenti, che prevede l'uso della virgola come delimitatore.</span><span class="sxs-lookup"><span data-stu-id="302fb-160">This use collides with the behavior that many existing type converters have, which is to use a comma as a delimiter.</span></span> <span data-ttu-id="302fb-161">Il passaggio di impostazioni cultura tramite `xml:lang` nel codice XAML adiacente non risolve il problema.</span><span class="sxs-lookup"><span data-stu-id="302fb-161">Passing a culture through `xml:lang` in the surrounding XAML does not solve the issue.</span></span>

### <a name="implementing-convertfrom"></a><span data-ttu-id="302fb-162">Implementazione di ConvertFrom</span><span class="sxs-lookup"><span data-stu-id="302fb-162">Implementing ConvertFrom</span></span>

<span data-ttu-id="302fb-163">Per essere utilizzabile come implementazione di <xref:System.ComponentModel.TypeConverter> che supporti XAML, il metodo <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> per il convertitore deve accettare una stringa come parametro `value` .</span><span class="sxs-lookup"><span data-stu-id="302fb-163">To be usable as a <xref:System.ComponentModel.TypeConverter> implementation that supports XAML, the <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> method for that converter must accept a string as the `value` parameter.</span></span> <span data-ttu-id="302fb-164">Se la stringa ha un formato valido e può essere convertita dall'implementazione di <xref:System.ComponentModel.TypeConverter> , l'oggetto restituito deve supportare un cast nel tipo previsto dalla proprietà.</span><span class="sxs-lookup"><span data-stu-id="302fb-164">If the string is in a valid format and can be converted by the <xref:System.ComponentModel.TypeConverter> implementation, the returned object must support a cast to the type that is expected by the property.</span></span> <span data-ttu-id="302fb-165">In caso contrario, l'implementazione <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> deve restituire `null`.</span><span class="sxs-lookup"><span data-stu-id="302fb-165">Otherwise, the <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> implementation must return `null`.</span></span>

<span data-ttu-id="302fb-166">Ogni implementazione di <xref:System.ComponentModel.TypeConverter> può interpretare in modo univoco il concetto di stringa valida per una conversione e può anche usare o ignorare i contesti di descrizione del tipo o di impostazione cultura passati come parametri.</span><span class="sxs-lookup"><span data-stu-id="302fb-166">Each <xref:System.ComponentModel.TypeConverter> implementation can uniquely interpret what constitutes a valid string for a conversion, and it can also use or ignore the type description or culture contexts that are passed as parameters.</span></span> <span data-ttu-id="302fb-167">Tuttavia, l'elaborazione della sintassi XAML di WPF potrebbe non passare i valori al contesto della descrizione del tipo in tutti i casi e potrebbe perfino non passare le impostazioni cultura basate su `xml:lang`.</span><span class="sxs-lookup"><span data-stu-id="302fb-167">However, the WPF XAML processing might not pass values to the type description context in all cases and also might not pass culture based on `xml:lang`.</span></span>

> [!NOTE]
> <span data-ttu-id="302fb-168">Non utilizzare le parentesi graffe ({}), in particolare la parentesi graffa di apertura , come elemento del formato della stringa.</span><span class="sxs-lookup"><span data-stu-id="302fb-168">Do not use the braces ({}), specifically the opening brace ({), as an element of your string format.</span></span> <span data-ttu-id="302fb-169">Questi caratteri vengono usati esclusivamente come punti di ingresso e di uscita di una sequenza di estensione del markup.</span><span class="sxs-lookup"><span data-stu-id="302fb-169">These characters are reserved as the entry and exit for a markup extension sequence.</span></span>

<span data-ttu-id="302fb-170">È opportuno generare un'eccezione quando il convertitore di tipi deve avere <xref:System.IServiceProvider.GetService%2A> accesso a un servizio XAML dal writer di oggetti dei servizi XAML .NET, ma la chiamata effettuata sul contesto non restituisce tale servizio.</span><span class="sxs-lookup"><span data-stu-id="302fb-170">It is appropriate to throw an exception when your type converter must have access to a XAML service from .NET XAML Services object writer, but the <xref:System.IServiceProvider.GetService%2A> call that is made against the context does not return that service.</span></span>

### <a name="implementing-convertto"></a><span data-ttu-id="302fb-171">Implementazione di ConvertTo</span><span class="sxs-lookup"><span data-stu-id="302fb-171">Implementing ConvertTo</span></span>

<span data-ttu-id="302fb-172"><xref:System.ComponentModel.TypeConverter.ConvertTo%2A> viene potenzialmente usato per il supporto della serializzazione.</span><span class="sxs-lookup"><span data-stu-id="302fb-172"><xref:System.ComponentModel.TypeConverter.ConvertTo%2A> is potentially used for serialization support.</span></span> <span data-ttu-id="302fb-173">Il supporto della serializzazione tramite <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> per il tipo personalizzato e il relativo convertitore di tipi non è un requisito assoluto.</span><span class="sxs-lookup"><span data-stu-id="302fb-173">Serialization support through <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> for your custom type and its type converter is not an absolute requirement.</span></span> <span data-ttu-id="302fb-174">Tuttavia, se si implementa un controllo o si usa la serializzazione come parte delle funzionalità o della progettazione della classe, sarà necessario implementare <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="302fb-174">However, if you are implementing a control, or using serialization of as part of the features or design of your class, you should implement <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>.</span></span>

<span data-ttu-id="302fb-175">Per essere utilizzabile come implementazione di <xref:System.ComponentModel.TypeConverter> che supporti XAML, il metodo <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> per il convertitore deve accettare un'istanza del tipo (o un valore) supportata come parametro `value` .</span><span class="sxs-lookup"><span data-stu-id="302fb-175">To be usable as a <xref:System.ComponentModel.TypeConverter> implementation that supports XAML, the <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> method for that converter must accept an instance of the type (or a value) that is supported as the `value` parameter.</span></span> <span data-ttu-id="302fb-176">Quando il parametro `destinationType` è di tipo <xref:System.String>, deve essere possibile eseguire il cast dell'oggetto restituito come <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="302fb-176">When the `destinationType` parameter is of type <xref:System.String>, the returned object must be able to be cast as <xref:System.String>.</span></span> <span data-ttu-id="302fb-177">La stringa restituita deve rappresentare un valore serializzato di `value`.</span><span class="sxs-lookup"><span data-stu-id="302fb-177">The returned string must represent a serialized value of `value`.</span></span> <span data-ttu-id="302fb-178">In teoria, il formato di serializzazione scelto deve essere in grado di generare lo stesso valore che si otterrebbe se quella stringa venisse passata all'implementazione di <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> dello stesso convertitore, senza perdite significative di informazioni.</span><span class="sxs-lookup"><span data-stu-id="302fb-178">Ideally, the serialization format that you choose should be able to generate the same value as if that string were passed to the <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> implementation of the same converter, without significant loss of information.</span></span>

<span data-ttu-id="302fb-179">Se il valore non può essere serializzato o il convertitore non supporta la serializzazione, l'implementazione di <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> deve restituire `null` e può generare un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="302fb-179">If the value cannot be serialized or the converter does not support serialization, the <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> implementation must return `null` and can throw an exception.</span></span> <span data-ttu-id="302fb-180">Tuttavia, se si generano eccezioni, sarà necessario segnalare l'impossibilità di usare tale conversione nell'implementazione di <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> in modo da supportare un controllo preventivo con <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> , che rappresenta la procedura consigliata per evitare eccezioni.</span><span class="sxs-lookup"><span data-stu-id="302fb-180">However, if you do throw exceptions, you should report the inability to use that conversion as part of your <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> implementation so that the best practice of checking with <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> first to avoid exceptions is supported.</span></span>

<span data-ttu-id="302fb-181">Se il parametro `destinationType` non è di tipo <xref:System.String>, è possibile scegliere la gestione del convertitore.</span><span class="sxs-lookup"><span data-stu-id="302fb-181">If the `destinationType` parameter is not of type <xref:System.String>, you can choose your own converter handling.</span></span> <span data-ttu-id="302fb-182">In genere viene ripristinata la gestione dell'implementazione di base, che nella forma base di <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> genera un'eccezione specifica.</span><span class="sxs-lookup"><span data-stu-id="302fb-182">Typically, you revert to base implementation handling, which in the base <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> raises a specific exception.</span></span>

<span data-ttu-id="302fb-183">È opportuno generare un'eccezione quando il convertitore di tipi deve avere <xref:System.IServiceProvider.GetService%2A> accesso a un servizio XAML dal writer di oggetti dei servizi XAML .NET, ma la chiamata effettuata sul contesto non restituisce tale servizio.</span><span class="sxs-lookup"><span data-stu-id="302fb-183">It is appropriate to throw an exception when your type converter must have access to a XAML service from .NET XAML Services object writer, but the <xref:System.IServiceProvider.GetService%2A> call that is made against the context does not return that service.</span></span>

### <a name="implementing-canconvertfrom"></a><span data-ttu-id="302fb-184">Implementazione di CanConvertFrom</span><span class="sxs-lookup"><span data-stu-id="302fb-184">Implementing CanConvertFrom</span></span>

<span data-ttu-id="302fb-185">L'implementazione di <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> deve restituire `true` per un oggetto `sourceType` di tipo <xref:System.String> ; in caso contrario, deve rinviare all'implementazione di base.</span><span class="sxs-lookup"><span data-stu-id="302fb-185">Your <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> implementation should return `true` for `sourceType` of type <xref:System.String> and otherwise, defer to the base implementation.</span></span> <span data-ttu-id="302fb-186">Non generare eccezioni da <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A>.</span><span class="sxs-lookup"><span data-stu-id="302fb-186">Do not throw exceptions from <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A>.</span></span>

### <a name="implementing-canconvertto"></a><span data-ttu-id="302fb-187">Implementazione di CanConvertTo</span><span class="sxs-lookup"><span data-stu-id="302fb-187">Implementing CanConvertTo</span></span>

<span data-ttu-id="302fb-188">L'implementazione di <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> deve restituire `true` per un oggetto `destinationType` di tipo <xref:System.String>; in caso contrario, deve rinviare all'implementazione di base.</span><span class="sxs-lookup"><span data-stu-id="302fb-188">Your <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> implementation should return `true` for `destinationType` of type <xref:System.String>, and otherwise defer to the base implementation.</span></span> <span data-ttu-id="302fb-189">Non generare eccezioni da <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="302fb-189">Do not throw exceptions from <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A>.</span></span>

## <a name="applying-the-typeconverterattribute"></a><span data-ttu-id="302fb-190">Applicazione di TypeConverterAttribute</span><span class="sxs-lookup"><span data-stu-id="302fb-190">Applying the TypeConverterAttribute</span></span>

<span data-ttu-id="302fb-191">Affinché il convertitore di tipi personalizzato venga utilizzato come convertitore di tipi <xref:System.ComponentModel.TypeConverterAttribute> che agisce per una classe personalizzata dai servizi XAML .NET, è necessario applicare l'oggetto alla definizione della classe.</span><span class="sxs-lookup"><span data-stu-id="302fb-191">For your custom type converter to be used as the acting type converter for a custom class by .NET XAML Services, you must apply the <xref:System.ComponentModel.TypeConverterAttribute> to your class definition.</span></span> <span data-ttu-id="302fb-192">L'oggetto <xref:System.ComponentModel.TypeConverterAttribute.ConverterTypeName%2A> specificato tramite l'attributo deve corrispondere al nome di tipo del convertitore dei tipi personalizzato.</span><span class="sxs-lookup"><span data-stu-id="302fb-192">The <xref:System.ComponentModel.TypeConverterAttribute.ConverterTypeName%2A> that you specify through the attribute must be the type name of your custom type converter.</span></span> <span data-ttu-id="302fb-193">Se si applica questo attributo, quando un processore XAML gestisce valori per cui il tipo di proprietà usa il tipo di classe personalizzato, può immettere stringhe e restituire istanze di oggetti.</span><span class="sxs-lookup"><span data-stu-id="302fb-193">If you apply this attribute, when a XAML processor handles values where the property type uses your custom class type, it can input strings and return object instances.</span></span>

<span data-ttu-id="302fb-194">Si può anche fornire un convertitore dei tipi per le singole proprietà.</span><span class="sxs-lookup"><span data-stu-id="302fb-194">You can also provide a type converter on a per-property basis.</span></span> <span data-ttu-id="302fb-195">Anziché applicare <xref:System.ComponentModel.TypeConverterAttribute> un alla definizione della classe, applicarlo a una `get` / `set` definizione di proprietà (la definizione principale, non le implementazioni al suo interno).</span><span class="sxs-lookup"><span data-stu-id="302fb-195">Instead of applying a <xref:System.ComponentModel.TypeConverterAttribute> to the class definition, apply it to a property definition (the main definition, not the `get`/`set` implementations within it).</span></span> <span data-ttu-id="302fb-196">Il tipo della proprietà deve corrispondere al tipo elaborato dal convertitore dei tipi personalizzato.</span><span class="sxs-lookup"><span data-stu-id="302fb-196">The type of the property must match the type that is processed by your custom type converter.</span></span> <span data-ttu-id="302fb-197">Se questo attributo viene applicato, quando un processore XAML gestisce i valori di quella proprietà, può elaborare stringhe di input e restituire istanze di oggetti.</span><span class="sxs-lookup"><span data-stu-id="302fb-197">With this attribute applied, when a XAML processor handles values of that property, it can process input strings and return object instances.</span></span> <span data-ttu-id="302fb-198">La tecnica del convertitore di tipi per proprietà è utile se si sceglie di utilizzare un tipo di proprietà <xref:System.ComponentModel.TypeConverterAttribute> da Microsoft .NET Framework o da un'altra libreria in cui non è possibile controllare la definizione della classe e non è possibile applicare un tipo.</span><span class="sxs-lookup"><span data-stu-id="302fb-198">The per-property type converter technique is useful if you choose to use a property type from Microsoft .NET Framework or from some other library where you cannot control the class definition and cannot apply a <xref:System.ComponentModel.TypeConverterAttribute> there.</span></span>

<span data-ttu-id="302fb-199">Per fornire un comportamento di conversione di tipi per un membro associato personalizzato, applicare <xref:System.ComponentModel.TypeConverterAttribute> al metodo della funzione di accesso `Get` del modello di implementazione per il membro associato.</span><span class="sxs-lookup"><span data-stu-id="302fb-199">To supply a type conversion behavior for a custom attached member, apply <xref:System.ComponentModel.TypeConverterAttribute> to the `Get` accessor method of the implementation pattern for the attached member.</span></span>

## <a name="accessing-service-provider-context-from-a-markup-extension-implementation"></a><span data-ttu-id="302fb-200">Accesso al contesto del provider di servizi da un'implementazione dell'estensione di markup</span><span class="sxs-lookup"><span data-stu-id="302fb-200">Accessing Service Provider Context from a Markup Extension Implementation</span></span>

<span data-ttu-id="302fb-201">I servizi disponibili sono gli stessi per qualsiasi convertitore di valori.</span><span class="sxs-lookup"><span data-stu-id="302fb-201">The available services are the same for any value converter.</span></span> <span data-ttu-id="302fb-202">L'unica differenza risiede nel modo in cui ogni convertitore di valori riceve il contesto del servizio.</span><span class="sxs-lookup"><span data-stu-id="302fb-202">The difference is in how each value converter receives the service context.</span></span> <span data-ttu-id="302fb-203">L'accesso ai servizi e i servizi disponibili sono illustrati nell'argomento [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="302fb-203">Accessing services and the services available are documented in the topic [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span></span>

## <a name="type-converters-in-the-xaml-node-stream"></a><span data-ttu-id="302fb-204">Convertitori di tipi nel flusso di nodi XAML</span><span class="sxs-lookup"><span data-stu-id="302fb-204">Type Converters in the XAML Node Stream</span></span>

<span data-ttu-id="302fb-205">Se si usa un flusso del nodo XAML, l'azione o il risultato finale di un convertitore di tipi non è ancora eseguito.</span><span class="sxs-lookup"><span data-stu-id="302fb-205">If you are working with a XAML node stream, the action or end result of a type converter is not yet executed.</span></span> <span data-ttu-id="302fb-206">In un percorso di caricamento, la stringa dell'attributo che necessita di una conversione di tipi ai fini del caricamento resta sotto forma di valore testuale all'interno di un membro iniziale e di un membro finale.</span><span class="sxs-lookup"><span data-stu-id="302fb-206">In a load path, the attribute string that eventually needs to be type-converted in order to load remains as a text value within a start member and end member.</span></span> <span data-ttu-id="302fb-207">Il convertitore di tipi eventualmente necessario per questa operazione può essere determinato tramite la proprietà <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="302fb-207">The type converter that is eventually needed for this operation can be determined by using the <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="302fb-208">Tuttavia, per ottenere un valore valido da <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> è necessario avere un contesto dello schema XAML, che può accedere a queste informazioni tramite il membro sottostante, o il tipo del valore dell'oggetto usato dal membro.</span><span class="sxs-lookup"><span data-stu-id="302fb-208">However, obtaining a valid value from <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> relies on having a XAML schema context, which can access such information through the underlying member, or the type of the object value that the member uses.</span></span> <span data-ttu-id="302fb-209">Il richiamo del comportamento di conversione di tipi richiede anche il contesto dello schema XAML poiché ciò richiede il mapping dei tipi e la creazione di un'istanza del convertitore.</span><span class="sxs-lookup"><span data-stu-id="302fb-209">Invoking the type conversion behavior also requires the XAML schema context because that requires type-mapping and creating a converter instance.</span></span>

## <a name="see-also"></a><span data-ttu-id="302fb-210">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="302fb-210">See also</span></span>

- <xref:System.ComponentModel.TypeConverterAttribute>
- [<span data-ttu-id="302fb-211">Convertitori di tipi ed estensioni di markup per XAML</span><span class="sxs-lookup"><span data-stu-id="302fb-211">Type Converters and Markup Extensions for XAML</span></span>](type-converters-and-markup-extensions.md)
- [<span data-ttu-id="302fb-212">Panoramica di XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="302fb-212">XAML Overview (WPF)</span></span>](../fundamentals/xaml.md)
