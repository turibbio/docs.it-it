---
title: Confronto tra schema API Gateway e comunicazione diretta da client a microservizio
description: Informazioni sulle differenze e sugli usi dello schema API Gateway e della comunicazione diretta da client a microservizio.
ms.date: 01/07/2019
ms.openlocfilehash: 089b6302132437e4bb733653b3edb401ff81a164
ms.sourcegitcommit: 5280b2aef60a1ed99002dba44e4b9e7f6c830604
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/03/2020
ms.locfileid: "84306955"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="f7cbf-103">Confronto tra schema API Gateway e comunicazione diretta da client a microservizio</span><span class="sxs-lookup"><span data-stu-id="f7cbf-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="f7cbf-104">In un'architettura di microservizi, ogni microservizio espone in genere un set di endpoint specifici.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="f7cbf-105">Questo può influire sulla comunicazione da client a microservizio, come spiegato in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="f7cbf-106">Comunicazione da client a microservizio diretta</span><span class="sxs-lookup"><span data-stu-id="f7cbf-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="f7cbf-107">Un possibile approccio prevede l'uso di un'architettura di comunicazione da client a microservizio diretta.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="f7cbf-108">In questo caso, un'app client può effettuare richieste direttamente ad alcuni microservizi, come illustrato nella figura 4-12.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagramma che illustra l'architettura di comunicazione da client a microservizio.](./media/direct-client-to-microservice-communication.png)

<span data-ttu-id="f7cbf-110">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-110">**Figure 4-12**.</span></span> <span data-ttu-id="f7cbf-111">Uso di un'architettura di comunicazione da client a microservizio diretta</span><span class="sxs-lookup"><span data-stu-id="f7cbf-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="f7cbf-112">In questo approccio ogni microservizio include un endpoint pubblico, talvolta con una porta TCP diversa per ogni microservizio.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="f7cbf-113">Un esempio di URL per un determinato servizio potrebbe essere l'URL seguente in Azure:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

`http://eshoponcontainers.westus.cloudapp.azure.com:88/`

<span data-ttu-id="f7cbf-114">In un ambiente di produzione basato su un cluster, questo URL esegue il mapping al servizio di bilanciamento del carico usato nel cluster, che a sua volta distribuisce le richieste nei vari microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="f7cbf-115">Negli ambienti di produzione, tra i microservizi e Internet potrebbe esserci un controller per la distribuzione delle applicazioni (ADC, Application Delivery Controller), ad esempio il [gateway applicazione di Azure](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="f7cbf-116">Questo controller funge da livello trasparente ed esegue non solo il bilanciamento del carico, ma anche la terminazione SSL per proteggere i servizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="f7cbf-117">In questo modo, migliora il carico degli host eliminando le operazioni di terminazione SSL che richiedono un utilizzo intensivo della CPU e altre attività di routing al gateway applicazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="f7cbf-118">In ogni caso, dal punto di vista dell'architettura dell'applicazione logica, un servizio di bilanciamento del carico e un controller per la distribuzione delle applicazioni sono trasparenti.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="f7cbf-119">Un'architettura di comunicazione da client a microservizio diretta potrebbe essere sufficiente per un'applicazione basata su microservizi di piccole dimensioni, soprattutto se l'app client è un'applicazione Web sul lato server, ad esempio un'applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="f7cbf-120">Questo approccio, tuttavia, presenta dei problemi quando si compilano applicazioni grandi e complesse basate su microservizi, ad esempio quando si gestiscono decine di tipi di microservizi, e sopratutto quando le app client sono app per dispositivi mobili remote o applicazioni Web SPA.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="f7cbf-121">Quando si sviluppa un'applicazione di grandi dimensioni basata su microservizi, porsi le domande seguenti:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="f7cbf-122">*Come ridurre al minimo il numero di richieste per il back-end e le comunicazioni "frammentate" con più microservizi nelle app client?*</span><span class="sxs-lookup"><span data-stu-id="f7cbf-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="f7cbf-123">L'interazione con più microservizi per compilare una singola schermata dell'interfaccia utente aumenta il numero di round trip in Internet.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="f7cbf-124">In questo modo si aumenta la latenza e la complessità sul lato dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="f7cbf-125">In teoria, le risposte dovrebbero essere aggregate in modo efficiente sul lato server.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="f7cbf-126">Ciò consente di ridurre la latenza, perché vengono restituiti più blocchi di dati in parallelo e alcune interfacce utente possono visualizzare i dati non appena vengono resi disponibili.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="f7cbf-127">*Come si gestiscono i problemi trasversali, ad esempio le autorizzazioni, le trasformazioni dei dati e l'invio di richieste dinamiche?*</span><span class="sxs-lookup"><span data-stu-id="f7cbf-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="f7cbf-128">L'implementazione di soluzioni per la sicurezza e il montaggio incrociato, ad esempio la sicurezza e le autorizzazioni in ogni microservizio, possono richiedere un notevole impegno in termini di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="f7cbf-129">Un possibile approccio prevede di inserire questi servizi all'interno dell'host Docker o di un cluster interno, in modo da limitare l'accesso diretto dall'esterno e di implementare queste soluzioni di montaggio incrociato in una posizione centralizzata, ad esempio un gateway API.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="f7cbf-130">*In che modo le app client possono comunicare con i servizi che usano protocolli non adatti a Internet?*</span><span class="sxs-lookup"><span data-stu-id="f7cbf-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="f7cbf-131">In genere i protocolli usati sul lato server, ad esempio AMQP o i protocolli binari, non sono supportati nelle app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="f7cbf-132">Quindi, le richieste devono essere eseguite con protocolli come HTTP/HTTPS e trasferite in un secondo momento in altri protocolli.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="f7cbf-133">Un approccio *man-in-the-middle* può risultare utile per questa situazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="f7cbf-134">*Come modellare una facciata progettata specificamente per le app per dispositivi mobili?*</span><span class="sxs-lookup"><span data-stu-id="f7cbf-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="f7cbf-135">L'API di più microservizi potrebbe non essere progettata adeguatamente per le esigenze delle diverse applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="f7cbf-136">Ad esempio, le esigenze di un'app per dispositivi mobili potrebbero essere diverse rispetto a quelle di un'app Web.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="f7cbf-137">Per le app per dispositivi mobili potrebbe essere necessario un livello ancora maggiore di ottimizzazione per rendere più efficienti le risposte dei dati.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="f7cbf-138">Per farlo è possibile aggregare i dati di più microservizi e restituire un singolo set di dati, talvolta eliminando tutti i dati nella risposta non necessari per l'app per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="f7cbf-139">E, naturalmente, si possono comprimere i dati.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="f7cbf-140">Anche in questo scenario può risultare utile inserire una facciata o un'API tra l'app per dispositivi mobili e i microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="f7cbf-141">Perché prendere in considerazione i gateway API invece della comunicazione da client a microservizio diretta</span><span class="sxs-lookup"><span data-stu-id="f7cbf-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="f7cbf-142">In un'architettura di microservizi le app client necessitano in genere di utilizzare le funzionalità di più microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="f7cbf-143">Se questo utilizzo viene eseguito direttamente, il client deve gestire più chiamate agli endpoint dei microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="f7cbf-144">Cosa accade quando l'applicazione si evolve e vengono introdotti nuovi microservizi oppure quelli esistenti vengono aggiornati?</span><span class="sxs-lookup"><span data-stu-id="f7cbf-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="f7cbf-145">Se l'applicazione ha molti microservizi, la gestione di un numero elevato di endpoint dalle app client può essere molto difficoltosa.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="f7cbf-146">Dal momento che l'app client viene associata a questi endpoint interni, l'evoluzione dei microservizi in futuro potrebbe comportare un impatto elevato per le app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="f7cbf-147">Pertanto, può essere molto comodo per le applicazioni basate su microservizi disporre di un livello intermedio di riferimento indiretto (gateway).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="f7cbf-148">Se non si dispone di gateway API, le app client devono inviare le richieste direttamente ai microservizi e ciò può creare problemi, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="f7cbf-149">**Accoppiamento**: senza lo schema API Gateway, le app client sono associate ai microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="f7cbf-150">Le app client devono sapere in che modo le diverse aree dell'applicazione vengono scomposte in microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="f7cbf-151">Quando si evolvono e si effettua il refactoring dei microservizi interni, tali azioni incidono sulla manutenzione perché causano modifiche di rilievo alle app client a causa del riferimento diretto ai microservizi interni dalle app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-151">When evolving and refactoring the internal microservices, those actions impact maintenance because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="f7cbf-152">Le app client devono essere aggiornate frequentemente, rendendo più difficile sviluppare la soluzione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="f7cbf-153">**Troppi round trip**: una singola pagina/schermata nell'app client potrebbe richiedere diverse chiamate a più servizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="f7cbf-154">Questo può determinare più round trip in rete tra il client e il server e causare così una latenza significativa.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="f7cbf-155">Con l'aggregazione gestita in un livello intermedio è stato possibile migliorare le prestazioni e l'esperienza utente per l'app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="f7cbf-156">**Problemi di sicurezza**: senza un gateway, tutti i microservizi devono essere esposti all'esterno, rendendo più ampia la superficie di attacco rispetto a quando si nascondono i microservizi interni non usati direttamente dalle app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="f7cbf-157">Minore è la superficie di attacco, maggiore è la sicurezza dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="f7cbf-158">**Problematiche trasversali**: ogni microservizio pubblicato pubblicamente deve gestire problemi quali l'autorizzazione e SSL.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization and SSL.</span></span> <span data-ttu-id="f7cbf-159">In molti casi questi problemi possono essere gestiti in un livello singolo così che i microservizi interni risultino semplificati.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-159">In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="f7cbf-160">Definizione dello schema API Gateway</span><span class="sxs-lookup"><span data-stu-id="f7cbf-160">What is the API Gateway pattern?</span></span>

<span data-ttu-id="f7cbf-161">Quando si progettano e si compilano applicazioni grandi e complesse basate su microservizi con più app client, si può prendere in considerazione l'uso di un [gateway API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-161">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="f7cbf-162">Si tratta di un servizio che fornisce un singolo punto di ingresso per alcuni gruppi di microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-162">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="f7cbf-163">È simile allo [schema Facade](https://en.wikipedia.org/wiki/Facade_pattern) della progettazione orientata a oggetti, ma in questo caso fa parte di un sistema distribuito.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-163">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="f7cbf-164">Il modello di gateway API è anche noto come "backend per front-end" ([BFF](https://samnewman.io/patterns/architectural/bff/)), perché viene compilato pensando alle esigenze dell'app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-164">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="f7cbf-165">Pertanto, il gateway API si trova tra le app client e i microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-165">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="f7cbf-166">e funge da proxy inverso, indirizzando le richieste dai client ai servizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-166">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="f7cbf-167">Può inoltre fornire altre funzionalità a montaggio incrociato, come autenticazione, terminazione SSL e cache.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-167">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="f7cbf-168">La figura 4-13 mostra in che modo un gateway API personalizzato può essere inserito in un'architettura basata su microservizi semplificata, con pochi microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-168">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagramma che mostra un gateway API implementato come servizio personalizzato.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/custom-service-api-gateway.png)

<span data-ttu-id="f7cbf-170">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-170">**Figure 4-13**.</span></span> <span data-ttu-id="f7cbf-171">Uso di un gateway API implementato come servizio personalizzato</span><span class="sxs-lookup"><span data-stu-id="f7cbf-171">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="f7cbf-172">Le app si connettono a un singolo endpoint, il gateway API, configurato per l'invio di richieste a singoli microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-172">Apps connect to a single endpoint, the API Gateway, that's configured to forward requests to individual microservices.</span></span> <span data-ttu-id="f7cbf-173">In questo esempio il gateway API viene implementato sotto forma di servizio WebHost ASP.NET Core personalizzato eseguito come contenitore.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-173">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="f7cbf-174">È importante evidenziare che nel diagramma viene usato un solo servizio gateway API personalizzato per numerose app client di diverso tipo.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-174">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="f7cbf-175">Ciò può presentare dei rischi significativi perché il servizio API Gateway verrà ampliato e sviluppato in base alle diverse esigenze delle app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-175">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="f7cbf-176">Alla fine, il problema si verificherà a causa di queste diverse esigenze e in effetti potrebbe essere simile a un'applicazione monolitica o a un servizio monolitico.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-176">Eventually, it will be bloated because of those different needs and effectively it could be similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="f7cbf-177">Ecco perché si consiglia vivamente di suddividere il gateway API in più servizi o in gateway API più piccoli, ad esempio uno per ogni tipo fattore di forma di app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-177">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="f7cbf-178">È necessario prestare attenzione quando si implementa lo schema API Gateway.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-178">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="f7cbf-179">Di solito non è consigliabile lasciare che un singolo gateway API aggreghi tutti i microservizi interni dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-179">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="f7cbf-180">Se accade, funge da aggregatore monolitico o da agente di orchestrazione e viola l'autonomia del microservizio accoppiando tutti i microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-180">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="f7cbf-181">Di conseguenza, i gateway API devono essere separati in base ai limiti aziendali e alle app client e non fungere da aggregatore singolo per tutti i microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-181">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="f7cbf-182">Quando si divide il livello API Gateway in più gateway API, se l'applicazione ha più app client può costituire un elemento pivot primario per l'identificazione dei diversi tipi di gateway API, in modo da avere una facciata differente per le esigenze di ciascuna app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-182">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="f7cbf-183">Questo caso è uno schema denominato "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)), in cui ogni gateway API può fornire un'API specifica per ogni tipo di app client, eventualmente anche in base al fattore di forma del client, implementando un codice dell'adattatore specifico che chiama più microservizi interni, come illustrato nell'immagine seguente:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-183">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagramma che Mostra più gateway API personalizzati.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/multiple-custom-api-gateways.png)

<span data-ttu-id="f7cbf-185">**Figura 4-13.1**.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-185">**Figure 4-13.1**.</span></span> <span data-ttu-id="f7cbf-186">Uso di più gateway API personalizzati</span><span class="sxs-lookup"><span data-stu-id="f7cbf-186">Using multiple custom API Gateways</span></span>

<span data-ttu-id="f7cbf-187">Figura 4-13.1 Mostra i gateway API che sono separati dal tipo di client; uno per i client per dispositivi mobili e uno per i client Web.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-187">Figure 4-13.1 shows API Gateways that are segregated by client type; one for mobile clients and one for web clients.</span></span> <span data-ttu-id="f7cbf-188">Un'app Web tradizionale si connette a un microservizio MVC che usa gateway API Web.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-188">A traditional web app connects to an MVC microservice that uses the web API Gateway.</span></span> <span data-ttu-id="f7cbf-189">Nell'esempio viene illustrata un'architettura semplificata con più gateway API con granularità fine.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-189">The example depicts a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="f7cbf-190">In questo caso i limiti identificati per ogni gateway API si basano esclusivamente sullo schema "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)), pertanto sono basati solo sull'API necessaria per ciascuna app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-190">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="f7cbf-191">Ma in applicazioni di dimensioni più elevate è anche opportuno andare avanti e creare altri gateway API basati sui limiti aziendali come secondo elemento pivot di progettazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-191">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="f7cbf-192">Funzionalità principali dello schema API Gateway</span><span class="sxs-lookup"><span data-stu-id="f7cbf-192">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="f7cbf-193">Lo schema API Gateway può offrire più funzionalità.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-193">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="f7cbf-194">A seconda del prodotto, le funzionalità possono essere più o meno avanzate, tuttavia quelle più importanti e fondamentali per qualsiasi gateway API sono gli schemi progettuali seguenti:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-194">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="f7cbf-195">**Proxy inverso o routing del gateway.**</span><span class="sxs-lookup"><span data-stu-id="f7cbf-195">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="f7cbf-196">Lo schema API Gateway offre un proxy inverso per reindirizzare o instradare le richieste (routing di livello 7, in genere richieste HTTP) agli endpoint dei microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-196">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="f7cbf-197">Il gateway fornisce un singolo endpoint o URL per le app client e quindi associa internamente le richieste a un gruppo di microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-197">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="f7cbf-198">Questa funzionalità di routing consente di separare le app client dai microservizi, ma è anche utile quando si modernizza un'API monolitica posizionando il gateway API tra l'API monolitica e le app client, è possibile aggiungere nuove API come nuovi microservizi continuando comunque a usare l'API monolitica legacy fino a quando non sarà suddiviso in molti microservizi in futuro.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-198">This routing feature helps to decouple the client apps from the microservices but it's also convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="f7cbf-199">A causa del gateway API, le app client non rilevano se le API in uso sono implementate come microservizi interni o come un'API monolitica e, cosa ancora più importante, quando si sviluppa e si effettua il refactoring dell'API monolitica in microservizi, grazie al routing del gateway API le app client non sono interessate da eventuali modifiche a livello di URI.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-199">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="f7cbf-200">Per altre informazioni, vedere [Modello di routing gateway](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-200">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="f7cbf-201">**Aggregazione di richieste.**</span><span class="sxs-lookup"><span data-stu-id="f7cbf-201">**Requests aggregation.**</span></span> <span data-ttu-id="f7cbf-202">Nell'ambito dello schema del gateway è possibile aggregare più richieste client (in genere richieste HTTP) destinate a più microservizi interni in una singola richiesta client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-202">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="f7cbf-203">Questo schema è particolarmente utile quando una pagina/schermata del client necessita di informazioni da svariati microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-203">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="f7cbf-204">Con questo approccio, l'app client invia una singola richiesta al gateway API che invia diverse richieste ai microservizi interni, per poi aggregare i risultati e inviare nuovamente tutti i dati all'app client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-204">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="f7cbf-205">Il principale vantaggio e lo scopo di questo schema progettuale è quello di ridurre i chattiness tra le app client e l'API back-end, che è particolarmente importante per le app Remote fuori dal Data Center in cui si trovano i microservizi, come le app per dispositivi mobili o le richieste provenienti da app SPA che provengono da JavaScript nei browser remoti del client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-205">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from JavaScript in client remote browsers.</span></span> <span data-ttu-id="f7cbf-206">Per le app Web regolari che eseguono le richieste nell'ambiente server (come un'app Web ASP.NET Core MVC), questo schema non è così importante dal momento che la latenza è molto inferiore rispetto a quella per le app client remote.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-206">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="f7cbf-207">A seconda del gateway API in uso, potrebbe essere possibile eseguire questa aggregazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-207">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="f7cbf-208">Tuttavia in molti casi risulta più flessibile creare microservizi di aggregazione nell'ambito del gateway API, definendo l'aggregazione nel codice (vale a dire nel codice C#):</span><span class="sxs-lookup"><span data-stu-id="f7cbf-208">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="f7cbf-209">Per altre informazioni, vedere [Modello di aggregazione gateway](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-209">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="f7cbf-210">**Problemi trasversali o offload del gateway.**</span><span class="sxs-lookup"><span data-stu-id="f7cbf-210">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="f7cbf-211">A seconda delle funzionalità offerte da ogni gateway API, è possibile eseguire l'offload delle funzionalità dai singoli microservizi al gateway, semplificando l'implementazione di ogni microservizio attraverso il consolidamento dei problemi trasversali in un livello.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-211">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="f7cbf-212">Ciò è particolarmente utile per le funzionalità specializzate che possono essere complesse da implementare correttamente in ogni microservizio interno, ad esempio le funzionalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-212">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="f7cbf-213">Autenticazione e autorizzazione</span><span class="sxs-lookup"><span data-stu-id="f7cbf-213">Authentication and authorization</span></span>
- <span data-ttu-id="f7cbf-214">Integrazione dell'individuazione dei servizi</span><span class="sxs-lookup"><span data-stu-id="f7cbf-214">Service discovery integration</span></span>
- <span data-ttu-id="f7cbf-215">Memorizzazione nella cache delle risposte</span><span class="sxs-lookup"><span data-stu-id="f7cbf-215">Response caching</span></span>
- <span data-ttu-id="f7cbf-216">Criteri per i tentativi, interruttore di circuito e QoS</span><span class="sxs-lookup"><span data-stu-id="f7cbf-216">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="f7cbf-217">Limiti di velocità e limitazione delle richieste</span><span class="sxs-lookup"><span data-stu-id="f7cbf-217">Rate limiting and throttling</span></span>
- <span data-ttu-id="f7cbf-218">Bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="f7cbf-218">Load balancing</span></span>
- <span data-ttu-id="f7cbf-219">Registrazione, analisi, correlazione</span><span class="sxs-lookup"><span data-stu-id="f7cbf-219">Logging, tracing, correlation</span></span>
- <span data-ttu-id="f7cbf-220">Intestazioni, stringhe di query e trasformazione delle attestazioni</span><span class="sxs-lookup"><span data-stu-id="f7cbf-220">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="f7cbf-221">Inserimento nell'elenco di IP consentiti</span><span class="sxs-lookup"><span data-stu-id="f7cbf-221">IP whitelisting</span></span>

<span data-ttu-id="f7cbf-222">Per altre informazioni, vedere [Modello di offload gateway](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-222">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="f7cbf-223">Uso di prodotti con funzionalità di gateway API</span><span class="sxs-lookup"><span data-stu-id="f7cbf-223">Using products with API Gateway features</span></span>

<span data-ttu-id="f7cbf-224">Possono esserci molti altri problemi trasversali generati dai gateway API a seconda dell'implementazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-224">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="f7cbf-225">Di seguito verranno esaminati:</span><span class="sxs-lookup"><span data-stu-id="f7cbf-225">We'll explore here:</span></span>

- [<span data-ttu-id="f7cbf-226">Gestione API di Azure</span><span class="sxs-lookup"><span data-stu-id="f7cbf-226">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="f7cbf-227">Ocelot</span><span class="sxs-lookup"><span data-stu-id="f7cbf-227">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="f7cbf-228">Gestione API di Azure</span><span class="sxs-lookup"><span data-stu-id="f7cbf-228">Azure API Management</span></span>

<span data-ttu-id="f7cbf-229">[Gestione API di Azure](https://azure.microsoft.com/services/api-management/) (come illustrato nella figura 4-14) consente di risolvere le esigenze del gateway API e fornisce anche funzionalità come la raccolta di informazioni dalle API.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="f7cbf-230">Se si usa una soluzione per la gestione delle API, un gateway API è solo un componente della soluzione completa.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-230">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Diagramma che illustra come usare gestione API di Azure come gateway API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/api-gateway-azure-api-management.png)

<span data-ttu-id="f7cbf-232">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-232">**Figure 4-14**.</span></span> <span data-ttu-id="f7cbf-233">Utilizzo di Gestione API di Azure per il gateway API</span><span class="sxs-lookup"><span data-stu-id="f7cbf-233">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="f7cbf-234">Gestione API di Azure risolve sia il gateway API sia le esigenze di gestione, ad esempio registrazione, sicurezza, misurazione e così via. In questo caso, quando si usa un prodotto come gestione API di Azure, il fatto che si disponga di un singolo gateway API non è così rischioso perché questi tipi di gateway API sono "più sottili", vale a dire che non si implementa codice C# personalizzato che può evolversi verso un componente monolitico.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-234">Azure API Management solves both your API Gateway and Management needs like logging, security, metering, etc. In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="f7cbf-235">I gateway API fungono in genere da proxy inverso per le comunicazioni in ingresso, in cui è possibile anche filtrare le API dai microservizi interni e applicare l'autorizzazione alle API pubblicate in questo livello singolo.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-235">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="f7cbf-236">Le informazioni disponibili nel sistema di gestione API aiutano a capire le modalità di utilizzo e le prestazioni delle API.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-236">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="f7cbf-237">Questi dati vengono visualizzati in report di analisi quasi in tempo reale e codificati grazie all'identificazione di tendenze che potrebbero avere un impatto aziendale.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-237">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="f7cbf-238">Inoltre, possono essere forniti log sulle attività di richiesta e risposta che permettono ulteriori analisi online e offline.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-238">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="f7cbf-239">Con Gestione API di Azure è possibile proteggere le API usando una chiave, un token e il filtro IP.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-239">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="f7cbf-240">Queste funzionalità consentono di applicare limiti di velocità e quote flessibili e specifiche, modificare la forma e il comportamento delle API usando i criteri e migliorare le prestazioni con la memorizzazione nella cache delle risposte.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-240">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="f7cbf-241">In questa guida e nell'applicazione di esempio di riferimento (eShopOnContainers), l'architettura è una semplice architettura in contenitori personalizzata che consente di concentrarsi sui contenitori normali senza usare prodotti PaaS come Gestione API di Azure.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-241">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="f7cbf-242">Per le applicazioni di grandi dimensioni basate su microservizi distribuite in Microsoft Azure, invece, si consiglia di valutare Gestione API di Azure come base per i gateway API in produzione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-242">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="f7cbf-243">Ocelot</span><span class="sxs-lookup"><span data-stu-id="f7cbf-243">Ocelot</span></span>

<span data-ttu-id="f7cbf-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) è un gateway API leggero, consigliato per gli approcci più semplici.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="f7cbf-245">Ocelot è un gateway API Open source basato su .NET Core, appositamente creato per le architetture di microservizi che necessitano di punti di ingresso unificati nei rispettivi sistemi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-245">Ocelot is an Open Source .NET Core-based API Gateway especially made for microservices architectures that need unified points of entry into their systems.</span></span> <span data-ttu-id="f7cbf-246">Si tratta di un servizio leggero, veloce e scalabile che offre routing e autenticazione tra molte altre funzionalità.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-246">It's lightweight, fast, and scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="f7cbf-247">Il motivo principale per cui si sceglie Ocelot per l' [applicazione di riferimento eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers) è che Ocelot è un gateway API Lightweight .NET Core che è possibile distribuire nello stesso ambiente di distribuzione dell'applicazione in cui si distribuiscono i microservizi/contenitori, ad esempio un host Docker, Kubernetes e così via. Poiché è basato su .NET Core, è multipiattaforma che ti permette di eseguire la distribuzione in Linux o Windows.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-247">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="f7cbf-248">I diagrammi precedenti dei gateway API personalizzati in esecuzione nei contenitori rappresentano esattamente come è possibile eseguire anche Ocelot in un contenitore e in un'applicazione basata su microservizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-248">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="f7cbf-249">Esistono anche molti altri prodotti sul mercato che offrono funzionalità di gateway API, ad esempio Apigee, Kong, MuleSoft, WSO2, e altri prodotti come Linkerd e Istio per funzionalità di controller in ingresso per il mesh dei servizi.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-249">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="f7cbf-250">Dopo le sezioni iniziali di spiegazione degli schemi e dell'architettura, le sezioni successive illustrano come implementare gateway API con [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="f7cbf-250">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="f7cbf-251">Svantaggi dello schema API Gateway</span><span class="sxs-lookup"><span data-stu-id="f7cbf-251">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="f7cbf-252">Lo svantaggio più importante consiste nel fatto che, quando si implementa un gateway API, tale livello viene accoppiato con i microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-252">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="f7cbf-253">Un accoppiamento di questo tipo potrebbe causare gravi difficoltà per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-253">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="f7cbf-254">Clemens Vaster, architetto del team del bus di servizio di Azure, chiama questa difficoltà potenziale "il nuovo ESB" nella sessione sulla [messaggistica e i microservizi](https://www.youtube.com/watch?v=rXi5CLjIQ9k) di GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-254">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="f7cbf-255">Usando un gateway API per i microservizi, si crea un altro possibile singolo punto di guasto.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-255">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="f7cbf-256">Un gateway API può aumentare il tempo di risposta a causa della chiamata di rete aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-256">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="f7cbf-257">Tuttavia il ritardo dovuto a questa chiamata è di solito minore del tempo perso in comunicazioni frammentate da un'interfaccia client che chiama direttamente i microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-257">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="f7cbf-258">Se la scalabilità orizzontale non viene eseguita correttamente, il gateway API può diventare un collo di bottiglia.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-258">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="f7cbf-259">Un gateway API richiede un costo di sviluppo aggiuntivo e ulteriori operazioni di manutenzione future se include la logica personalizzata e l'aggregazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-259">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="f7cbf-260">Gli sviluppatori devono aggiornare il gateway API per esporre gli endpoint di ogni microservizio.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-260">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="f7cbf-261">Inoltre, le modifiche di implementazione nei microservizi interni potrebbero causare modifiche al codice al livello del gateway API.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-261">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="f7cbf-262">Tuttavia, se il gateway API viene usato semplicemente per le attività di sicurezza, registrazione e controllo delle versioni, come avviene con Gestione API di Azure, il costo di sviluppo aggiuntivo potrebbe non essere applicato.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-262">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="f7cbf-263">Se il gateway API viene sviluppato da un singolo team, potrebbe verificarsi un collo di bottiglia nello sviluppo.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-263">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="f7cbf-264">Ecco un altro motivo per cui è preferibile avere più gateway API specifici che rispondono alle diverse esigenze dei client.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-264">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="f7cbf-265">È anche possibile suddividere internamente il gateway API in più aree o livelli di proprietà dei diversi team che lavorano sui microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="f7cbf-265">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f7cbf-266">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="f7cbf-266">Additional resources</span></span>

- <span data-ttu-id="f7cbf-267">**Chris Richardson. Modello: gateway API/backend per front-end** </span><span class="sxs-lookup"><span data-stu-id="f7cbf-267">**Chris Richardson. Pattern: API Gateway / Backend for Front-End** </span></span>\
  <https://microservices.io/patterns/apigateway.html>

- <span data-ttu-id="f7cbf-268">**Modello del gateway API** </span><span class="sxs-lookup"><span data-stu-id="f7cbf-268">**API Gateway pattern** </span></span>\
  <https://docs.microsoft.com/azure/architecture/microservices/gateway>

- <span data-ttu-id="f7cbf-269">**Modello di aggregazione e composizione** </span><span class="sxs-lookup"><span data-stu-id="f7cbf-269">**Aggregation and composition pattern** </span></span>\
  <https://microservices.io/patterns/data/api-composition.html>

- <span data-ttu-id="f7cbf-270">**Gestione API di Azure** </span><span class="sxs-lookup"><span data-stu-id="f7cbf-270">**Azure API Management** </span></span>\
  <https://azure.microsoft.com/services/api-management/>

- <span data-ttu-id="f7cbf-271">**UDI. Composizione orientata ai servizi** </span><span class="sxs-lookup"><span data-stu-id="f7cbf-271">**Udi Dahan. Service Oriented Composition** </span></span>\
  <https://udidahan.com/2014/07/30/service-oriented-composition-with-video/>

- <span data-ttu-id="f7cbf-272">**Clemens più grande. Messaggistica e microservizi in GOTO 2016 (video)** </span><span class="sxs-lookup"><span data-stu-id="f7cbf-272">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** </span></span>\
  <https://www.youtube.com/watch?v=rXi5CLjIQ9k>

- <span data-ttu-id="f7cbf-273">**Gateway API in breve** (ASP.NET Core serie di esercitazioni sul gateway API) </span><span class="sxs-lookup"><span data-stu-id="f7cbf-273">**API Gateway in a Nutshell** (ASP.NET Core API Gateway Tutorial Series) </span></span>\
  <https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html>

>[!div class="step-by-step"]
><span data-ttu-id="f7cbf-274">[Precedente](identify-microservice-domain-model-boundaries.md) 
> [Avanti](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="f7cbf-274">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
