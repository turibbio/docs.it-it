---
title: Gestione degli errori parziali
description: Informazioni su come gestire correttamente gli errori parziali. Un microservizio potrebbe non essere completamente funzionale, ma essere comunque in grado di eseguire operazioni utili.
ms.date: 10/16/2018
ms.openlocfilehash: 0300719360e1a2500db0af8454c91fdfe2e5b09b
ms.sourcegitcommit: e3cbf26d67f7e9286c7108a2752804050762d02d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/09/2020
ms.locfileid: "80988870"
---
# <a name="handle-partial-failure"></a><span data-ttu-id="58be9-104">Gestire gli errori parziali</span><span class="sxs-lookup"><span data-stu-id="58be9-104">Handle partial failure</span></span>

<span data-ttu-id="58be9-105">Nei sistemi distribuiti, come le applicazioni basate su microservizi, esiste sempre un rischio di errori parziali.</span><span class="sxs-lookup"><span data-stu-id="58be9-105">In distributed systems like microservices-based applications, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="58be9-106">Ad esempio, può verificarsi un errore in un singolo microservizio/contenitore oppure questo potrebbe non essere disponibile per rispondere per un breve periodo di tempo oppure può verificarsi un arresto anomalo di una macchina virtuale o di un server.</span><span class="sxs-lookup"><span data-stu-id="58be9-106">For instance, a single microservice/container can fail or might not be available to respond for a short time, or a single VM or server can crash.</span></span> <span data-ttu-id="58be9-107">Poiché i client e i servizi sono processi separati, un servizio potrebbe non essere in grado di rispondere in modo tempestivo alla richiesta di un client.</span><span class="sxs-lookup"><span data-stu-id="58be9-107">Since clients and services are separate processes, a service might not be able to respond in a timely way to a client's request.</span></span> <span data-ttu-id="58be9-108">Il servizio potrebbe essere sovraccarico e rispondere molto lentamente alle richieste oppure potrebbe semplicemente non essere accessibile per un breve periodo di tempo a causa di problemi di rete.</span><span class="sxs-lookup"><span data-stu-id="58be9-108">The service might be overloaded and responding very slowly to requests or might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="58be9-109">Si consideri ad esempio la pagina dei dettagli dell'ordine dell'applicazione di esempio eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="58be9-109">For example, consider the Order details page from the eShopOnContainers sample application.</span></span> <span data-ttu-id="58be9-110">Se il microservizio degli ordini non risponde quando l'utente tenta di inviare un ordine, un'implementazione non corretta del processo client (l'applicazione Web MVC), se ad esempio il codice client usasse RPC sincrone senza timeout, bloccherebbe i thread a tempo indefinito in attesa di una risposta.</span><span class="sxs-lookup"><span data-stu-id="58be9-110">If the ordering microservice is unresponsive when the user tries to submit an order, a bad implementation of the client process (the MVC web application)—for example, if the client code were to use synchronous RPCs with no timeout—would block threads indefinitely waiting for a response.</span></span> <span data-ttu-id="58be9-111">Oltre a creare un'esperienza utente non corretta, ogni attesa senza risposta usa o blocca un thread e i thread sono estremamente preziosi nelle applicazioni a scalabilità elevata.</span><span class="sxs-lookup"><span data-stu-id="58be9-111">Besides creating a bad user experience, every unresponsive wait consumes or blocks a thread, and threads are extremely valuable in highly scalable applications.</span></span> <span data-ttu-id="58be9-112">Se sono presenti molti thread bloccati, il runtime dell'applicazione può esaurire i thread.</span><span class="sxs-lookup"><span data-stu-id="58be9-112">If there are many blocked threads, eventually the application's runtime can run out of threads.</span></span> <span data-ttu-id="58be9-113">In questo caso l'applicazione potrebbe non rispondere a livello globale anziché solo parzialmente, come illustrato nella figura 8-1.</span><span class="sxs-lookup"><span data-stu-id="58be9-113">In that case, the application can become globally unresponsive instead of just partially unresponsive, as shown in Figure 8-1.</span></span>

![Diagramma che mostra gli errori parziali.](./media/handle-partial-failure/partial-failures-diagram.png)

<span data-ttu-id="58be9-115">**Figura 8-1**.</span><span class="sxs-lookup"><span data-stu-id="58be9-115">**Figure 8-1**.</span></span> <span data-ttu-id="58be9-116">Errori parziali dovuti a dipendenze che influiscono sulla disponibilità dei thread del servizio</span><span class="sxs-lookup"><span data-stu-id="58be9-116">Partial failures because of dependencies that impact service thread availability</span></span>

<span data-ttu-id="58be9-117">In applicazioni basate su microservizi di grandi dimensioni, ogni errore parziale può risultare amplificato, in particolare se la maggior parte dell'interazione tra i microservizi interni è basata su chiamate HTTP sincrone (scenario definito come antipattern).</span><span class="sxs-lookup"><span data-stu-id="58be9-117">In a large microservices-based application, any partial failure can be amplified, especially if most of the internal microservices interaction is based on synchronous HTTP calls (which is considered an anti-pattern).</span></span> <span data-ttu-id="58be9-118">Si pensi a un sistema che riceve milioni di chiamate in ingresso al giorno.</span><span class="sxs-lookup"><span data-stu-id="58be9-118">Think about a system that receives millions of incoming calls per day.</span></span> <span data-ttu-id="58be9-119">Se il sistema ha una progettazione errata basata su lunghe catene di chiamate HTTP sincrone, queste chiamate in ingresso potrebbero comportare molti più milioni di chiamate in uscita (supponiamo un rapporto di 1:4) a decine di microservizi interni come dipendenze sincrone.</span><span class="sxs-lookup"><span data-stu-id="58be9-119">If your system has a bad design that's based on long chains of synchronous HTTP calls, these incoming calls might result in many more millions of outgoing calls (let's suppose a ratio of 1:4) to dozens of internal microservices as synchronous dependencies.</span></span> <span data-ttu-id="58be9-120">Questa situazione è illustrata nella figura \#8-2, in particolare la dipendenza 3, che avvia una catena, chiamando le dipendenze #4.</span><span class="sxs-lookup"><span data-stu-id="58be9-120">This situation is shown in Figure 8-2, especially dependency \#3, that starts a chain, calling dependency #4.</span></span> <span data-ttu-id="58be9-121">chiamate #5.</span><span class="sxs-lookup"><span data-stu-id="58be9-121">which the calls #5.</span></span>

![Diagramma che mostra più dipendenze distribuite.](./media/handle-partial-failure/multiple-distributed-dependencies.png)

<span data-ttu-id="58be9-123">**Figura 8-2**.</span><span class="sxs-lookup"><span data-stu-id="58be9-123">**Figure 8-2**.</span></span> <span data-ttu-id="58be9-124">L'impatto di una progettazione non corretta che prevede lunghe catene di richieste HTTP</span><span class="sxs-lookup"><span data-stu-id="58be9-124">The impact of having an incorrect design featuring long chains of HTTP requests</span></span>

<span data-ttu-id="58be9-125">L'errore intermittente è garantito in un sistema distribuito basato sul cloud, anche se ogni dipendenza presenta una disponibilità eccellente.</span><span class="sxs-lookup"><span data-stu-id="58be9-125">Intermittent failure is guaranteed in a distributed and cloud-based system, even if every dependency itself has excellent availability.</span></span> <span data-ttu-id="58be9-126">Questo è un aspetto da prendere in considerazione.</span><span class="sxs-lookup"><span data-stu-id="58be9-126">It's a fact you need to consider.</span></span>

<span data-ttu-id="58be9-127">Se non si progettano e implementano tecniche in grado di garantire la tolleranza di errore, anche brevi periodi di inattività possono risultare amplificati.</span><span class="sxs-lookup"><span data-stu-id="58be9-127">If you do not design and implement techniques to ensure fault tolerance, even small downtimes can be amplified.</span></span> <span data-ttu-id="58be9-128">Ad esempio, 50 dipendenze ognuna con una disponibilità del 99,99% genererebbero diverse ore di inattività al mese a causa dell'effetto domino.</span><span class="sxs-lookup"><span data-stu-id="58be9-128">As an example, 50 dependencies each with 99.99% of availability would result in several hours of downtime each month because of this ripple effect.</span></span> <span data-ttu-id="58be9-129">Quando si verifica un errore nella dipendenza di un microservizio durante la gestione di un volume elevato di richieste, l'errore può saturare velocemente tutti i thread delle richieste disponibili in ogni servizio e determinare un arresto anomalo dell'intera applicazione.</span><span class="sxs-lookup"><span data-stu-id="58be9-129">When a microservice dependency fails while handling a high volume of requests, that failure can quickly saturate all available request threads in each service and crash the whole application.</span></span>

![Diagramma che mostra un errore parziale amplificato nei microservizi.](./media/handle-partial-failure/partial-failure-amplified-microservices.png)

<span data-ttu-id="58be9-131">**Figura 8-3**.</span><span class="sxs-lookup"><span data-stu-id="58be9-131">**Figure 8-3**.</span></span> <span data-ttu-id="58be9-132">Errore parziale amplificato da microservizi con lunghe catene di chiamate HTTP sincrone</span><span class="sxs-lookup"><span data-stu-id="58be9-132">Partial failure amplified by microservices with long chains of synchronous HTTP calls</span></span>

<span data-ttu-id="58be9-133">Per ridurre al minimo questo problema, nella sezione [L'integrazione asincrona dei microservizi impone l'autonomia dei microservizi,](../architect-microservice-container-applications/communication-in-microservice-architecture.md#asynchronous-microservice-integration-enforces-microservices-autonomy)questa guida incoraggia a utilizzare la comunicazione asincrona tra i microservizi interni.</span><span class="sxs-lookup"><span data-stu-id="58be9-133">To minimize this problem, in the section [Asynchronous microservice integration enforce microservice's autonomy](../architect-microservice-container-applications/communication-in-microservice-architecture.md#asynchronous-microservice-integration-enforces-microservices-autonomy), this guide encourages you to use asynchronous communication across the internal microservices.</span></span>

<span data-ttu-id="58be9-134">È anche essenziale progettare i microservizi e le applicazioni client per la gestione degli errori parziali, ovvero creare microservizi e applicazioni client resilienti.</span><span class="sxs-lookup"><span data-stu-id="58be9-134">In addition, it's essential that you design your microservices and client applications to handle partial failures—that is, to build resilient microservices and client applications.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="58be9-135">[Successivo](index.md)
>[precedente](partial-failure-strategies.md)</span><span class="sxs-lookup"><span data-stu-id="58be9-135">[Previous](index.md)
[Next](partial-failure-strategies.md)</span></span>
