---
title: Migrazione a Windows 10
description: Approfondimento delle funzionalità di Windows 10, come la creazione di pacchetti e le isole XAML.
ms.date: 09/16/2019
ms.openlocfilehash: cd17088b086a32fd3bb37e617d3a1047acedde0e
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/15/2020
ms.locfileid: "83423208"
---
# <a name="windows-10-migration"></a><span data-ttu-id="51aa8-103">Migrazione a Windows 10</span><span class="sxs-lookup"><span data-stu-id="51aa8-103">Windows 10 migration</span></span>

<span data-ttu-id="51aa8-104">Si consideri la situazione seguente: si dispone di un'applicazione desktop funzionante sviluppata in Windows 7 Days.</span><span class="sxs-lookup"><span data-stu-id="51aa8-104">Consider the following situation: You have a working desktop application that was developed in the Windows 7 days.</span></span> <span data-ttu-id="51aa8-105">Usa la tecnologia WPF disponibile in quel momento e funziona correttamente, ma ha un'interfaccia utente obsoleta e i comportamenti quando lo Esegui in Windows 10.</span><span class="sxs-lookup"><span data-stu-id="51aa8-105">It's using WPF technology available at that time and working fine but it has an outdated UI and behaviors when you run it on Windows 10.</span></span> <span data-ttu-id="51aa8-106">È come quando si guarda un film futuristico come Matrix e si vede neo usando il dispositivo Nokia 8110.</span><span class="sxs-lookup"><span data-stu-id="51aa8-106">It is like when you watch a futuristic movie like Matrix and you see Neo using the Nokia 8110 device.</span></span> <span data-ttu-id="51aa8-107">Il film funziona benissimo dopo 20 anni, ma è piuttosto vantaggioso per la modernizzazione dei dispositivi.</span><span class="sxs-lookup"><span data-stu-id="51aa8-107">The film works great after 20 years but it would rather benefit from a device modernization.</span></span>

<span data-ttu-id="51aa8-108">Con il rilascio di Windows 10, Microsoft ha introdotto molte innovazioni per supportare scenari come tablet e dispositivi touch e fornire la migliore esperienza per gli utenti di un sistema operativo Microsoft.</span><span class="sxs-lookup"><span data-stu-id="51aa8-108">With the release of Windows 10, Microsoft introduced many innovations to support scenarios like tablets and touch devices and to provide the best experience for users for a Microsoft operating system ever.</span></span> <span data-ttu-id="51aa8-109">Ad esempio, è possibile:</span><span class="sxs-lookup"><span data-stu-id="51aa8-109">For example, you can:</span></span>

- <span data-ttu-id="51aa8-110">Accedi con la tua faccia usando Windows Hello.</span><span class="sxs-lookup"><span data-stu-id="51aa8-110">Sign in with your face using Windows Hello.</span></span>
- <span data-ttu-id="51aa8-111">Usare una penna per creare o scrivere il testo riconosciuto e digitalizzato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-111">Use a pen to draw or handwrite text that is automatically recognized and digitalized.</span></span>
- <span data-ttu-id="51aa8-112">Esegui i modelli di intelligenza artificiale personalizzati in locale basati sul cloud usando WinML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-112">Run locally customized AI models built on the cloud using WinML.</span></span>

<span data-ttu-id="51aa8-113">Tutte queste funzionalità sono abilitate per gli sviluppatori Windows tramite le librerie Windows Runtime (WinRT).</span><span class="sxs-lookup"><span data-stu-id="51aa8-113">All these features are enabled for Windows developers through Windows Runtime (WinRT) libraries.</span></span> <span data-ttu-id="51aa8-114">È possibile sfruttare queste funzionalità nelle app desktop esistenti perché le librerie sono esposte anche a .NET Framework e .NET Core.</span><span class="sxs-lookup"><span data-stu-id="51aa8-114">You can take advantage of these features in your existing desktop apps because the libraries are exposed to both the .NET Framework and .NET Core as well.</span></span> <span data-ttu-id="51aa8-115">È anche possibile modernizzare l'interfaccia utente con l'uso di isole XAML e migliorare gli oggetti visivi e il comportamento delle app in base ai tempi.</span><span class="sxs-lookup"><span data-stu-id="51aa8-115">You can even modernize your UI with the use of XAML Islands and improve the visuals and behavior of your apps according to the times.</span></span>

<span data-ttu-id="51aa8-116">Una cosa importante da notare è che non è necessario abbandonare .NET Framework tecnologia per seguire questo percorso di modernizzazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-116">One important thing to note here is that you don't need to abandon .NET Framework technology to follow this modernization path.</span></span> <span data-ttu-id="51aa8-117">È possibile rimanere sempre aggiornati e ottenere tutti i vantaggi di Windows 10 senza la necessità di eseguire la migrazione a .NET Core.</span><span class="sxs-lookup"><span data-stu-id="51aa8-117">You can safely stay on there and have all the benefits of Windows 10 without the pressure to migrate to .NET Core.</span></span> <span data-ttu-id="51aa8-118">Quindi, si ottiene la potenza e la flessibilità per scegliere il percorso di modernizzazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-118">So, you get both the power and the flexibility to choose your modernization path.</span></span>

## <a name="winrt-apis"></a><span data-ttu-id="51aa8-119">API WinRT</span><span class="sxs-lookup"><span data-stu-id="51aa8-119">WinRT APIs</span></span>

<span data-ttu-id="51aa8-120">Le API WinRT sono API (Application Programming Interface) orientate a oggetti che consentono agli sviluppatori di Windows 10 di accedere a tutti gli elementi offerti dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-120">WinRT APIs are object-oriented, well-structured application programming interfaces (APIs) that give Windows 10 developers access to everything the operating system has to offer.</span></span> <span data-ttu-id="51aa8-121">Tramite le API di WinRT, è possibile integrare funzionalità come le notifiche push, le API dei dispositivi, Microsoft Ink e WinML, tra le altre applicazioni desktop.</span><span class="sxs-lookup"><span data-stu-id="51aa8-121">Through WinRT APIs, you can integrate functionalities like Push Notifications, Device APIs, Microsoft Ink, and WinML, among others on your desktop apps.</span></span>

<span data-ttu-id="51aa8-122">In generale, le API WinRT possono essere chiamate da un'app desktop classica.</span><span class="sxs-lookup"><span data-stu-id="51aa8-122">In general, WinRT APIs can be called from a classic desktop app.</span></span> <span data-ttu-id="51aa8-123">Tuttavia, due aree principali presentano un'eccezione a questa regola:</span><span class="sxs-lookup"><span data-stu-id="51aa8-123">However, two main areas present an exception to this rule:</span></span>

* <span data-ttu-id="51aa8-124">API che richiedono un'identità del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-124">APIs that require a package identity.</span></span>
* <span data-ttu-id="51aa8-125">API che richiedono la visualizzazione come XAML o Composition.</span><span class="sxs-lookup"><span data-stu-id="51aa8-125">APIs that require visualization like XAML or Composition.</span></span>

### <a name="universal-windows-platform-uwp-packages"></a><span data-ttu-id="51aa8-126">Pacchetti piattaforma UWP (Universal Windows Platform) (UWP)</span><span class="sxs-lookup"><span data-stu-id="51aa8-126">Universal Windows Platform (UWP) packages</span></span>

#### <a name="application-package-identity"></a><span data-ttu-id="51aa8-127">Identità del pacchetto dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="51aa8-127">Application Package Identity</span></span>

<span data-ttu-id="51aa8-128">Le app UWP dispongono di un sistema di distribuzione in cui il sistema operativo gestisce l'installazione e la disinstallazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-128">UWP apps have a deployment system where the OS manages the installation and uninstallation of application.</span></span> <span data-ttu-id="51aa8-129">Questa operazione richiede l'installazione dichiarativa, ovvero nessun codice utente viene eseguito durante l'installazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-129">That requires the installation to be declarative, meaning that no user code is executed during install.</span></span> <span data-ttu-id="51aa8-130">Al contrario, tutti gli elementi che l'app vuole integrare con il sistema, ad esempio protocolli, tipi di file ed estensioni, sono dichiarati nel manifesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-130">Instead, everything the app wants to integrate with the system, such as protocols, file types, and extensions, is declared in the application manifest.</span></span> <span data-ttu-id="51aa8-131">In fase di distribuzione, la pipeline di distribuzione configura tali punti di integrazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-131">At deployment time, the deployment pipeline configures those integration points.</span></span> <span data-ttu-id="51aa8-132">L'unico modo per il sistema operativo di gestire tutte queste funzionalità e tenerne traccia è che ogni "pacchetto" deve avere un'identità, un identificatore univoco per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-132">The only way for the OS to manage all this functionality and keep track of it is for each 'package' to have an identity, a unique identifier for the application.</span></span>

<span data-ttu-id="51aa8-133">Per alcune API WinRT è necessario che l'identità del pacchetto funzioni come previsto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-133">Some WinRT APIs require this package identity to work as expected.</span></span> <span data-ttu-id="51aa8-134">Tuttavia, le app desktop classiche come le app C++ native o .NET usano sistemi di distribuzione diversi che non richiedono un'identità del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-134">However, classic desktop apps like native C++ or .NET apps, use different deployment systems that don't require a package identity.</span></span> <span data-ttu-id="51aa8-135">Se si vogliono usare queste API WinRT nell'applicazione desktop, è necessario fornire loro un'identità del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-135">If you want to use these WinRT APIs in your desktop application, you need to provide them a package identity.</span></span>

<span data-ttu-id="51aa8-136">Un modo per procedere consiste nel compilare un progetto di creazione pacchetti aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-136">One way to proceed is to build an additional packaging project.</span></span> <span data-ttu-id="51aa8-137">All'interno del progetto di creazione pacchetto, puntare al progetto di codice sorgente originale e specificare le informazioni di identità che si desidera fornire.</span><span class="sxs-lookup"><span data-stu-id="51aa8-137">Inside the packaging project, you point to the original source code project and specify the Identity information you want to provide.</span></span><span data-ttu-id="51aa8-138">Se si installa il pacchetto ed Esegui l'app installata, verrà automaticamente individuata un'identificazione che consente al codice di chiamare tutte le API WinRT che richiedono l'identità.</span><span class="sxs-lookup"><span data-stu-id="51aa8-138"> If you install the package and run the installed app, it will automatically get an identify enabling your code to call all WinRT APIs requiring Identity.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<Package xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
         xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10">
    <Identity Name="YOUR-APP-GUID "
              Publisher="CN=YOUR COMPANY"
              Version="1.x.x.x" />
</Package>
```

<span data-ttu-id="51aa8-139">È possibile verificare quali API necessitano di un'identità di applicazione in pacchetto controllando se il tipo che contiene l'API è contrassegnato con l'attributo [DualApiPartition](xref:Windows.Foundation.Metadata.DualApiPartitionAttribute) .</span><span class="sxs-lookup"><span data-stu-id="51aa8-139">You can check which APIs need a packaged application identity by inspecting if the type that contains the API is marked with the [DualApiPartition](xref:Windows.Foundation.Metadata.DualApiPartitionAttribute) attribute.</span></span><span data-ttu-id="51aa8-140">In tal caso, è possibile chiamare se da un'app desktop tradizionale non in pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-140"> If it is, you can call if from an unpackaged traditional desktop app.</span></span> <span data-ttu-id="51aa8-141">In caso contrario, è necessario convertire l'app desktop classica in un UWP con l'aiuto di un progetto di creazione pacchetti.</span><span class="sxs-lookup"><span data-stu-id="51aa8-141">Otherwise, you must convert your classic desktop app to a UWP with the help of a packaging project.</span></span>

<https://docs.microsoft.com/windows/desktop/apiindex/uwp-apis-callable-from-a-classic-desktop-app>

#### <a name="benefits-of-packaging"></a><span data-ttu-id="51aa8-142">Vantaggi della creazione di pacchetti</span><span class="sxs-lookup"><span data-stu-id="51aa8-142">Benefits of packaging</span></span>

<span data-ttu-id="51aa8-143">Oltre a fornire l'accesso a queste API, si ottengono alcuni vantaggi aggiuntivi creando un pacchetto dell'app Windows per l'applicazione desktop, tra cui:</span><span class="sxs-lookup"><span data-stu-id="51aa8-143">Besides giving you access to these APIs, you get some additional benefits by creating a Windows App package for your desktop application including:</span></span>

* <span data-ttu-id="51aa8-144">**Distribuzione semplificata**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-144">**Streamlined deployment**.</span></span> <span data-ttu-id="51aa8-145">Le app hanno un'esperienza di distribuzione ottimale che garantisce agli utenti la possibilità di installare un'applicazione e di aggiornarla.</span><span class="sxs-lookup"><span data-stu-id="51aa8-145">Apps have a great deployment experience ensuring that users can confidently install an application and update it.</span></span> <span data-ttu-id="51aa8-146">Se un utente sceglie di disinstallare l'app, viene rimossa completamente senza alcuna traccia che impedisce il problema di Windows Rot.</span><span class="sxs-lookup"><span data-stu-id="51aa8-146">If a user chooses to uninstall the app, it's removed completely with no trace left behind preventing the Windows rot problem.</span></span>

* <span data-ttu-id="51aa8-147">**Licenze e aggiornamenti automatici**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-147">**Automatic updates and licensing**.</span></span> <span data-ttu-id="51aa8-148">L'applicazione può partecipare alle funzionalità predefinite di gestione delle licenze e aggiornamenti automatici Microsoft Store.</span><span class="sxs-lookup"><span data-stu-id="51aa8-148">Your application can participate in the Microsoft Store's built-in licensing and automatic update facilities.</span></span> <span data-ttu-id="51aa8-149">L'aggiornamento automatico è un meccanismo affidabile ed efficiente, perché vengono scaricate solo le parti modificate dei file.</span><span class="sxs-lookup"><span data-stu-id="51aa8-149">Automatic update is a highly reliable and efficient mechanism, because only the changed parts of files are downloaded.</span></span>

* <span data-ttu-id="51aa8-150">**Pubblico più ampio e monetizzazione semplificata**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-150">**Increased reach and simplified monetization**.</span></span> <span data-ttu-id="51aa8-151">Forse non è il caso, ma se si sceglie di distribuire l'applicazione tramite il Microsoft Store si raggiungono milioni di utenti di Windows 10.</span><span class="sxs-lookup"><span data-stu-id="51aa8-151">Maybe not your case but if you choose to distribute your application through the Microsoft Store you reach millions of Windows 10 users.</span></span>

* <span data-ttu-id="51aa8-152">**Aggiunta di funzionalità UWP**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-152">**Add UWP features**.</span></span> <span data-ttu-id="51aa8-153">È possibile aggiungere le funzionalità di UWP al pacchetto dell'app con il proprio ritmo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-153">You can add UWP features to your app's package at your own pace.</span></span>

#### <a name="prepare-for-packaging"></a><span data-ttu-id="51aa8-154">Prepararsi per la creazione di pacchetti</span><span class="sxs-lookup"><span data-stu-id="51aa8-154">Prepare for packaging</span></span>

<span data-ttu-id="51aa8-155">Prima di procedere con il pacchetto dell'applicazione desktop, è necessario risolvere alcuni aspetti prima di avviare il processo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-155">Before proceeding to package your desktop application, there are some points you have to address before starting the process.</span></span> <span data-ttu-id="51aa8-156">L'applicazione deve rispettare le regole e i criteri di Microsoft Store ed essere eseguita nel modello di applicazione UWP.</span><span class="sxs-lookup"><span data-stu-id="51aa8-156">Your application must respect any of the Microsoft Store rules and policies and run in the UWP application model.</span></span> <span data-ttu-id="51aa8-157">Ad esempio, deve essere eseguito nel .NET Framework 4.6.2 o versione successiva e scrive nell' `HKEY_CURRENT_USER` hive del registro di sistema e le cartelle AppData verranno virtualizzate in un percorso locale dell'app specifico dell'utente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-157">For example, it has to run on the .NET Framework 4.6.2 or later and writes to the `HKEY_CURRENT_USER` registry hive and the AppData folders will be virtualized to a user-specific app-local location.</span></span>

<span data-ttu-id="51aa8-158">L'obiettivo di progettazione per la creazione di pacchetti consiste nel separare lo stato dell'applicazione dallo stato del sistema mantenendo la compatibilità con altre app.</span><span class="sxs-lookup"><span data-stu-id="51aa8-158">The design goal for packaging is to separate the application state from system state while maintaining compatibility with other apps.</span></span> <span data-ttu-id="51aa8-159">Windows 10 realizza questo obiettivo inserendo l'applicazione all'interno di un pacchetto UWP.</span><span class="sxs-lookup"><span data-stu-id="51aa8-159">Windows 10 accomplishes this goal by placing the application inside a UWP package.</span></span> <span data-ttu-id="51aa8-160">Rileva e reindirizza alcune modifiche apportate al file system e al registro di sistema in fase di esecuzione per soddisfare la promessa di un comportamento di installazione e disinstallazione attendibile e affidabile di un'applicazione fornita dalla creazione di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="51aa8-160">It detects and redirects some changes to the file system and registry at run time to fulfill the promise of a trusted and clean install and uninstall behavior of an application provided by packaging.</span></span>

<span data-ttu-id="51aa8-161">I pacchetti creati per l'applicazione desktop sono applicazioni con attendibilità totale e solo desktop che non sono in modalità sandbox, sebbene la virtualizzazione leggera venga applicata all'app per le Scritture in `HKCU` e `AppData` .</span><span class="sxs-lookup"><span data-stu-id="51aa8-161">Packages that you create for your desktop application are desktop-only, full-trust applications that aren't sandboxed, although there's lightweight virtualization applied to the app for writes to `HKCU` and `AppData`.</span></span> <span data-ttu-id="51aa8-162">Questa virtualizzazione consente loro di interagire con altre app allo stesso modo delle applicazioni desktop classiche.</span><span class="sxs-lookup"><span data-stu-id="51aa8-162">This virtualization allows them to interact with other apps the same way classic desktop applications do.</span></span>

##### <a name="installation"></a><span data-ttu-id="51aa8-163">Installazione</span><span class="sxs-lookup"><span data-stu-id="51aa8-163">Installation</span></span>

<span data-ttu-id="51aa8-164">I pacchetti dell'applicazione vengono installati in *% ProgramFiles% \\ WindowsApps \\ package_name*, con il file eseguibile denominato  `app_name.exe` .</span><span class="sxs-lookup"><span data-stu-id="51aa8-164">App packages are installed under *%ProgramFiles%\\WindowsApps\\package_name*, with the executable titled `app_name.exe`.</span></span> <span data-ttu-id="51aa8-165">Ogni cartella del pacchetto contiene un manifesto (denominato `AppxManifest.xml` ) che contiene uno spazio dei nomi XML speciale per le app in pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-165">Each package folder contains a manifest (named `AppxManifest.xml`) that contains a special XML namespace for packaged apps.</span></span> <span data-ttu-id="51aa8-166">All'interno del file manifesto è un  `<EntryPoint>`   elemento che fa riferimento all'app con attendibilità totale.</span><span class="sxs-lookup"><span data-stu-id="51aa8-166">Inside that manifest file is an `<EntryPoint>` element, which references the full-trust app.</span></span> <span data-ttu-id="51aa8-167">Quando l'applicazione viene avviata, non viene eseguita all'interno di un contenitore di app, ma viene invece eseguita come l'utente normalmente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-167">When that application is launched, it doesn't run inside an app container, but instead it runs as the user as it normally would.</span></span>

<span data-ttu-id="51aa8-168">Dopo la distribuzione, i file di pacchetto vengono contrassegnati come di sola lettura e bloccati dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-168">After deployment, package files are marked read-only and heavily locked down by the operating system.</span></span> <span data-ttu-id="51aa8-169">Se questi file vengono manomessi, Windows impedisce l'avvio delle app.</span><span class="sxs-lookup"><span data-stu-id="51aa8-169">Windows prevents apps from launching if these files are tampered with.</span></span>

##### <a name="file-system"></a><span data-ttu-id="51aa8-170">File system</span><span class="sxs-lookup"><span data-stu-id="51aa8-170">File system</span></span>

<span data-ttu-id="51aa8-171">Il sistema operativo supporta diversi livelli di operazioni di file system per le applicazioni desktop in pacchetto, a seconda del percorso della cartella.</span><span class="sxs-lookup"><span data-stu-id="51aa8-171">The OS supports different levels of file system operations for packaged desktop applications, depending on the folder location.</span></span>

<span data-ttu-id="51aa8-172">Quando si tenta di accedere alla cartella *AppData* dell'utente, il sistema crea una posizione privata per singolo utente e per app dietro le quinte.</span><span class="sxs-lookup"><span data-stu-id="51aa8-172">When trying to access the user's *AppData* folder, the system creates a private per-user, per-app location behind the scenes.</span></span> <span data-ttu-id="51aa8-173">In questo modo si crea l'illusione che l'applicazione in pacchetto stia modificando il *AppData* reale quando sta effettivamente modificando una copia privata.</span><span class="sxs-lookup"><span data-stu-id="51aa8-173">This creates the illusion that the packaged application is editing the real *AppData* when it's actually modifying a private copy.</span></span> <span data-ttu-id="51aa8-174">Reindirizzando in questo modo le scritture, il sistema può tenere traccia di tutte le modifiche ai file effettuate dall'app.</span><span class="sxs-lookup"><span data-stu-id="51aa8-174">By redirecting writes this way, the system can track all file modifications made by the app.</span></span> <span data-ttu-id="51aa8-175">Può quindi pulire tutti i file durante la disinstallazione della riduzione del sistema "rot" e garantire una migliore esperienza di rimozione dell'applicazione per l'utente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-175">It can then clean all those files when uninstalling reducing system "rot" and providing a better application removal experience for the user.</span></span>

##### <a name="registry"></a><span data-ttu-id="51aa8-176">Registro</span><span class="sxs-lookup"><span data-stu-id="51aa8-176">Registry</span></span>

<span data-ttu-id="51aa8-177">I pacchetti dell'applicazione contengono un file Registry. dat, che funge da equivalente logico di  `HKLM\Software`   nel registro di sistema reale.</span><span class="sxs-lookup"><span data-stu-id="51aa8-177">App packages contain a registry.dat file, which serves as the logical equivalent of `HKLM\Software` in the real registry.</span></span> <span data-ttu-id="51aa8-178">In fase di esecuzione, questo Registro di sistema virtuale unisce il contenuto di questo hive con l'hive di sistema nativo per fornire una vista singola di entrambi.</span><span class="sxs-lookup"><span data-stu-id="51aa8-178">At runtime, this virtual registry merges the contents of this hive into the native system hive to provide a singular view of both.</span></span>

<span data-ttu-id="51aa8-179">Tutte le scritture vengono mantenute durante l'aggiornamento del pacchetto e vengono eliminate solo quando l'applicazione viene disinstallata.</span><span class="sxs-lookup"><span data-stu-id="51aa8-179">All writes are kept during package upgrade and only deleted when the application is uninstalled.</span></span>

##### <a name="uninstallation"></a><span data-ttu-id="51aa8-180">Disinstallazione</span><span class="sxs-lookup"><span data-stu-id="51aa8-180">Uninstallation</span></span>

<span data-ttu-id="51aa8-181">Quando l'utente disinstalla un pacchetto, vengono rimossi tutti i file e le cartelle presenti in, nonché le  `C:\Program Files\WindowsApps\package_name` Scritture reindirizzate a AppData o il registro di sistema acquisito durante il processo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-181">When the user uninstalls a package, all files and folders located under `C:\Program Files\WindowsApps\package_name` are removed, as well as any redirected writes to AppData or the registry that were captured during the process.</span></span>

<span data-ttu-id="51aa8-182">Per informazioni dettagliate sul modo in cui un'applicazione in pacchetto gestisce l'installazione, l'accesso ai file, il registro di sistema e la disinstallazione, vedere <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-behind-the-scenes> .</span><span class="sxs-lookup"><span data-stu-id="51aa8-182">For details about how a packaged application handles installation, file access, registry, and uninstallation, see <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-behind-the-scenes>.</span></span>

<span data-ttu-id="51aa8-183">È possibile ottenere un elenco completo di elementi da controllare <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-prepare> .</span><span class="sxs-lookup"><span data-stu-id="51aa8-183">You can get a complete list of things to check on <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-prepare>.</span></span>

## <a name="how-to-add-winrt-apis-to-your-desktop-project"></a><span data-ttu-id="51aa8-184">Come aggiungere API WinRT al progetto desktop</span><span class="sxs-lookup"><span data-stu-id="51aa8-184">How to add WinRT APIs to your desktop project</span></span>

<span data-ttu-id="51aa8-185">In questa sezione è possibile trovare una procedura dettagliata su come integrare le notifiche di tipo avviso popup in un'applicazione WPF esistente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-185">In this section, you can find a walkthrough on how to integrate Toast Notifications in an existing WPF application.</span></span> <span data-ttu-id="51aa8-186">Sebbene sia semplice dal punto di vista del codice, consente di illustrare l'intero processo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-186">Although it's simple from the code perspective, it helps illustrate the whole process.</span></span> <span data-ttu-id="51aa8-187">Le notifiche sono una delle numerose API WinRT disponibili che è possibile usare nell'app .NET.</span><span class="sxs-lookup"><span data-stu-id="51aa8-187">Notifications are one of the many available WinRT APIs available that you can use in .NET app.</span></span> <span data-ttu-id="51aa8-188">In questo caso, l'API richiede un'identità del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-188">In this case, the API requires a Package Identity.</span></span> <span data-ttu-id="51aa8-189">Questo processo è più semplice se le API non richiedono l'identità del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-189">This process is more straightforward if the APIs don't require Package Identity.</span></span>

<span data-ttu-id="51aa8-190">Si prenda un'app di esempio WPF esistente che legge i file e ne Visualizza il contenuto sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-190">Let's take an existing WPF sample app that reads files and shows its contents on the screen.</span></span> <span data-ttu-id="51aa8-191">L'obiettivo consiste nel visualizzare una notifica di tipo avviso popup all'avvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-191">The goal is to display a Toast Notification when the application starts.</span></span>

![Screenshot dell'applicazione di esempio in esecuzione](./media/windows-migration/sample-application.png)

<span data-ttu-id="51aa8-193">Prima di tutto, è necessario archiviare il collegamento seguente se l'API di Windows 10 che si userà richiede un'identità del pacchetto:</span><span class="sxs-lookup"><span data-stu-id="51aa8-193">First, you should check in the following link whether the Windows 10 API that you'll use requires a Package Identity:</span></span>

<https://docs.microsoft.com/windows/apps/desktop/modernize/desktop-to-uwp-supported-api>

<span data-ttu-id="51aa8-194">Nell'esempio viene usata l' <xref:Windows.UI.Notifications.Notification?displayProperty=nameWithType> API che richiede un'identità in pacchetto:</span><span class="sxs-lookup"><span data-stu-id="51aa8-194">Our sample will use the <xref:Windows.UI.Notifications.Notification?displayProperty=nameWithType> API that requires a packaged identity:</span></span>

![Classe di notifica nella documentazione di Microsoft](./media/windows-migration/notification-class-documentation.png)

<span data-ttu-id="51aa8-196">Per accedere all'API WinRT, aggiungere un riferimento al `Microsoft.Windows.SDK.Contracts`   pacchetto NuGet e questo pacchetto eseguirà la magia dietro le quinte (vedere i dettagli in <https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/> ).</span><span class="sxs-lookup"><span data-stu-id="51aa8-196">To access the WinRT API, add a reference to the `Microsoft.Windows.SDK.Contracts` NuGet package and this package will do the magic behind the scenes (see details at <https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/>).</span></span>

<span data-ttu-id="51aa8-197">A questo punto si è pronti per iniziare ad aggiungere codice.</span><span class="sxs-lookup"><span data-stu-id="51aa8-197">You're now prepared to start adding some code.</span></span>

<span data-ttu-id="51aa8-198">Creare un `ShowToastNotification` metodo che verrà chiamato all'avvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-198">Create a `ShowToastNotification` method that will be called on application startup.</span></span> <span data-ttu-id="51aa8-199">Compila semplicemente una notifica di tipo avviso popup da un modello XML:</span><span class="sxs-lookup"><span data-stu-id="51aa8-199">It just builds a toast notification from an XML pattern:</span></span>

```csharp
private void ShowNotification(string title, string content, string image)
{
    string xmlString = $@"<toast><visual><binding template = 'ToastGeneric'><text>{title}</text><text>{content}</text><image src=>'{image}'</image></binding></visual></toast>";
    XmlDocument toastXml = new XmlDocument();
    toastXml.LoadXml(xmlString);
    ToastNotification toast = new ToastNotification(toastXml);
    ToastNotificationManager.CreateToastNotifier().Show(toast);
}
```

<span data-ttu-id="51aa8-200">Sebbene il progetto venga compilato, si verificano errori perché l'API delle notifiche richiede un'identità del pacchetto e non è stata fornita.</span><span class="sxs-lookup"><span data-stu-id="51aa8-200">Although the project builds, there are errors because the Notifications API requires a Package Identity and you didn't provide it.</span></span> <span data-ttu-id="51aa8-201">L'aggiunta di un progetto di creazione pacchetti Windows alla soluzione risolverà il problema:</span><span class="sxs-lookup"><span data-stu-id="51aa8-201">Adding a Windows Packaging Project to the solution will fix the issue:</span></span>

![Screenshot della finestra di dialogo Aggiungi nuovo progetto in Visual Studio](./media/windows-migration/add-packaging-project.png)

<span data-ttu-id="51aa8-203">Selezionare la versione minima di Windows che si desidera supportare e la versione di destinazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-203">Select the minimum Windows version you want to support and the version you're targeting.</span></span> <span data-ttu-id="51aa8-204">Non tutte le API WinRT sono supportate in tutte le versioni di Windows 10.</span><span class="sxs-lookup"><span data-stu-id="51aa8-204">Not all the WinRT APIs are supported in all Windows 10 versions.</span></span> <span data-ttu-id="51aa8-205">Ogni aggiornamento di Windows 10 aggiunge nuove API disponibili solo da questa versione. il supporto di livello inferiore non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="51aa8-205">Each Windows 10 update adds new APIs that are only available from this version; down-level support isn't available.</span></span>

![Selezione della versione minima di Windows](./media/windows-migration/select-versions.png)

<span data-ttu-id="51aa8-207">Il passaggio successivo consiste nell'aggiungere l'applicazione WPF al progetto di creazione pacchetti Windows mediante l'aggiunta di un riferimento al progetto:</span><span class="sxs-lookup"><span data-stu-id="51aa8-207">Next step is to add the WPF application to the Windows Packaging Project by adding a project reference:</span></span>

![Aggiunta di un'applicazione WPF al progetto di creazione pacchetti Windows](./media/windows-migration/add-application.png)

![Gestione riferimenti](./media/windows-migration/reference-manager.png)

<span data-ttu-id="51aa8-210">Un progetto di creazione pacchetti Windows può comprimere diverse app, quindi è necessario impostare quello che è il punto di ingresso:</span><span class="sxs-lookup"><span data-stu-id="51aa8-210">A Windows Packaging Project can package several apps so you should set which one is the Entry Point:</span></span>

![Impostazione del punto di ingresso](./media/windows-migration/set-entry-point.png)

<span data-ttu-id="51aa8-212">Il passaggio successivo consiste nell'impostare il progetto WPF come progetto di avvio nella configurazione della soluzione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-212">Next step is to set the WPF Project as the startup Project in the solution configuration.</span></span> <span data-ttu-id="51aa8-213">È possibile premere F5 per compilare e compilare e visualizzare i risultati.</span><span class="sxs-lookup"><span data-stu-id="51aa8-213">You can press F5 to compile and build and see the results.</span></span>

![Applicazione di esempio in esecuzione e visualizzazione dei risultati](./media/windows-migration/sample-app-result.png)

<span data-ttu-id="51aa8-215">Generare il pacchetto per poter installare l'app.</span><span class="sxs-lookup"><span data-stu-id="51aa8-215">Let's generate the package so you can install your app.</span></span> <span data-ttu-id="51aa8-216">Fare clic con il pulsante destro del mouse su **Store**  >  **Crea pacchetti dell'applicazione**</span><span class="sxs-lookup"><span data-stu-id="51aa8-216">Right click on **Store** > **Create App Packages**.</span></span>

![Finestra di dialogo Crea pacchetti dell'applicazione](./media/windows-migration/create-app-packages.png)

<span data-ttu-id="51aa8-218">Selezionare l'opzione sideload per distribuire l'app dal computer:</span><span class="sxs-lookup"><span data-stu-id="51aa8-218">Select the sideloading option to deploy the app from your machine:</span></span>

![Selezione dell'opzione sideload](./media/windows-migration/select-sideloading-option.png)

<span data-ttu-id="51aa8-220">Selezionare l'architettura dell'applicazione dell'app:</span><span class="sxs-lookup"><span data-stu-id="51aa8-220">Select the application architecture of your app:</span></span>

![Selezione dell'architettura dell'applicazione](./media/windows-migration/select-app-architecture.png)

<span data-ttu-id="51aa8-222">Infine, creare il pacchetto facendo clic su **Crea**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-222">Finally, create the package by clicking on **Create**.</span></span>

## <a name="xaml-islands"></a><span data-ttu-id="51aa8-223">Isole XAML</span><span class="sxs-lookup"><span data-stu-id="51aa8-223">XAML Islands</span></span>

<span data-ttu-id="51aa8-224">Le isole XAML sono un set di componenti che consentono agli sviluppatori di Windows desktop di usare i controlli XAML UWP nelle applicazioni Win32 esistenti, tra cui Windows Forms e WPF.</span><span class="sxs-lookup"><span data-stu-id="51aa8-224">XAML Islands are a set of components that enable Windows desktop developers to use UWP XAML controls on their existing Win32 applications, including Windows Forms and WPF.</span></span>

![Struttura delle isole XAML](./media/windows-migration/xaml-islands.png)

<span data-ttu-id="51aa8-226">È possibile creare un'immagine dell'app Win32 con i controlli standard e tra di essi un'"isola" dell'interfaccia utente di UWP contenente i controlli del mondo moderno.</span><span class="sxs-lookup"><span data-stu-id="51aa8-226">You can image your Win32 app with your standard controls and among them an "island" of UWP UI containing controls from the modern world.</span></span> <span data-ttu-id="51aa8-227">Il concetto è simile a quello di un iFrame all'interno di una pagina Web che mostra il contenuto di un`different page.`</span><span class="sxs-lookup"><span data-stu-id="51aa8-227">The concept is similar as having an iFrame inside a web page that shows content from a `different page.`</span></span>

<span data-ttu-id="51aa8-228">Oltre ad aggiungere funzionalità dalle API di Windows 10, è possibile aggiungere frammenti di codice XAML UWP all'interno dell'app usando le isole XAML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-228">Besides adding functionality from the Windows 10 APIs, you can add pieces of UWP XAML inside of your app using XAML Islands.</span></span>

<span data-ttu-id="51aa8-229">Con l'aggiornamento di Windows 10 1903 è stato introdotto un set di API che consente di ospitare il contenuto XAML di UWP nelle finestre di Win32.</span><span class="sxs-lookup"><span data-stu-id="51aa8-229">Windows 10 1903 update introduces a set of APIs that allows hosting UWP XAML content in Win32 windows.</span></span> <span data-ttu-id="51aa8-230">Solo le app in esecuzione in Windows 10 1903 possono usare le isole XAML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-230">Only apps running on Windows 10 1903 can use XAML Islands.</span></span>

### <a name="the-road-to-xaml-islands"></a><span data-ttu-id="51aa8-231">La strada verso le isole XAML</span><span class="sxs-lookup"><span data-stu-id="51aa8-231">The road to XAML Islands</span></span>

<span data-ttu-id="51aa8-232">La strada verso le isole XAML è iniziata nel 2012 quando Microsoft ha introdotto le API WinRT come Framework per modernizzare le app Win32 (Windows Forms, WPF e le app Win32 native).</span><span class="sxs-lookup"><span data-stu-id="51aa8-232">The road to XAML Islands started in 2012 when Microsoft introduced the WinRT APIs as a framework to modernize the Win32 apps (Windows Forms, WPF, and native Win32 apps).</span></span> <span data-ttu-id="51aa8-233">Tuttavia, i nuovi controlli dell'interfaccia utente all'interno di WinRT erano disponibili per le nuove applicazioni, ma non per quelli esistenti.</span><span class="sxs-lookup"><span data-stu-id="51aa8-233">However, the new UI controls inside WinRT were available for new applications but not for existing ones.</span></span>

<span data-ttu-id="51aa8-234">In 2015, insieme a Windows 10, è nato UWP.</span><span class="sxs-lookup"><span data-stu-id="51aa8-234">In 2015, along with Windows 10, UWP was born.</span></span> <span data-ttu-id="51aa8-235">UWP consente di creare app che funzionano tra dispositivi Windows come XBox, mobile e desktop.</span><span class="sxs-lookup"><span data-stu-id="51aa8-235">UWP allows you to create apps that work across Windows devices like XBox, Mobile, and Desktop.</span></span> <span data-ttu-id="51aa8-236">Un anno dopo, Microsoft ha annunciato desktop Bridge (precedentemente noto come Project Centennial).</span><span class="sxs-lookup"><span data-stu-id="51aa8-236">One year later, Microsoft announced Desktop Bridge (formerly known as Project Centennial).</span></span> <span data-ttu-id="51aa8-237">Desktop Bridge è un set di strumenti che consentono agli sviluppatori di portare le proprie app Win32 esistenti nel Microsoft Store.</span><span class="sxs-lookup"><span data-stu-id="51aa8-237">Desktop Bridge is a set of tools that allowed developers to bring their existing Win32 apps to the Microsoft Store.</span></span> <span data-ttu-id="51aa8-238">Sono state aggiunte altre funzionalità in 2017, che consentono agli sviluppatori di migliorare le proprie app Win32 sfruttando alcune delle nuove API di Windows 10, come i riquadri animati e le notifiche nel centro operativo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-238">More capabilities were added in 2017, allowing developers to enhance their Win32 apps leveraging some of the new Windows 10 APIs, like live tiles and notifications on the action center.</span></span> <span data-ttu-id="51aa8-239">Tuttavia, non sono presenti nuovi controlli dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-239">But still, no new UI controls.</span></span>

<span data-ttu-id="51aa8-240">Alla build 2018, Microsoft ha annunciato un modo per gli sviluppatori di usare i nuovi controlli XAML di Windows 10 nelle app Win32 correnti senza eseguire la migrazione completa delle app in UWP.</span><span class="sxs-lookup"><span data-stu-id="51aa8-240">At Build 2018, Microsoft announced a way for developers to use the new Windows 10 XAML controls into their current Win32 apps, without fully migrating their apps to UWP.</span></span> <span data-ttu-id="51aa8-241">È stata personalizzata come UWP XAML Islands.</span><span class="sxs-lookup"><span data-stu-id="51aa8-241">It was branded as UWP XAML Islands.</span></span>

### <a name="how-it-works"></a><span data-ttu-id="51aa8-242">Come funziona</span><span class="sxs-lookup"><span data-stu-id="51aa8-242">How it works</span></span>

<span data-ttu-id="51aa8-243">L'aggiornamento di Windows 10 1903 introduce diverse API di hosting XAML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-243">The Windows 10 1903 update introduces several XAML hosting APIs.</span></span> <span data-ttu-id="51aa8-244">Due di esse sono `WindowsXamlManager`   e  `DesktopWindowXamlSource` .</span><span class="sxs-lookup"><span data-stu-id="51aa8-244">Two of them are `WindowsXamlManager` and `DesktopWindowXamlSource`.</span></span>

<span data-ttu-id="51aa8-245">La  `WindowsXamlManager`   classe gestisce il framework XAML UWP.</span><span class="sxs-lookup"><span data-stu-id="51aa8-245">The `WindowsXamlManager` class handles the UWP XAML Framework.</span></span> <span data-ttu-id="51aa8-246">Il `InitializeForCurrentThread` metodo carica il framework XAML UWP all'interno del thread corrente dell'app Win32.</span><span class="sxs-lookup"><span data-stu-id="51aa8-246">Its `InitializeForCurrentThread` method loads the UWP XAML Framework inside the current thread of the Win32 app.</span></span>

<span data-ttu-id="51aa8-247"> `DesktopWindowXamlSource`   È l'istanza del contenuto dell'isola XAML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-247">The `DesktopWindowXamlSource` is the instance of your XAML Island content.</span></span> <span data-ttu-id="51aa8-248">Dispone della `Content` proprietà, che è responsabile della creazione di istanze e dell'impostazione di.</span><span class="sxs-lookup"><span data-stu-id="51aa8-248">It has the `Content` property, which you're responsible for instantiating and setting.</span></span> <span data-ttu-id="51aa8-249">`DesktopWindowXamlSource`   Esegue il rendering e ottiene il relativo input da un HWND.</span><span class="sxs-lookup"><span data-stu-id="51aa8-249">The `DesktopWindowXamlSource` renders and gets its input from an HWND.</span></span> <span data-ttu-id="51aa8-250">È necessario che sia in grado di stabilire quale altro HWND collegherà l'isola XAML e che l'utente sia responsabile del dimensionamento e del posizionamento dell'HWND del padre.</span><span class="sxs-lookup"><span data-stu-id="51aa8-250">It needs to know to which other HWND it will attach the XAML Island's one, and you're responsible for sizing and positioning the parent's HWND.</span></span>

<span data-ttu-id="51aa8-251">Gli sviluppatori WPF o Windows Forms non gestiscono in genere HWND all'interno del proprio codice, pertanto potrebbe essere difficile comprendere e gestire i puntatori HWND e il cablaggio sottostante per comunicare i mondi Win32 e UWP.</span><span class="sxs-lookup"><span data-stu-id="51aa8-251">WPF or Windows Forms developers don't usually deal with HWND inside their code, so it may be hard to understand and handle HWND pointers and the underlying wiring stuff to communicate Win32 and UWP worlds.</span></span>

#### <a name="the-xaml-islands-net-wrappers"></a><span data-ttu-id="51aa8-252">Wrapper .NET delle isole XAML</span><span class="sxs-lookup"><span data-stu-id="51aa8-252">The XAML Islands .NET Wrappers</span></span>

<span data-ttu-id="51aa8-253">Windows community Toolkit dispone di un set di wrapper .NET di isole XAML per WPF o Windows Forms che semplificano l'utilizzo delle isole XAML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-253">The Windows Community Toolkit has a set the XAML Islands .NET wrappers for WPF or Windows Forms that make easier to use XAML Islands.</span></span> <span data-ttu-id="51aa8-254">Questi wrapper gestiscono gli HWND, la gestione dello stato attivo, tra le altre cose.</span><span class="sxs-lookup"><span data-stu-id="51aa8-254">These wrappers manage the HWNDs, the focus management, among other things.</span></span> <span data-ttu-id="51aa8-255">Gli sviluppatori Windows Forms e WPF devono usare questi wrapper.</span><span class="sxs-lookup"><span data-stu-id="51aa8-255">Windows Forms and WPF developers should use these wrappers.</span></span>

<span data-ttu-id="51aa8-256">Windows community Toolkit offre due tipi di controlli: i controlli con wrapper e i controlli di hosting.</span><span class="sxs-lookup"><span data-stu-id="51aa8-256">The Windows Community Toolkit offers two types of controls: Wrapped Controls and Hosting Controls.</span></span>

##### <a name="wrapped-controls"></a><span data-ttu-id="51aa8-257">Controlli con wrapper</span><span class="sxs-lookup"><span data-stu-id="51aa8-257">Wrapped Controls</span></span>

<span data-ttu-id="51aa8-258">Questi controlli di cui è stato eseguito il wrapping incapsulano alcuni controlli UWP in controlli Windows Forms o WPF, nascondendo i concetti UWP per tali sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="51aa8-258">These wrapped controls wrap some UWP controls into Windows Forms or WPF controls, hiding UWP concepts for those developers.</span></span> <span data-ttu-id="51aa8-259">Questi controlli sono:</span><span class="sxs-lookup"><span data-stu-id="51aa8-259">These controls are:</span></span>

* <span data-ttu-id="51aa8-260">WebView e WebViewCompatible</span><span class="sxs-lookup"><span data-stu-id="51aa8-260">WebView and WebViewCompatible</span></span>
* <span data-ttu-id="51aa8-261">InkCanvas e InkToolbar</span><span class="sxs-lookup"><span data-stu-id="51aa8-261">InkCanvas and InkToolbar</span></span>
* <span data-ttu-id="51aa8-262">MediaPlayerElement</span><span class="sxs-lookup"><span data-stu-id="51aa8-262">MediaPlayerElement</span></span>
* <span data-ttu-id="51aa8-263">MapControl</span><span class="sxs-lookup"><span data-stu-id="51aa8-263">MapControl</span></span>

<span data-ttu-id="51aa8-264">Aggiungere il `Microsoft.Toolkit.Wpf.UI.Controls` pacchetto al progetto, includere il riferimento allo spazio dei nomi e iniziare a usarlo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-264">Add the `Microsoft.Toolkit.Wpf.UI.Controls` package to your project, include the reference to the namespace, and start using them.</span></span>

```xml
<Window
        ...
        xmlns:uwpControls="clr-namespace:Microsoft.Toolkit.Wpf.UI.Controls;assembly=Microsoft.Toolkit.Wpf.UI.Controls">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="\*"/>
    </Grid.RowDefinitions>
    <uwpControls:InkToolbar TargetInkCanvas="{x:Reference Name=inkCanvas}"/>
    <uwpControls:InkCanvas Grid.Row="1" x:Name="inkCanvas" />
</Grid>
```

##### <a name="hosting-controls"></a><span data-ttu-id="51aa8-265">Controlli di hosting</span><span class="sxs-lookup"><span data-stu-id="51aa8-265">Hosting controls</span></span>

<span data-ttu-id="51aa8-266">Le potenzialità delle isole XAML si estendono alla maggior parte dei controlli di terze parti, dei controlli di terze parti e dei controlli personalizzati sviluppati per UWP, che possono essere integrati in Windows Forms e WPF come "isole" con interfaccia utente completamente funzionante.</span><span class="sxs-lookup"><span data-stu-id="51aa8-266">The power of XAML Islands extends to most first-party controls, third-party controls, and custom controls developed for UWP, which can be integrated into Windows Forms and WPF as "Islands" with fully functional UI.</span></span> <span data-ttu-id="51aa8-267">Il `WindowsXamlHost` controllo per WPF e Windows Forms consente di eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-267">The `WindowsXamlHost` control for WPF and Windows Forms allows doing this.</span></span>

<span data-ttu-id="51aa8-268">Per utilizzare il `WindowsXamlHost` controllo in WPF, ad esempio, aggiungere un riferimento al `Microsoft.Toolkit.Wpf.UI.XamlHost` pacchetto fornito da Windows community Toolkit.</span><span class="sxs-lookup"><span data-stu-id="51aa8-268">For example, to use the `WindowsXamlHost` control in WPF, add a reference to the `Microsoft.Toolkit.Wpf.UI.XamlHost` package provided by the Windows Community Toolkit.</span></span>

<span data-ttu-id="51aa8-269">Dopo aver inserito il `WindowsXamlHost` nel codice dell'interfaccia utente, specificare il tipo di UWP che si vuole caricare.</span><span class="sxs-lookup"><span data-stu-id="51aa8-269">Once you've placed your `WindowsXamlHost` into your UI code, specify which UWP type you want to load.</span></span> <span data-ttu-id="51aa8-270">È possibile scegliere di utilizzare un controllo di cui è stato eseguito il Wrapped, ad esempio `Button` o più complesso, composto da più controlli diversi, ovvero un controllo UWP personalizzato.</span><span class="sxs-lookup"><span data-stu-id="51aa8-270">You can choose to use a wrapped control like a `Button` or a more complex one composed by several different controls, which are a custom UWP control.</span></span>

<span data-ttu-id="51aa8-271">Nell'esempio seguente viene illustrato come aggiungere un UWP `Button` :</span><span class="sxs-lookup"><span data-stu-id="51aa8-271">The following example shows how to add a UWP `Button`:</span></span>

```xml
<Window
        ...
        xmlns:xamlhost="clr-namespace:Microsoft.Toolkit.Wpf.UI.XamlHost;assembly=Microsoft.Toolkit.Wpf.UI.XamlHost">

<xamlhost:WindowsXamlHost x:Name="myUwpButton"
                          InitialTypeName="Windows.UI.Xaml.Controls.Button" />
```

<span data-ttu-id="51aa8-272">Ci sono indicazioni chiare su come affrontarlo ed è preferibile disporre di una singola e più grande isola XAML contenente un controllo composito personalizzato anziché avere diverse isole con un solo controllo.</span><span class="sxs-lookup"><span data-stu-id="51aa8-272">There's a clear recommendation on how to approach this and it's better to have one single and bigger XAML Island containing a custom composite control than to have several islands with one control on each.</span></span>

<span data-ttu-id="51aa8-273">Una delle funzionalità principali di XAML è l'associazione e funziona tra il codice Win32 e l'isola.</span><span class="sxs-lookup"><span data-stu-id="51aa8-273">One of the core features of XAML is binding and it works between your Win32 code and the island.</span></span> <span data-ttu-id="51aa8-274">Quindi, è possibile associare, ad esempio, una Win32 `Textbox` con un UWP `Textbox` .</span><span class="sxs-lookup"><span data-stu-id="51aa8-274">So, you can bind, for instance, a Win32 `Textbox` with a UWP `Textbox`.</span></span> <span data-ttu-id="51aa8-275">Un aspetto importante da considerare è che queste associazioni sono associazioni unidirezionali, da UWP a Win32, pertanto se si aggiorna l' `Textbox` interno dell'isola XAML, la casella di testo Win32 verrà aggiornata, ma non viceversa.</span><span class="sxs-lookup"><span data-stu-id="51aa8-275">One important thing to consider is that these bindings are one-way bindings, from UWP to Win32, so if you update the `Textbox` inside the XAML Island the Win32 Textbox will be updated, but not the other way around.</span></span>

<span data-ttu-id="51aa8-276">Per una procedura dettagliata sull'uso delle isole XAML, vedere:</span><span class="sxs-lookup"><span data-stu-id="51aa8-276">To see a walkthrough about how to use XAML Islands, see:</span></span>

<https://docs.microsoft.com/windows/apps/desktop/modernize/host-standard-control-with-xaml-islands>

#### <a name="adding-uwp-xaml-custom-controls"></a><span data-ttu-id="51aa8-277">Aggiunta di controlli personalizzati XAML UWP</span><span class="sxs-lookup"><span data-stu-id="51aa8-277">Adding UWP XAML custom controls</span></span>

<span data-ttu-id="51aa8-278">Un controllo personalizzato XAML è un controllo (o controllo utente) creato dall'utente o da terze parti (inclusi i controlli WinUI 2. x).</span><span class="sxs-lookup"><span data-stu-id="51aa8-278">A XAML custom control is a control (or user control) created by you or by third parties (including WinUI 2.x controls).</span></span> <span data-ttu-id="51aa8-279">Per ospitare un controllo UWP personalizzato in un'app Windows Forms o WPF, è necessario:</span><span class="sxs-lookup"><span data-stu-id="51aa8-279">To host a custom UWP control in a Windows Forms or WPF app, you'll need:</span></span>

- <span data-ttu-id="51aa8-280">Per usare il `WindowsXamlHost` controllo UWP nell'app .NET Core 3. x.</span><span class="sxs-lookup"><span data-stu-id="51aa8-280">To use the `WindowsXamlHost` UWP control in your .NET Core 3.x app.</span></span>
- <span data-ttu-id="51aa8-281">Per creare un progetto di app UWP che definisce un `XamlApplication` oggetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-281">To create a UWP app project that defines a `XamlApplication` object.</span></span>

<span data-ttu-id="51aa8-282">Il progetto WPF o Windows Forms deve avere accesso a un'istanza della `Microsoft.Toolkit.Win32.UI.XamlHost.XamlApplication` classe fornita da Windows community Toolkit.</span><span class="sxs-lookup"><span data-stu-id="51aa8-282">Your WPF or Windows Forms project must have access to an instance of the `Microsoft.Toolkit.Win32.UI.XamlHost.XamlApplication` class provided by the Windows Community Toolkit.</span></span> <span data-ttu-id="51aa8-283">Questo oggetto funge da provider di metadati radice per il caricamento dei metadati per i tipi XAML UWP personalizzati negli assembly nella directory corrente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="51aa8-283">This object acts as a root metadata provider for loading metadata for custom UWP XAML types in assemblies in the current directory of your application.</span></span> <span data-ttu-id="51aa8-284">Il metodo consigliato per eseguire questa operazione consiste nell'aggiungere un progetto app vuota (Windows universale) alla stessa soluzione del progetto WPF o Windows Forms e rivedere la classe app predefinita in questo progetto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-284">The recommended way to do this is to add a Blank App (Universal Windows) project to the same solution as your WPF or Windows Forms project and revise the default App class in this project.</span></span>

<span data-ttu-id="51aa8-285">Il controllo XAML UWP personalizzato può essere incluso in questa app UWP o in un progetto di libreria di classi UWP indipendente a cui si fa riferimento nella stessa soluzione del progetto WPF o Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="51aa8-285">The custom UWP XAML control can be included on this UWP app or in an independent UWP Class Library project that you reference in the same solution as your WPF or Windows Forms project.</span></span>

<span data-ttu-id="51aa8-286">È possibile controllare una descrizione dettagliata del processo:</span><span class="sxs-lookup"><span data-stu-id="51aa8-286">You can check a detailed step-by-step process description at:</span></span>

<https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands>

#### <a name="the-windows-ui-library-winui-2"></a><span data-ttu-id="51aa8-287">Libreria dell'interfaccia utente di Windows (WinUI 2)</span><span class="sxs-lookup"><span data-stu-id="51aa8-287">The Windows UI Library (WinUI 2)</span></span>

<span data-ttu-id="51aa8-288">Oltre ai controlli della posta in arrivo di Windows 10 forniti con il sistema operativo, lo stesso team UWP XAML fornisce anche controlli aggiuntivi nella libreria dell'interfaccia utente di Windows (**WinUI 2**).</span><span class="sxs-lookup"><span data-stu-id="51aa8-288">Besides the inbox Windows 10 controls that comes with the OS, the same UWP XAML team also deliver additional controls in the Windows UI Library (**WinUI 2**).</span></span> <span data-ttu-id="51aa8-289">WinUI 2 fornisce le funzionalità e i controlli dell'interfaccia utente nativi Microsoft per le app UWP di Windows e questi controlli possono essere usati all'interno delle isole XAML.</span><span class="sxs-lookup"><span data-stu-id="51aa8-289">WinUI 2 provides official native Microsoft UI controls and features for Windows UWP apps and these controls can be used inside of XAML Islands.</span></span>

<span data-ttu-id="51aa8-290">WinUI 2 è open source ed è possibile trovare informazioni in <https://github.com/microsoft/microsoft-ui-xaml> .</span><span class="sxs-lookup"><span data-stu-id="51aa8-290">WinUI 2 is open source and you can find information at <https://github.com/microsoft/microsoft-ui-xaml>.</span></span>

<span data-ttu-id="51aa8-291">Nell'articolo seguente viene illustrato come ospitare un controllo XAML UWP dalla libreria WinUI 2:<https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands></span><span class="sxs-lookup"><span data-stu-id="51aa8-291">The following article demonstrates how to host a UWP XAML control from the WinUI 2 library: <https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands></span></span>

### <a name="do-you-need-xaml-islands"></a><span data-ttu-id="51aa8-292">Sono necessarie le isole XAML</span><span class="sxs-lookup"><span data-stu-id="51aa8-292">Do you need XAML Islands</span></span>

<span data-ttu-id="51aa8-293">Le isole XAML sono destinate alle app Win32 esistenti che vogliono migliorare l'esperienza utente sfruttando i nuovi controlli e comportamenti di UWP senza una riscrittura completa dell'app.</span><span class="sxs-lookup"><span data-stu-id="51aa8-293">XAML Islands are intended for existing Win32 apps that want to improve their user experience by leveraging new UWP controls and behaviors without a full rewrite of the app.</span></span> <span data-ttu-id="51aa8-294">È già possibile [sfruttare le API di Windows 10](/windows/uwp/porting/desktop-to-uwp-enhance), ma fino a quando non le isole XAML, solo le API correlate all'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="51aa8-294">You could already [leverage Windows 10 APIs](/windows/uwp/porting/desktop-to-uwp-enhance), but up until XAML Islands, only non-UI related APIs.</span></span>

<span data-ttu-id="51aa8-295">Se si sta sviluppando una nuova app di Windows, un' [app UWP](/windows/uwp/get-started/universal-application-platform-guide)   è probabilmente l'approccio giusto.</span><span class="sxs-lookup"><span data-stu-id="51aa8-295">If you're developing a new Windows App, a [UWP App](/windows/uwp/get-started/universal-application-platform-guide) is probably the right approach.</span></span>

### <a name="the-road-ahead-xaml-islands-winui-30"></a><span data-ttu-id="51aa8-296">Le isole XAML per la strada avanti: WinUI 3,0</span><span class="sxs-lookup"><span data-stu-id="51aa8-296">The road ahead XAML Islands: WinUI 3.0</span></span>

<span data-ttu-id="51aa8-297">Poiché Windows 8, la piattaforma dell'interfaccia utente di Windows, tra cui il Framework dell'interfaccia utente XAML, il livello di composizione visiva e l'elaborazione dell'input è stato fornito come parte integrante di Windows.</span><span class="sxs-lookup"><span data-stu-id="51aa8-297">Since Windows 8, the Windows UI platform, including the XAML UI framework, visual composition layer, and input processing has been shipped as an integral part of Windows.</span></span> <span data-ttu-id="51aa8-298">Ciò significa che per trarre vantaggio dai miglioramenti più recenti sulle tecnologie dell'interfaccia utente, è necessario eseguire l'aggiornamento alla versione più recente dell'interfaccia utente, rallentando la velocità di innovazione durante lo sviluppo delle app.</span><span class="sxs-lookup"><span data-stu-id="51aa8-298">This means that to benefit from the latest improvements on UI technologies, you must upgrade to the latest version of the UI, slowing down the pace of innovation when you develop your apps.</span></span> <span data-ttu-id="51aa8-299">Per separare questi due cicli di evoluzione e promuovere l'innovazione, Microsoft lavora attivamente sul progetto WinUI.</span><span class="sxs-lookup"><span data-stu-id="51aa8-299">To decouple these two evolution cycles and foster innovation, Microsoft is actively working on the WinUI project.</span></span>

<span data-ttu-id="51aa8-300">A partire da WinUI 2 in 2018, Microsoft ha iniziato a distribuire alcuni nuovi controlli e funzionalità dell'interfaccia utente XAML come pacchetti NuGet distinti che si basano su UWP SDK.</span><span class="sxs-lookup"><span data-stu-id="51aa8-300">Starting with WinUI 2 in 2018, Microsoft started shipping some new XAML UI controls and features as separate NuGet packages that build on top of the UWP SDK.</span></span>

![Struttura di WinUI 2,0](./media/windows-migration/winui2.png)

<span data-ttu-id="51aa8-302">WinUI 3 è in fase di sviluppo attivo e espande in modo sostanziale l'ambito di WinUI per includere la piattaforma dell'interfaccia utente completa, che verrà completamente disaccoppiata da UWP SDK:</span><span class="sxs-lookup"><span data-stu-id="51aa8-302">WinUI 3 is under active development and will greatly expand the scope of WinUI to include the full UI platform, which will be fully decoupled from the UWP SDK:</span></span>

![Struttura di WinUI 3,0](./media/windows-migration/winui3.png)

<span data-ttu-id="51aa8-304">Il framework XAML verrà ora sviluppato su GitHub e distribuito fuori banda come pacchetti [NuGet](/nuget/what-is-nuget)   .</span><span class="sxs-lookup"><span data-stu-id="51aa8-304">XAML framework will now be developed on GitHub and shipped out of band as [NuGet](/nuget/what-is-nuget) packages.</span></span>

<span data-ttu-id="51aa8-305">Le API XAML UWP esistenti che vengono fornite come parte del sistema operativo non riceveranno più gli aggiornamenti delle nuove funzionalità.</span><span class="sxs-lookup"><span data-stu-id="51aa8-305">The existing UWP XAML APIs that ship as part of the OS will no longer receive new feature updates.</span></span> <span data-ttu-id="51aa8-306">Riceveranno comunque gli aggiornamenti della sicurezza e le correzioni critiche in base al ciclo di vita del supporto di Windows 10.</span><span class="sxs-lookup"><span data-stu-id="51aa8-306">They will still receive security updates and critical fixes according to the Windows 10 support lifecycle.</span></span>

<span data-ttu-id="51aa8-307">Il piattaforma UWP (Universal Windows Platform) contiene solo il framework XAML (ad esempio, il modello di applicazione e di sicurezza, la pipeline multimediale, le integrazioni della shell di Xbox e Windows 10, il supporto di dispositivi ampi) e continueranno a evolversi.</span><span class="sxs-lookup"><span data-stu-id="51aa8-307">The Universal Windows Platform contains more than just the XAML framework (for example, application and security model, media pipeline, Xbox and Windows 10 shell integrations, broad device support) and will continue to evolve.</span></span> <span data-ttu-id="51aa8-308">Tutte le nuove funzionalità XAML verranno sviluppate e fornite come parte di WinUI.</span><span class="sxs-lookup"><span data-stu-id="51aa8-308">All new XAML features will just be developed and ship as part of WinUI instead.</span></span>

#### <a name="winui-3-in-desktop-app-and-winui-xaml-islands"></a><span data-ttu-id="51aa8-309">WinUI 3 nell'app desktop e nelle isole WinUI XAML</span><span class="sxs-lookup"><span data-stu-id="51aa8-309">WinUI 3 in desktop app and WinUI XAML Islands</span></span>

<span data-ttu-id="51aa8-310">Come si può notare, WinUI 3 è l'evoluzione di UWP XAML e funziona in modo naturale nel modello di app UWP e in tutti i relativi requisiti (ID pacchetto MSIX, sandbox, CoreWindow e così via).</span><span class="sxs-lookup"><span data-stu-id="51aa8-310">As you can see, WinUI 3 is the evolution of UWP XAML and it works naturally within the UWP app model and all its requirements (MSIX packaged ID, sandbox, CoreWindow, and so on.</span></span> <span data-ttu-id="51aa8-311">Per usare solo WinUI 3 in un modello di app Win32, il contenuto di WinUI deve essere ospitato da un altro framework dell'interfaccia utente (Windows Forms, WPF e così via) usando le **isole XAML di WinUI**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-311">To use just WinUI 3 in a Win32 app model, the WinUI content should be hosted by another UI Framework (Windows Forms, WPF, and so on) using **WinUI XAML Islands**.</span></span> <span data-ttu-id="51aa8-312">Questo è il percorso giusto se si vuole sviluppare le tecnologie per app e combinazioni.</span><span class="sxs-lookup"><span data-stu-id="51aa8-312">This is the right path if you want to evolve your app and mix technologies.</span></span> <span data-ttu-id="51aa8-313">Tuttavia, se si vuole sostituire l'intera interfaccia utente precedente per WinUI, l'app non deve caricare i Framework dell'interfaccia utente per ospitare solo WinUI.</span><span class="sxs-lookup"><span data-stu-id="51aa8-313">However, if you want to replace your entire old UI for WinUI, your app shouldn't load UI Frameworks for just hosting WinUI.</span></span>

<span data-ttu-id="51aa8-314">WinUI 3 affronterà questo feedback critico aggiungendo **WinUI nelle app desktop**.</span><span class="sxs-lookup"><span data-stu-id="51aa8-314">WinUI 3 will address this critical feedback adding **WinUI in desktop apps**.</span></span> <span data-ttu-id="51aa8-315">In questo modo le app Win32 possono usare WinUI 3 come Framework di interfaccia utente autonomo; non è necessario caricare Windows Forms o WPF.</span><span class="sxs-lookup"><span data-stu-id="51aa8-315">This will allow that Win32 apps can use WinUI 3 as standalone UI Framework; no need to load Windows Forms or WPF.</span></span>

<span data-ttu-id="51aa8-316">All'interno di questa aggregazione, WinUI 3 consente agli sviluppatori di combinare facilmente le combinazioni corrette tra le seguenti:</span><span class="sxs-lookup"><span data-stu-id="51aa8-316">Within this aggregation, WinUI 3 will let developers easily mix and match the right combination of:</span></span>

* <span data-ttu-id="51aa8-317">Modello di app: UWP, Win32</span><span class="sxs-lookup"><span data-stu-id="51aa8-317">App model: UWP, Win32</span></span>
* <span data-ttu-id="51aa8-318">Piattaforma: .NET Core o nativo</span><span class="sxs-lookup"><span data-stu-id="51aa8-318">Platform: .NET Core or Native</span></span>
* <span data-ttu-id="51aa8-319">Lingua: .NET (C \# , Visual Basic), C++ standard</span><span class="sxs-lookup"><span data-stu-id="51aa8-319">Language: .NET (C\#, Visual Basic), standard C++</span></span>
* <span data-ttu-id="51aa8-320">Creazione di pacchetti: MSIX, AppX per la Microsoft Store, non in pacchetto</span><span class="sxs-lookup"><span data-stu-id="51aa8-320">Packaging: MSIX, AppX for the Microsoft Store, unpackaged</span></span>
* <span data-ttu-id="51aa8-321">Interoperabilità: usare WinUI 3 per estendere le app WPF, WinForms e MFC esistenti usando le isole XAML di WinUI.</span><span class="sxs-lookup"><span data-stu-id="51aa8-321">Interop: use WinUI 3 to extend existing WPF, WinForms, and MFC apps using WinUI XAML Islands.</span></span>

<span data-ttu-id="51aa8-322">Per ulteriori informazioni, Microsoft condivide questa guida di orientamento in <https://github.com/microsoft/microsoft-ui-xaml/blob/master/docs/roadmap.md> .</span><span class="sxs-lookup"><span data-stu-id="51aa8-322">If you want to know more details, Microsoft is sharing this roadmap in <https://github.com/microsoft/microsoft-ui-xaml/blob/master/docs/roadmap.md>.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="51aa8-323">[Precedente](migrate-modern-applications.md) 
> [Avanti](example-migration-core.md)</span><span class="sxs-lookup"><span data-stu-id="51aa8-323">[Previous](migrate-modern-applications.md)
[Next](example-migration-core.md)</span></span>
