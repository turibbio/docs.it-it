---
title: Configurazione centralizzata
description: Centralizzazione della configurazione per le applicazioni native del cloud usando app Azure configurazione e l'insieme di credenziali AzureKey.
ms.date: 04/19/2020
ms.openlocfilehash: 53bdc03370b04af4d830fe7abbd8aebad81e9650
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895649"
---
# <a name="centralized-configuration"></a><span data-ttu-id="273c5-103">Configurazione centralizzata</span><span class="sxs-lookup"><span data-stu-id="273c5-103">Centralized configuration</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="273c5-104">A differenza di un'app monolitica in cui tutto viene eseguito all'interno di una singola istanza, un'applicazione nativa del cloud è costituita da servizi indipendenti distribuiti tra macchine virtuali, contenitori e aree geografiche.</span><span class="sxs-lookup"><span data-stu-id="273c5-104">Unlike a monolithic app in which everything runs within a single instance, a cloud-native application consists of independent services distributed across virtual machines, containers, and geographic regions.</span></span> <span data-ttu-id="273c5-105">La gestione delle impostazioni di configurazione per decine di servizi interdipendenti può risultare complessa.</span><span class="sxs-lookup"><span data-stu-id="273c5-105">Managing configuration settings for dozens of interdependent services can be challenging.</span></span> <span data-ttu-id="273c5-106">Le copie duplicate delle impostazioni di configurazione in posizioni diverse sono soggette a errori e difficili da gestire.</span><span class="sxs-lookup"><span data-stu-id="273c5-106">Duplicate copies of configuration settings across different locations is error prone and difficult to manage.</span></span> <span data-ttu-id="273c5-107">La configurazione centralizzata è un requisito fondamentale per le applicazioni distribuite native del cloud.</span><span class="sxs-lookup"><span data-stu-id="273c5-107">Centralized configuration is a critical requirement for distributed cloud-native applications.</span></span>

<span data-ttu-id="273c5-108">Come illustrato nel [capitolo 1](introduction.md), le raccomandazioni per le app a dodici fattori richiedono una separazione rigorosa tra il codice e la configurazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-108">As discussed in [Chapter 1](introduction.md), the Twelve-Factor App recommendations require strict separation between code and configuration.</span></span> <span data-ttu-id="273c5-109">La configurazione deve essere archiviata esternamente dall'applicazione e deve essere letta in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="273c5-109">Configuration must be stored externally from the application and read-in as needed.</span></span> <span data-ttu-id="273c5-110">L'archiviazione dei valori di configurazione come costanti o valori letterali nel codice è una violazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-110">Storing configuration values as constants or literal values in code is a violation.</span></span> <span data-ttu-id="273c5-111">Gli stessi valori di configurazione vengono spesso usati da molti servizi nella stessa applicazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-111">The same configuration values are often be used by many services in the same application.</span></span> <span data-ttu-id="273c5-112">Inoltre, è necessario supportare gli stessi valori in più ambienti, ad esempio sviluppo, test e produzione.</span><span class="sxs-lookup"><span data-stu-id="273c5-112">Additionally, we must support the same values across multiple environments, such as dev, testing, and production.</span></span> <span data-ttu-id="273c5-113">La procedura consigliata è archiviarli in un archivio di configurazione centralizzato.</span><span class="sxs-lookup"><span data-stu-id="273c5-113">The best practice is store them in a centralized configuration store.</span></span>

<span data-ttu-id="273c5-114">Il cloud di Azure presenta diverse opzioni eccezionali.</span><span class="sxs-lookup"><span data-stu-id="273c5-114">The Azure cloud presents several great options.</span></span>

## <a name="azure-app-configuration"></a><span data-ttu-id="273c5-115">Configurazione app di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-115">Azure App Configuration</span></span>

<span data-ttu-id="273c5-116">[App Azure configurazione](https://docs.microsoft.com/azure/azure-app-configuration/overview) è un servizio di Azure completamente gestito che archivia le impostazioni di configurazione non segrete in una posizione sicura e centralizzata.</span><span class="sxs-lookup"><span data-stu-id="273c5-116">[Azure App Configuration](https://docs.microsoft.com/azure/azure-app-configuration/overview) is a fully managed Azure service that stores non-secret configuration settings in a secure, centralized location.</span></span> <span data-ttu-id="273c5-117">I valori archiviati possono essere condivisi tra più servizi e applicazioni.</span><span class="sxs-lookup"><span data-stu-id="273c5-117">Stored values can be shared among multiple services and applications.</span></span>

<span data-ttu-id="273c5-118">Il servizio è semplice da usare e offre diversi vantaggi:</span><span class="sxs-lookup"><span data-stu-id="273c5-118">The service is simple to use and provides several benefits:</span></span>

- <span data-ttu-id="273c5-119">Rappresentazioni e mapping flessibili di chiave/valore</span><span class="sxs-lookup"><span data-stu-id="273c5-119">Flexible key/value representations and mappings</span></span>
- <span data-ttu-id="273c5-120">Assegnazione di tag con etichette di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-120">Tagging with Azure labels</span></span>
- <span data-ttu-id="273c5-121">Interfaccia utente dedicata per la gestione</span><span class="sxs-lookup"><span data-stu-id="273c5-121">Dedicated UI for management</span></span>
- <span data-ttu-id="273c5-122">Crittografia delle informazioni riservate</span><span class="sxs-lookup"><span data-stu-id="273c5-122">Encryption of sensitive information</span></span>
- <span data-ttu-id="273c5-123">Esecuzione di query e recupero batch</span><span class="sxs-lookup"><span data-stu-id="273c5-123">Querying and batch retrieval</span></span>

<span data-ttu-id="273c5-124">App Azure configurazione mantiene le modifiche apportate alle impostazioni chiave-valore per sette giorni.</span><span class="sxs-lookup"><span data-stu-id="273c5-124">Azure App Configuration maintains changes made to key-value settings for seven days.</span></span> <span data-ttu-id="273c5-125">La funzionalità snapshot temporizzato consente di ricostruire la cronologia di un'impostazione e persino di eseguire il rollback per una distribuzione non riuscita.</span><span class="sxs-lookup"><span data-stu-id="273c5-125">The point-in-time snapshot feature enables you to reconstruct the history of a setting and even rollback for a failed deployment.</span></span>

<span data-ttu-id="273c5-126">La configurazione dell'app memorizza automaticamente nella cache ogni impostazione per evitare chiamate eccessive all'archivio di configurazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-126">App Configuration automatically caches each setting to avoid excessive calls to the configuration store.</span></span> <span data-ttu-id="273c5-127">L'operazione di aggiornamento resta in attesa fino a quando il valore memorizzato nella cache di un'impostazione non scade per aggiornare tale impostazione, anche quando il relativo valore viene modificato nell'archivio di configurazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-127">The refresh operation waits until the cached value of a setting expires to update that setting, even when its value changes in the configuration store.</span></span> <span data-ttu-id="273c5-128">La scadenza predefinita della cache è 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="273c5-128">The default cache expiration time is 30 seconds.</span></span> <span data-ttu-id="273c5-129">È possibile eseguire l'override dell'ora di scadenza.</span><span class="sxs-lookup"><span data-stu-id="273c5-129">You can override the expiration time.</span></span>

<span data-ttu-id="273c5-130">La configurazione dell'app crittografa tutti i valori di configurazione in transito e inattivi.</span><span class="sxs-lookup"><span data-stu-id="273c5-130">App Configuration encrypts all configuration values in transit and at rest.</span></span> <span data-ttu-id="273c5-131">I nomi delle chiavi e le etichette vengono usati come indici per il recupero dei dati di configurazione e non vengono crittografati.</span><span class="sxs-lookup"><span data-stu-id="273c5-131">Key names and labels are used as indexes for retrieving configuration data and aren't encrypted.</span></span>

<span data-ttu-id="273c5-132">Sebbene la configurazione dell'app fornisca sicurezza avanzata, Azure Key Vault rappresenta comunque il posto migliore per l'archiviazione dei segreti delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="273c5-132">Although App Configuration provides hardened security, Azure Key Vault is still the best place for storing application secrets.</span></span> <span data-ttu-id="273c5-133">Key Vault fornisce la crittografia a livello di hardware, i criteri di accesso granulari e le operazioni di gestione, ad esempio la rotazione del certificato.</span><span class="sxs-lookup"><span data-stu-id="273c5-133">Key Vault provides hardware-level encryption, granular access policies, and management operations such as certificate rotation.</span></span> <span data-ttu-id="273c5-134">È possibile creare valori di configurazione dell'app che fanno riferimento a segreti archiviati in un Key Vault.</span><span class="sxs-lookup"><span data-stu-id="273c5-134">You can create App Configuration values that reference secrets stored in a Key Vault.</span></span>

## <a name="azure-key-vault"></a><span data-ttu-id="273c5-135">Insieme di credenziali chiave di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-135">Azure Key Vault</span></span>

<span data-ttu-id="273c5-136">Key Vault è un servizio gestito per l'archiviazione e l'accesso in modo sicuro ai segreti.</span><span class="sxs-lookup"><span data-stu-id="273c5-136">Key Vault is a managed service for securely storing and accessing secrets.</span></span> <span data-ttu-id="273c5-137">Un segreto è qualsiasi elemento per cui si vuole controllare rigorosamente l'accesso, ad esempio chiavi API, password o certificati.</span><span class="sxs-lookup"><span data-stu-id="273c5-137">A secret is anything that you want to tightly control access to, such as API keys, passwords, or certificates.</span></span> <span data-ttu-id="273c5-138">Un insieme di credenziali è un gruppo logico di segreti.</span><span class="sxs-lookup"><span data-stu-id="273c5-138">A vault is a logical group of secrets.</span></span>

<span data-ttu-id="273c5-139">Key Vault riduce notevolmente le probabilità di divulgazione accidentale dei segreti.</span><span class="sxs-lookup"><span data-stu-id="273c5-139">Key Vault greatly reduces the chances that secrets may be accidentally leaked.</span></span> <span data-ttu-id="273c5-140">Quando si usa Key Vault, gli sviluppatori di applicazioni non devono più archiviare le informazioni di sicurezza nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-140">When using Key Vault, application developers no longer need to store security information in their application.</span></span> <span data-ttu-id="273c5-141">Questa pratica Elimina la necessità di archiviare queste informazioni all'interno del codice.</span><span class="sxs-lookup"><span data-stu-id="273c5-141">This practice eliminates the need to store this information inside your code.</span></span> <span data-ttu-id="273c5-142">Ad esempio, per un'applicazione potrebbe essere necessario connettersi a un database.</span><span class="sxs-lookup"><span data-stu-id="273c5-142">For example, an application may need to connect to a database.</span></span> <span data-ttu-id="273c5-143">Invece di archiviare la stringa di connessione nel codice dell'app, è possibile archiviarla in modo sicuro in Key Vault.</span><span class="sxs-lookup"><span data-stu-id="273c5-143">Instead of storing the connection string in the app's code, you can store it securely in Key Vault.</span></span>

<span data-ttu-id="273c5-144">Le applicazioni possono accedere in modo sicuro alle informazioni necessarie tramite URI.</span><span class="sxs-lookup"><span data-stu-id="273c5-144">Your applications can securely access the information they need by using URIs.</span></span> <span data-ttu-id="273c5-145">Questi URI permettono alle applicazioni di recuperare versioni specifiche di un segreto.</span><span class="sxs-lookup"><span data-stu-id="273c5-145">These URIs allow the applications to retrieve specific versions of a secret.</span></span> <span data-ttu-id="273c5-146">Non è necessario scrivere codice personalizzato per proteggere le informazioni segrete archiviate nel Key Vault.</span><span class="sxs-lookup"><span data-stu-id="273c5-146">There's no need to write custom code to protect any of the secret information stored in Key Vault.</span></span>

<span data-ttu-id="273c5-147">L'accesso a Key Vault richiede l'autenticazione e l'autorizzazione del chiamante corrette.</span><span class="sxs-lookup"><span data-stu-id="273c5-147">Access to Key Vault requires proper caller authentication and authorization.</span></span> <span data-ttu-id="273c5-148">In genere, ogni microservizio nativo del cloud usa una combinazione ClientID/ClientSecret.</span><span class="sxs-lookup"><span data-stu-id="273c5-148">Typically, each cloud-native microservice uses a ClientId/ClientSecret combination.</span></span> <span data-ttu-id="273c5-149">È importante che queste credenziali vengano mantenute al di fuori del controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="273c5-149">It's important to keep these credentials outside source control.</span></span> <span data-ttu-id="273c5-150">Una procedura consigliata consiste nell'impostarli nell'ambiente dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="273c5-150">A best practice is to set them in  the application's environment.</span></span> <span data-ttu-id="273c5-151">L'accesso diretto a Key Vault da AKS può essere eseguito usando [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span><span class="sxs-lookup"><span data-stu-id="273c5-151">Direct access to Key Vault from AKS can be achieved using [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span></span>

## <a name="configuration-in-eshop"></a><span data-ttu-id="273c5-152">Configurazione in eShop</span><span class="sxs-lookup"><span data-stu-id="273c5-152">Configuration in eShop</span></span>

<span data-ttu-id="273c5-153">L'applicazione eShopOnContainers include i file di impostazioni dell'applicazione locale con ogni microservizio.</span><span class="sxs-lookup"><span data-stu-id="273c5-153">The eShopOnContainers application includes local application settings files with each microservice.</span></span> <span data-ttu-id="273c5-154">Questi file vengono archiviati nel controllo del codice sorgente, ma non includono i segreti di produzione, ad esempio le stringhe di connessione o le chiavi API.</span><span class="sxs-lookup"><span data-stu-id="273c5-154">These files are checked into source control, but don't include production secrets such as connection strings or API keys.</span></span> <span data-ttu-id="273c5-155">In produzione, le singole impostazioni possono essere sovrascritte con le variabili di ambiente per servizio.</span><span class="sxs-lookup"><span data-stu-id="273c5-155">In production, individual settings may be overwritten with per-service environment variables.</span></span> <span data-ttu-id="273c5-156">L'inserimento di segreti nelle variabili di ambiente è una pratica comune per le applicazioni ospitate, ma non fornisce un archivio di configurazione centrale.</span><span class="sxs-lookup"><span data-stu-id="273c5-156">Injecting secrets in environment variables is a common practice for hosted applications, but doesn't provide a central configuration store.</span></span> <span data-ttu-id="273c5-157">Per supportare la gestione centralizzata delle impostazioni di configurazione, ogni microservizio include un'impostazione che consente di alternare l'uso di impostazioni locali o Azure Key Vault impostazioni.</span><span class="sxs-lookup"><span data-stu-id="273c5-157">To support centralized management of configuration settings, each microservice includes a setting to toggle between its use of local settings or Azure Key Vault settings.</span></span>

## <a name="references"></a><span data-ttu-id="273c5-158">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="273c5-158">References</span></span>

- [<span data-ttu-id="273c5-159">Architettura eShopOnContainers</span><span class="sxs-lookup"><span data-stu-id="273c5-159">The eShopOnContainers Architecture</span></span>](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Architecture)
- [<span data-ttu-id="273c5-160">Orchestrazione di microservizi e applicazioni a più contenitori per la scalabilità e la disponibilità elevate</span><span class="sxs-lookup"><span data-stu-id="273c5-160">Orchestrating microservices and multi-container applications for high scalability and availability</span></span>](https://docs.microsoft.com/dotnet/architecture/microservices/architect-microservice-container-applications/scalable-available-multi-container-microservice-applications)
- [<span data-ttu-id="273c5-161">Gestione API di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-161">Azure API Management</span></span>](https://docs.microsoft.com/azure/api-management/api-management-key-concepts)
- [<span data-ttu-id="273c5-162">Panoramica del database SQL di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-162">Azure SQL Database Overview</span></span>](https://docs.microsoft.com/azure/sql-database/sql-database-technical-overview)
- [<span data-ttu-id="273c5-163">Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-163">Azure Cache for Redis</span></span>](https://azure.microsoft.com/services/cache/)
- [<span data-ttu-id="273c5-164">API Azure Cosmos DB per MongoDB</span><span class="sxs-lookup"><span data-stu-id="273c5-164">Azure Cosmos DB's API for MongoDB</span></span>](https://docs.microsoft.com/azure/cosmos-db/mongodb-introduction)
- [<span data-ttu-id="273c5-165">Bus di servizio di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-165">Azure Service Bus</span></span>](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview)
- [<span data-ttu-id="273c5-166">Panoramica di Monitoraggio di Azure</span><span class="sxs-lookup"><span data-stu-id="273c5-166">Azure Monitor overview</span></span>](https://docs.microsoft.com/azure/azure-monitor/overview)
- <span data-ttu-id="273c5-167">[eShopOnContainers: creare un cluster Kubernetes in AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span><span class="sxs-lookup"><span data-stu-id="273c5-167">[eShopOnContainers: Create Kubernetes cluster in AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span></span>
- [<span data-ttu-id="273c5-168">eShopOnContainers: Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="273c5-168">eShopOnContainers: Azure Dev Spaces</span></span>](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Azure-Dev-Spaces)
- [<span data-ttu-id="273c5-169">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="273c5-169">Azure Dev Spaces</span></span>](https://docs.microsoft.com/azure/dev-spaces/about)

>[!div class="step-by-step"]
><span data-ttu-id="273c5-170">[Precedente](deploy-eshoponcontainers-azure.md)
>[successivo](scale-applications.md)</span><span class="sxs-lookup"><span data-stu-id="273c5-170">[Previous](deploy-eshoponcontainers-azure.md)
[Next](scale-applications.md)</span></span>
