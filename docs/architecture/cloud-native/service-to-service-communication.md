---
title: Comunicazione da servizio a servizio
description: Scopri come i microservizi back-end nativi cloud comunicano con altri microservizi back-end.
author: robvet
ms.date: 09/09/2019
ms.openlocfilehash: 926be3c2eb4513c89ebcd1f31dceb7d58639dc6f
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/01/2020
ms.locfileid: "80523555"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="bd015-103">Comunicazione da servizio a servizio</span><span class="sxs-lookup"><span data-stu-id="bd015-103">Service-to-service communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="bd015-104">Passando dal client front-end, ora ci rivoliamo ai microservizi back-end comunicano tra loro.</span><span class="sxs-lookup"><span data-stu-id="bd015-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="bd015-105">Quando si costruisce un'applicazione cloud-native, è consigliabile essere sensibili al modo in cui i servizi back-end comunicano tra loro.</span><span class="sxs-lookup"><span data-stu-id="bd015-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="bd015-106">Idealmente, meno comunicazione tra servizi, meglio è.</span><span class="sxs-lookup"><span data-stu-id="bd015-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="bd015-107">Tuttavia, evitare non è sempre possibile in quanto i servizi back-end spesso si basano l'uno sull'altro per completare un'operazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="bd015-108">Esistono diversi approcci ampiamente accettati per l'implementazione della comunicazione tra servizi.</span><span class="sxs-lookup"><span data-stu-id="bd015-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="bd015-109">Il *tipo di interazione di comunicazione* spesso determinerà l'approccio migliore.</span><span class="sxs-lookup"><span data-stu-id="bd015-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="bd015-110">Considerare i seguenti tipi di interazione:</span><span class="sxs-lookup"><span data-stu-id="bd015-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="bd015-111">*Query:* quando un microservizio chiamante richiede una risposta da un microservizio chiamato, ad esempio "Ehi, forniscimi le informazioni sull'acquirente per un determinato ID cliente".</span><span class="sxs-lookup"><span data-stu-id="bd015-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="bd015-112">*Comando:* quando il microservizio chiamante necessita di un altro microservizio per eseguire un'azione ma non richiede una risposta, ad esempio "Ehi, spedisci questo ordine".</span><span class="sxs-lookup"><span data-stu-id="bd015-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="bd015-113">*Evento:* quando un microservizio, denominato editore, genera un evento che lo stato è stato modificato o si è verificata un'azione.</span><span class="sxs-lookup"><span data-stu-id="bd015-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="bd015-114">Altri microservizi, denominati sottoscrittori, interessati, possono reagire all'evento in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="bd015-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="bd015-115">Il server di pubblicazione e gli abbonati non sono a conoscenza l'uno dell'altro.</span><span class="sxs-lookup"><span data-stu-id="bd015-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="bd015-116">I sistemi di microservizio usano in genere una combinazione di questi tipi di interazione durante l'esecuzione di operazioni che richiedono l'interazione tra servizi.</span><span class="sxs-lookup"><span data-stu-id="bd015-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="bd015-117">Diamo un'occhiata da vicino a ciascuno e come si potrebbe implementarli.</span><span class="sxs-lookup"><span data-stu-id="bd015-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="bd015-118">Query</span><span class="sxs-lookup"><span data-stu-id="bd015-118">Queries</span></span>

<span data-ttu-id="bd015-119">Molte volte, un microservizio potrebbe essere necessario *eseguire una query* un altro, richiedendo una risposta immediata per completare un'operazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="bd015-120">Un microservizio del carrello della spesa potrebbe aver bisogno di informazioni sui prodotti e di un prezzo per aggiungere un articolo al carrello.</span><span class="sxs-lookup"><span data-stu-id="bd015-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="bd015-121">Esistono diversi approcci per l'implementazione di operazioni di query.</span><span class="sxs-lookup"><span data-stu-id="bd015-121">There are a number of approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="bd015-122">Messaggistica di tipo richiesta/risposta</span><span class="sxs-lookup"><span data-stu-id="bd015-122">Request/Response Messaging</span></span>

<span data-ttu-id="bd015-123">Un'opzione per l'implementazione di questo scenario è che il microservizio back-end chiamante effettui richieste HTTP dirette ai microservizi di cui deve eseguire una query, illustrato nella Figura 4-8.</span><span class="sxs-lookup"><span data-stu-id="bd015-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Comunicazione HTTP diretta](./media/direct-http-communication.png)

<span data-ttu-id="bd015-125">**Figura 4-8**.</span><span class="sxs-lookup"><span data-stu-id="bd015-125">**Figure 4-8**.</span></span> <span data-ttu-id="bd015-126">Comunicazione HTTP diretta</span><span class="sxs-lookup"><span data-stu-id="bd015-126">Direct HTTP communication</span></span>

<span data-ttu-id="bd015-127">Mentre le chiamate HTTP dirette tra microservizi sono relativamente semplici da implementare, è necessario prestare attenzione a ridurre al minimo questa pratica.</span><span class="sxs-lookup"><span data-stu-id="bd015-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="bd015-128">Per iniziare, queste chiamate sono sempre *sincrone* e bloccheranno l'operazione fino a quando non viene restituito un risultato o si scade la richiesta.</span><span class="sxs-lookup"><span data-stu-id="bd015-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="bd015-129">Quelli che un tempo erano autonomi, servizi indipendenti, in grado di evolversi in modo indipendente e di distribuirsi frequentemente, ora diventano accoppiati tra loro.</span><span class="sxs-lookup"><span data-stu-id="bd015-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="bd015-130">Con l'aumento dell'accoppiamento tra i microservizi, i loro benefici architettonici diminuiscono.</span><span class="sxs-lookup"><span data-stu-id="bd015-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="bd015-131">L'esecuzione di una richiesta poco frequente che effettua una singola chiamata HTTP diretta a un altro microservizio potrebbe essere accettabile per alcuni sistemi.</span><span class="sxs-lookup"><span data-stu-id="bd015-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="bd015-132">Tuttavia, le chiamate con volumi elevati che richiamano chiamate HTTP dirette a più microservizi non sono consigliabili.</span><span class="sxs-lookup"><span data-stu-id="bd015-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="bd015-133">Possono aumentare la latenza e influire negativamente sulle prestazioni, la scalabilità e la disponibilità del sistema.</span><span class="sxs-lookup"><span data-stu-id="bd015-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="bd015-134">Ancora peggio, una lunga serie di comunicazioni HTTP dirette può portare a catene profonde e complesse di chiamate di microservizi sincroni, illustrato nella figura 4-9:</span><span class="sxs-lookup"><span data-stu-id="bd015-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Concatenamento di query HTTP](./media/chaining-http-queries.png)

<span data-ttu-id="bd015-136">**Figura 4-9**.</span><span class="sxs-lookup"><span data-stu-id="bd015-136">**Figure 4-9**.</span></span> <span data-ttu-id="bd015-137">Concatenamento di query HTTP</span><span class="sxs-lookup"><span data-stu-id="bd015-137">Chaining HTTP queries</span></span>

<span data-ttu-id="bd015-138">Si può certamente immaginare il rischio nel disegno mostrato nell'immagine precedente.</span><span class="sxs-lookup"><span data-stu-id="bd015-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="bd015-139">Cosa succede \#se il passaggio 3 non riesce?</span><span class="sxs-lookup"><span data-stu-id="bd015-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="bd015-140">O \#il passaggio 8 non riesce?</span><span class="sxs-lookup"><span data-stu-id="bd015-140">Or Step \#8 fails?</span></span> <span data-ttu-id="bd015-141">Come si fa a recuperare?</span><span class="sxs-lookup"><span data-stu-id="bd015-141">How do you recover?</span></span> <span data-ttu-id="bd015-142">Cosa succede \#se il passaggio 6 è lento perché il servizio sottostante è occupato?</span><span class="sxs-lookup"><span data-stu-id="bd015-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="bd015-143">Come si continua?</span><span class="sxs-lookup"><span data-stu-id="bd015-143">How do you continue?</span></span> <span data-ttu-id="bd015-144">Anche se tutto funziona correttamente, pensare alla latenza che questa chiamata comporterebbe, che è la somma della latenza di ogni passaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="bd015-145">Il grande grado di accoppiamento nell'immagine precedente suggerisce che i servizi non sono stati modellati in modo ottimale.</span><span class="sxs-lookup"><span data-stu-id="bd015-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="bd015-146">Sarebbe doveroso che il team rivisiti il loro design.</span><span class="sxs-lookup"><span data-stu-id="bd015-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="bd015-147">Modello di vista materializzata</span><span class="sxs-lookup"><span data-stu-id="bd015-147">Materialized View pattern</span></span>

<span data-ttu-id="bd015-148">Un'opzione popolare per la rimozione dell'accoppiamento dei microservizi è il [modello Vista materializzata.](https://docs.microsoft.com/azure/architecture/patterns/materialized-view)</span><span class="sxs-lookup"><span data-stu-id="bd015-148">A popular option for removing microservice coupling is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="bd015-149">Con questo modello, un microservizio archivia la propria copia locale denormalizzata dei dati di proprietà di altri servizi.</span><span class="sxs-lookup"><span data-stu-id="bd015-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="bd015-150">Invece del microservizio Shopping Basket che esegue query sui microservizi Product Catalog e Pricing, mantiene la propria copia locale di tali dati.</span><span class="sxs-lookup"><span data-stu-id="bd015-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="bd015-151">Questo modello elimina l'accoppiamento non necessario e migliora l'affidabilità e il tempo di risposta.</span><span class="sxs-lookup"><span data-stu-id="bd015-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="bd015-152">L'intera operazione viene eseguita all'interno di un singolo processo.</span><span class="sxs-lookup"><span data-stu-id="bd015-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="bd015-153">Esaminiamo questo modello e altre preoccupazioni relative ai dati nel capitolo 5.</span><span class="sxs-lookup"><span data-stu-id="bd015-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="bd015-154">Modello di aggregatore di serviziService Aggregator Pattern</span><span class="sxs-lookup"><span data-stu-id="bd015-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="bd015-155">Un'altra opzione per eliminare l'accoppiamento microservizio-microservizio è un [microservizio Aggregator](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), mostrato in viola nella figura 4-10.</span><span class="sxs-lookup"><span data-stu-id="bd015-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span>

![Servizio Aggregatore](./media/aggregator-service.png)

<span data-ttu-id="bd015-157">**Figura 4-10**.</span><span class="sxs-lookup"><span data-stu-id="bd015-157">**Figure 4-10**.</span></span> <span data-ttu-id="bd015-158">Microservizio aggregatore</span><span class="sxs-lookup"><span data-stu-id="bd015-158">Aggregator microservice</span></span>

<span data-ttu-id="bd015-159">Il modello isola un'operazione che effettua chiamate a più microservizi back-end, centralizzando la logica in un microservizio specializzato.</span><span class="sxs-lookup"><span data-stu-id="bd015-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="bd015-160">Il microservizio dell'aggregatore di estrazione viola nella figura precedente orchestra il flusso di lavoro per l'operazione di estrazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="bd015-161">Include chiamate a diversi microservizi back-end in un ordine in sequenza.</span><span class="sxs-lookup"><span data-stu-id="bd015-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="bd015-162">I dati del flusso di lavoro vengono aggregati e restituiti al chiamante.</span><span class="sxs-lookup"><span data-stu-id="bd015-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="bd015-163">Sebbene implementi ancora chiamate HTTP dirette, il microservizio aggregatore riduce le dipendenze dirette tra i microservizi back-end.</span><span class="sxs-lookup"><span data-stu-id="bd015-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span>

### <a name="requestreply-pattern"></a><span data-ttu-id="bd015-164">Modello di richiesta/risposta</span><span class="sxs-lookup"><span data-stu-id="bd015-164">Request/Reply Pattern</span></span>

<span data-ttu-id="bd015-165">Un altro approccio per la disaccoppiamento dei messaggi HTTP sincroni è un modello [di richiesta-risposta](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), che utilizza la comunicazione di accodamento.</span><span class="sxs-lookup"><span data-stu-id="bd015-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="bd015-166">La comunicazione tramite una coda è sempre un canale unidirezionale, con un producer che invia il messaggio e il consumer che lo riceve.</span><span class="sxs-lookup"><span data-stu-id="bd015-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="bd015-167">Con questo modello, vengono implementate sia una coda di richieste che una coda di risposta, illustrata nella Figura 4-11.With this pattern, both a request queue are implemented, both a request queue are implemented, shown in Figure 4-11.</span><span class="sxs-lookup"><span data-stu-id="bd015-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Modello di richiesta-risposta](./media/request-reply-pattern.png)

<span data-ttu-id="bd015-169">**Figura 4-11**.</span><span class="sxs-lookup"><span data-stu-id="bd015-169">**Figure 4-11**.</span></span> <span data-ttu-id="bd015-170">Modello di richiesta-risposta</span><span class="sxs-lookup"><span data-stu-id="bd015-170">Request-reply pattern</span></span>

<span data-ttu-id="bd015-171">In questo caso, il produttore di messaggi crea un messaggio basato su query che contiene un ID di correlazione univoco e lo inserisce in una coda di richieste.</span><span class="sxs-lookup"><span data-stu-id="bd015-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="bd015-172">Il servizio consumer deaccoda i messaggi, li elabora e inserisce la risposta nella coda di risposta con lo stesso ID di correlazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="bd015-173">Il servizio producer deaccoda il messaggio, lo associa all'ID di correlazione e continua l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="bd015-174">Copriamo le code in dettaglio nella prossima sezione.</span><span class="sxs-lookup"><span data-stu-id="bd015-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="bd015-175">Comandi:</span><span class="sxs-lookup"><span data-stu-id="bd015-175">Commands</span></span>

<span data-ttu-id="bd015-176">Un altro tipo di interazione di comunicazione è un *comando*.</span><span class="sxs-lookup"><span data-stu-id="bd015-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="bd015-177">Un microservizio potrebbe avere bisogno di un altro microservizio per eseguire un'azione.</span><span class="sxs-lookup"><span data-stu-id="bd015-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="bd015-178">Il microservizio Ordering potrebbe richiedere il microservizio Shipping per creare una spedizione per un ordine approvato.</span><span class="sxs-lookup"><span data-stu-id="bd015-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="bd015-179">Nella figura 4-12, un microservizio, denominato Producer, invia un messaggio a un altro microservizio, il consumer, comandandolo a eseguire un'operazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span>

![Interazione dei comandi con una codaCommand interaction with a queue](./media/command-interaction-with-queue.png)

<span data-ttu-id="bd015-181">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="bd015-181">**Figure 4-12**.</span></span> <span data-ttu-id="bd015-182">Interazione dei comandi con una codaCommand interaction with a queue</span><span class="sxs-lookup"><span data-stu-id="bd015-182">Command interaction with a queue</span></span>

<span data-ttu-id="bd015-183">Molto spesso, il Produttore non richiede una risposta e può *sparare e dimenticare* il messaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="bd015-184">Se è necessaria una risposta, il Consumatore invia un messaggio separato a Producer su un altro canale.</span><span class="sxs-lookup"><span data-stu-id="bd015-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="bd015-185">Un messaggio di comando viene inviato in modo asincrono con una coda di messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="bd015-186">supportato da un broker di messaggi leggeri.</span><span class="sxs-lookup"><span data-stu-id="bd015-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="bd015-187">Nel diagramma precedente, notare come una coda separa e separa entrambi i servizi.</span><span class="sxs-lookup"><span data-stu-id="bd015-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="bd015-188">Una coda di messaggi è un costrutto intermedio tramite il quale un producer e un consumer passano un messaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="bd015-189">Le code implementano un modello di messaggistica punto-punto asincrono.</span><span class="sxs-lookup"><span data-stu-id="bd015-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="bd015-190">Il Produttore sa dove un comando deve essere inviato e instrada in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="bd015-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="bd015-191">La coda garantisce che un messaggio venga elaborato esattamente da una delle istanze consumer che stanno leggendo dal canale.</span><span class="sxs-lookup"><span data-stu-id="bd015-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="bd015-192">In questo scenario, il producer o il servizio consumer può aumentare la scalabilità orizzontale senza influire sull'altro.</span><span class="sxs-lookup"><span data-stu-id="bd015-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="bd015-193">Inoltre, le tecnologie possono essere disparate su ogni lato, il che significa che potremmo avere un microservizio Java che chiama un microservizio [Golang.](https://golang.org)</span><span class="sxs-lookup"><span data-stu-id="bd015-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span>

<span data-ttu-id="bd015-194">Nel capitolo 1, abbiamo parlato di servizi di *sostegno*.</span><span class="sxs-lookup"><span data-stu-id="bd015-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="bd015-195">I servizi di supporto sono risorse ausiliarie da cui dipendono i sistemi nativi del cloud.</span><span class="sxs-lookup"><span data-stu-id="bd015-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="bd015-196">Le code di messaggi supportano i servizi di backup.</span><span class="sxs-lookup"><span data-stu-id="bd015-196">Message queues are backing services.</span></span> <span data-ttu-id="bd015-197">Il cloud di Azure supporta due tipi di code di messaggi che i sistemi nativi cloud possono usare per implementare la messaggistica dei comandi: Code di archiviazione di Azure e Code del bus di servizio di Azure.The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span><span class="sxs-lookup"><span data-stu-id="bd015-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="bd015-198">Code di Archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="bd015-198">Azure Storage Queues</span></span>

<span data-ttu-id="bd015-199">Le code di archiviazione di Azure offrono una semplice infrastruttura di accodamento veloce, conveniente e supportata da account di archiviazione di Azure.Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span><span class="sxs-lookup"><span data-stu-id="bd015-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="bd015-200">Le code di archiviazione di [Azure dispongono](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) di un meccanismo di accodamento basato su REST con messaggistica affidabile e persistente.</span><span class="sxs-lookup"><span data-stu-id="bd015-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="bd015-201">Forniscono un set di funzionalità minimo, ma sono poco costosi e archiviano milioni di messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="bd015-202">La loro capacità varia fino a 500 TB.</span><span class="sxs-lookup"><span data-stu-id="bd015-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="bd015-203">Un singolo messaggio può avere una dimensione massima di 64 KB.</span><span class="sxs-lookup"><span data-stu-id="bd015-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="bd015-204">È possibile accedere ai messaggi da qualsiasi parte del mondo tramite chiamate autenticate tramite HTTP o HTTPS.</span><span class="sxs-lookup"><span data-stu-id="bd015-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="bd015-205">Le code di archiviazione possono scalare orizzontalmente a un numero elevato di client simultanei per gestire i picchi di traffico.</span><span class="sxs-lookup"><span data-stu-id="bd015-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="bd015-206">Detto questo, ci sono limitazioni con il servizio:</span><span class="sxs-lookup"><span data-stu-id="bd015-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="bd015-207">L'ordine dei messaggi non è garantito.</span><span class="sxs-lookup"><span data-stu-id="bd015-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="bd015-208">Un messaggio può essere mantenuto solo per sette giorni prima che venga rimosso automaticamente.</span><span class="sxs-lookup"><span data-stu-id="bd015-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="bd015-209">Il supporto per la gestione dello stato, il rilevamento duplicati o le transazioni non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="bd015-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="bd015-210">Nella figura 4-13 viene illustrata la gerarchia di una coda di Archiviazione di Azure.Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span><span class="sxs-lookup"><span data-stu-id="bd015-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Gerarchia delle code di archiviazione](./media/storage-queue-hierarchy.png)

<span data-ttu-id="bd015-212">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="bd015-212">**Figure 4-13**.</span></span> <span data-ttu-id="bd015-213">Gerarchia delle code di archiviazione</span><span class="sxs-lookup"><span data-stu-id="bd015-213">Storage queue hierarchy</span></span>

<span data-ttu-id="bd015-214">Nella figura precedente, prendere nota di come le code di archiviazione archiviano i messaggi nell'account di archiviazione di Azure sottostante.</span><span class="sxs-lookup"><span data-stu-id="bd015-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="bd015-215">Per gli sviluppatori, Microsoft fornisce diverse librerie client e lato server per l'elaborazione della coda di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="bd015-216">La maggior parte delle piattaforme principali sono supportate tra cui .NET, Java, JavaScript, Ruby, Python e Go.</span><span class="sxs-lookup"><span data-stu-id="bd015-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="bd015-217">Gli sviluppatori non devono mai comunicare direttamente con queste librerie.</span><span class="sxs-lookup"><span data-stu-id="bd015-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="bd015-218">In questo modo, il codice del microservizio verrà associato al servizio di coda di Archiviazione di Azure.Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span><span class="sxs-lookup"><span data-stu-id="bd015-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="bd015-219">È consigliabile isolare i dettagli di implementazione dell'API.</span><span class="sxs-lookup"><span data-stu-id="bd015-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="bd015-220">Introdurre un livello di intermediazione, o API intermedia, che espone operazioni generiche e incapsula la libreria concreta.</span><span class="sxs-lookup"><span data-stu-id="bd015-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="bd015-221">Questo accoppiamento libero consente di scambiare un servizio di accodamento con un altro senza dover apportare modifiche al codice del servizio principale.</span><span class="sxs-lookup"><span data-stu-id="bd015-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span>

<span data-ttu-id="bd015-222">Le code di Archiviazione di Azure sono un'opzione economica per implementare la messaggistica dei comandi nelle applicazioni native cloud.</span><span class="sxs-lookup"><span data-stu-id="bd015-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="bd015-223">Soprattutto quando una dimensione della coda supererà gli 80 GB o un semplice set di funzionalità è accettabile.</span><span class="sxs-lookup"><span data-stu-id="bd015-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="bd015-224">Si paga solo per l'archiviazione dei messaggi; non ci sono costi orari fissi.</span><span class="sxs-lookup"><span data-stu-id="bd015-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="bd015-225">Code del bus di servizio di Azure</span><span class="sxs-lookup"><span data-stu-id="bd015-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="bd015-226">Per requisiti di messaggistica più complessi, prendere in considerazione le code del bus di servizio di Azure.For more complex messaging requirements, consider Azure Service Bus queues.</span><span class="sxs-lookup"><span data-stu-id="bd015-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="bd015-227">Seduti in cima a una solida infrastruttura dei messaggi, [il bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) di servizio di Azure supporta un modello di *messaggistica negoziato.*</span><span class="sxs-lookup"><span data-stu-id="bd015-227">Sitting atop a robust message infrastructure, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="bd015-228">I messaggi vengono archiviati in modo affidabile in un broker (la coda) fino alla ricezione dal consumer.</span><span class="sxs-lookup"><span data-stu-id="bd015-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="bd015-229">La coda garantisce il recapito dei messaggi FIFO (First-In/First-Out), rispettando l'ordine in cui i messaggi sono stati aggiunti alla coda.</span><span class="sxs-lookup"><span data-stu-id="bd015-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="bd015-230">La dimensione di un messaggio può essere molto più grande, fino a 256 KB.</span><span class="sxs-lookup"><span data-stu-id="bd015-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="bd015-231">I messaggi vengono mantenuti nella coda per un periodo di tempo illimitato.</span><span class="sxs-lookup"><span data-stu-id="bd015-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="bd015-232">Il bus di servizio supporta non solo le chiamate basate su HTTP, ma fornisce anche il supporto completo per il [protocollo AMPQ.](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview)</span><span class="sxs-lookup"><span data-stu-id="bd015-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMPQ protocol](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="bd015-233">AMPQ è uno standard aperto tra i fornitori che supporta un protocollo binario e livelli di affidabilità più elevati.</span><span class="sxs-lookup"><span data-stu-id="bd015-233">AMPQ is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="bd015-234">Il bus di servizio offre un set completo di funzionalità, tra cui il supporto delle [transazioni](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) e una funzionalità di [rilevamento duplicati.](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection)</span><span class="sxs-lookup"><span data-stu-id="bd015-234">Service Bus provides a rich set of features, including [transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="bd015-235">La coda garantisce "al massimo il recapito" per messaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="bd015-236">Elimina automaticamente un messaggio già inviato.</span><span class="sxs-lookup"><span data-stu-id="bd015-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="bd015-237">Se un producer è in dubbio, può inviare nuovamente lo stesso messaggio e il bus di servizio garantisce che verrà elaborata una sola copia.</span><span class="sxs-lookup"><span data-stu-id="bd015-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="bd015-238">Il rilevamento duplicati ti evita di dover creare ulteriori impianti idraulici dell'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="bd015-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="bd015-239">Altre due funzionalità aziendali sono il partizionamento e le sessioni.</span><span class="sxs-lookup"><span data-stu-id="bd015-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="bd015-240">Una coda del bus di servizio convenzionale viene gestita da un singolo broker di messaggi e archiviata in un singolo archivio messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="bd015-241">Tuttavia, [il partizionamento](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) del bus di servizio distribuisce la coda tra più broker di messaggi e archivi messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-241">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="bd015-242">La velocità effettiva complessiva non è più limitata dalle prestazioni di un singolo broker di messaggi o di un archivio di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="bd015-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="bd015-243">Un'interruzione temporanea di un archivio di messaggistica non rende non disponibile una coda partizionata.</span><span class="sxs-lookup"><span data-stu-id="bd015-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="bd015-244">[Le sessioni del bus](https://codingcanvas.com/azure-service-bus-sessions/) di servizio consentono di raggruppare i messaggi relativi ai gruppi.</span><span class="sxs-lookup"><span data-stu-id="bd015-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="bd015-245">Si immagini uno scenario di flusso di lavoro in cui i messaggi devono essere elaborati insieme e l'operazione completata alla fine.</span><span class="sxs-lookup"><span data-stu-id="bd015-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="bd015-246">Per sfruttare i vantaggi, le sessioni devono essere abilitate in modo esplicito per la coda e ogni messaggio correlato deve contenere lo stesso ID di sessione.</span><span class="sxs-lookup"><span data-stu-id="bd015-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="bd015-247">Tuttavia, ci sono alcuni avvertimenti importanti: le code del bus di servizio sono limitate a 80 GB, che è molto più piccolo di quello disponibile dalle code dell'archivio.</span><span class="sxs-lookup"><span data-stu-id="bd015-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="bd015-248">Inoltre, le code del bus di servizio comportano un costo di base e un addebito per operazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="bd015-249">Nella figura 4-14 viene descritta l'architettura di alto livello di una coda del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="bd015-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![Coda del bus di servizio](./media/service-bus-queue.png)

<span data-ttu-id="bd015-251">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="bd015-251">**Figure 4-14**.</span></span> <span data-ttu-id="bd015-252">Coda del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="bd015-252">Service Bus queue</span></span>

<span data-ttu-id="bd015-253">Nella figura precedente, prendere nota della relazione punto-punto.</span><span class="sxs-lookup"><span data-stu-id="bd015-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="bd015-254">Due istanze dello stesso provider stanno accodando messaggi in una singola coda del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="bd015-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="bd015-255">Ogni messaggio viene utilizzato da una sola delle tre istanze consumer a destra.</span><span class="sxs-lookup"><span data-stu-id="bd015-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="bd015-256">Successivamente, viene illustrato come implementare la messaggistica in cui utenti diversi possono essere tutti interessati allo stesso messaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="bd015-257">Eventi</span><span class="sxs-lookup"><span data-stu-id="bd015-257">Events</span></span>

<span data-ttu-id="bd015-258">Accodamento messaggi è un modo efficace per implementare la comunicazione in cui un producer può inviare un messaggio a un consumer in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="bd015-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="bd015-259">Tuttavia, cosa succede quando *molti consumatori diversi* sono interessati allo stesso messaggio?</span><span class="sxs-lookup"><span data-stu-id="bd015-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="bd015-260">Una coda di messaggi dedicata per ogni consumer non verrebbe ridimensionata bene e diventerebbe difficile da gestire.</span><span class="sxs-lookup"><span data-stu-id="bd015-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span>

<span data-ttu-id="bd015-261">Per risolvere questo scenario, si passa al terzo tipo di interazione di messaggio, *l'evento*.</span><span class="sxs-lookup"><span data-stu-id="bd015-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="bd015-262">Un microservizio annuncia che si è verificata un'azione.</span><span class="sxs-lookup"><span data-stu-id="bd015-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="bd015-263">Altri microservizi, se interessati, reagiscono all'azione o all'evento.</span><span class="sxs-lookup"><span data-stu-id="bd015-263">Other microservices, if interested, react to the action, or event.</span></span>

<span data-ttu-id="bd015-264">L'evento è un processo in due fasi.</span><span class="sxs-lookup"><span data-stu-id="bd015-264">Eventing is a two-step process.</span></span> <span data-ttu-id="bd015-265">Per una determinata modifica dello stato, un microservizio pubblica un evento in un broker di messaggi, rendendolo disponibile per qualsiasi altro microservizio interessato.</span><span class="sxs-lookup"><span data-stu-id="bd015-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="bd015-266">Il microservizio interessato riceve una notifica sottoscrivendo l'evento nel broker di messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="bd015-267">Utilizzare il modello [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) per implementare la [comunicazione basata su eventi](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span><span class="sxs-lookup"><span data-stu-id="bd015-267">You use the [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="bd015-268">Nella figura 4-15 viene illustrato un microservizio del carrello acquisti che pubblica un evento con altri due microservizi che vi si iscrivono.</span><span class="sxs-lookup"><span data-stu-id="bd015-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Messaggistica basata su eventi](./media/event-driven-messaging.png)

<span data-ttu-id="bd015-270">**Figura 4-15**.</span><span class="sxs-lookup"><span data-stu-id="bd015-270">**Figure 4-15**.</span></span> <span data-ttu-id="bd015-271">Messaggistica basata su eventi</span><span class="sxs-lookup"><span data-stu-id="bd015-271">Event-Driven messaging</span></span>

<span data-ttu-id="bd015-272">Si noti il componente *bus di eventi* che si trova al centro del canale di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="bd015-273">Si tratta di una classe personalizzata che incapsula il broker di messaggi e lo separa dall'applicazione sottostante.</span><span class="sxs-lookup"><span data-stu-id="bd015-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="bd015-274">I microservizi di ordinazione e inventario gestiscono in modo indipendente l'evento senza alcuna conoscenza l'uno dell'altro, né il microservizio del carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="bd015-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="bd015-275">Quando l'evento registrato viene pubblicato nel bus di eventi, agiscono su di esso.</span><span class="sxs-lookup"><span data-stu-id="bd015-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="bd015-276">Con gli eventi, passiamo dalla tecnologia di accodamento agli *argomenti.*</span><span class="sxs-lookup"><span data-stu-id="bd015-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="bd015-277">Un [argomento](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) è simile a una coda, ma supporta un modello di messaggistica uno-a-molti.</span><span class="sxs-lookup"><span data-stu-id="bd015-277">A [topic](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="bd015-278">Un microservizio pubblica un messaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-278">One microservice publishes a message.</span></span> <span data-ttu-id="bd015-279">Più microservizi di sottoscrizione possono scegliere di ricevere e agire in base a tale messaggio.</span><span class="sxs-lookup"><span data-stu-id="bd015-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="bd015-280">Nella figura 4-16 viene illustrata un'architettura di argomenti.</span><span class="sxs-lookup"><span data-stu-id="bd015-280">Figure 4-16 shows a topic architecture.</span></span>

![Architettura dell'argomento](./media/topic-architecture.png)

<span data-ttu-id="bd015-282">**Figura 4-16**.</span><span class="sxs-lookup"><span data-stu-id="bd015-282">**Figure 4-16**.</span></span> <span data-ttu-id="bd015-283">Architettura dell'argomento</span><span class="sxs-lookup"><span data-stu-id="bd015-283">Topic architecture</span></span>

<span data-ttu-id="bd015-284">Nella figura precedente, gli editori inviano messaggi all'argomento.</span><span class="sxs-lookup"><span data-stu-id="bd015-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="bd015-285">Alla fine, i sottoscrittori ricevono messaggi dalle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="bd015-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="bd015-286">Al centro, l'argomento inoltra i messaggi alle sottoscrizioni in base a un set di *regole,* visualizzate in riquadri blu scuro.</span><span class="sxs-lookup"><span data-stu-id="bd015-286">In the middle, the topic forwards messages to subscriptions based on a set of *rules*, shown in dark blue boxes.</span></span> <span data-ttu-id="bd015-287">Le regole fungono da filtro che inoltrano messaggi specifici a una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="bd015-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="bd015-288">In questo caso, un evento "CreateOrder" verrà inviato alla sottoscrizione \#1 e alla sottoscrizione \#3, ma non alla sottoscrizione \#2.</span><span class="sxs-lookup"><span data-stu-id="bd015-288">Here, a "CreateOrder" event would be sent to Subscription \#1 and Subscription \#3, but not to Subscription \#2.</span></span> <span data-ttu-id="bd015-289">Un evento "OrderCompleted" viene \#inviato alla \#sottoscrizione 2 e alla sottoscrizione 3.</span><span class="sxs-lookup"><span data-stu-id="bd015-289">An "OrderCompleted" event would be sent to Subscription \#2 and Subscription \#3.</span></span>

<span data-ttu-id="bd015-290">Il cloud di Azure supporta due diversi servizi di argomento: Argomenti del bus di servizio di Azure e EventGrid di Azure.The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span><span class="sxs-lookup"><span data-stu-id="bd015-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="bd015-291">Argomenti del bus di servizio di Azure</span><span class="sxs-lookup"><span data-stu-id="bd015-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="bd015-292">In cima allo stesso modello di messaggi negoziato robusto delle code del bus di servizio di Azure sono Argomenti del bus di servizio di [Azure.](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions)</span><span class="sxs-lookup"><span data-stu-id="bd015-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="bd015-293">Un argomento può ricevere messaggi da più server di pubblicazione indipendenti e inviare messaggi a un massimo di 2.000 sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="bd015-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="bd015-294">Le sottoscrizioni possono essere aggiunte o rimosse dinamicamente in fase di esecuzione senza arrestare il sistema o ricreare l'argomento.</span><span class="sxs-lookup"><span data-stu-id="bd015-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="bd015-295">Molte funzionalità avanzate delle code del bus di servizio di Azure sono disponibili anche per gli argomenti, tra cui [Il rilevamento duplicati](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) e [il supporto delle transazioni](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span><span class="sxs-lookup"><span data-stu-id="bd015-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) and [Transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="bd015-296">Per impostazione predefinita, gli argomenti del bus di servizio vengono gestiti da un singolo broker di messaggi e archiviati in un singolo archivio messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="bd015-297">Tuttavia, [il partizionamento](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) del bus di servizio ridimensiona un argomento distesa su molti broker di messaggi e archivi messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-297">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="bd015-298">[Il recapito dei messaggi pianificato contrassegna](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) un messaggio con un orario specifico per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-298">[Scheduled Message Delivery](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="bd015-299">Il messaggio non verrà visualizzato nell'argomento prima di tale ora.</span><span class="sxs-lookup"><span data-stu-id="bd015-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="bd015-300">[Il rinvio](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) dei messaggi consente di rinviare il recupero di un messaggio a un momento successivo.</span><span class="sxs-lookup"><span data-stu-id="bd015-300">[Message Deferral](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="bd015-301">Entrambi vengono comunemente utilizzati negli scenari di elaborazione del flusso di lavoro in cui le operazioni vengono elaborate in un ordine specifico.</span><span class="sxs-lookup"><span data-stu-id="bd015-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="bd015-302">È possibile posticipare l'elaborazione dei messaggi ricevuti fino al completamento del lavoro precedente.</span><span class="sxs-lookup"><span data-stu-id="bd015-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="bd015-303">Gli argomenti del bus di servizio sono una tecnologia robusta e collaudata per abilitare la comunicazione di pubblicazione/sottoscrizione nei sistemi nativi del cloud.</span><span class="sxs-lookup"><span data-stu-id="bd015-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="bd015-304">Griglia di eventi di Azure</span><span class="sxs-lookup"><span data-stu-id="bd015-304">Azure Event Grid</span></span>

<span data-ttu-id="bd015-305">Mentre il bus di servizio di Azure è un broker di messaggistica testato in battaglia con un set completo di funzionalità aziendali, [Griglia di](https://docs.microsoft.com/azure/event-grid/overview) eventi di Azure è il nuovo capretto nel blocco.</span><span class="sxs-lookup"><span data-stu-id="bd015-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="bd015-306">A prima vista, Griglia di eventi può apparire come solo un altro sistema di messaggistica basato su argomenti.</span><span class="sxs-lookup"><span data-stu-id="bd015-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="bd015-307">Tuttavia, è diverso in molti modi.</span><span class="sxs-lookup"><span data-stu-id="bd015-307">However, it's different in many ways.</span></span> <span data-ttu-id="bd015-308">Incentrato sui carichi di lavoro basati su eventi, consente l'elaborazione degli eventi in tempo reale, l'integrazione completa di Azure e una piattaforma aperta, il tutto sull'infrastruttura senza server.</span><span class="sxs-lookup"><span data-stu-id="bd015-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="bd015-309">È progettato per applicazioni contemporanee native per il cloud e senza server</span><span class="sxs-lookup"><span data-stu-id="bd015-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="bd015-310">Come *backplane centralizzato*degli eventi, o pipe, Griglia di eventi reagisce agli eventi all'interno delle risorse di Azure e dai propri servizi.</span><span class="sxs-lookup"><span data-stu-id="bd015-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="bd015-311">Le notifiche degli eventi vengono pubblicate in un argomento Griglia di eventi che, a sua volta, indirizza ogni evento a una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="bd015-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="bd015-312">I sottoscrittori eseguono il mapping alle sottoscrizioni e utilizzano gli eventi.</span><span class="sxs-lookup"><span data-stu-id="bd015-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="bd015-313">Come il bus di servizio, Griglia di eventi supporta un modello di *sottoscrittore filtrato* in cui una regola di set di sottoscrizioni per gli eventi che desidera ricevere.</span><span class="sxs-lookup"><span data-stu-id="bd015-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="bd015-314">Griglia di eventi offre una velocità effettiva rapida con una garanzia di 10 milioni di eventi al secondo, consentendo il recapito quasi in tempo reale, molto più di quanto può generare il bus di servizio di Azure.Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - molto more than what Azure Service Bus can generate.</span><span class="sxs-lookup"><span data-stu-id="bd015-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="bd015-315">Un punto debole per Griglia di eventi è la sua profonda integrazione nell'infrastruttura dell'infrastruttura di Azure.A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span><span class="sxs-lookup"><span data-stu-id="bd015-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="bd015-316">Una risorsa di Azure, ad esempio Cosmos DB, può pubblicare eventi predefiniti direttamente in altre risorse di Azure interessate, senza la necessità di codice personalizzato.</span><span class="sxs-lookup"><span data-stu-id="bd015-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="bd015-317">Griglia di eventi può pubblicare eventi da una sottoscrizione di Azure, un gruppo di risorse o un servizio, offrendo agli sviluppatori un controllo granulare sul ciclo di vita delle risorse cloud.</span><span class="sxs-lookup"><span data-stu-id="bd015-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="bd015-318">Tuttavia, Griglia di eventi non è limitata ad Azure.However, Event Grid isn't limited to Azure.</span><span class="sxs-lookup"><span data-stu-id="bd015-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="bd015-319">Si tratta di una piattaforma aperta che può utilizzare eventi HTTP personalizzati pubblicati da applicazioni o servizi di terze parti e indirizzare gli eventi ai sottoscrittori esterni.</span><span class="sxs-lookup"><span data-stu-id="bd015-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="bd015-320">Quando si pubblica noe e si sottoscrive eventi nativi dalle risorse di Azure, non è necessaria alcuna codifica.</span><span class="sxs-lookup"><span data-stu-id="bd015-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="bd015-321">Con la configurazione semplice, è possibile integrare gli eventi da una risorsa di Azure a un'altra sfruttando l'impianto idraulico incorporato per Argomenti e sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="bd015-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="bd015-322">La figura 4-17 mostra l'anatomia della griglia di eventi.</span><span class="sxs-lookup"><span data-stu-id="bd015-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Anatomia della griglia di eventi](./media/event-grid-anatomy.png)

<span data-ttu-id="bd015-324">**Figura 4-17**.</span><span class="sxs-lookup"><span data-stu-id="bd015-324">**Figure 4-17**.</span></span> <span data-ttu-id="bd015-325">Anatomia della griglia di eventi</span><span class="sxs-lookup"><span data-stu-id="bd015-325">Event Grid anatomy</span></span>

<span data-ttu-id="bd015-326">Una differenza importante tra EventGrid e Service Bus è il modello di *scambio*dei messaggi sottostante.</span><span class="sxs-lookup"><span data-stu-id="bd015-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="bd015-327">Il bus di servizio implementa un *modello pull* di stile precedente in cui il sottoscrittore downstream esegue attivamente il polling della sottoscrizione dell'argomento per i nuovi messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="bd015-328">Al rialzo, questo approccio offre all'abbonato il pieno controllo del ritmo con cui elabora i messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="bd015-329">Controlla quando e quanti messaggi elaborare in un determinato momento.</span><span class="sxs-lookup"><span data-stu-id="bd015-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="bd015-330">I messaggi non letti rimangono nella sottoscrizione fino all'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="bd015-331">Una carenza significativa è la latenza tra il momento in cui viene generato l'evento e l'operazione di polling che esegue il pull del messaggio al server di sottoscrizione per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="bd015-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="bd015-332">Inoltre, l'overhead del polling costante per l'evento successivo consuma risorse e denaro.</span><span class="sxs-lookup"><span data-stu-id="bd015-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="bd015-333">EventGrid, tuttavia, è diverso.</span><span class="sxs-lookup"><span data-stu-id="bd015-333">EventGrid, however, is different.</span></span> <span data-ttu-id="bd015-334">Implementa un *modello push* in cui gli eventi vengono inviati a EventHandlers come ricevuti, con recapito quasi in tempo reale degli eventi.</span><span class="sxs-lookup"><span data-stu-id="bd015-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="bd015-335">Riduce inoltre i costi in quanto il servizio viene attivato solo quando è necessario per utilizzare un evento, non continuamente come con il polling.</span><span class="sxs-lookup"><span data-stu-id="bd015-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="bd015-336">Detto questo, un gestore eventi deve gestire il carico in ingresso e fornire meccanismi di limitazione per proteggersi da essere sopraffatto.</span><span class="sxs-lookup"><span data-stu-id="bd015-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="bd015-337">Molti servizi di Azure che utilizzano questi eventi, ad esempio Funzioni di Azure e App per la logica, offrono funzionalità di scalabilità automatica automatica automatica per gestire carichi aumentati.</span><span class="sxs-lookup"><span data-stu-id="bd015-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="bd015-338">Griglia di eventi è un servizio cloud completamente gestito senza server.</span><span class="sxs-lookup"><span data-stu-id="bd015-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="bd015-339">Si ridimensiona dinamicamente in base al traffico e ti addebita solo l'utilizzo effettivo, non la capacità preacquistata.</span><span class="sxs-lookup"><span data-stu-id="bd015-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="bd015-340">Le prime 100.000 operazioni al mese sono gratuite: le operazioni vengono definite come ingresso eventi (notifiche di eventi in ingresso), tentativi di recapito delle sottoscrizioni, chiamate di gestione e filtraggio in base all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="bd015-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="bd015-341">Con una disponibilità del 99,99%, EventGrid garantisce la distribuzione di un evento entro un periodo di 24 ore, con funzionalità di ripetizione dei tentativi incorporate per la consegna non riuscita.</span><span class="sxs-lookup"><span data-stu-id="bd015-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="bd015-342">I messaggi non consegnati possono essere spostati in una coda "lettera morta" per la risoluzione.</span><span class="sxs-lookup"><span data-stu-id="bd015-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="bd015-343">A differenza del bus di servizio di Azure, Griglia di eventi è sintonizzata per ottenere prestazioni veloci e non supporta funzionalità come messaggistica ordinata, transazioni e sessioni.</span><span class="sxs-lookup"><span data-stu-id="bd015-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="bd015-344">Streaming di messaggi nel cloud di AzureStreaming messages in the Azure cloud</span><span class="sxs-lookup"><span data-stu-id="bd015-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="bd015-345">Il bus di servizio di Azure e Griglia di eventi forniscono un ottimo supporto per le applicazioni che espongono singoli eventi discreti come un nuovo documento è stato inserito in un cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="bd015-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document has been inserted into a Cosmos DB.</span></span> <span data-ttu-id="bd015-346">Ma cosa succede se il sistema nativo del cloud deve elaborare un *flusso di eventi correlati?*</span><span class="sxs-lookup"><span data-stu-id="bd015-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="bd015-347">[I flussi di eventi](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) sono più complessi.</span><span class="sxs-lookup"><span data-stu-id="bd015-347">[Event streams](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) are more complex.</span></span> <span data-ttu-id="bd015-348">Sono in genere ordinati nel tempo, sono correlati e devono essere elaborati come gruppo.</span><span class="sxs-lookup"><span data-stu-id="bd015-348">They're typically time-ordered, interrelated, and must be processed as a group.</span></span>

<span data-ttu-id="bd015-349">[Hub eventi di Azure](https://azure.microsoft.com/services/event-hubs/) è una piattaforma di streaming dati e un servizio di inserimento eventi che raccoglie, trasforma e archivia eventi.</span><span class="sxs-lookup"><span data-stu-id="bd015-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="bd015-350">È stata messa a chiave per acquisire i dati di streaming, ad esempio le notifiche di eventi continue generate da un contesto di telemetria.</span><span class="sxs-lookup"><span data-stu-id="bd015-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="bd015-351">Il servizio è altamente scalabile e può archiviare ed [elaborare milioni di eventi al secondo.](https://docs.microsoft.com/azure/event-hubs/event-hubs-about)</span><span class="sxs-lookup"><span data-stu-id="bd015-351">The service is highly scalable and can store and [process millions of events per second](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="bd015-352">Nella figura 4-18, è spesso una porta iniziale per una pipeline di eventi, disaccoppiamento flusso di inserimento dall'utilizzo dell'evento.</span><span class="sxs-lookup"><span data-stu-id="bd015-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![Hub eventi di Azure](./media/azure-event-hub.png)

<span data-ttu-id="bd015-354">**Figura 4-18**.</span><span class="sxs-lookup"><span data-stu-id="bd015-354">**Figure 4-18**.</span></span> <span data-ttu-id="bd015-355">Hub eventi di Azure</span><span class="sxs-lookup"><span data-stu-id="bd015-355">Azure Event Hub</span></span>

<span data-ttu-id="bd015-356">L'Hub eventi supporta una bassa latenza e una conservazione del tempo configurabile.</span><span class="sxs-lookup"><span data-stu-id="bd015-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="bd015-357">A differenza delle code e degli argomenti, gli hub eventi mantengono i dati degli eventi dopo che sono stati letti da un consumer.</span><span class="sxs-lookup"><span data-stu-id="bd015-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="bd015-358">Questa funzionalità consente ad altri servizi di analisi dei dati, sia interni che esterni, di riprodurre i dati per un'ulteriore analisi.</span><span class="sxs-lookup"><span data-stu-id="bd015-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="bd015-359">Gli eventi archiviati nell'hub eventi vengono eliminati solo alla scadenza del periodo di conservazione, che è un giorno per impostazione predefinita, ma configurabile.</span><span class="sxs-lookup"><span data-stu-id="bd015-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="bd015-360">Event Hub supporta protocolli comuni di pubblicazione degli eventi, tra cui HTTPS e AMQP.</span><span class="sxs-lookup"><span data-stu-id="bd015-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="bd015-361">Supporta anche Kafka 1.0.</span><span class="sxs-lookup"><span data-stu-id="bd015-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="bd015-362">[Le applicazioni Kafka esistenti possono comunicare con Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) utilizzando il protocollo Kafka che offre un'alternativa alla gestione di cluster Kafka di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="bd015-362">[Existing Kafka applications can communicate with Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="bd015-363">Molti sistemi cloud-nativi open-source adottano Kafka.</span><span class="sxs-lookup"><span data-stu-id="bd015-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="bd015-364">Gli hub eventi implementano lo streaming dei messaggi tramite un [modello consumer partizionato](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in cui ogni consumer legge solo un subset specifico, o partizione, del flusso di messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-364">Event Hubs implements message streaming through a [partitioned consumer model](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="bd015-365">Questo modello consente notevole scalabilità orizzontale per l'elaborazione di eventi e fornisce altre funzionalità incentrate sui flussi che non sono disponibili in code e argomenti.</span><span class="sxs-lookup"><span data-stu-id="bd015-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="bd015-366">Una partizione è una sequenza ordinata di eventi contenuta in un hub eventi.</span><span class="sxs-lookup"><span data-stu-id="bd015-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="bd015-367">Quando arrivano gli eventi più recenti, vengono aggiunti alla fine di questa sequenza.</span><span class="sxs-lookup"><span data-stu-id="bd015-367">As newer events arrive, they're added to the end of this sequence.</span></span><span data-ttu-id="bd015-368">Figura 4-19 Mostra il partizionamento in un hub eventi.</span><span class="sxs-lookup"><span data-stu-id="bd015-368"> Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Partizionamento dell'hub eventi](./media/event-hub-partitioning.png)

<span data-ttu-id="bd015-370">**Figura 4-19**.</span><span class="sxs-lookup"><span data-stu-id="bd015-370">**Figure 4-19**.</span></span> <span data-ttu-id="bd015-371">Partizionamento dell'hub eventi</span><span class="sxs-lookup"><span data-stu-id="bd015-371">Event Hub partitioning</span></span>

<span data-ttu-id="bd015-372">Anziché leggere dalla stessa risorsa, ogni gruppo di consumer legge in un subset, o partizione, il flusso di messaggi.</span><span class="sxs-lookup"><span data-stu-id="bd015-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span>

<span data-ttu-id="bd015-373">Per le applicazioni native cloud che devono eseguire lo streaming di un numero elevato di eventi, l'hub eventi di Azure può essere una soluzione affidabile e conveniente.</span><span class="sxs-lookup"><span data-stu-id="bd015-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="bd015-374">[Successivo](front-end-communication.md)
>[precedente](grpc.md)</span><span class="sxs-lookup"><span data-stu-id="bd015-374">[Previous](front-end-communication.md)
[Next](grpc.md)</span></span>
