---
title: Distribuzione di eShopOnContainers in Azure
description: Distribuzione dell'applicazione eShopOnContainers tramite il servizio Kubernetes di Azure, Helm e DevSpaces.
ms.date: 05/13/2020
ms.openlocfilehash: 93a2848f095d7593e1e169f4a6c6c1818a76217d
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/19/2020
ms.locfileid: "83614097"
---
# <a name="deploying-eshoponcontainers-to-azure"></a><span data-ttu-id="03bcf-103">Distribuzione di eShopOnContainers in Azure</span><span class="sxs-lookup"><span data-stu-id="03bcf-103">Deploying eShopOnContainers to Azure</span></span>

<span data-ttu-id="03bcf-104">L'applicazione eShopOnContainers può essere distribuita in un'ampia gamma di piattaforme Azure.</span><span class="sxs-lookup"><span data-stu-id="03bcf-104">The eShopOnContainers application can be deployed to a variety of Azure platforms.</span></span> <span data-ttu-id="03bcf-105">L'approccio consigliato consiste nel distribuire l'applicazione in Azure Kubernetes Services (AKS).</span><span class="sxs-lookup"><span data-stu-id="03bcf-105">The recommended approach is to deploy the application to Azure Kubernetes Services (AKS).</span></span> <span data-ttu-id="03bcf-106">Helm, uno strumento di distribuzione Kubernetes, è disponibile per ridurre la complessità della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="03bcf-106">Helm, a Kubernetes deployment tool, is available to reduce deployment complexity.</span></span> <span data-ttu-id="03bcf-107">Facoltativamente, gli sviluppatori possono implementare Azure Dev Spaces per Kubernetes per semplificare il processo di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="03bcf-107">Optionally, developers may implement Azure Dev Spaces for Kubernetes to streamline their development process.</span></span>

## <a name="azure-kubernetes-service"></a><span data-ttu-id="03bcf-108">Servizio Azure Kubernetes</span><span class="sxs-lookup"><span data-stu-id="03bcf-108">Azure Kubernetes Service</span></span>

<span data-ttu-id="03bcf-109">Per ospitare eShop in AKS, il primo passaggio consiste nel creare un cluster AKS.</span><span class="sxs-lookup"><span data-stu-id="03bcf-109">To host eShop in AKS, the first step is to create an AKS cluster.</span></span> <span data-ttu-id="03bcf-110">A tale scopo, è possibile usare la portale di Azure, che illustra i passaggi necessari.</span><span class="sxs-lookup"><span data-stu-id="03bcf-110">To do so, you might use the Azure portal, which will walk you through the required steps.</span></span> <span data-ttu-id="03bcf-111">È anche possibile creare un cluster dall'interfaccia della riga di comando di Azure, prestando attenzione per abilitare il controllo degli accessi in base al ruolo e il routing dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="03bcf-111">You could also create a cluster from the Azure CLI, taking care to enable Role-Based Access Control (RBAC) and application routing.</span></span> <span data-ttu-id="03bcf-112">La documentazione di eShopOnContainers descrive i passaggi per la creazione del cluster AKS.</span><span class="sxs-lookup"><span data-stu-id="03bcf-112">The eShopOnContainers' documentation details the steps for creating your own AKS cluster.</span></span> <span data-ttu-id="03bcf-113">Una volta creato, è possibile accedere al cluster e gestirlo dal dashboard di Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="03bcf-113">Once created, you can access and manage the cluster from the Kubernetes dashboard.</span></span>

<span data-ttu-id="03bcf-114">È ora possibile distribuire l'applicazione eShop nel cluster sfruttando Helm e Tiller.</span><span class="sxs-lookup"><span data-stu-id="03bcf-114">You can now deploy the eShop application to the cluster leveraging Helm and Tiller.</span></span>

## <a name="deploying-to-azure-kubernetes-service-using-helm"></a><span data-ttu-id="03bcf-115">Distribuzione nel servizio Azure Kubernetes tramite Helm</span><span class="sxs-lookup"><span data-stu-id="03bcf-115">Deploying to Azure Kubernetes Service using Helm</span></span>

<span data-ttu-id="03bcf-116">Helm è uno strumento di gestione dei pacchetti dell'applicazione che funziona direttamente con Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="03bcf-116">Helm is an application package manager tool that works directly with Kubernetes.</span></span> <span data-ttu-id="03bcf-117">Consente di definire, installare e aggiornare le applicazioni Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="03bcf-117">It helps you define, install, and upgrade Kubernetes applications.</span></span> <span data-ttu-id="03bcf-118">Sebbene le app semplici possano essere distribuite in AKS con script dell'interfaccia della riga di comando personalizzati o semplici file di distribuzione, le app complesse possono contenere molti oggetti Kubernetes e trarre vantaggio da Helm.</span><span class="sxs-lookup"><span data-stu-id="03bcf-118">While simple apps can be deployed to AKS with custom CLI scripts or simple deployment files, complex apps can contain many Kubernetes objects and benefit from Helm.</span></span>

<span data-ttu-id="03bcf-119">Con Helm, le applicazioni includono file di configurazione basati su testo, chiamati grafici Helm, che descrivono in modo dichiarativo l'applicazione e la configurazione nei pacchetti Helm.</span><span class="sxs-lookup"><span data-stu-id="03bcf-119">Using Helm, applications include text-based configuration files, called Helm charts, which declaratively describe the application and configuration in Helm packages.</span></span> <span data-ttu-id="03bcf-120">I grafici usano file in formato YAML standard per descrivere un set correlato di risorse Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="03bcf-120">Charts use standard YAML-formatted files to describe a related set of Kubernetes resources.</span></span> <span data-ttu-id="03bcf-121">Viene eseguito il controllo delle versioni insieme al codice dell'applicazione descritto.</span><span class="sxs-lookup"><span data-stu-id="03bcf-121">They're versioned alongside the application code they describe.</span></span> <span data-ttu-id="03bcf-122">I grafici Helm variano da semplici a complessi, a seconda dei requisiti dell'installazione che descrivono.</span><span class="sxs-lookup"><span data-stu-id="03bcf-122">Helm Charts range from simple to complex depending on the requirements of the installation they describe.</span></span>

<span data-ttu-id="03bcf-123">Helm è costituito da uno strumento client da riga di comando che utilizza i grafici Helm e avvia i comandi in un componente server denominato, Tiller.</span><span class="sxs-lookup"><span data-stu-id="03bcf-123">Helm is composed of a command-line client tool, which consumes helm charts and launches commands to a server component named, Tiller.</span></span> <span data-ttu-id="03bcf-124">Il timone comunica con l'API Kubernetes per garantire il corretto provisioning dei carichi di lavoro in contenitori.</span><span class="sxs-lookup"><span data-stu-id="03bcf-124">Tiller communicates with the Kubernetes API to ensure the correct provisioning of your containerized workloads.</span></span> <span data-ttu-id="03bcf-125">Helm è gestito da cloud-native Computing Foundation.</span><span class="sxs-lookup"><span data-stu-id="03bcf-125">Helm is maintained by the Cloud-native Computing Foundation.</span></span>

<span data-ttu-id="03bcf-126">Il file YAML seguente presenta un modello Helm:</span><span class="sxs-lookup"><span data-stu-id="03bcf-126">The following yaml file presents a Helm template:</span></span>

```yaml
apiVersion: v1
kind: Service
metadata:
  name: {{ .Values.app.svc.marketing }}
  labels:
    app: {{ template "marketing-api.name" . }}
    chart: {{ template "marketing-api.chart" . }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
spec:
  type: {{ .Values.service.type }}
  ports:
    - port: {{ .Values.service.port }}
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app: {{ template "marketing-api.name" . }}
    release: {{ .Release.Name }}
```

<span data-ttu-id="03bcf-127">Si noti come il modello descrive un set dinamico di coppie chiave/valore.</span><span class="sxs-lookup"><span data-stu-id="03bcf-127">Note how the template describes a dynamic set of key/value pairs.</span></span> <span data-ttu-id="03bcf-128">Quando il modello viene richiamato, i valori racchiusi tra parentesi graffe vengono estratti da altri file di configurazione basati su YAML.</span><span class="sxs-lookup"><span data-stu-id="03bcf-128">When the template is invoked, values that enclosed in curly braces are pulled in from other yaml-based configuration files.</span></span>

<span data-ttu-id="03bcf-129">I grafici Helm di eShopOnContainers sono disponibili nella cartella/K8S/Helm.</span><span class="sxs-lookup"><span data-stu-id="03bcf-129">You'll find the eShopOnContainers helm charts in the /k8s/helm folder.</span></span> <span data-ttu-id="03bcf-130">La figura 2-6 illustra come i diversi componenti dell'applicazione sono organizzati in una struttura di cartelle utilizzata da Helm per definire e distribuire le distribuzioni.</span><span class="sxs-lookup"><span data-stu-id="03bcf-130">Figure 2-6 shows how the different components of the application are organized into a folder structure used by helm to define and managed deployments.</span></span>

<span data-ttu-id="03bcf-131">![Architettura eShopOnContainers ](./media/eshoponcontainers-helm-folder.png)
 **Figura 2-6**.</span><span class="sxs-lookup"><span data-stu-id="03bcf-131">![eShopOnContainers Architecture](./media/eshoponcontainers-helm-folder.png)
**Figure 2-6**.</span></span> <span data-ttu-id="03bcf-132">Cartella Helm eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="03bcf-132">The eShopOnContainers helm folder.</span></span>

<span data-ttu-id="03bcf-133">Ogni singolo componente viene installato utilizzando un `helm install` comando.</span><span class="sxs-lookup"><span data-stu-id="03bcf-133">Each individual component is installed using a `helm install` command.</span></span> <span data-ttu-id="03bcf-134">eShop include uno script "deploy all" che esegue il ciclo e installa i componenti usando i rispettivi grafici Helm.</span><span class="sxs-lookup"><span data-stu-id="03bcf-134">eShop includes a "deploy all" script that loops through and installs the components using their respective helm charts.</span></span> <span data-ttu-id="03bcf-135">Il risultato è un processo ripetibile, con versione con l'applicazione nel controllo del codice sorgente, che chiunque nel team può distribuire in un cluster AKS con un comando di script a una riga.</span><span class="sxs-lookup"><span data-stu-id="03bcf-135">The result is a repeatable process, versioned with the application in source control, that anyone on the team can deploy to an AKS cluster with a one-line script command.</span></span>

> <span data-ttu-id="03bcf-136">Si noti che la versione 3 di Helm Elimina ufficialmente la necessità di un componente del server di Tiller.</span><span class="sxs-lookup"><span data-stu-id="03bcf-136">Note that version 3 of Helm officially removes the need for the Tiller server component.</span></span> <span data-ttu-id="03bcf-137">Altre informazioni su questo miglioramento sono disponibili [qui](https://medium.com/better-programming/why-is-tiller-missing-in-helm-3-2347c446714).</span><span class="sxs-lookup"><span data-stu-id="03bcf-137">More information on this enhancement can be found [here](https://medium.com/better-programming/why-is-tiller-missing-in-helm-3-2347c446714).</span></span>

## <a name="azure-dev-spaces"></a><span data-ttu-id="03bcf-138">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="03bcf-138">Azure Dev Spaces</span></span>

<span data-ttu-id="03bcf-139">Le applicazioni native del cloud possono diventare rapidamente grandi e complesse, con la necessità di eseguire risorse di calcolo significative.</span><span class="sxs-lookup"><span data-stu-id="03bcf-139">Cloud-native applications can quickly grow large and complex, requiring significant compute resources to run.</span></span> <span data-ttu-id="03bcf-140">In questi scenari, l'intera applicazione non può essere ospitata in un computer di sviluppo, soprattutto in un computer portatile.</span><span class="sxs-lookup"><span data-stu-id="03bcf-140">In these scenarios, the entire application can't be hosted on a development machine (especially a laptop).</span></span> <span data-ttu-id="03bcf-141">Azure Dev Spaces è progettato per risolvere questo problema usando AKS.</span><span class="sxs-lookup"><span data-stu-id="03bcf-141">Azure Dev Spaces is designed to address this problem using AKS.</span></span> <span data-ttu-id="03bcf-142">Consente agli sviluppatori di usare una versione locale dei servizi mentre ospita il resto dell'applicazione in un cluster di sviluppo AKS.</span><span class="sxs-lookup"><span data-stu-id="03bcf-142">It enables developers to work with a local version of their services while hosting the rest of the application in an AKS development cluster.</span></span>

<span data-ttu-id="03bcf-143">Gli sviluppatori condividono un'istanza in esecuzione (sviluppo) in un cluster AKS che contiene l'intera applicazione in contenitori.</span><span class="sxs-lookup"><span data-stu-id="03bcf-143">Developers share a running (development) instance in an AKS cluster that contains the entire containerized application.</span></span> <span data-ttu-id="03bcf-144">Ma usano gli spazi personali configurati nel computer per lo sviluppo locale dei servizi.</span><span class="sxs-lookup"><span data-stu-id="03bcf-144">But they use personal spaces set up on their machine to locally develop their services.</span></span> <span data-ttu-id="03bcf-145">Quando si è pronti, viene testato da end-to-end nel cluster AKS senza replicare le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="03bcf-145">When ready, they test from end-to-end in the AKS cluster - without replicating dependencies.</span></span> <span data-ttu-id="03bcf-146">Azure Dev Spaces unisce il codice del computer locale con i servizi in AKS.</span><span class="sxs-lookup"><span data-stu-id="03bcf-146">Azure Dev Spaces merges code from the local machine with services in AKS.</span></span> <span data-ttu-id="03bcf-147">I membri del team possono vedere come si comporteranno le modifiche in un ambiente AKS reale.</span><span class="sxs-lookup"><span data-stu-id="03bcf-147">Team members can see how their changes will behave in a real AKS environment.</span></span> <span data-ttu-id="03bcf-148">Gli sviluppatori possono eseguire rapidamente l'iterazione e il debug del codice direttamente in Kubernetes usando Visual Studio 2017 o Visual Studio Code.</span><span class="sxs-lookup"><span data-stu-id="03bcf-148">Developers can rapidly iterate and debug code directly in Kubernetes using Visual Studio 2017 or Visual Studio Code.</span></span>

<span data-ttu-id="03bcf-149">Nella figura 2-7 è possibile vedere che lo sviluppatore Susie ha distribuito una versione aggiornata del microservizio Bikes nello spazio di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="03bcf-149">In Figure 2-7, you can see that Developer Susie has deployed an updated version of the Bikes microservice into her dev space.</span></span> <span data-ttu-id="03bcf-150">Potrà quindi testare le modifiche usando un URL personalizzato che inizia con il nome dello spazio (susie.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="03bcf-150">She's then able to test her changes using a custom URL starting with the name of her space (susie.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="03bcf-151">![Architettura eShopOnContainers ](./media/azure-devspaces-one.png)
 **Figura 2-7**.</span><span class="sxs-lookup"><span data-stu-id="03bcf-151">![eShopOnContainers Architecture](./media/azure-devspaces-one.png)
**Figure 2-7**.</span></span> <span data-ttu-id="03bcf-152">Developer Susie distribuisce la propria versione del microservizio Bikes e ne esegue il test.</span><span class="sxs-lookup"><span data-stu-id="03bcf-152">Developer Susie deploys her own version of the Bikes microservice and tests it.</span></span>

<span data-ttu-id="03bcf-153">Allo stesso tempo, lo sviluppatore Giorgio sta personalizzando il microservizio prenotazioni e deve testare le proprie modifiche.</span><span class="sxs-lookup"><span data-stu-id="03bcf-153">At the same time, developer John is customizing the Reservations microservice and needs to test his changes.</span></span> <span data-ttu-id="03bcf-154">Distribuisce le modifiche nel proprio spazio di sviluppo senza conflitti con le modifiche di Susie, come illustrato nella figura 2-8.</span><span class="sxs-lookup"><span data-stu-id="03bcf-154">He deploys his changes to his own dev space without conflicting with Susie's changes as shown in Figure 2-8.</span></span> <span data-ttu-id="03bcf-155">Giorgio quindi testa le modifiche usando il proprio URL, che è preceduto dal nome dello spazio (john.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="03bcf-155">John then tests his changes using his own URL that is prefixed with the name of his space (john.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="03bcf-156">![Architettura eShopOnContainers ](./media/azure-devspaces-two.png)
 **Figura 2-8**.</span><span class="sxs-lookup"><span data-stu-id="03bcf-156">![eShopOnContainers Architecture](./media/azure-devspaces-two.png)
**Figure 2-8**.</span></span> <span data-ttu-id="03bcf-157">Developer Giorgio distribuisce la propria versione del microservizio prenotazioni e la testa senza conflitti con altri sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="03bcf-157">Developer John deploys his own version of the Reservations microservice and tests it without conflicting with other developers.</span></span>

<span data-ttu-id="03bcf-158">Con Azure Dev Spaces, i team possono lavorare direttamente con AKS mentre cambiano, distribuiscono e verificano le modifiche in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="03bcf-158">Using Azure Dev Spaces, teams can work directly with AKS while independently changing, deploying, and testing their changes.</span></span> <span data-ttu-id="03bcf-159">Questo approccio riduce la necessità di ambienti host dedicati distinti, perché ogni sviluppatore ha in effetti un proprio ambiente AKS.</span><span class="sxs-lookup"><span data-stu-id="03bcf-159">This approach reduces the need for separate dedicated hosted environments since every developer effectively has their own AKS environment.</span></span> <span data-ttu-id="03bcf-160">Gli sviluppatori possono lavorare con Azure Dev Spaces usando l'interfaccia della riga di comando o avviare l'applicazione per Azure Dev Spaces direttamente da Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="03bcf-160">Developers can work with Azure Dev Spaces using its CLI or launch their application to Azure Dev Spaces directly from Visual Studio.</span></span> [<span data-ttu-id="03bcf-161">Altre informazioni sul funzionamento di Azure Dev Spaces e sulla configurazione.</span><span class="sxs-lookup"><span data-stu-id="03bcf-161">Learn more about how Azure Dev Spaces works and is configured.</span></span>](https://docs.microsoft.com/azure/dev-spaces/how-dev-spaces-works)

## <a name="azure-functions-and-logic-apps-serverless"></a><span data-ttu-id="03bcf-162">Funzioni di Azure e app per la logica (senza server)</span><span class="sxs-lookup"><span data-stu-id="03bcf-162">Azure Functions and Logic Apps (Serverless)</span></span>

<span data-ttu-id="03bcf-163">L'esempio eShopOnContainers include il supporto per tenere traccia delle campagne di marketing online.</span><span class="sxs-lookup"><span data-stu-id="03bcf-163">The eShopOnContainers sample includes support for tracking online marketing campaigns.</span></span> <span data-ttu-id="03bcf-164">Una funzione di Azure viene usata per tenere traccia dei dettagli della campagna di marketing per un determinato ID campagna.</span><span class="sxs-lookup"><span data-stu-id="03bcf-164">An Azure Function is used to track marketing campaign details for a given campaign ID.</span></span> <span data-ttu-id="03bcf-165">Anziché creare un microservizio completo, una singola funzione di Azure è più semplice e sufficiente.</span><span class="sxs-lookup"><span data-stu-id="03bcf-165">Rather than creating a full microservice, a single Azure Function is simpler and sufficient.</span></span> <span data-ttu-id="03bcf-166">Funzioni di Azure include un semplice modello di compilazione e distribuzione, specialmente se configurato per l'esecuzione in Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="03bcf-166">Azure Functions have a simple build and deployment model, especially when configured to run in Kubernetes.</span></span> <span data-ttu-id="03bcf-167">La distribuzione della funzione viene scritta tramite script usando i modelli di Azure Resource Manager (ARM) e l'interfaccia della riga di comando di Azure.</span><span class="sxs-lookup"><span data-stu-id="03bcf-167">Deploying the function is scripted using Azure Resource Manager (ARM) templates and the Azure CLI.</span></span> <span data-ttu-id="03bcf-168">Questo servizio della campagna non è rivolte al cliente e richiama una singola operazione, rendendolo un candidato ideale per funzioni di Azure.</span><span class="sxs-lookup"><span data-stu-id="03bcf-168">This campaign service isn't customer-facing and invokes a single operation, making it a great candidate for Azure Functions.</span></span> <span data-ttu-id="03bcf-169">La funzione richiede una configurazione minima, incluse le impostazioni di dati della stringa di connessione del database e dell'URI di base dell'immagine.</span><span class="sxs-lookup"><span data-stu-id="03bcf-169">The function requires minimal configuration, including a database connection string data and image base URI settings.</span></span> <span data-ttu-id="03bcf-170">Le funzioni di Azure vengono configurate nel portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="03bcf-170">You configure Azure Functions in the Azure portal.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="03bcf-171">[Precedente](map-eshoponcontainers-azure-services.md) 
> [Avanti](centralized-configuration.md)</span><span class="sxs-lookup"><span data-stu-id="03bcf-171">[Previous](map-eshoponcontainers-azure-services.md)
[Next](centralized-configuration.md)</span></span>
