---
title: Crea servizi resilienti pronti per il cloud. Gestire gli errori temporanei nel cloud
description: Modernizzare le applicazioni .NET esistenti con il cloud di Azure e i contenitori di Windows | Crea servizi resilienti pronti per il cloud. Gestire gli errori temporanei nel cloud
ms.date: 04/30/2018
ms.openlocfilehash: 899084ac00d9be0df47ef88c026f4e8c19722bb6
ms.sourcegitcommit: ee5b798427f81237a3c23d1fd81fff7fdc21e8d3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/28/2020
ms.locfileid: "84144252"
---
# <a name="build-resilient-services-ready-for-the-cloud-embrace-transient-failures-in-the-cloud"></a><span data-ttu-id="9da18-105">Creare servizi resilienti pronti per il cloud: gestire gli errori temporanei nel cloud</span><span class="sxs-lookup"><span data-stu-id="9da18-105">Build resilient services ready for the cloud: Embrace transient failures in the cloud</span></span>

<span data-ttu-id="9da18-106">La resilienza è la capacità di recupero da errori che consente un funzionamento continuativo.</span><span class="sxs-lookup"><span data-stu-id="9da18-106">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="9da18-107">La resilienza non riguarda l'evitare gli errori, ma accettando il fatto che si verifichino errori e quindi rispondendo a tali errori in modo da evitare tempi di inattività o perdite di dati.</span><span class="sxs-lookup"><span data-stu-id="9da18-107">Resiliency is not about avoiding failures, but accepting the fact that failures will occur, and then responding to them in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="9da18-108">L'obiettivo della resilienza è riportare l'applicazione in uno stato pienamente operativo dopo un errore.</span><span class="sxs-lookup"><span data-stu-id="9da18-108">The goal of resiliency is to return the application to a fully functioning state after a failure.</span></span>

<span data-ttu-id="9da18-109">L'applicazione è pronta per il cloud quando, come minimo, implementa un modello basato sul software di resilienza, anziché un modello basato su hardware.</span><span class="sxs-lookup"><span data-stu-id="9da18-109">Your application is ready for the cloud when, at a minimum, it implements a software-based model of resiliency, rather than a hardware-based model.</span></span> <span data-ttu-id="9da18-110">L'applicazione cloud deve accettare gli errori parziali che certamente si verificheranno.</span><span class="sxs-lookup"><span data-stu-id="9da18-110">Your cloud application must embrace the partial failures that will certainly occur.</span></span> <span data-ttu-id="9da18-111">Progettare o eseguire il refactoring parziale dell'applicazione per ottenere la resilienza con errori parziali previsti.</span><span class="sxs-lookup"><span data-stu-id="9da18-111">Design or partially refactor your application to achieve resiliency with expected partial failures.</span></span> <span data-ttu-id="9da18-112">Deve essere progettato per gestire gli errori parziali, ad esempio interruzioni della rete transitoria e nodi, o arresti anomali delle macchine virtuali nel cloud.</span><span class="sxs-lookup"><span data-stu-id="9da18-112">It should be designed to cope with partial failures, like transient network outages and nodes, or VMs crashing in the cloud.</span></span> <span data-ttu-id="9da18-113">Anche i contenitori spostati in un nodo diverso all'interno di un cluster dell'agente di orchestrazione possono causare errori intermittenti all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9da18-113">Even containers being moved to a different node within an orchestrator cluster can cause intermittent short failures within the application.</span></span>

## <a name="handling-partial-failure"></a><span data-ttu-id="9da18-114">Gestione degli errori parziali</span><span class="sxs-lookup"><span data-stu-id="9da18-114">Handling partial failure</span></span>

<span data-ttu-id="9da18-115">In un'applicazione basata sul cloud è presente un rischio costante di errore parziale.</span><span class="sxs-lookup"><span data-stu-id="9da18-115">In a cloud-based application, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="9da18-116">Ad esempio, una singola istanza di sito Web o un contenitore potrebbe non riuscire o potrebbe non essere disponibile o non rispondere per un breve periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="9da18-116">For instance, a single website instance or a container might fail, or it might be unavailable or unresponsive for a short time.</span></span> <span data-ttu-id="9da18-117">In alternativa, è possibile che una singola macchina virtuale o un server si arresti</span><span class="sxs-lookup"><span data-stu-id="9da18-117">Or, a single VM or server might crash.</span></span>

<span data-ttu-id="9da18-118">Poiché i client e i servizi sono processi distinti, un servizio potrebbe non essere in grado di rispondere tempestivamente a una richiesta del client.</span><span class="sxs-lookup"><span data-stu-id="9da18-118">Because clients and services are separate processes, a service might not be able to respond in a timely manner to a client's request.</span></span> <span data-ttu-id="9da18-119">Il servizio potrebbe essere sovraccarico e rispondere lentamente alle richieste oppure potrebbe non essere accessibile per un breve periodo di tempo a causa di problemi di rete.</span><span class="sxs-lookup"><span data-stu-id="9da18-119">The service might be overloaded and respond slowly to requests, or it might not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="9da18-120">Si consideri, ad esempio, un'applicazione .NET monolitica che accede a un database nel database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="9da18-120">For example, consider a monolithic .NET application that accesses a database in Azure SQL Database.</span></span> <span data-ttu-id="9da18-121">Se il database SQL di Azure o qualsiasi altro servizio di terze parti non risponde per un breve periodo di tempo (un database SQL di Azure può essere spostato in un nodo o un server diverso e non risponde per pochi secondi), quando l'utente tenta di eseguire un'azione, l'applicazione potrebbe arrestarsi in modo anomalo e visualizzare un'eccezione nello stesso momento.</span><span class="sxs-lookup"><span data-stu-id="9da18-121">If the Azure SQL database or any other third-party service is unresponsive for a brief time (an Azure SQL database might be moved to a different node or server, and be unresponsive for a few seconds), when the user tries to do any action, the application might crash and show an exception at the same moment.</span></span>

<span data-ttu-id="9da18-122">Uno scenario simile potrebbe verificarsi in un'app che usa i servizi HTTP.</span><span class="sxs-lookup"><span data-stu-id="9da18-122">A similar scenario might occur in an app that consumes HTTP services.</span></span> <span data-ttu-id="9da18-123">La rete o il servizio stesso potrebbe non essere disponibile nel cloud durante un breve errore temporaneo.</span><span class="sxs-lookup"><span data-stu-id="9da18-123">The network or the service itself might not be available in the cloud during a short, transient failure.</span></span>

<span data-ttu-id="9da18-124">Un'applicazione resiliente come quella illustrata nella figura 4-9 dovrebbe implementare tecniche quali "tentativi con backoff esponenziale" per offrire all'applicazione la possibilità di gestire gli errori temporanei nelle risorse.</span><span class="sxs-lookup"><span data-stu-id="9da18-124">A resilient application like the one shown in Figure 4-9 should implement techniques like "retries with exponential backoff" to give the application an opportunity to handle transient failures in resources.</span></span> <span data-ttu-id="9da18-125">È inoltre consigliabile usare "interruttori di circuito" nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="9da18-125">You also should use "circuit breakers" in your applications.</span></span> <span data-ttu-id="9da18-126">Un interruttore impedisce a un'applicazione di provare ad accedere a una risorsa quando si tratta in realtà di un errore a lungo termine.</span><span class="sxs-lookup"><span data-stu-id="9da18-126">A circuit breaker stops an application from trying to access a resource when it's actually a long-term failure.</span></span> <span data-ttu-id="9da18-127">Usando un interruttore, l'applicazione evita di provocare un attacco Denial of Service a se stesso.</span><span class="sxs-lookup"><span data-stu-id="9da18-127">By using a circuit breaker, the application avoids provoking a denial of service to itself.</span></span>

![Diagramma degli errori parziali gestiti da tentativi con backoff esponenziale.](./media/retry-partial-failures.png)

<span data-ttu-id="9da18-129">**Figura 4-9.**</span><span class="sxs-lookup"><span data-stu-id="9da18-129">**Figure 4-9.**</span></span> <span data-ttu-id="9da18-130">Errori parziali gestiti da tentativi con backoff esponenziale</span><span class="sxs-lookup"><span data-stu-id="9da18-130">Partial failures handled by retries with exponential backoff</span></span>

<span data-ttu-id="9da18-131">È possibile utilizzare queste tecniche sia nelle risorse HTTP che nelle risorse del database.</span><span class="sxs-lookup"><span data-stu-id="9da18-131">You can use these techniques both in HTTP resources and in database resources.</span></span> <span data-ttu-id="9da18-132">Nella figura 4-9, l'applicazione è basata su un'architettura a 3 livelli, quindi sono necessarie queste tecniche a livello di servizi (HTTP) e a livello di livello dati (TCP).</span><span class="sxs-lookup"><span data-stu-id="9da18-132">In Figure 4-9, the application is based on a 3-tier architecture, so you need these techniques at the services level (HTTP) and at the data tier level (TCP).</span></span> <span data-ttu-id="9da18-133">In un'applicazione monolitica che usa un solo livello app, oltre al database (senza servizi o microservizi aggiuntivi), la gestione degli errori temporanei a livello di connessione al database potrebbe essere sufficiente.</span><span class="sxs-lookup"><span data-stu-id="9da18-133">In a monolithic application that uses only a single app tier in addition to the database (no additional services or microservices), handling transient failures at the database connection level might be enough.</span></span> <span data-ttu-id="9da18-134">In questo scenario è necessaria solo una particolare configurazione della connessione al database.</span><span class="sxs-lookup"><span data-stu-id="9da18-134">In that scenario, just a particular configuration of the database connection is required.</span></span>

<span data-ttu-id="9da18-135">Quando si implementano comunicazioni resilienti che accedono al database, a seconda della versione di .NET in uso, può essere semplice, ad esempio [con Entity Framework 6 o versioni successive](/ef/ef6/fundamentals/connection-resiliency/retry-logic).</span><span class="sxs-lookup"><span data-stu-id="9da18-135">When implementing resilient communications that access the database, depending on the version of .NET you are using, it can be straightforward (for example, [with Entity Framework 6 or later](/ef/ef6/fundamentals/connection-resiliency/retry-logic).</span></span> <span data-ttu-id="9da18-136">È sufficiente configurare la connessione al database.</span><span class="sxs-lookup"><span data-stu-id="9da18-136">It's just a matter of configuring the database connection).</span></span> <span data-ttu-id="9da18-137">In alternativa, potrebbe essere necessario usare librerie aggiuntive come il [blocco di applicazioni per la gestione degli errori temporanei](https://docs.microsoft.com/previous-versions/msp-n-p/hh680934(v=pandp.50)) (per le versioni precedenti di .NET) o persino implementare una libreria personalizzata.</span><span class="sxs-lookup"><span data-stu-id="9da18-137">Or, you might need to use additional libraries like the [Transient Fault Handling Application Block](https://docs.microsoft.com/previous-versions/msp-n-p/hh680934(v=pandp.50)) (for earlier versions of .NET), or even implement your own library.</span></span>

<span data-ttu-id="9da18-138">Quando si implementano i tentativi HTTP e gli interruttori di circuito, la raccomandazione per .NET consiste nell'usare la libreria [Polly](https://github.com/App-vNext/Polly) , che ha come destinazione .NET Framework 4,0, .NET Framework 4,5 e .NET standard 1,1, che include il supporto di .NET Core.</span><span class="sxs-lookup"><span data-stu-id="9da18-138">When implementing HTTP retries and circuit breakers, the recommendation for .NET is to use the [Polly](https://github.com/App-vNext/Polly) library, which targets .NET Framework 4.0, .NET Framework 4.5, and .NET Standard 1.1, which includes .NET Core support.</span></span>

<span data-ttu-id="9da18-139">Per informazioni su come implementare strategie per la gestione di errori parziali nel cloud, vedere i riferimenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="9da18-139">To learn how to implement strategies for handling partial failures in the cloud, see the following references.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="9da18-140">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="9da18-140">Additional resources</span></span>

- <span data-ttu-id="9da18-141">**Implementazione della comunicazione resiliente per la gestione di errori parziali**</span><span class="sxs-lookup"><span data-stu-id="9da18-141">**Implementing resilient communication to handle partial failure**</span></span>

    [https://docs.microsoft.com/dotnet/architecture/microservices/implement-resilient-applications/partial-failure-strategies](../../microservices/implement-resilient-applications/partial-failure-strategies.md)

- <span data-ttu-id="9da18-142">**Entity Framework la resilienza della connessione e la logica di ripetizione dei tentativi (versione 6 e successive)**</span><span class="sxs-lookup"><span data-stu-id="9da18-142">**Entity Framework connection resiliency and retry logic (version 6 and later)**</span></span>

    [https://docs.microsoft.com/ef/ef6/fundamentals/connection-resiliency/retry-logic](/ef/ef6/fundamentals/connection-resiliency/retry-logic)

- <span data-ttu-id="9da18-143">**Blocco di applicazioni per la gestione degli errori temporanei**</span><span class="sxs-lookup"><span data-stu-id="9da18-143">**The Transient Fault Handling Application Block**</span></span>

- <https://docs.microsoft.com/previous-versions/msp-n-p/hh680934(v=pandp.50)>

- <span data-ttu-id="9da18-144">**Libreria Polly per la comunicazione HTTP resiliente**</span><span class="sxs-lookup"><span data-stu-id="9da18-144">**Polly library for resilient HTTP communication**</span></span>

    <https://github.com/App-vNext/Polly>

>[!div class="step-by-step"]
><span data-ttu-id="9da18-145">[Precedente](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md) 
> [Avanti](modernize-your-apps-with-monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="9da18-145">[Previous](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
[Next](modernize-your-apps-with-monitoring-and-telemetry.md)</span></span>
